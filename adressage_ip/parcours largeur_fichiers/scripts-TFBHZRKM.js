(function(){function A(ee){return ee&&ee.__esModule?ee.default:ee}function j(ee){if(ee===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ee}function M(ee,z){if(!(ee instanceof z))throw new TypeError("Cannot call a class as a function")}function w(ee,z){for(var P=0;P<z.length;P++){var Y=z[P];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(ee,Y.key,Y)}}function E(ee,z,P){return z&&w(ee.prototype,z),P&&w(ee,P),ee}function N(ee){return N=Object.setPrototypeOf?Object.getPrototypeOf:function(z){return z.__proto__||Object.getPrototypeOf(z)},N(ee)}function O(ee,z){return O=Object.setPrototypeOf||function(P,Y){return P.__proto__=Y,P},O(ee,z)}function x(ee,z){if(typeof z!="function"&&z!==null)throw new TypeError("Super expression must either be null or a function");ee.prototype=Object.create(z&&z.prototype,{constructor:{value:ee,writable:!0,configurable:!0}}),z&&O(ee,z)}function I(ee,z){return!z||((P=z)&&P.constructor===Symbol?"symbol":typeof P)!="object"&&typeof z!="function"?j(ee):z;var P}var _;function S(ee){return Array.isArray(ee)||{}.toString.call(ee)=="[object Object]"}function u(ee){return!ee||typeof ee!="object"&&typeof ee!="function"}_=function ee(){var z=[].slice.call(arguments),P=!1;typeof z[0]=="boolean"&&(P=z.shift());var Y=z[0];if(u(Y))throw new Error("extendee must be an object");for(var $=z.slice(1),J=$.length,te=0;te<J;te++){var q=$[te];for(var K in q)if(Object.prototype.hasOwnProperty.call(q,K)){var U=q[K];if(P&&S(U)){var F=Array.isArray(U)?[]:{};Y[K]=ee(!0,Object.prototype.hasOwnProperty.call(Y,K)&&!u(Y[K])?Y[K]:F,U)}else Y[K]=U}}return Y};var y=function(){"use strict";function ee(){M(this,ee)}return E(ee,[{key:"on",value:function(z,P){return this._callbacks=this._callbacks||{},this._callbacks[z]||(this._callbacks[z]=[]),this._callbacks[z].push(P),this}},{key:"emit",value:function(z){for(var P=arguments.length,Y=new Array(P>1?P-1:0),$=1;$<P;$++)Y[$-1]=arguments[$];this._callbacks=this._callbacks||{};var J=this._callbacks[z],te=!0,q=!1,K=void 0;if(J)try{for(var U,F=J[Symbol.iterator]();!(te=(U=F.next()).done);te=!0){var re=U.value;re.apply(this,Y)}}catch(W){q=!0,K=W}finally{try{te||F.return==null||F.return()}finally{if(q)throw K}}return this.element&&this.element.dispatchEvent(this.makeEvent("dropzone:"+z,{args:Y})),this}},{key:"makeEvent",value:function(z,P){var Y={bubbles:!0,cancelable:!0,detail:P};if(typeof window.CustomEvent=="function")return new CustomEvent(z,Y);var $=document.createEvent("CustomEvent");return $.initCustomEvent(z,Y.bubbles,Y.cancelable,Y.detail),$}},{key:"off",value:function(z,P){if(!this._callbacks||arguments.length===0)return this._callbacks={},this;var Y=this._callbacks[z];if(!Y)return this;if(arguments.length===1)return delete this._callbacks[z],this;for(var $=0;$<Y.length;$++){var J=Y[$];if(J===P){Y.splice($,1);break}}return this}}]),ee}(),v={url:null,method:"post",withCredentials:!1,timeout:null,parallelUploads:2,uploadMultiple:!1,chunking:!1,forceChunking:!1,chunkSize:2097152,parallelChunkUploads:!1,retryChunks:!1,retryChunksLimit:3,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,thumbnailMethod:"crop",resizeWidth:null,resizeHeight:null,resizeMimeType:null,resizeQuality:.8,resizeMethod:"contain",filesizeBase:1e3,maxFiles:null,headers:null,defaultHeaders:!0,clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,disablePreviews:!1,hiddenInputContainer:"body",capture:null,renameFilename:null,renameFile:null,forceFallback:!1,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictUploadCanceled:"Upload canceled.",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",dictFileSizeUnits:{tb:"TB",gb:"GB",mb:"MB",kb:"KB",b:"b"},init:function(){},params:function(ee,z,P){if(P)return{dzuuid:P.file.upload.uuid,dzchunkindex:P.index,dztotalfilesize:P.file.size,dzchunksize:this.options.chunkSize,dztotalchunkcount:P.file.upload.totalChunkCount,dzchunkbyteoffset:P.index*this.options.chunkSize}},accept:function(ee,z){return z()},chunksUploaded:function(ee,z){z()},binaryBody:!1,fallback:function(){var ee;this.element.className="".concat(this.element.className," dz-browser-not-supported");var z=!0,P=!1,Y=void 0;try{for(var $,J=this.element.getElementsByTagName("div")[Symbol.iterator]();!(z=($=J.next()).done);z=!0){var te=$.value;if(/(^| )dz-message($| )/.test(te.className)){ee=te,te.className="dz-message";break}}}catch(K){P=!0,Y=K}finally{try{z||J.return==null||J.return()}finally{if(P)throw Y}}ee||(ee=m.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(ee));var q=ee.getElementsByTagName("span")[0];return q&&(q.textContent!=null?q.textContent=this.options.dictFallbackMessage:q.innerText!=null&&(q.innerText=this.options.dictFallbackMessage)),this.element.appendChild(this.getFallbackForm())},resize:function(ee,z,P,Y){var $={srcX:0,srcY:0,srcWidth:ee.width,srcHeight:ee.height},J=ee.width/ee.height;z==null&&P==null?(z=$.srcWidth,P=$.srcHeight):z==null?z=P*J:P==null&&(P=z/J);var te=(z=Math.min(z,$.srcWidth))/(P=Math.min(P,$.srcHeight));if($.srcWidth>z||$.srcHeight>P)if(Y==="crop")J>te?($.srcHeight=ee.height,$.srcWidth=$.srcHeight*te):($.srcWidth=ee.width,$.srcHeight=$.srcWidth/te);else{if(Y!=="contain")throw new Error("Unknown resizeMethod '".concat(Y,"'"));J>te?P=z/J:z=P*J}return $.srcX=(ee.width-$.srcWidth)/2,$.srcY=(ee.height-$.srcHeight)/2,$.trgWidth=z,$.trgHeight=P,$},transformFile:function(ee,z){return(this.options.resizeWidth||this.options.resizeHeight)&&ee.type.match(/image.*/)?this.resizeImage(ee,this.options.resizeWidth,this.options.resizeHeight,this.options.resizeMethod,z):z(ee)},previewTemplate:A('<div class="dz-file-preview dz-preview"> <div class="dz-image"><img data-dz-thumbnail=""></div> <div class="dz-details"> <div class="dz-size"><span data-dz-size=""></span></div> <div class="dz-filename"><span data-dz-name=""></span></div> </div> <div class="dz-progress"> <span class="dz-upload" data-dz-uploadprogress=""></span> </div> <div class="dz-error-message"><span data-dz-errormessage=""></span></div> <div class="dz-success-mark"> <svg width="54" height="54" fill="#fff"><path d="m10.207 29.793 4.086-4.086a1 1 0 0 1 1.414 0l5.586 5.586a1 1 0 0 0 1.414 0l15.586-15.586a1 1 0 0 1 1.414 0l4.086 4.086a1 1 0 0 1 0 1.414L22.707 42.293a1 1 0 0 1-1.414 0L10.207 31.207a1 1 0 0 1 0-1.414Z"/></svg> </div> <div class="dz-error-mark"> <svg width="54" height="54" fill="#fff"><path d="m26.293 20.293-7.086-7.086a1 1 0 0 0-1.414 0l-4.586 4.586a1 1 0 0 0 0 1.414l7.086 7.086a1 1 0 0 1 0 1.414l-7.086 7.086a1 1 0 0 0 0 1.414l4.586 4.586a1 1 0 0 0 1.414 0l7.086-7.086a1 1 0 0 1 1.414 0l7.086 7.086a1 1 0 0 0 1.414 0l4.586-4.586a1 1 0 0 0 0-1.414l-7.086-7.086a1 1 0 0 1 0-1.414l7.086-7.086a1 1 0 0 0 0-1.414l-4.586-4.586a1 1 0 0 0-1.414 0l-7.086 7.086a1 1 0 0 1-1.414 0Z"/></svg> </div> </div>'),drop:function(ee){return this.element.classList.remove("dz-drag-hover")},dragstart:function(ee){},dragend:function(ee){return this.element.classList.remove("dz-drag-hover")},dragenter:function(ee){return this.element.classList.add("dz-drag-hover")},dragover:function(ee){return this.element.classList.add("dz-drag-hover")},dragleave:function(ee){return this.element.classList.remove("dz-drag-hover")},paste:function(ee){},reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(ee){if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer&&!this.options.disablePreviews){var z=this;ee.previewElement=m.createElement(this.options.previewTemplate.trim()),ee.previewTemplate=ee.previewElement,this.previewsContainer.appendChild(ee.previewElement);var P=!0,Y=!1,$=void 0;try{for(var J,te=ee.previewElement.querySelectorAll("[data-dz-name]")[Symbol.iterator]();!(P=(J=te.next()).done);P=!0){var q=J.value;q.textContent=ee.name}}catch(le){Y=!0,$=le}finally{try{P||te.return==null||te.return()}finally{if(Y)throw $}}var K=!0,U=!1,F=void 0;try{for(var re,W=ee.previewElement.querySelectorAll("[data-dz-size]")[Symbol.iterator]();!(K=(re=W.next()).done);K=!0)(q=re.value).innerHTML=this.filesize(ee.size)}catch(le){U=!0,F=le}finally{try{K||W.return==null||W.return()}finally{if(U)throw F}}this.options.addRemoveLinks&&(ee._removeLink=m.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'.concat(this.options.dictRemoveFile,"</a>")),ee.previewElement.appendChild(ee._removeLink));var ie=function(le){var me=z;if(le.preventDefault(),le.stopPropagation(),ee.status===m.UPLOADING)return m.confirm(z.options.dictCancelUploadConfirmation,function(){return me.removeFile(ee)});var De=z;return z.options.dictRemoveFileConfirmation?m.confirm(z.options.dictRemoveFileConfirmation,function(){return De.removeFile(ee)}):z.removeFile(ee)},he=!0,ve=!1,Ne=void 0;try{for(var ze,rt=ee.previewElement.querySelectorAll("[data-dz-remove]")[Symbol.iterator]();!(he=(ze=rt.next()).done);he=!0)ze.value.addEventListener("click",ie)}catch(le){ve=!0,Ne=le}finally{try{he||rt.return==null||rt.return()}finally{if(ve)throw Ne}}}},removedfile:function(ee){return ee.previewElement!=null&&ee.previewElement.parentNode!=null&&ee.previewElement.parentNode.removeChild(ee.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(ee,z){if(ee.previewElement){ee.previewElement.classList.remove("dz-file-preview");var P=!0,Y=!1,$=void 0;try{for(var J,te=ee.previewElement.querySelectorAll("[data-dz-thumbnail]")[Symbol.iterator]();!(P=(J=te.next()).done);P=!0){var q=J.value;q.alt=ee.name,q.src=z}}catch(K){Y=!0,$=K}finally{try{P||te.return==null||te.return()}finally{if(Y)throw $}}return setTimeout(function(){return ee.previewElement.classList.add("dz-image-preview")},1)}},error:function(ee,z){if(ee.previewElement){ee.previewElement.classList.add("dz-error"),typeof z!="string"&&z.error&&(z=z.error);var P=!0,Y=!1,$=void 0;try{for(var J,te=ee.previewElement.querySelectorAll("[data-dz-errormessage]")[Symbol.iterator]();!(P=(J=te.next()).done);P=!0)J.value.textContent=z}catch(q){Y=!0,$=q}finally{try{P||te.return==null||te.return()}finally{if(Y)throw $}}}},errormultiple:function(){},processing:function(ee){if(ee.previewElement&&(ee.previewElement.classList.add("dz-processing"),ee._removeLink))return ee._removeLink.innerHTML=this.options.dictCancelUpload},processingmultiple:function(){},uploadprogress:function(ee,z,P){var Y=!0,$=!1,J=void 0;if(ee.previewElement)try{for(var te,q=ee.previewElement.querySelectorAll("[data-dz-uploadprogress]")[Symbol.iterator]();!(Y=(te=q.next()).done);Y=!0){var K=te.value;K.nodeName==="PROGRESS"?K.value=z:K.style.width="".concat(z,"%")}}catch(U){$=!0,J=U}finally{try{Y||q.return==null||q.return()}finally{if($)throw J}}},totaluploadprogress:function(){},sending:function(){},sendingmultiple:function(){},success:function(ee){if(ee.previewElement)return ee.previewElement.classList.add("dz-success")},successmultiple:function(){},canceled:function(ee){return this.emit("error",ee,this.options.dictUploadCanceled)},canceledmultiple:function(){},complete:function(ee){if(ee._removeLink&&(ee._removeLink.innerHTML=this.options.dictRemoveFile),ee.previewElement)return ee.previewElement.classList.add("dz-complete")},completemultiple:function(){},maxfilesexceeded:function(){},maxfilesreached:function(){},queuecomplete:function(){},addedfiles:function(){}},m=function(ee){"use strict";function z(P,Y){var $,J,te,q;if(M(this,z),($=I(this,(J=z,N(J)).call(this))).element=P,$.clickableElements=[],$.listeners=[],$.files=[],typeof $.element=="string"&&($.element=document.querySelector($.element)),!$.element||$.element.nodeType==null)throw new Error("Invalid dropzone element.");if($.element.dropzone)throw new Error("Dropzone already attached.");z.instances.push(j($)),$.element.dropzone=j($);var K=(q=z.optionsForElement($.element))!=null?q:{};if($.options=A(_)(!0,{},v,K,Y??{}),$.options.previewTemplate=$.options.previewTemplate.replace(/\n*/g,""),$.options.forceFallback||!z.isBrowserSupported())return I($,$.options.fallback.call(j($)));if($.options.url==null&&($.options.url=$.element.getAttribute("action")),!$.options.url)throw new Error("No URL provided.");if($.options.acceptedFiles&&$.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");if($.options.uploadMultiple&&$.options.chunking)throw new Error("You cannot set both: uploadMultiple and chunking.");if($.options.binaryBody&&$.options.uploadMultiple)throw new Error("You cannot set both: binaryBody and uploadMultiple.");return $.options.acceptedMimeTypes&&($.options.acceptedFiles=$.options.acceptedMimeTypes,delete $.options.acceptedMimeTypes),$.options.renameFilename!=null&&($.options.renameFile=function(U){return $.options.renameFilename.call(j($),U.name,U)}),typeof $.options.method=="string"&&($.options.method=$.options.method.toUpperCase()),(te=$.getExistingFallback())&&te.parentNode&&te.parentNode.removeChild(te),$.options.previewsContainer!==!1&&($.options.previewsContainer?$.previewsContainer=z.getElement($.options.previewsContainer,"previewsContainer"):$.previewsContainer=$.element),$.options.clickable&&($.options.clickable===!0?$.clickableElements=[$.element]:$.clickableElements=z.getElements($.options.clickable,"clickable")),$.init(),$}return x(z,ee),E(z,[{key:"getAcceptedFiles",value:function(){return this.files.filter(function(P){return P.accepted}).map(function(P){return P})}},{key:"getRejectedFiles",value:function(){return this.files.filter(function(P){return!P.accepted}).map(function(P){return P})}},{key:"getFilesWithStatus",value:function(P){return this.files.filter(function(Y){return Y.status===P}).map(function(Y){return Y})}},{key:"getQueuedFiles",value:function(){return this.getFilesWithStatus(z.QUEUED)}},{key:"getUploadingFiles",value:function(){return this.getFilesWithStatus(z.UPLOADING)}},{key:"getAddedFiles",value:function(){return this.getFilesWithStatus(z.ADDED)}},{key:"getActiveFiles",value:function(){return this.files.filter(function(P){return P.status===z.UPLOADING||P.status===z.QUEUED}).map(function(P){return P})}},{key:"init",value:function(){var P=this,Y=this,$=this,J=this,te=this,q=this,K=this,U=this,F=this,re=this,W=this;if(this.element.tagName==="form"&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(z.createElement('<div class="dz-default dz-message"><button class="dz-button" type="button">'.concat(this.options.dictDefaultMessage,"</button></div>"))),this.clickableElements.length){var ie=this,he=function(){var Me=ie;ie.hiddenFileInput&&ie.hiddenFileInput.parentNode.removeChild(ie.hiddenFileInput),ie.hiddenFileInput=document.createElement("input"),ie.hiddenFileInput.setAttribute("type","file"),(ie.options.maxFiles===null||ie.options.maxFiles>1)&&ie.hiddenFileInput.setAttribute("multiple","multiple"),ie.hiddenFileInput.className="dz-hidden-input",ie.options.acceptedFiles!==null&&ie.hiddenFileInput.setAttribute("accept",ie.options.acceptedFiles),ie.options.capture!==null&&ie.hiddenFileInput.setAttribute("capture",ie.options.capture),ie.hiddenFileInput.setAttribute("tabindex","-1"),ie.hiddenFileInput.style.visibility="hidden",ie.hiddenFileInput.style.position="absolute",ie.hiddenFileInput.style.top="0",ie.hiddenFileInput.style.left="0",ie.hiddenFileInput.style.height="0",ie.hiddenFileInput.style.width="0",z.getElement(ie.options.hiddenInputContainer,"hiddenInputContainer").appendChild(ie.hiddenFileInput),ie.hiddenFileInput.addEventListener("change",function(){var Re=Me.hiddenFileInput.files,we=!0,ke=!1,Ve=void 0;if(Re.length)try{for(var We,$e=Re[Symbol.iterator]();!(we=(We=$e.next()).done);we=!0){var ue=We.value;Me.addFile(ue)}}catch(Se){ke=!0,Ve=Se}finally{try{we||$e.return==null||$e.return()}finally{if(ke)throw Ve}}Me.emit("addedfiles",Re),he()})};he()}this.URL=window.URL!==null?window.URL:window.webkitURL;var ve=!0,Ne=!1,ze=void 0;try{for(var rt,le=this.events[Symbol.iterator]();!(ve=(rt=le.next()).done);ve=!0){var me=rt.value;this.on(me,this.options[me])}}catch(Me){Ne=!0,ze=Me}finally{try{ve||le.return==null||le.return()}finally{if(Ne)throw ze}}this.on("uploadprogress",function(){return P.updateTotalUploadProgress()}),this.on("removedfile",function(){return Y.updateTotalUploadProgress()}),this.on("canceled",function(Me){return $.emit("complete",Me)}),this.on("complete",function(Me){var Re=J;if(J.getAddedFiles().length===0&&J.getUploadingFiles().length===0&&J.getQueuedFiles().length===0)return setTimeout(function(){return Re.emit("queuecomplete")},0)});var De=function(Me){if(function(Re){if(Re.dataTransfer.types){for(var we=0;we<Re.dataTransfer.types.length;we++)if(Re.dataTransfer.types[we]==="Files")return!0}return!1}(Me))return Me.stopPropagation(),Me.preventDefault?Me.preventDefault():Me.returnValue=!1};return this.listeners=[{element:this.element,events:{dragstart:function(Me){return te.emit("dragstart",Me)},dragenter:function(Me){return De(Me),q.emit("dragenter",Me)},dragover:function(Me){var Re;try{Re=Me.dataTransfer.effectAllowed}catch{}return Me.dataTransfer.dropEffect=Re==="move"||Re==="linkMove"?"move":"copy",De(Me),K.emit("dragover",Me)},dragleave:function(Me){return U.emit("dragleave",Me)},drop:function(Me){return De(Me),F.drop(Me)},dragend:function(Me){return re.emit("dragend",Me)}}}],this.clickableElements.forEach(function(Me){var Re=W;return W.listeners.push({element:Me,events:{click:function(we){return(Me!==Re.element||we.target===Re.element||z.elementInside(we.target,Re.element.querySelector(".dz-message")))&&Re.hiddenFileInput.click(),!0}}})}),this.enable(),this.options.init.call(this)}},{key:"destroy",value:function(){return this.disable(),this.removeAllFiles(!0),this.hiddenFileInput!=null&&this.hiddenFileInput.parentNode&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,z.instances.splice(z.instances.indexOf(this),1)}},{key:"updateTotalUploadProgress",value:function(){var P,Y=0,$=0;if(this.getActiveFiles().length){var J=!0,te=!1,q=void 0;try{for(var K,U=this.getActiveFiles()[Symbol.iterator]();!(J=(K=U.next()).done);J=!0){var F=K.value;Y+=F.upload.bytesSent,$+=F.upload.total}}catch(re){te=!0,q=re}finally{try{J||U.return==null||U.return()}finally{if(te)throw q}}P=100*Y/$}else P=100;return this.emit("totaluploadprogress",P,$,Y)}},{key:"_getParamName",value:function(P){return typeof this.options.paramName=="function"?this.options.paramName(P):"".concat(this.options.paramName).concat(this.options.uploadMultiple?"[".concat(P,"]"):"")}},{key:"_renameFile",value:function(P){return typeof this.options.renameFile!="function"?P.name:this.options.renameFile(P)}},{key:"getFallbackForm",value:function(){var P,Y;if(P=this.getExistingFallback())return P;var $='<div class="dz-fallback">';this.options.dictFallbackText&&($+="<p>".concat(this.options.dictFallbackText,"</p>")),$+='<input type="file" name="'.concat(this._getParamName(0),'" ').concat(this.options.uploadMultiple?'multiple="multiple"':void 0,' /><input type="submit" value="Upload!"></div>');var J=z.createElement($);return this.element.tagName!=="FORM"?(Y=z.createElement('<form action="'.concat(this.options.url,'" enctype="multipart/form-data" method="').concat(this.options.method,'"></form>'))).appendChild(J):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),Y??J}},{key:"getExistingFallback",value:function(){var P=function(F){var re=!0,W=!1,ie=void 0;try{for(var he,ve=F[Symbol.iterator]();!(re=(he=ve.next()).done);re=!0){var Ne=he.value;if(/(^| )fallback($| )/.test(Ne.className))return Ne}}catch(ze){W=!0,ie=ze}finally{try{re||ve.return==null||ve.return()}finally{if(W)throw ie}}},Y=!0,$=!1,J=void 0;try{for(var te,q=["div","form"][Symbol.iterator]();!(Y=(te=q.next()).done);Y=!0){var K,U=te.value;if(K=P(this.element.getElementsByTagName(U)))return K}}catch(F){$=!0,J=F}finally{try{Y||q.return==null||q.return()}finally{if($)throw J}}}},{key:"setupEventListeners",value:function(){return this.listeners.map(function(P){return function(){var Y=[];for(var $ in P.events){var J=P.events[$];Y.push(P.element.addEventListener($,J,!1))}return Y}()})}},{key:"removeEventListeners",value:function(){return this.listeners.map(function(P){return function(){var Y=[];for(var $ in P.events){var J=P.events[$];Y.push(P.element.removeEventListener($,J,!1))}return Y}()})}},{key:"disable",value:function(){var P=this;return this.clickableElements.forEach(function(Y){return Y.classList.remove("dz-clickable")}),this.removeEventListeners(),this.disabled=!0,this.files.map(function(Y){return P.cancelUpload(Y)})}},{key:"enable",value:function(){return delete this.disabled,this.clickableElements.forEach(function(P){return P.classList.add("dz-clickable")}),this.setupEventListeners()}},{key:"filesize",value:function(P){var Y=0,$="b";if(P>0){for(var J=["tb","gb","mb","kb","b"],te=0;te<J.length;te++){var q=J[te];if(P>=Math.pow(this.options.filesizeBase,4-te)/10){Y=P/Math.pow(this.options.filesizeBase,4-te),$=q;break}}Y=Math.round(10*Y)/10}return"<strong>".concat(Y,"</strong> ").concat(this.options.dictFileSizeUnits[$])}},{key:"_updateMaxFilesReachedClass",value:function(){return this.options.maxFiles!=null&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")}},{key:"drop",value:function(P){if(P.dataTransfer){this.emit("drop",P);for(var Y=[],$=0;$<P.dataTransfer.files.length;$++)Y[$]=P.dataTransfer.files[$];if(Y.length){var J=P.dataTransfer.items;J&&J.length&&J[0].webkitGetAsEntry!=null?this._addFilesFromItems(J):this.handleFiles(Y)}this.emit("addedfiles",Y)}}},{key:"paste",value:function(P){if(Y=P!=null?P.clipboardData:void 0,$=function(te){return te.items},(Y!=null?$(Y):void 0)!=null){var Y,$;this.emit("paste",P);var J=P.clipboardData.items;return J.length?this._addFilesFromItems(J):void 0}}},{key:"handleFiles",value:function(P){var Y=!0,$=!1,J=void 0;try{for(var te,q=P[Symbol.iterator]();!(Y=(te=q.next()).done);Y=!0){var K=te.value;this.addFile(K)}}catch(U){$=!0,J=U}finally{try{Y||q.return==null||q.return()}finally{if($)throw J}}}},{key:"_addFilesFromItems",value:function(P){var Y=this;return function(){var $=[],J=!0,te=!1,q=void 0;try{for(var K,U=P[Symbol.iterator]();!(J=(K=U.next()).done);J=!0){var F,re=K.value;re.webkitGetAsEntry!=null&&(F=re.webkitGetAsEntry())?F.isFile?$.push(Y.addFile(re.getAsFile())):F.isDirectory?$.push(Y._addFilesFromDirectory(F,F.name)):$.push(void 0):re.getAsFile!=null&&(re.kind==null||re.kind==="file")?$.push(Y.addFile(re.getAsFile())):$.push(void 0)}}catch(W){te=!0,q=W}finally{try{J||U.return==null||U.return()}finally{if(te)throw q}}return $}()}},{key:"_addFilesFromDirectory",value:function(P,Y){var $=this,J=P.createReader(),te=function(K){return U=console,F="log",re=function(W){return W.log(K)},U!=null&&typeof U[F]=="function"?re(U,F):void 0;var U,F,re},q=function(){var K=$;return J.readEntries(function(U){if(U.length>0){var F=!0,re=!1,W=void 0;try{for(var ie,he=U[Symbol.iterator]();!(F=(ie=he.next()).done);F=!0){var ve=ie.value,Ne=K;ve.isFile?ve.file(function(ze){if(!Ne.options.ignoreHiddenFiles||ze.name.substring(0,1)!==".")return ze.fullPath="".concat(Y,"/").concat(ze.name),Ne.addFile(ze)}):ve.isDirectory&&K._addFilesFromDirectory(ve,"".concat(Y,"/").concat(ve.name))}}catch(ze){re=!0,W=ze}finally{try{F||he.return==null||he.return()}finally{if(re)throw W}}q()}return null},te)};return q()}},{key:"accept",value:function(P,Y){this.options.maxFilesize&&P.size>1048576*this.options.maxFilesize?Y(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(P.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):z.isValidFile(P,this.options.acceptedFiles)?this.options.maxFiles!=null&&this.getAcceptedFiles().length>=this.options.maxFiles?(Y(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",P)):this.options.accept.call(this,P,Y):Y(this.options.dictInvalidFileType)}},{key:"addFile",value:function(P){var Y=this;P.upload={uuid:z.uuidv4(),progress:0,total:P.size,bytesSent:0,filename:this._renameFile(P)},this.files.push(P),P.status=z.ADDED,this.emit("addedfile",P),this._enqueueThumbnail(P),this.accept(P,function($){$?(P.accepted=!1,Y._errorProcessing([P],$)):(P.accepted=!0,Y.options.autoQueue&&Y.enqueueFile(P)),Y._updateMaxFilesReachedClass()})}},{key:"enqueueFiles",value:function(P){var Y=!0,$=!1,J=void 0;try{for(var te,q=P[Symbol.iterator]();!(Y=(te=q.next()).done);Y=!0){var K=te.value;this.enqueueFile(K)}}catch(U){$=!0,J=U}finally{try{Y||q.return==null||q.return()}finally{if($)throw J}}return null}},{key:"enqueueFile",value:function(P){if(P.status!==z.ADDED||P.accepted!==!0)throw new Error("This file can't be queued because it has already been processed or was rejected.");var Y=this;if(P.status=z.QUEUED,this.options.autoProcessQueue)return setTimeout(function(){return Y.processQueue()},0)}},{key:"_enqueueThumbnail",value:function(P){if(this.options.createImageThumbnails&&P.type.match(/image.*/)&&P.size<=1048576*this.options.maxThumbnailFilesize){var Y=this;return this._thumbnailQueue.push(P),setTimeout(function(){return Y._processThumbnailQueue()},0)}}},{key:"_processThumbnailQueue",value:function(){var P=this;if(!this._processingThumbnail&&this._thumbnailQueue.length!==0){this._processingThumbnail=!0;var Y=this._thumbnailQueue.shift();return this.createThumbnail(Y,this.options.thumbnailWidth,this.options.thumbnailHeight,this.options.thumbnailMethod,!0,function($){return P.emit("thumbnail",Y,$),P._processingThumbnail=!1,P._processThumbnailQueue()})}}},{key:"removeFile",value:function(P){if(P.status===z.UPLOADING&&this.cancelUpload(P),this.files=R(this.files,P),this.emit("removedfile",P),this.files.length===0)return this.emit("reset")}},{key:"removeAllFiles",value:function(P){P==null&&(P=!1);var Y=!0,$=!1,J=void 0;try{for(var te,q=this.files.slice()[Symbol.iterator]();!(Y=(te=q.next()).done);Y=!0){var K=te.value;(K.status!==z.UPLOADING||P)&&this.removeFile(K)}}catch(U){$=!0,J=U}finally{try{Y||q.return==null||q.return()}finally{if($)throw J}}return null}},{key:"resizeImage",value:function(P,Y,$,J,te){var q=this;return this.createThumbnail(P,Y,$,J,!0,function(K,U){if(U==null)return te(P);var F=q.options.resizeMimeType;F==null&&(F=P.type);var re=U.toDataURL(F,q.options.resizeQuality);return F!=="image/jpeg"&&F!=="image/jpg"||(re=ne.restore(P.dataURL,re)),te(z.dataURItoBlob(re))})}},{key:"createThumbnail",value:function(P,Y,$,J,te,q){var K=this,U=new FileReader;U.onload=function(){P.dataURL=U.result,P.type!=="image/svg+xml"?K.createThumbnailFromUrl(P,Y,$,J,te,q):q!=null&&q(U.result)},U.readAsDataURL(P)}},{key:"displayExistingFile",value:function(P,Y,$,J,te){var q=te===void 0||te;if(this.emit("addedfile",P),this.emit("complete",P),q){var K=this;P.dataURL=Y,this.createThumbnailFromUrl(P,this.options.thumbnailWidth,this.options.thumbnailHeight,this.options.thumbnailMethod,this.options.fixOrientation,function(U){K.emit("thumbnail",P,U),$&&$()},J)}else this.emit("thumbnail",P,Y),$&&$()}},{key:"createThumbnailFromUrl",value:function(P,Y,$,J,te,q,K){var U=this,F=document.createElement("img");return K&&(F.crossOrigin=K),te=getComputedStyle(document.body).imageOrientation!="from-image"&&te,F.onload=function(){var re=U,W=function(ie){return ie(1)};return typeof EXIF<"u"&&EXIF!==null&&te&&(W=function(ie){return EXIF.getData(F,function(){return ie(EXIF.getTag(this,"Orientation"))})}),W(function(ie){P.width=F.width,P.height=F.height;var he=re.options.resize.call(re,P,Y,$,J),ve=document.createElement("canvas"),Ne=ve.getContext("2d");switch(ve.width=he.trgWidth,ve.height=he.trgHeight,ie>4&&(ve.width=he.trgHeight,ve.height=he.trgWidth),ie){case 2:Ne.translate(ve.width,0),Ne.scale(-1,1);break;case 3:Ne.translate(ve.width,ve.height),Ne.rotate(Math.PI);break;case 4:Ne.translate(0,ve.height),Ne.scale(1,-1);break;case 5:Ne.rotate(.5*Math.PI),Ne.scale(1,-1);break;case 6:Ne.rotate(.5*Math.PI),Ne.translate(0,-ve.width);break;case 7:Ne.rotate(.5*Math.PI),Ne.translate(ve.height,-ve.width),Ne.scale(-1,1);break;case 8:Ne.rotate(-.5*Math.PI),Ne.translate(-ve.height,0)}Z(Ne,F,he.srcX!=null?he.srcX:0,he.srcY!=null?he.srcY:0,he.srcWidth,he.srcHeight,he.trgX!=null?he.trgX:0,he.trgY!=null?he.trgY:0,he.trgWidth,he.trgHeight);var ze=ve.toDataURL("image/png");if(q!=null)return q(ze,ve)})},q!=null&&(F.onerror=q),F.src=P.dataURL}},{key:"processQueue",value:function(){var P=this.options.parallelUploads,Y=this.getUploadingFiles().length,$=Y;if(!(Y>=P)){var J=this.getQueuedFiles();if(J.length>0){if(this.options.uploadMultiple)return this.processFiles(J.slice(0,P-Y));for(;$<P;){if(!J.length)return;this.processFile(J.shift()),$++}}}}},{key:"processFile",value:function(P){return this.processFiles([P])}},{key:"processFiles",value:function(P){var Y=!0,$=!1,J=void 0;try{for(var te,q=P[Symbol.iterator]();!(Y=(te=q.next()).done);Y=!0){var K=te.value;K.processing=!0,K.status=z.UPLOADING,this.emit("processing",K)}}catch(U){$=!0,J=U}finally{try{Y||q.return==null||q.return()}finally{if($)throw J}}return this.options.uploadMultiple&&this.emit("processingmultiple",P),this.uploadFiles(P)}},{key:"_getFilesWithXhr",value:function(P){return this.files.filter(function(Y){return Y.xhr===P}).map(function(Y){return Y})}},{key:"cancelUpload",value:function(P){if(P.status===z.UPLOADING){var Y=this._getFilesWithXhr(P.xhr),$=!0,J=!1,te=void 0;try{for(var q,K=Y[Symbol.iterator]();!($=(q=K.next()).done);$=!0)(he=q.value).status=z.CANCELED}catch(ve){J=!0,te=ve}finally{try{$||K.return==null||K.return()}finally{if(J)throw te}}P.xhr!==void 0&&P.xhr.abort();var U=!0,F=!1,re=void 0;try{for(var W,ie=Y[Symbol.iterator]();!(U=(W=ie.next()).done);U=!0){var he=W.value;this.emit("canceled",he)}}catch(ve){F=!0,re=ve}finally{try{U||ie.return==null||ie.return()}finally{if(F)throw re}}this.options.uploadMultiple&&this.emit("canceledmultiple",Y)}else P.status!==z.ADDED&&P.status!==z.QUEUED||(P.status=z.CANCELED,this.emit("canceled",P),this.options.uploadMultiple&&this.emit("canceledmultiple",[P]));if(this.options.autoProcessQueue)return this.processQueue()}},{key:"resolveOption",value:function(P){for(var Y=arguments.length,$=new Array(Y>1?Y-1:0),J=1;J<Y;J++)$[J-1]=arguments[J];return typeof P=="function"?P.apply(this,$):P}},{key:"uploadFile",value:function(P){return this.uploadFiles([P])}},{key:"uploadFiles",value:function(P){var Y=this;this._transformFiles(P,function($){if(Y.options.chunking){var J=$[0];P[0].upload.chunked=Y.options.chunking&&(Y.options.forceChunking||J.size>Y.options.chunkSize),P[0].upload.totalChunkCount=Math.ceil(J.size/Y.options.chunkSize)}if(P[0].upload.chunked){var te=Y,q=Y,K=P[0];J=$[0],K.upload.chunks=[];var U=function(){for(var W=0;K.upload.chunks[W]!==void 0;)W++;if(!(W>=K.upload.totalChunkCount)){var ie=W*te.options.chunkSize,he=Math.min(ie+te.options.chunkSize,J.size),ve={name:te._getParamName(0),data:J.webkitSlice?J.webkitSlice(ie,he):J.slice(ie,he),filename:K.upload.filename,chunkIndex:W};K.upload.chunks[W]={file:K,index:W,dataBlock:ve,status:z.UPLOADING,progress:0,retries:0},te._uploadData(P,[ve])}};if(K.upload.finishedChunkUpload=function(W,ie){var he=q,ve=!0;W.status=z.SUCCESS,W.dataBlock=null,W.response=W.xhr.responseText,W.responseHeaders=W.xhr.getAllResponseHeaders(),W.xhr=null;for(var Ne=0;Ne<K.upload.totalChunkCount;Ne++){if(K.upload.chunks[Ne]===void 0)return U();K.upload.chunks[Ne].status!==z.SUCCESS&&(ve=!1)}ve&&q.options.chunksUploaded(K,function(){he._finished(P,ie,null)})},Y.options.parallelChunkUploads)for(var F=0;F<K.upload.totalChunkCount;F++)U();else U()}else{var re=[];for(F=0;F<P.length;F++)re[F]={name:Y._getParamName(F),data:$[F],filename:P[F].upload.filename};Y._uploadData(P,re)}})}},{key:"_getChunk",value:function(P,Y){for(var $=0;$<P.upload.totalChunkCount;$++)if(P.upload.chunks[$]!==void 0&&P.upload.chunks[$].xhr===Y)return P.upload.chunks[$]}},{key:"_uploadData",value:function(P,Y){var $=this,J=this,te=this,q=this,K=new XMLHttpRequest,U=!0,F=!1,re=void 0;try{for(var W=P[Symbol.iterator]();!(U=(we=W.next()).done);U=!0)(rt=we.value).xhr=K}catch(Ve){F=!0,re=Ve}finally{try{U||W.return==null||W.return()}finally{if(F)throw re}}P[0].upload.chunked&&(P[0].upload.chunks[Y[0].chunkIndex].xhr=K);var ie=this.resolveOption(this.options.method,P,Y),he=this.resolveOption(this.options.url,P,Y);K.open(ie,he,!0),this.resolveOption(this.options.timeout,P)&&(K.timeout=this.resolveOption(this.options.timeout,P)),K.withCredentials=!!this.options.withCredentials,K.onload=function(Ve){$._finishedUploading(P,K,Ve)},K.ontimeout=function(){J._handleUploadError(P,K,"Request timedout after ".concat(J.options.timeout/1e3," seconds"))},K.onerror=function(){te._handleUploadError(P,K)},(K.upload!=null?K.upload:K).onprogress=function(Ve){return q._updateFilesUploadProgress(P,K,Ve)};var ve=this.options.defaultHeaders?{Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"}:{};for(var Ne in this.options.binaryBody&&(ve["Content-Type"]=P[0].type),this.options.headers&&A(_)(ve,this.options.headers),ve){var ze=ve[Ne];ze&&K.setRequestHeader(Ne,ze)}if(this.options.binaryBody){U=!0,F=!1,re=void 0;try{for(W=P[Symbol.iterator]();!(U=(we=W.next()).done);U=!0){var rt=we.value;this.emit("sending",rt,K)}}catch(Ve){F=!0,re=Ve}finally{try{U||W.return==null||W.return()}finally{if(F)throw re}}this.options.uploadMultiple&&this.emit("sendingmultiple",P,K),this.submitRequest(K,null,P)}else{var le=new FormData;if(this.options.params){var me=this.options.params;for(var De in typeof me=="function"&&(me=me.call(this,P,K,P[0].upload.chunked?this._getChunk(P[0],K):null)),me){var Me=me[De];if(Array.isArray(Me))for(var Re=0;Re<Me.length;Re++)le.append(De,Me[Re]);else le.append(De,Me)}}U=!0,F=!1,re=void 0;try{var we;for(W=P[Symbol.iterator]();!(U=(we=W.next()).done);U=!0)rt=we.value,this.emit("sending",rt,K,le)}catch(Ve){F=!0,re=Ve}finally{try{U||W.return==null||W.return()}finally{if(F)throw re}}for(this.options.uploadMultiple&&this.emit("sendingmultiple",P,K,le),this._addFormElementData(le),Re=0;Re<Y.length;Re++){var ke=Y[Re];le.append(ke.name,ke.data,ke.filename)}this.submitRequest(K,le,P)}}},{key:"_transformFiles",value:function(P,Y){for(var $=this,J=function(U){$.options.transformFile.call($,P[U],function(F){te[U]=F,++q===P.length&&Y(te)})},te=[],q=0,K=0;K<P.length;K++)J(K)}},{key:"_addFormElementData",value:function(P){var Y=!0,$=!1,J=void 0;if(this.element.tagName==="FORM")try{for(var te=this.element.querySelectorAll("input, textarea, select, button")[Symbol.iterator]();!(Y=(F=te.next()).done);Y=!0){var q=F.value,K=q.getAttribute("name"),U=q.getAttribute("type");if(U&&(U=U.toLowerCase()),K!=null)if(q.tagName==="SELECT"&&q.hasAttribute("multiple")){Y=!0,$=!1,J=void 0;try{var F;for(te=q.options[Symbol.iterator]();!(Y=(F=te.next()).done);Y=!0){var re=F.value;re.selected&&P.append(K,re.value)}}catch(W){$=!0,J=W}finally{try{Y||te.return==null||te.return()}finally{if($)throw J}}}else(!U||U!=="checkbox"&&U!=="radio"||q.checked)&&P.append(K,q.value)}}catch(W){$=!0,J=W}finally{try{Y||te.return==null||te.return()}finally{if($)throw J}}}},{key:"_updateFilesUploadProgress",value:function(P,Y,$){var J=!0,te=!1,q=void 0;if(P[0].upload.chunked){W=P[0];var K=this._getChunk(W,Y);$?(K.progress=100*$.loaded/$.total,K.total=$.total,K.bytesSent=$.loaded):(K.progress=100,K.bytesSent=K.total),W.upload.progress=0,W.upload.total=0,W.upload.bytesSent=0;for(var U=0;U<W.upload.totalChunkCount;U++)W.upload.chunks[U]&&W.upload.chunks[U].progress!==void 0&&(W.upload.progress+=W.upload.chunks[U].progress,W.upload.total+=W.upload.chunks[U].total,W.upload.bytesSent+=W.upload.chunks[U].bytesSent);W.upload.progress=W.upload.progress/W.upload.totalChunkCount,this.emit("uploadprogress",W,W.upload.progress,W.upload.bytesSent)}else try{for(var F,re=P[Symbol.iterator]();!(J=(F=re.next()).done);J=!0){var W;(W=F.value).upload.total&&W.upload.bytesSent&&W.upload.bytesSent==W.upload.total||($?(W.upload.progress=100*$.loaded/$.total,W.upload.total=$.total,W.upload.bytesSent=$.loaded):(W.upload.progress=100,W.upload.bytesSent=W.upload.total),this.emit("uploadprogress",W,W.upload.progress,W.upload.bytesSent))}}catch(ie){te=!0,q=ie}finally{try{J||re.return==null||re.return()}finally{if(te)throw q}}}},{key:"_finishedUploading",value:function(P,Y,$){var J;if(P[0].status!==z.CANCELED&&Y.readyState===4){if(Y.responseType!=="arraybuffer"&&Y.responseType!=="blob"&&(J=Y.responseText,Y.getResponseHeader("content-type")&&~Y.getResponseHeader("content-type").indexOf("application/json")))try{J=JSON.parse(J)}catch(te){$=te,J="Invalid JSON response from server."}this._updateFilesUploadProgress(P,Y),200<=Y.status&&Y.status<300?P[0].upload.chunked?P[0].upload.finishedChunkUpload(this._getChunk(P[0],Y),J):this._finished(P,J,$):this._handleUploadError(P,Y,J)}}},{key:"_handleUploadError",value:function(P,Y,$){if(P[0].status!==z.CANCELED){if(P[0].upload.chunked&&this.options.retryChunks){var J=this._getChunk(P[0],Y);if(J.retries++<this.options.retryChunksLimit)return void this._uploadData(P,[J.dataBlock]);console.warn("Retried this chunk too often. Giving up.")}this._errorProcessing(P,$||this.options.dictResponseError.replace("{{statusCode}}",Y.status),Y)}}},{key:"submitRequest",value:function(P,Y,$){if(P.readyState==1)if(this.options.binaryBody)if($[0].upload.chunked){var J=this._getChunk($[0],P);P.send(J.dataBlock.data)}else P.send($[0]);else P.send(Y);else console.warn("Cannot send this request because the XMLHttpRequest.readyState is not OPENED.")}},{key:"_finished",value:function(P,Y,$){var J=!0,te=!1,q=void 0;try{for(var K,U=P[Symbol.iterator]();!(J=(K=U.next()).done);J=!0){var F=K.value;F.status=z.SUCCESS,this.emit("success",F,Y,$),this.emit("complete",F)}}catch(re){te=!0,q=re}finally{try{J||U.return==null||U.return()}finally{if(te)throw q}}if(this.options.uploadMultiple&&(this.emit("successmultiple",P,Y,$),this.emit("completemultiple",P)),this.options.autoProcessQueue)return this.processQueue()}},{key:"_errorProcessing",value:function(P,Y,$){var J=!0,te=!1,q=void 0;try{for(var K,U=P[Symbol.iterator]();!(J=(K=U.next()).done);J=!0){var F=K.value;F.status=z.ERROR,this.emit("error",F,Y,$),this.emit("complete",F)}}catch(re){te=!0,q=re}finally{try{J||U.return==null||U.return()}finally{if(te)throw q}}if(this.options.uploadMultiple&&(this.emit("errormultiple",P,Y,$),this.emit("completemultiple",P)),this.options.autoProcessQueue)return this.processQueue()}}],[{key:"initClass",value:function(){this.prototype.Emitter=y,this.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","addedfiles","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],this.prototype._thumbnailQueue=[],this.prototype._processingThumbnail=!1}},{key:"uuidv4",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(P){var Y=16*Math.random()|0;return(P==="x"?Y:3&Y|8).toString(16)})}}]),z}(y);m.initClass(),m.options={},m.optionsForElement=function(ee){return ee.getAttribute("id")?m.options[V(ee.getAttribute("id"))]:void 0},m.instances=[],m.forElement=function(ee){if(typeof ee=="string"&&(ee=document.querySelector(ee)),(ee!=null?ee.dropzone:void 0)==null)throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return ee.dropzone},m.discover=function(){var ee;if(document.querySelectorAll)ee=document.querySelectorAll(".dropzone");else{ee=[];var z=function(P){return function(){var Y=[],$=!0,J=!1,te=void 0;try{for(var q,K=P[Symbol.iterator]();!($=(q=K.next()).done);$=!0){var U=q.value;/(^| )dropzone($| )/.test(U.className)?Y.push(ee.push(U)):Y.push(void 0)}}catch(F){J=!0,te=F}finally{try{$||K.return==null||K.return()}finally{if(J)throw te}}return Y}()};z(document.getElementsByTagName("div")),z(document.getElementsByTagName("form"))}return function(){var P=[],Y=!0,$=!1,J=void 0;try{for(var te,q=ee[Symbol.iterator]();!(Y=(te=q.next()).done);Y=!0){var K=te.value;m.optionsForElement(K)!==!1?P.push(new m(K)):P.push(void 0)}}catch(U){$=!0,J=U}finally{try{Y||q.return==null||q.return()}finally{if($)throw J}}return P}()},m.blockedBrowsers=[/opera.*(Macintosh|Windows Phone).*version\/12/i],m.isBrowserSupported=function(){var ee=!0;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a")){m.blacklistedBrowsers!==void 0&&(m.blockedBrowsers=m.blacklistedBrowsers);var z=!0,P=!1,Y=void 0;try{for(var $,J=m.blockedBrowsers[Symbol.iterator]();!(z=($=J.next()).done);z=!0)$.value.test(navigator.userAgent)&&(ee=!1)}catch(te){P=!0,Y=te}finally{try{z||J.return==null||J.return()}finally{if(P)throw Y}}}else ee=!1;else ee=!1;return ee},m.dataURItoBlob=function(ee){for(var z=atob(ee.split(",")[1]),P=ee.split(",")[0].split(":")[1].split(";")[0],Y=new ArrayBuffer(z.length),$=new Uint8Array(Y),J=0,te=z.length,q=0<=te;q?J<=te:J>=te;q?J++:J--)$[J]=z.charCodeAt(J);return new Blob([Y],{type:P})};var R=function(ee,z){return ee.filter(function(P){return P!==z}).map(function(P){return P})},V=function(ee){return ee.replace(/[\-_](\w)/g,function(z){return z.charAt(1).toUpperCase()})};m.createElement=function(ee){var z=document.createElement("div");return z.innerHTML=ee,z.childNodes[0]},m.elementInside=function(ee,z){if(ee===z)return!0;for(;ee=ee.parentNode;)if(ee===z)return!0;return!1},m.getElement=function(ee,z){var P;if(typeof ee=="string"?P=document.querySelector(ee):ee.nodeType!=null&&(P=ee),P==null)throw new Error("Invalid `".concat(z,"` option provided. Please provide a CSS selector or a plain HTML element."));return P},m.getElements=function(ee,z){var P,Y;if(ee instanceof Array){Y=[];try{var $=!0,J=!1,te=void 0;try{for(var q=ee[Symbol.iterator]();!($=(K=q.next()).done);$=!0)P=K.value,Y.push(this.getElement(P,z))}catch(U){J=!0,te=U}finally{try{$||q.return==null||q.return()}finally{if(J)throw te}}}catch{Y=null}}else if(typeof ee=="string"){Y=[],$=!0,J=!1,te=void 0;try{var K;for(q=document.querySelectorAll(ee)[Symbol.iterator]();!($=(K=q.next()).done);$=!0)P=K.value,Y.push(P)}catch(U){J=!0,te=U}finally{try{$||q.return==null||q.return()}finally{if(J)throw te}}}else ee.nodeType!=null&&(Y=[ee]);if(Y==null||!Y.length)throw new Error("Invalid `".concat(z,"` option provided. Please provide a CSS selector, a plain HTML element or a list of those."));return Y},m.confirm=function(ee,z,P){return window.confirm(ee)?z():P!=null?P():void 0},m.isValidFile=function(ee,z){if(!z)return!0;z=z.split(",");var P=ee.type,Y=P.replace(/\/.*$/,""),$=!0,J=!1,te=void 0;try{for(var q,K=z[Symbol.iterator]();!($=(q=K.next()).done);$=!0){var U=q.value;if((U=U.trim()).charAt(0)==="."){if(ee.name.toLowerCase().indexOf(U.toLowerCase(),ee.name.length-U.length)!==-1)return!0}else if(/\/\*$/.test(U)){if(Y===U.replace(/\/.*$/,""))return!0}else if(P===U)return!0}}catch(F){J=!0,te=F}finally{try{$||K.return==null||K.return()}finally{if(J)throw te}}return!1},typeof jQuery<"u"&&jQuery!==null&&(jQuery.fn.dropzone=function(ee){return this.each(function(){return new m(this,ee)})}),m.ADDED="added",m.QUEUED="queued",m.ACCEPTED=m.QUEUED,m.UPLOADING="uploading",m.PROCESSING=m.UPLOADING,m.CANCELED="canceled",m.ERROR="error",m.SUCCESS="success";var Z=function(ee,z,P,Y,$,J,te,q,K,U){var F=function(re){re.naturalWidth;var W=re.naturalHeight,ie=document.createElement("canvas");ie.width=1,ie.height=W;var he=ie.getContext("2d");he.drawImage(re,0,0);for(var ve=he.getImageData(1,0,1,W).data,Ne=0,ze=W,rt=W;rt>Ne;)ve[4*(rt-1)+3]===0?ze=rt:Ne=rt,rt=ze+Ne>>1;var le=rt/W;return le===0?1:le}(z);return ee.drawImage(z,P,Y,$,J,te,q,K,U/F)},ne=function(){"use strict";function ee(){M(this,ee)}return E(ee,null,[{key:"initClass",value:function(){this.KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}},{key:"encode64",value:function(z){for(var P="",Y=void 0,$=void 0,J="",te=void 0,q=void 0,K=void 0,U="",F=0;te=(Y=z[F++])>>2,q=(3&Y)<<4|($=z[F++])>>4,K=(15&$)<<2|(J=z[F++])>>6,U=63&J,isNaN($)?K=U=64:isNaN(J)&&(U=64),P=P+this.KEY_STR.charAt(te)+this.KEY_STR.charAt(q)+this.KEY_STR.charAt(K)+this.KEY_STR.charAt(U),Y=$=J="",te=q=K=U="",F<z.length;);return P}},{key:"restore",value:function(z,P){if(!z.match("data:image/jpeg;base64,"))return P;var Y=this.decode64(z.replace("data:image/jpeg;base64,","")),$=this.slice2Segments(Y),J=this.exifManipulation(P,$);return"data:image/jpeg;base64,".concat(this.encode64(J))}},{key:"exifManipulation",value:function(z,P){var Y=this.getExifArray(P),$=this.insertExif(z,Y);return new Uint8Array($)}},{key:"getExifArray",value:function(z){for(var P=void 0,Y=0;Y<z.length;){if((P=z[Y])[0]===255&P[1]===225)return P;Y++}return[]}},{key:"insertExif",value:function(z,P){var Y=z.replace("data:image/jpeg;base64,",""),$=this.decode64(Y),J=$.indexOf(255,3),te=$.slice(0,J),q=$.slice(J),K=te;return K=(K=K.concat(P)).concat(q)}},{key:"slice2Segments",value:function(z){for(var P=0,Y=[];!(z[P]===255&z[P+1]===218);){if(z[P]===255&z[P+1]===216)P+=2;else{var $=P+(256*z[P+2]+z[P+3])+2,J=z.slice(P,$);Y.push(J),P=$}if(P>z.length)break}return Y}},{key:"decode64",value:function(z){var P=void 0,Y=void 0,$="",J=void 0,te=void 0,q="",K=0,U=[];for(/[^A-Za-z0-9\+\/\=]/g.exec(z)&&console.warn(`There were invalid base64 characters in the input text.
Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='
Expect errors in decoding.`),z=z.replace(/[^A-Za-z0-9\+\/\=]/g,"");P=this.KEY_STR.indexOf(z.charAt(K++))<<2|(J=this.KEY_STR.indexOf(z.charAt(K++)))>>4,Y=(15&J)<<4|(te=this.KEY_STR.indexOf(z.charAt(K++)))>>2,$=(3&te)<<6|(q=this.KEY_STR.indexOf(z.charAt(K++))),U.push(P),te!==64&&U.push(Y),q!==64&&U.push($),P=Y=$="",J=te=q="",K<z.length;);return U}}]),ee}();ne.initClass(),window.Dropzone=m})();var $bu_=new function(){var A=this;this.version="3.3.55npm",this.vsakt={c:"130",f:"131",s:"17.6",e:"130",i:"12",ios:"17.6",samsung:"27",o:"114",e_a:"129",o_a:"84",y:"24.7.8",v:"6.9",uc:"13.7.8"},this.vsinsecure_below={c:"126",f:"126",s:"11.1.1",e:"119",i:11,ios:"16.5",samsung:12,o:62,o_a:78,y:"20",v:"6.0",uc:"13.4"},this.vsdefault={c:-3,f:-3,s:-2,e:17,i:11,ios:12,samsung:-3,o:-3,o_a:-3,y:-1,v:-1,uc:-.2,a:535},this.names={c:"Chrome",f:"Firefox",s:"Safari",e:"Edge",i:"Internet Explorer",ios:"iOS",samsung:"Samsung Internet",o:"Opera",o_a:"Opera",e_a:"Edge",y:"Yandex Browser",v:"Vivaldi",uc:"UC Browser",a:"Android Browser",x:"Other",silk:"Silk"},this.get_browser=function(w){var M,w=(w||navigator.userAgent).replace("_","."),E={n:"x",v:0,t:"other browser",age_years:void 0,no_device_update:!1,available:A.vsakt};function N(v,m){return new RegExp(m,"i").test(w)?v:!1}E.other=N("bot","Pagespeed|pingdom|Preview|ktxn|dynatrace|Ruxit|PhantomJS|Headless|Lighthouse|bot|spider|archiver|transcoder|crawl|checker|monitoring|prerender|screenshot|python-|php|uptime|validator|fetcher|facebook|slurp|google|yahoo|node|mail.ru|github|cloudflare|addthis|thumb|proxy|feed|fetch|favicon|link|http|scrape|seo|page|search console|AOLBuild|Teoma|Expeditor")||N("TV","SMART-TV|SmartTV")||N("niche browser","motorola edge|Comodo.Dragon|OculusBrowser|Falkon|Brave|Classic Browser|Dorado|LBBROWSER|Focus|waterfox|Firefox/56.2|Firefox/56.3|Whale|MIDP|k-meleon|sparrow|wii|Chromium|Puffin|Opera Mini|maxthon|maxton|dolfin|dolphin|seamonkey|opera mini|netfront|moblin|maemo|arora|kazehakase|epiphany|konqueror|rekonq|symbian|webos|PaleMoon|Basilisk|QupZilla|Otter|Midori|qutebrowser|slimjet")||N("mobile without upgrade path or landing page","OPR/44.12.2246|cros|kindle|tizen|silk|blackberry|bb10|RIM|PlayBook|meego|nokia|ucweb|ZuneWP7|537.85.10"),E.embedded=/"QtWebEngine|Teams|Electron/i.test(w),E.mobile=/iphone|ipod|ipad|android|mobile|phone|ios|iemobile/i.test(w),E.discontinued=/netscape|greenbrowser|camino|flot|fennec|galeon|coolnovo/i.test(w);for(var O=[["CriOS.VV","c","ios"],["FxiOS.VV","f","ios"],["Trident.*rv:VV","i","i"],["Trident.VV","i","i"],["UCBrowser.VV","uc","c"],["MSIE.VV","i","i"],["Edge.VV","e","e"],["Edg.VV","e","c"],["EdgA.VV","e_a","c"],["Vivaldi.VV","v","c"],["Android.*OPR.VV","o_a","c"],["OPR.VV","o","c"],["YaBrowser.VV","y","c"],["SamsungBrowser.VV","samsung","c"],["Silk.VV","silk","c"],["Chrome.VV","c","c"],["Firefox.VV","f","f"],[" OS.VV.*Safari","ios","ios"],["Version.VV.*Safari","s","s"],["Safari.VV","s","s"],["Opera.*Version.VV","o"],["Opera.VV","o"]],x="(\\d+\\.?\\d+\\.?\\d*\\.?\\d*)",I=0;I<O.length;I++)if(w.match(new RegExp(O[I][0].replace("VV",x),"i"))){E.n=O[I][1],E.engine=O[I][2];break}if(E.fullv=RegExp.$1,E.v=parseFloat(E.fullv),/windows.nt.5|windows.nt.4|windows.nt.6.0|windows.95|windows.98|os x 10.2|os x 10.3|os x 10.4|os x 10.5/i.test(w)&&(E.no_device_update=!0,E.available={}),navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1&&(E.n="ios",E.engine="ios",E.fullv=E.v=13,E.no_device_update=!0),/iphone|ipod|ipad|ios/i.test(w)){w.match(new RegExp("OS."+x,"i")),E.n="ios",E.fullv=RegExp.$1,E.v=parseFloat(E.fullv),E.engine="ios";var _=A.available_ios(w,E.v);_<12&&Math.round(E.v)===11&&(_=12),E.available={ios:_},parseFloat(E.available.ios)<15&&(E.no_device_update=!0)}if(/windows.nt.5.1|windows.nt.5.2|windows.nt.6.0/i.test(w)&&(E.available={c:49.9,f:52.9},E.no_device_update=!0),/os x 10.6/i.test(w)&&(E.available={s:"5.1.10",c:49.9,f:48},E.no_device_update=!0),/os x 10.7|os x 10.8/i.test(w)&&(E.available={s:"6.2.8",c:49.9,f:48},E.no_device_update=!0),/os x 10.9/i.test(w)&&(E.available.s="9.1.3"),/os x 10.10/i.test(w)&&(E.available.s="10.1.2"),w.indexOf("Android")>-1&&E.n==="s"){var S=parseInt((/WebKit\/([0-9]+)/i.exec(w)||0)[1],10)||2e3;S<=534&&(E.n="a",E.fullv=E.v=S,E.is_insecure=!0)}E.t=A.names[E.n]+" "+E.v,E.is_supported=E.is_latest=A.vsakt[E.n]?A.less(E.fullv,A.vsakt[E.n])<=0:void 0,E.vmaj=Math.round(E.v),E.is_insecure=E.is_insecure||!A.vsinsecure_below[E.n]?void 0:A.less(E.fullv,A.vsinsecure_below[E.n])===1,(E.n==="f"&&(E.vmaj===115||E.vmaj===128)||E.n==="c"&&E.vmaj===120)&&(E.is_supported=!0,E.is_insecure=!1,E.n==="f"&&(E.esr=!0)),E.n==="ios"&&E.v>=15&&(E.is_supported=!0),(E.n==="a"||E.n==="x")&&(E.t=A.names[E.n]),E.n==="e"&&(E.t=A.names[E.n]+" "+E.vmaj,E.is_supported=A.less(E.fullv,"18.15063")!=1),E.n in["c","f","o","e"]&&A.less(E.fullv,parseFloat(A.vsakt[E.n])-1)<=0&&(E.is_supported=!0);var u={f:7,c:8,o:8,i:1,e:1,s:1};u[E.n]&&(E.age_years=Math.round((A.vsakt[E.n]-E.v)/u[E.n]*10)/10||0);var y={e:"Edge.VV",c:"Chrome.VV",f:"Firefox.VV",s:"Version.VV",i:"MSIE.VV",ios:" OS.VV"};return E.engine&&(w.match(new RegExp(y[E.engine].replace("VV",x),"i")),E.engine_version=parseFloat(RegExp.$1)),E},this.semver=function(j){if(j instanceof Array)return j;var M=(j+".0.0.0").split(".");return[parseInt(M[0])||0,parseInt(M[1])||0,parseInt(M[2])||0,parseInt(M[3])||0]},this.less=function(j,M){j=A.semver(j),M=A.semver(M);for(var w=0;;w++){if(w>=j.length)return w>=M.length?0:1;if(w>=M.length)return-1;var E=M[w]-j[w];if(E)return E>0?1:-1}},this.available_ios=function(j,M){var w=Math.max(window.screen.height,window.screen.width),E=window.devicePixelRatio;return/ipad/i.test(j)?w==1024&&E==2?10:w==1112||w==1366?15:w==1024&&M<6?5:9:E==1?6:E==3||w==812||w==736||w==667?15:w==568?10:w==480?7:6}};window.$bu_getBrowser=$bu_.get_browser;var $buo=function(A,j){var M=window.navigator,w;A=window._buorgres=A||{};var E=A.l||(M.languages?M.languages[0]:null)||M.language||M.browserLanguage||M.userLanguage||document.documentElement.getAttribute("lang")||"en";A.llfull=E.replace("_","-").toLowerCase().substr(0,5),A.ll=A.llfull.substr(0,2),A.domain=A.domain!==void 0?A.domain:(/file:/.test(location.href)?"https:":"")+"//browser-update.org",A.apiver=A.api||A.c||-1,A.jsv=$bu_.version;var N=A.apiver<2018&&{i:10,f:11,o:21,s:8,c:30}||{},O=A.notify||A.vs||{};O.e!==0&&(O.e=O.e||O.i),O.i=O.i||O.e;var x=A.required||{};x.e!==0&&(x.e=x.e||x.i),x.i||(x.i=x.e,$bu_.vsakt.i=$bu_.vsakt.e);for(w in $bu_.vsdefault)O[w]&&($bu_.less(O[w],0)>=0?x[w]=parseFloat($bu_.vsakt[w])+parseFloat(O[w])+.01:x[w]=parseFloat(O[w])+.01),(!(w in x)||x[w]==null)&&(x[w]=$bu_.vsdefault[w]),$bu_.less(x[w],0)>=0&&(x[w]=parseFloat($bu_.vsakt[w])+parseFloat(x[w])),N[w]&&$bu_.less(x[w],N[w])===1&&(x[w]=N[w]);x.ios=x.ios||x.s,x.i<79&&x.i>65&&(x.i=x.i-60),x.e<79&&x.e>65&&(x.e=x.e-60),A.required=x,A.reminder=A.reminder<.1?0:A.reminder||24*7,A.reminderClosed=A.reminderClosed<1?0:A.reminderClosed||24*7,A.onshow=A.onshow||function(_){},A.onclick=A.onclick||function(_){},A.onclose=A.onclose||function(_){},A.pageurl=A.pageurl||location.hostname||"x",A.newwindow=A.newwindow!==!1,A.test=j||A.test||location.hash==="#test-bu"||!1,A.ignorecookie=A.ignorecookie||location.hash==="#ignorecookie-bu",A.reasons=[],A.hide_reasons=[];function I(_){var S=_.browser=$bu_.get_browser(_.override_ua);return _.is_below_required=x[S.n]&&$bu_.less(S.fullv,x[S.n])===1,S.other!==!1&&_.hide_reasons.push("is other browser:"+S.other),S.embedded!==!1&&_.hide_reasons.push("is embedded browser:"+S.embedded),S.esr&&!_.notify_esr&&_.hide_reasons.push("Extended support (ESR)"),S.mobile&&_.mobile===!1&&_.hide_reasons.push("do not notify mobile"),S.is_latest&&_.hide_reasons.push("is latest version of the browser"),S.no_device_update&&_.hide_reasons.push("no device update"),_.is_below_required&&_.reasons.push("below required"),(_.insecure||_.unsecure)&&S.is_insecure&&_.reasons.push("insecure"),_.unsupported&&!S.is_supported&&_.reasons.push("no vendor support"),_.hide_reasons.length>0?!1:_.reasons.length>0}if(A.notified=I(A),A.already_shown=document.cookie.indexOf("browserupdateorg=pause")>-1&&!A.ignorecookie,!(!A.test&&(!A.notified||A.already_shown))){if(A.setCookie=function(_){document.cookie="browserupdateorg=pause; expires="+new Date(new Date().getTime()+36e5*_).toGMTString()+"; path=/; SameSite=Lax"+(/https:/.test(location.href)?"; Secure":"")},A.already_shown&&(A.ignorecookie||A.test)&&A.setCookie(-10),A.reminder>0&&A.setCookie(A.reminder),A.nomessage){A.onshow(A);return}$buo_show()}};typeof module<"u"&&(module.exports=$buo);var $buo_show=function(){var A=window._buorgres,j=$bu_getBrowser(),M=A.burl||"http"+(/MSIE/i.test(navigator.userAgent)?"":"s")+"://browser-update.org/";A.url||(A.url=M+(A.l&&A.l+"/"||"")+"update-browser.html"+(A.test?"?force_outdated=true":"")+"#"+A.jsv+":"+A.pageurl),A.url_permanent_hide=A.url_permanent_hide||M+"block-ignore-browser-update-warning.html";function w(){for(var V=arguments,Z=V[0],ne=1;ne<V.length;++ne)Z=Z.replace(/%s/,V[ne]);return Z}var E={},N;E.en={msg:"Your web browser ({brow_name}) is out of date.",msgmore:"Update your browser for more security, speed and the best experience on this site.",bupdate:"Update browser",bignore:"Ignore",remind:"You will be reminded in {days} days.",bnever:"Never show again",insecure:"Your web browser ({brow_name}) has a serious security vulnerability!"},E.ar={msg:"\u0645\u062A\u0635\u0641\u062D \u0627\u0644\u0625\u0646\u062A\u0631\u0646\u062A \u0627\u0644\u062E\u0627\u0635 \u0628\u0643 ({brow_name}) \u063A\u064A\u0631 \u0645\u064F\u062D\u062F\u0651\u062B.",msgmore:"\u0642\u0645 \u0628\u062A\u062D\u062F\u064A\u062B \u0627\u0644\u0645\u062A\u0635\u0641\u062D \u0627\u0644\u062E\u0627\u0635 \u0628\u0643 \u0644\u0645\u0632\u064A\u062F \u0645\u0646 \u0627\u0644\u0623\u0645\u0627\u0646 \u0648\u0627\u0644\u0633\u0631\u0639\u0629 \u0648\u0644\u0623\u0641\u0636\u0644 \u062A\u062C\u0631\u0628\u0629 \u0639\u0644\u0649 \u0647\u0630\u0627 \u0627\u0644\u0645\u0648\u0642\u0639.",bupdate:"\u062A\u062D\u062F\u064A\u062B \u0627\u0644\u0645\u062A\u0635\u0641\u062D",bignore:"\u062A\u062C\u0627\u0647\u0644",remind:"\u0633\u064A\u062A\u0645 \u062A\u0630\u0643\u064A\u0631\u0643 \u0641\u064A \u063A\u0636\u0648\u0646 {days} \u0623\u064A\u0627\u0645.",bnever:"\u0644\u0627 \u062A\u0638\u0647\u0631 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649"},E.bg={msg:"\u0412\u0430\u0448\u0438\u044F\u0442 \u0443\u0435\u0431 \u0431\u0440\u0430\u0443\u0437\u044A\u0440 ({brow_name}) \u0435 \u043E\u0441\u0442\u0430\u0440\u044F\u043B.",msgmore:"\u0410\u043A\u0442\u0443\u0430\u043B\u0438\u0437\u0438\u0440\u0430\u0439\u0442\u0435 \u0431\u0440\u0430\u0443\u0437\u044A\u0440\u0430 \u0441\u0438 \u0437\u0430 \u043F\u043E\u0432\u0435\u0447\u0435 \u0441\u0438\u0433\u0443\u0440\u043D\u043E\u0441\u0442, \u0431\u044A\u0440\u0437\u0438\u043D\u0430 \u0438 \u043D\u0430\u0439-\u0434\u043E\u0431\u0440\u043E\u0442\u043E \u0438\u0437\u0436\u0438\u0432\u044F\u0432\u0430\u043D\u0435 \u043D\u0430 \u0442\u043E\u0437\u0438 \u0441\u0430\u0439\u0442.",bupdate:"\u0410\u043A\u0442\u0443\u0430\u043B\u0438\u0437\u0438\u0440\u0430\u043D\u0435 \u043D\u0430 \u0431\u0440\u0430\u0443\u0437\u044A\u0440\u0430",bignore:"\u0438\u0433\u043D\u043E\u0440\u0438\u0440\u0430\u0439",remind:"\u0429\u0435 \u0432\u0438 \u0431\u044A\u0434\u0435 \u043D\u0430\u043F\u043E\u043C\u043D\u0435\u043D\u043E \u0441\u043B\u0435\u0434 {days} \u0434\u043D\u0438.",bnever:"\u041D\u0438\u043A\u043E\u0433\u0430 \u043F\u043E\u0432\u0435\u0447\u0435 \u0434\u0430 \u043D\u0435 \u0441\u0435 \u043F\u043E\u043A\u0430\u0437\u0432\u0430"},E.ca={msg:"El teu navegador ({brow_name}) est\xE0 desactualitzat.",msgmore:"Actualitzeu el vostre navegador per obtenir m\xE9s seguretat, velocitat i una millor experi\xE8ncia en aquest lloc.",bupdate:"Actualitza el navegador",bignore:"Ignorar",remind:"T'ho recordarem d'aqu\xED a {days} dies.",bnever:"No ho tornis a mostrar"},E.cs={msg:"V\xE1\u0161 prohl\xED\u017Ee\u010D ({brow_name}) je zastaral\xFD.",msgmore:"Aktualizujte prohl\xED\u017Ee\u010D pro lep\u0161\xED zabezpe\u010Den\xED, rychlost a nejlep\u0161\xED z\xE1\u017Eitek z tohoto webu.",bupdate:"Aktualizovat prohl\xED\u017Ee\u010D",bignore:"Ignorovat",remind:"Znovu budete upozorn\u011Bni za {days} dn\u016F.",bnever:"Ji\u017E nezobrazovat"},E.cy={msg:"Mae eich porwr gwe ({brow_name}) angen ei ddiweddaru.",msgmore:"Diweddarwch eich porwr i gael mwy o ddiogelwch, cyflymder a'r profiad gorau ar y safle hwn.",bupdate:"Diweddaru porwr",bignore:"Anwybyddu",remind:"Byddwn yn eich atgoffa mewn {days} diwrnod.",bnever:"Peidiwch \xE2 dangos eto"},E.da={msg:"Din web browser ({brow_name}) er for\xE6ldet",msgmore:"Opdater din browser for mere sikkerhed, hastighed og den bedste oplevelse p\xE5 denne side.",bupdate:"Opdater browser",bignore:"Ignorer",remind:"Du vil blive p\xE5mindet om {days} dage.",bnever:"Vis aldrig igen"},E.de={msg:"Ihr Webbrowser ({brow_name}) ist veraltet.",msgmore:"Aktualisieren Sie Ihren Browser f\xFCr mehr Sicherheit, Geschwindigkeit und den besten Komfort auf dieser Seite.",bupdate:"Browser aktualisieren",bignore:"Ignorieren",remind:"Sie werden in {days} Tagen wieder erinnert.",bnever:"Nie wieder anzeigen",insecure:"Ihr Webbrowser ({brow_name}) hat eine ernsthafte Sicherheitsl\xFCcke!"},E.el={msg:"\u03A4\u03BF \u03C0\u03C1\u03CC\u03B3\u03C1\u03B1\u03BC\u03BC\u03B1 \u03C0\u03B5\u03C1\u03B9\u03AE\u03B3\u03B7\u03C3\u03AE\u03C2 \u03C3\u03B1\u03C2 ({brow_name}) \u03B5\u03AF\u03BD\u03B1\u03B9 \u03B1\u03C0\u03B1\u03C1\u03C7\u03B1\u03B9\u03C9\u03BC\u03AD\u03BD\u03BF.",msgmore:"\u0395\u03BD\u03B7\u03BC\u03B5\u03C1\u03CE\u03C3\u03C4\u03B5 \u03C4\u03BF \u03C0\u03C1\u03CC\u03B3\u03C1\u03B1\u03BC\u03BC\u03B1 \u03C0\u03B5\u03C1\u03B9\u03AE\u03B3\u03B7\u03C3\u03AE\u03C2 \u03C3\u03B1\u03C2 \u03B3\u03B9\u03B1 \u03C0\u03B5\u03C1\u03B9\u03C3\u03C3\u03CC\u03C4\u03B5\u03C1\u03B7 \u03B1\u03C3\u03C6\u03AC\u03BB\u03B5\u03B9\u03B1, \u03C4\u03B1\u03C7\u03CD\u03C4\u03B7\u03C4\u03B1 \u03BA\u03B1\u03B9 \u03C4\u03B7\u03BD \u03BA\u03B1\u03BB\u03CD\u03C4\u03B5\u03C1\u03B7 \u03B5\u03BC\u03C0\u03B5\u03B9\u03C1\u03AF\u03B1 \u03C3' \u03B1\u03C5\u03C4\u03CC\u03BD \u03C4\u03BF\u03BD \u03B9\u03C3\u03C4\u03CC\u03C4\u03BF\u03C0\u03BF.",bupdate:"\u0395\u03BD\u03B7\u03BC\u03B5\u03C1\u03CE\u03C3\u03C4\u03B5 \u03C4\u03BF \u03C0\u03C1\u03CC\u03B3\u03C1\u03B1\u03BC\u03BC\u03B1 \u03C0\u03B5\u03C1\u03B9\u03AE\u03B3\u03B7\u03C3\u03B7\u03C2",bignore:"\u0391\u03B3\u03BD\u03BF\u03AE\u03C3\u03C4\u03B5",remind:"\u0398\u03B1 \u03C3\u03B1\u03C2 \u03C4\u03BF \u03C5\u03C0\u03B5\u03BD\u03B8\u03C5\u03BC\u03AF\u03C3\u03BF\u03C5\u03BC\u03B5 \u03C3\u03B5 {days} \u03B7\u03BC\u03AD\u03C1\u03B5\u03C2.",bnever:"\u039D\u03B1 \u03BC\u03B7\u03BD \u03B5\u03BC\u03C6\u03B1\u03BD\u03B9\u03C3\u03C4\u03B5\u03AF \u03BE\u03B1\u03BD\u03AC"},E.es={msg:"Su navegador web ({brow_name}) est\xE1 desactualizado.",msgmore:"Actualice su navegador para obtener m\xE1s seguridad, velocidad y para disfrutar de la mejor experiencia en este sitio.",bupdate:"Actualizar navegador",bignore:"Ignorar",remind:"Se le recordar\xE1 en {days} d\xEDas.",bnever:"No mostrar de nuevo"},E.et={msg:"Teie veebilehitseja ({brow_name}) on vananenud.",msgmore:"Veebilehitseja uuendamisega kaasneb nii parem turvalisus, kiirus kui ka kasutusmugavus.",bupdate:"Uuenda veebilehitsejat",bignore:"Eira",remind:"Uus meeldetuletus {days} p\xE4eva p\xE4rast.",bnever:"\xC4ra kunagi enam n\xE4ita"},E.fa={msg:"\u0645\u0631\u0648\u0631\u06AF\u0631 \u0634\u0645\u0627 ({brow_name}) \u0642\u062F\u06CC\u0645\u06CC \u0627\u0633\u062A.",msgmore:"\u0628\u0631\u0627\u06CC \u0627\u06CC\u0645\u0646\u06CC\u060C \u0633\u0631\u0639\u062A \u0648 \u062A\u062C\u0631\u0628\u0647 \u0628\u0647\u062A\u0631 \u0645\u0631\u0648\u0631\u06AF\u0631 \u062E\u0648\u062F \u0631\u0627 \u0628\u0647\u200C\u0631\u0648\u0632 \u06A9\u0646\u06CC\u062F.",bupdate:"\u0628\u0647\u200C\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC \u0645\u0631\u0648\u0631\u06AF\u0631",bignore:"\u0646\u0627\u062F\u06CC\u062F\u0647 \u06AF\u0631\u0641\u062A\u0646",remind:"\u0628\u0647 \u0634\u0645\u0627 \u062A\u0627 {days} \u0631\u0648\u0632 \u062F\u06CC\u06AF\u0631 \u062F\u0648\u0628\u0627\u0631\u0647 \u06CC\u0627\u062F\u200C\u0622\u0648\u0631\u06CC \u062E\u0648\u0627\u0647\u062F \u0634\u062F.",bnever:"\u0647\u0631\u06AF\u0632 \u0646\u0645\u0627\u06CC\u0634 \u0646\u062F\u0647"},E.fi={msg:"Selaimesi ({brow_name}) on vanhentunut.",msgmore:"P\xE4ivit\xE4 selaimesi saadaksesi tietoturvap\xE4ivityksi\xE4, nopeutta sek\xE4 parhaan k\xE4ytt\xF6kokemuksen sivustolla.",bupdate:"P\xE4ivit\xE4 selain",bignore:"Ohita",remind:"Saat uuden muistutuksen {days} p\xE4iv\xE4n p\xE4\xE4st\xE4.",bnever:"\xC4l\xE4 n\xE4yt\xE4 uudestaan"},E.fr={msg:"Votre navigateur Web ({brow_name}) n'est pas \xE0 jour.",msgmore:"Mettez \xE0 jour votre navigateur pour plus de s\xE9curit\xE9 et de rapidit\xE9 et une meilleure exp\xE9rience sur ce site.",bupdate:"Mettre \xE0 jour le navigateur",bignore:"Ignorer",remind:"Vous serez rappel\xE9 dans {days} jours.",bnever:"Ne plus afficher"},E.gl={msg:"T\xE1 an l\xEDonl\xE9itheoir agat ({brow_name}) as d\xE1ta.",msgmore:"Actualiza o teu navegador para obter m\xE1is seguridade, rapidez e mellor experiencia neste sitio.",bupdate:"Actualizar navegador web",bignore:"Ignorar",remind:"Lembraralle en {days} d\xEDas.",bnever:"Non volver mostrar m\xE1is"},E.he={msg:"\u05D3\u05E4\u05D3\u05E4\u05DF ({brow_name}) \u05E9\u05DC\u05DA \u05D0\u05D9\u05E0\u05D5 \u05DE\u05E2\u05D5\u05D3\u05DB\u05DF.",msgmore:"\u05E2\u05D3\u05DB\u05DF/\u05D9 \u05D0\u05EA \u05D4\u05D3\u05E4\u05D3\u05E4\u05DF \u05E9\u05DC\u05DA \u05DC\u05E9\u05D9\u05E4\u05D5\u05E8 \u05D4\u05D0\u05D1\u05D8\u05D7\u05D4 \u05D5\u05D4\u05DE\u05D4\u05D9\u05E8\u05D5\u05EA \u05D5\u05DB\u05D3\u05D9 \u05DC\u05D9\u05D4\u05E0\u05D5\u05EA \u05DE\u05D4\u05D7\u05D5\u05D5\u05D9\u05D4 \u05D4\u05D8\u05D5\u05D1\u05D4 \u05D1\u05D9\u05D5\u05EA\u05E8 \u05D1\u05D0\u05EA\u05E8 \u05D6\u05D4.",bupdate:"\u05E2\u05D3\u05DB\u05DF \u05D3\u05E4\u05D3\u05E4\u05DF",bignore:"\u05D4\u05EA\u05E2\u05DC\u05DD",remind:"\u05EA\u05E7\u05D1\u05DC/\u05D9 \u05EA\u05D6\u05DB\u05D5\u05E8\u05EA \u05D1\u05E2\u05D5\u05D3  {days} \u05D9\u05DE\u05D9\u05DD.",bnever:"\u05D0\u05DC \u05EA\u05E6\u05D9\u05D2 \u05E9\u05D5\u05D1"},E.hi={msg:"\u0906\u092A\u0915\u093E \u0935\u0947\u092C \u092C\u094D\u0930\u093E\u0909\u091C\u093C\u0930 ({brow_name}) \u092A\u0941\u0930\u093E\u0928\u093E \u0939\u0948\u0964",msgmore:"\u0907\u0938 \u0938\u093E\u0907\u091F \u092A\u0930 \u0905\u0927\u093F\u0915 \u0938\u0941\u0930\u0915\u094D\u0937\u093E, \u0917\u0924\u093F \u0914\u0930 \u0938\u0930\u094D\u0935\u094B\u0924\u094D\u0924\u092E \u0905\u0928\u0941\u092D\u0935 \u0915\u0930\u0928\u0947 \u0915\u0947 \u0932\u093F\u090F \u0905\u092A\u0928\u0947 \u092C\u094D\u0930\u093E\u0909\u095B\u0930 \u0915\u094B \u0905\u092A\u0921\u0947\u091F \u0915\u0930\u0947\u0902 \u0964",bupdate:"\u092C\u094D\u0930\u093E\u0909\u091C\u093C\u0930 \u0905\u092A\u0921\u0947\u091F \u0915\u0930\u0947\u0902",bignore:"\u0928\u091C\u0930\u0905\u0902\u0926\u093E\u091C \u0915\u0930\u0947\u0902",remind:"\u0906\u092A\u0915\u094B {days} \u0926\u093F\u0928\u094B\u0902 \u092E\u0947\u0902 \u092F\u093E\u0926 \u0926\u093F\u0932\u093E\u092F\u093E \u091C\u093E\u090F\u0917\u093E\u0964",bnever:"\u092B\u093F\u0930 \u0915\u092D\u0940 \u092E\u0924 \u0926\u093F\u0916\u093E\u0928\u093E"},E.hu={msg:"Az \xD6n webb\xF6ng\xE9sz\u0151je ({brow_name}) elavult.",msgmore:"Friss\xEDtse b\xF6ng\xE9sz\u0151j\xE9t a nagyobb biztons\xE1g, sebess\xE9g \xE9s \xE9lm\xE9ny \xE9rdek\xE9ben!",bupdate:"B\xF6ng\xE9sz\u0151 friss\xEDt\xE9se",bignore:"Mell\u0151z\xE9s",remind:"\xDAjra eml\xE9keztet\xFCnk {days} napon bel\xFCl.",bnever:"Ne mutassa t\xF6bbet"},E.id={msg:"Peramban web ({brow_name}) Anda sudah usang.",msgmore:"Perbarui peramban Anda untuk pengalaman terbaik, lebih aman, dan cepat di situs ini.",bupdate:"Perbarui peramban",bignore:"Abaikan",remind:"Anda akan diingatkan kembali dalam {days} hari.",bnever:"Jangan pernah tampilkan lagi"},E.it={msg:"Il tuo browser ({brow_name}) non \xE8 aggiornato.",msgmore:"Aggiorna il browser per una maggiore sicurezza, velocit\xE0 e la migliore esperienza su questo sito.",bupdate:"Aggiorna browser",bignore:"Ignora",remind:"Riceverai un promemoria tra {days} giorni.",bnever:"Non mostrare di nuovo"},E.ja={msg:"\u304A\u4F7F\u3044\u306E\u30D6\u30E9\u30A6\u30B6\uFF08{brow_name}\uFF09\u306F\u6700\u65B0\u7248\u3067\u306F\u3042\u308A\u307E\u305B\u3093\u3002",msgmore:"\u30BB\u30AD\u30E5\u30EA\u30C6\u30A3\u3001\u30B9\u30D4\u30FC\u30C9\u3001\u305D\u3057\u3066\u3053\u306E\u30B5\u30A4\u30C8\u3067\u306E\u6700\u826F\u306E\u4F53\u9A13\u306E\u305F\u3081\u306B\u304A\u4F7F\u3044\u306E\u30D6\u30E9\u30A6\u30B6\u3092\u66F4\u65B0\u3057\u3066\u304F\u3060\u3055\u3044\u3002",bupdate:"\u30D6\u30E9\u30A6\u30B6\u3092\u66F4\u65B0\u3059\u308B",bignore:"\u7121\u8996\u3059\u308B",remind:"{days} \u65E5\u5F8C\u306B\u3082\u3046\u4E00\u5EA6\u304A\u77E5\u3089\u305B\u3057\u307E\u3059\u3002",bnever:"\u6B21\u56DE\u304B\u3089\u8868\u793A\u3057\u306A\u3044"},E.ko={msg:"\uADC0\uD558\uC758 \uC6F9 \uBE0C\uB77C\uC6B0\uC800({brow_name})\uB294 \uC624\uB798\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",msgmore:"\uC774 \uC0AC\uC774\uD2B8\uC5D0\uC11C \uBCF4\uC548, \uC18D\uB3C4\uC640 \uCD5C\uC0C1\uC758 \uACBD\uD5D8\uC744 \uC5BB\uC73C\uB824\uBA74 \uBE0C\uB77C\uC6B0\uC800\uB97C \uC5C5\uB370\uC774\uD2B8\uD558\uC2ED\uC2DC\uC624.",bupdate:"\uBE0C\uB77C\uC6B0\uC800 \uC5C5\uB370\uC774\uD2B8\uD558\uAE30",bignore:"\uBB34\uC2DC\uD558\uAE30",remind:"{days}\uC77C \uD6C4\uC5D0 \uC54C\uB824 \uB4DC\uB9BD\uB2C8\uB2E4.",bnever:"\uB2E4\uC2DC \uD45C\uC2DC\uD558\uC9C0 \uC54A\uAE30"},E.lt={msg:"J\u016Bs\u0173 nar\u0161ykl\u0117 ({brow_name}) yra pasenusi.",msgmore:"Atsinaujinkite savo nar\u0161ykl\u0119 nor\u0117dami gauti daugiau saugumo, grei\u010Dio ir pa\u010Di\u0173 geriausi\u0173 patir\u010Di\u0173 \u0161ioje svetain\u0117je.",bupdate:"Atnaujinti nar\u0161ykl\u0119",bignore:"Nepaisyti",remind:"Jums bus priminta po {days} dien\u0173.",bnever:"Daugiau niekada nerodyti"},E.lv={msg:"J\u016Bsu p\u0101rl\u016Bkprogramma ({brow_name}) ir novecojusi.",msgmore:"Atjaunojiet savu p\u0101rl\u016Bkprogrammu liel\u0101kai dro\u0161\u012Bbai, \u0101trumam un lab\u0101kai pieredzei ar \u0161o vietni.",bupdate:"Atjaunin\u0101t p\u0101rl\u016Bkprogrammu",bignore:"Ignor\u0113t",remind:"Jums tiks par\u0101d\u012Bts atg\u0101din\u0101jums p\u0113c {days} dien\u0101m.",bnever:"Vairs ner\u0101d\u012Bt"},E.ms={msg:"Pelayar web anda ({brow_name}) sudah lapuk.",msgmore:"Kemas kini pelayar anda untuk lebih keselamatan, kelajuan dan pengalaman terbaik di laman web ini.",bupdate:"Kemas kini pelayar",bignore:"Abaikan",remind:"Anda akan diingatkan dalam {days} hari.",bnever:"Jangan tunjukkan lagi"},E.nl={msg:"Uw webbrowser ({brow_name}) is verouderd.",msgmore:"Update uw browser voor meer veiligheid, snelheid en om deze site optimaal te kunnen gebruiken.",bupdate:"Browser updaten",bignore:"Negeren",remind:"We zullen u er in {days} dagen aan herinneren.",bnever:"Nooit meer tonen"},E.no=E.nn=E.nb={msg:"Nettleseren din ({brow_name}) er utdatert.",msgmore:"Oppdater nettleseren din for \xF8kt sikkerhet, hastighet og den beste opplevelsen p\xE5 dette nettstedet.",bupdate:"Oppdater nettleser",bignore:"Ignorer",remind:"Du vil f\xE5 en p\xE5minnelse om {days} dager.",bnever:"Aldri vis igjen"},E.pl={msg:"Twoja przegl\u0105darka ({brow_name}) jest nieaktualna.",msgmore:"Zaktualizuj przegl\u0105dark\u0119, by korzysta\u0107 z tej strony bezpieczniej, szybciej i po prostu sprawniej.",bupdate:"Aktualizuj przegl\u0105dark\u0119",bignore:"Ignoruj",remind:"Przypomnimy o tym za {days} dni.",bnever:"Nie pokazuj wi\u0119cej"},E.pt={msg:"Seu navegador da web ({brow_name}) est\xE1 desatualizado.",msgmore:"Atualize seu navegador para ter mais seguran\xE7a e velocidade, al\xE9m da melhor experi\xEAncia neste site.",bupdate:"Atualizar navegador",bignore:"Ignorar",remind:"Voc\xEA ser\xE1 relembrado em {days} dias.",bnever:"N\xE3o mostrar novamente"},E.ro={msg:"Browserul t\u0103u ({brow_name}) nu este actualizat.",msgmore:"Actualizeaz\u0103 browserul pentru o mai mare siguran\u021B\u0103, vitez\u0103 \u0219i cea mai bun\u0103 experien\u021B\u0103 pe acest site.",bupdate:"Actualizeaz\u0103 browser",bignore:"Ignor\u0103",remind:"\u021Ai se va reaminti peste {days} zile.",bnever:"Nu mai ar\u0103ta"},E.ru={msg:"\u0412\u0430\u0448 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 ({brow_name}) \u0443\u0441\u0442\u0430\u0440\u0435\u043B.",msgmore:"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u0435 \u0432\u0430\u0448 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u0434\u043B\u044F \u043F\u043E\u0432\u044B\u0448\u0435\u043D\u0438\u044F \u0443\u0440\u043E\u0432\u043D\u044F \u0431\u0435\u0437\u043E\u043F\u0430\u0441\u043D\u043E\u0441\u0442\u0438, \u0441\u043A\u043E\u0440\u043E\u0441\u0442\u0438 \u0438 \u043A\u043E\u043C\u0444\u043E\u0440\u0442\u0430 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u044F \u044D\u0442\u043E\u0433\u043E \u0441\u0430\u0439\u0442\u0430.",bupdate:"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C \u0431\u0440\u0430\u0443\u0437\u0435\u0440",bignore:"\u0418\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C",remind:"\u0412\u044B \u043F\u043E\u043B\u0443\u0447\u0438\u0442\u0435 \u043D\u0430\u043F\u043E\u043C\u0438\u043D\u0430\u043D\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 {days} \u0434\u043D\u0435\u0439.",bnever:"\u0411\u043E\u043B\u044C\u0448\u0435 \u043D\u0435 \u043F\u043E\u043A\u0430\u0437\u044B\u0432\u0430\u0442\u044C "},E.sk={msg:"V\xE1\u0161 internetov\xFD prehliada\u010D ({brow_name}) je zastaran\xFD.",msgmore:"Pre v\xE4\u010D\u0161iu bezpe\u010Dnos\u0165, r\xFDchlos\u0165 a lep\u0161iu sk\xFAsenos\u0165 s touto str\xE1nkou si aktualizujte svoj prehliada\u010D.",bupdate:"Aktualizova\u0165 prehliada\u010D",bignore:"Ignorova\u0165",remind:"Bude v\xE1m to pripomenut\xE9 o {days} dn\xED.",bnever:"U\u017E nikdy viac neukazova\u0165"},E.sl={msg:"Va\u0161 spletni brskalnik ({brow_name}) je zastarel.",msgmore:"Posodobite svoj brskalnik za dodatno varnost, hitrost in najbolj\u0161o izku\u0161njo na tem spletnem mestu.",bupdate:"Posodobi brskalnik",bignore:"Prezri",remind:"Opomnik boste prejeli \u010Dez toliko dni: {days}.",bnever:"Ne prika\u017Ei ve\u010D"},E.sq={msg:"Shfletuesi juaj ({brow_name}) \xEBsht\xEB i vjetruar.",msgmore:"P\xEBrdit\xEBsoni shfletuesin tuaj p\xEBr m\xEB tep\xEBr siguri, shpejt\xEBsi dhe p\xEBr m\xEB t\xEB mirin e funksionimeve n\xEB k\xEBt\xEB sajt.",bupdate:"P\xEBrdit\xEBso shfletuesin",bignore:"Shp\xEBrfille",remind:"Do t\u2019ju rikujtohet pas {days} dit\xEBsh.",bnever:"Mos e shfaq kurr\xEB m\xEB"},E.sr={msg:"Va\u0161 pretra\u017Eiva\u010D ({brow_name}) je zastareo.",msgmore:"Ima poznate sigurnosne probleme i najverovatnije ne\u0107e prikazati sve funkcionalnisti ovog i drugih sajtova.",bupdate:"Nadogradi pretra\u017Eiva\u010D",bignore:"Ignorisi",remind:"Zaboravic\u0301ete za {days} dana.",bnever:"Ne prikazuj opet"},E.sv={msg:"Din webbl\xE4sare ({brow_name}) \xE4r f\xF6r\xE5ldrad. ",msgmore:"Uppdatera din webbl\xE4sare f\xF6r mer s\xE4kerhet, hastighet och den b\xE4sta upplevelsen p\xE5 den h\xE4r sajten. ",bupdate:"Uppdatera webbl\xE4saren",bignore:"Ignorera",remind:"Du f\xE5r en p\xE5minnelse om {days} dagar.",bnever:"Visa aldrig igen"},E.th={msg:"\u0E40\u0E27\u0E47\u0E1A\u0E40\u0E1A\u0E23\u0E32\u0E27\u0E4C\u0E40\u0E0B\u0E2D\u0E23\u0E4C\u0E02\u0E2D\u0E07\u0E04\u0E38\u0E13 ({brow_name}) \u0E25\u0E49\u0E32\u0E2A\u0E21\u0E31\u0E22\u0E41\u0E25\u0E49\u0E27",msgmore:"\u0E2D\u0E31\u0E1B\u0E40\u0E14\u0E17\u0E40\u0E1A\u0E23\u0E32\u0E27\u0E4C\u0E40\u0E0B\u0E2D\u0E23\u0E4C\u0E40\u0E1E\u0E37\u0E48\u0E2D\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E04\u0E27\u0E32\u0E21\u0E1B\u0E25\u0E2D\u0E14\u0E20\u0E31\u0E22, \u0E04\u0E27\u0E32\u0E21\u0E40\u0E23\u0E47\u0E27 \u0E41\u0E25\u0E30\u0E1B\u0E23\u0E30\u0E2A\u0E1A\u0E01\u0E32\u0E23\u0E13\u0E4C\u0E17\u0E35\u0E48\u0E14\u0E35\u0E17\u0E35\u0E48\u0E2A\u0E38\u0E14\u0E1A\u0E19\u0E40\u0E27\u0E47\u0E1A\u0E44\u0E0B\u0E15\u0E4C\u0E19\u0E35\u0E49",bupdate:"\u0E2D\u0E31\u0E1B\u0E40\u0E14\u0E17\u0E40\u0E1A\u0E23\u0E32\u0E27\u0E4C\u0E40\u0E0B\u0E2D\u0E23\u0E4C",bignore:"\u0E02\u0E49\u0E32\u0E21",remind:"\u0E04\u0E38\u0E13\u0E08\u0E30\u0E44\u0E14\u0E49\u0E23\u0E31\u0E1A\u0E01\u0E32\u0E23\u0E41\u0E08\u0E49\u0E07\u0E40\u0E15\u0E37\u0E2D\u0E19\u0E43\u0E19 {days} \u0E27\u0E31\u0E19",bnever:"\u0E44\u0E21\u0E48\u0E15\u0E49\u0E2D\u0E07\u0E41\u0E2A\u0E14\u0E07\u0E2D\u0E35\u0E01"},E.tr={msg:"Web taray\u0131c\u0131n\u0131z ({brow_name}) g\xFCncel de\u011Fil.",msgmore:"Daha fazla g\xFCvenlik ve h\u0131z ile bu sitede en iyi deneyim i\xE7in taray\u0131c\u0131n\u0131z\u0131 g\xFCncelleyin.",bupdate:"Taray\u0131c\u0131y\u0131 g\xFCncelle",bignore:"Yok say",remind:"{days} g\xFCn sonra bir hat\u0131rlatma alacaks\u0131n\u0131z.",bnever:"Bir daha g\xF6sterme"},E.uk={msg:"\u0412\u0430\u0448 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 ({brow_name}) \u0437\u0430\u0441\u0442\u0430\u0440\u0456\u043B\u0438\u0439.",msgmore:"\u041E\u043D\u043E\u0432\u0456\u0442\u044C \u0441\u0432\u0456\u0439 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u0434\u043B\u044F \u0431\u0456\u043B\u044C\u0448\u043E\u0457 \u0431\u0435\u0437\u043F\u0435\u043A\u0438, \u0448\u0432\u0438\u0434\u043A\u043E\u0441\u0442\u0456 \u0442\u0430 \u043F\u043E\u0432\u043D\u043E\u0446\u0456\u043D\u043D\u043E\u0457 \u0440\u043E\u0431\u043E\u0442\u0438 \u0446\u044C\u043E\u0433\u043E \u0441\u0430\u0439\u0442\u0443.",bupdate:"\u041E\u043D\u043E\u0432\u0438\u0442\u0438 \u0431\u0440\u0430\u0443\u0437\u0435\u0440",bignore:"\u041F\u0440\u043E\u043F\u0443\u0441\u0442\u0438\u0442\u0438",remind:"\u0412\u0438 \u043E\u0442\u0440\u0438\u043C\u0430\u0454\u0442\u0435 \u043D\u0430\u0433\u0430\u0434\u0443\u0432\u0430\u043D\u043D\u044F \u0447\u0435\u0440\u0435\u0437 {days} \u0434\u043D\u0456\u0432.",bnever:"\u0411\u0456\u043B\u044C\u0448\u0435 \u043D\u0435 \u043F\u043E\u043A\u0430\u0437\u0443\u0432\u0430\u0442\u0438"},E.uz={msg:"Sizning ({brow_name}) veb-brauzeringiz eskirgan",msgmore:"Xavfsizlik, tezkorlik va ushbu sayt imkoniyatlaridan to`liq foydalanish uchun brauzeringizni yangilang.",bupdate:"Brauzeringizni yangilang",bignore:"E\u2019tibor bermaslik",remind:"Sizga {days} kundan so`ng eslatammiz.",bnever:"Hech qachon qayta ko'rsatmang"},E.vi={msg:"Tr\xECnh duy\u1EC7t web c\u1EE7a b\u1EA1n ({brow_name}) \u0111\xE3 l\u1ED7i th\u1EDDi.",msgmore:"C\u1EADp nh\u1EADt tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n \u0111\u1EC3 c\xF3 th\xEAm b\u1EA3o m\u1EADt, t\u1ED1c \u0111\u1ED9 v\xE0 tr\u1EA3i nghi\u1EC7m t\u1ED1t nh\u1EA5t tr\xEAn trang web n\xE0y.",bupdate:"C\u1EADp nh\u1EADt tr\xECnh duy\u1EC7t",bignore:"B\u1ECF qua",remind:"B\u1EA1n s\u1EBD \u0111\u01B0\u1EE3c nh\u1EAFc nh\u1EDF sau {days} ng\xE0y.",bnever:"Kh\xF4ng bao gi\u1EDD hi\u1EC3n th\u1ECB l\u1EA1i"},E.zh={msg:"\u60A8\u7684\u7F51\u9875\u6D4F\u89C8\u5668\uFF08{brow_name}\uFF09\u5DF2\u8FC7\u671F\u3002",msgmore:"\u66F4\u65B0\u60A8\u7684\u6D4F\u89C8\u5668\uFF0C\u4EE5\u4FBF\u5728\u8BE5\u7F51\u7AD9\u4E0A\u83B7\u5F97\u66F4\u5B89\u5168\u3001\u66F4\u5FEB\u901F\u548C\u6700\u597D\u7684\u4F53\u9A8C\u3002",bupdate:"\u66F4\u65B0\u6D4F\u89C8\u5668",bignore:"\u5FFD\u7565",remind:"\u4F1A\u5728{days}\u5929\u540E\u63D0\u9192\u60A8\u3002",bnever:"\u4E0D\u518D\u663E\u793A"},E["zh-tw"]=E["zh-hans-cn"]={msg:"\u60A8\u7684\u7DB2\u8DEF\u700F\u89BD\u5668\uFF08{brow_name}\uFF09\u5DF2\u904E\u820A\u3002",msgmore:"\u66F4\u65B0\u60A8\u7684\u700F\u89BD\u5668\u4EE5\u7372\u5F97\u66F4\u4F73\u7684\u5B89\u5168\u6027\u3001\u901F\u5EA6\u4EE5\u53CA\u5728\u6B64\u7DB2\u7AD9\u7684\u6700\u4F73\u9AD4\u9A57\u3002",bupdate:"\u66F4\u65B0\u700F\u89BD\u5668",bignore:"\u5FFD\u7565",remind:"\u60A8\u5C07\u5728 {days} \u5929\u5F8C\u6536\u5230\u63D0\u9192\u3002",bnever:"\u4E0D\u8981\u518D\u986F\u793A"};var O=A["text_for_"+j.n+"_in_"+A.ll]||A["text_for_"+j.n]||A["text_"+A.llfull]||A["text_in_"+A.ll]||A["text_"+A.ll]||A.text;if(E=N=E[A.llfull]||E[A.ll]||E.en,O)if(typeof O=="string")E=N=O;else for(var x in O)N[x]=O[x];A.browser.is_insecure&&N.insecure&&(N.msg=N.insecure),N.msg&&(E='<b class="buorg-mainmsg">'+E.msg+'</b> <span class="buorg-moremsg">'+E.msgmore+'</span> <span class="buorg-buttons"><a{up_but}>'+E.bupdate+"</a> <a{ignore_but}>"+E.bignore+"</a></span>");var I="";A.newwindow&&(I=' target="_blank" rel="noopener"');var _=A.div=document.createElement("div");_.id=_.className="buorg";var S="<style>.buorg-icon {width: 22px; height: 16px; vertical-align: middle; position: relative; top: -0.05em; display: inline-block; background: no-repeat 0px center url(https://browser-update.org/static/img/small/"+j.n+".png);}</style>",u="<style>.buorg {position:absolute;position:fixed;z-index:111111; width:100%; top:0px; left:0px; border-bottom:1px solid #A29330; text-align:center;  color:#000; background-color: #fff8ea; font: 18px Calibri,Helvetica,sans-serif; box-shadow: 0 0 5px rgba(0,0,0,0.2);animation: buorgfly 1s ease-out 0s;}.buorg-pad { padding: 9px;  line-height: 1.7em; }.buorg-buttons { display: block; text-align: center; }#buorgig,#buorgul,#buorgpermanent { color: #fff; text-decoration: none; cursor:pointer; box-shadow: 0 0 2px rgba(0,0,0,0.4); padding: 1px 10px; border-radius: 4px; font-weight: normal; background: #5ab400;    white-space: nowrap;    margin: 0 2px; display: inline-block;}#buorgig { background-color: #edbc68;}@media only screen and (max-width: 700px){.buorg div { padding:5px 12px 5px 9px; line-height: 1.3em;}}@keyframes buorgfly {from {opacity:0;transform:translateY(-50px)} to {opacity:1;transform:translateY(0px)}}.buorg-fadeout {transition: visibility 0s 8.5s, opacity 8s ease-out .5s;}</style>";N.msg&&(A.ll=="ar"||A.ll=="he"||A.ll=="fa")&&(u+="<style>.buorg {direction:RTL; unicode-bidi:embed;}</style>"),!N.msg&&E.indexOf&&E.indexOf("%s")!==-1?(E=w(E,j.t,' id="buorgul" href="'+A.url+'"'+I),S+="<style>.buorg {position:absolute;position:fixed;z-index:111111; width:100%; top:0px; left:0px; border-bottom:1px solid #A29330; text-align:left; cursor:pointer; color:#000; font: 13px Arial,sans-serif;color:#000;}.buorg div { padding:5px 36px 5px 40px; }.buorg>div>a,.buorg>div>a:visited{color:#E25600; text-decoration: underline;}#buorgclose{position:absolute;right:6px;top:0px;height:20px;width:12px;font:18px bold;padding:0;}#buorga{display:block;}@media only screen and (max-width: 700px){.buorg div { padding:5px 15px 5px 9px; }}</style>",_.innerHTML="<div>"+E+'<div id="buorgclose"><a id="buorga">&times;</a></div></div>'+S,A.addmargin=!0):(A.style==="bottom"?u+="<style>.buorg {bottom:0; top:auto; border-top:1px solid #A29330; } @keyframes buorgfly {from {opacity:0;transform:translateY(50px)} to {opacity:1;transform:translateY(0px)}}</style>":A.style==="corner"?u+="<style> .buorg { text-align: left; width:300px; top:50px; right:50px; left:auto; border:1px solid #A29330; } .buorg-buttons, .buorg-mainmsg, .buorg-moremsg { display: block; } .buorg-buttons a {margin: 4px 2px;} .buorg-icon {display: none;}</style>":A.addmargin=!0,E=E.replace("{brow_name}",j.t).replace("{up_but}",' id="buorgul" href="'+A.url+'"'+I).replace("{ignore_but}",' id="buorgig" role="button" tabindex="0"'),_.innerHTML='<div class="buorg-pad" role="status" aria-live="polite"><span class="buorg-icon"> </span>'+E+"</div>"+S+u),A.text=E,A.container?(A.container.appendChild(_),A.addmargin=!1):document.body.insertBefore(_,document.body.firstChild);var y=document.getElementById("buorgul");if(y&&(y.onclick=function(V){_.onclick=null,A.onclick(A),!A.noclose&&(A.setCookie(A.reminderClosed),A.noclose||(_.style.display="none",A.addmargin&&A.shift_page_down!==!1&&(v.style.marginTop=A.bodymt)))}),O||(_.style.cursor="pointer",_.onclick=function(){A.newwindow?window.open(A.url,"_blank"):window.location.href=A.url,A.setCookie(A.reminderClosed),A.onclick(A)}),A.addmargin&&A.shift_page_down!==!1){var v=document.getElementsByTagName("html")[0]||document.body;A.bodymt=v.style.marginTop,v.style.marginTop=_.clientHeight+"px"}var m=document.getElementById("buorga")||document.getElementById("buorgig");if(m&&(m.onclick=function(V){return _.onclick=null,A.onclose(A),A.addmargin&&A.shift_page_down!==!1&&(v.style.marginTop=A.bodymt),A.setCookie(A.reminderClosed),!A.no_permanent_hide&&N.bnever&&N.remind?(A.div.innerHTML='<div class="buorg-pad"><span class="buorg-moremsg">'+(A.reminderClosed>24?N.remind.replace("{days}",Math.round(A.reminderClosed/24)):"")+'</span> <span class="buorg-buttons"><a id="buorgpermanent" role="button" tabindex="0" href="'+A.url_permanent_hide+'"'+I+">"+N.bnever+"</a></span></div>"+S+u,_.className="buorg buorg-fadeout",document.getElementById("buorgpermanent").onclick=function(Z){A.setCookie(24*365),A.div.style.display="none"},A.div.style.opacity=0,A.div.style.visibility="hidden",!1):(A.div.style.display="none",!1)},(A.noclose||A.reminderClosed==0)&&m.parentNode.removeChild(m)),A.onshow(A),A.test&&!A.dont_show_debuginfo){var R=document.createElement("script");R.src=A.domain+"/update.test.js",document.body.appendChild(R)}};/**
 * @license
 * Video.js 8.21.0 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */(function(A,j){typeof exports=="object"&&typeof module<"u"?module.exports=j():typeof define=="function"&&define.amd?define(j):(A=typeof globalThis<"u"?globalThis:A||self).videojs=j()})(this,function(){var A="8.21.0";let j={},M=function(s,t){return j[s]=j[s]||[],t&&(j[s]=j[s].concat(t)),j[s]};function w(s,t){return!((t=M(s).indexOf(t))<=-1||(j[s]=j[s].slice(),j[s].splice(t,1),0))}let E={prefixed:!0};var N=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"]],O=N[0];let x;for(let s=0;s<N.length;s++)if(N[s][1]in document){x=N[s];break}if(x){for(let s=0;s<x.length;s++)E[O[s]]=x[s];E.prefixed=x[0]!==O[0]}let I=[];function _(s){return R(s)?Object.keys(s):[]}let S=function s(t,i=":",a=""){let o="info",l;function h(...H){l("log",o,H)}var T,B,G;return l=(T=t,G=a,(H,_e,pe)=>{var ae,_e=B.levels[_e],Ce=new RegExp(`^(${_e})$`);let Le=T;if(H!=="log"&&pe.unshift(H.toUpperCase()+":"),G&&(Le="%c"+T,pe.unshift(G)),pe.unshift(Le+":"),I&&(I.push([].concat(pe)),ae=I.length-1e3,I.splice(0,0<ae?ae:0)),window.console){let xe=window.console[H];(xe=xe||H!=="debug"?xe:window.console.info||window.console.log)&&_e&&Ce.test(H)&&xe[Array.isArray(pe)?"apply":"call"](window.console,pe)}}),(B=h).createLogger=(H,se,pe)=>s(t+` ${se=se!==void 0?se:i} `+H,se,pe!==void 0?pe:a),h.createNewLogger=(H,se,pe)=>s(H,se,pe),h.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:o},h.level=H=>{if(typeof H=="string"){if(!h.levels.hasOwnProperty(H))throw new Error(`"${H}" in not a valid log level`);o=H}return o},(h.history=()=>I?[].concat(I):[]).filter=H=>(I||[]).filter(se=>new RegExp(`.*${H}.*`).test(se[0])),h.history.clear=()=>{I&&(I.length=0)},h.history.disable=()=>{I!==null&&(I.length=0,I=null)},h.history.enable=()=>{I===null&&(I=[])},h.error=(...H)=>l("error",o,H),h.warn=(...H)=>l("warn",o,H),h.debug=(...H)=>l("debug",o,H),h}("VIDEOJS"),u=S.createLogger,y=Object.prototype.toString;function v(s,t){_(s).forEach(i=>t(s[i],i))}function m(s,t,i=0){return _(s).reduce((a,o)=>t(a,s[o],o),i)}function R(s){return!!s&&typeof s=="object"}function V(s){return R(s)&&y.call(s)==="[object Object]"&&s.constructor===Object}function Z(...s){let t={};return s.forEach(i=>{i&&v(i,(a,o)=>{V(a)?(V(t[o])||(t[o]={}),t[o]=Z(t[o],a)):t[o]=a})}),t}function ne(s={}){var t,i,a=[];for(t in s)s.hasOwnProperty(t)&&(i=s[t],a.push(i));return a}function ee(s,t,i,a=!0){let o=h=>Object.defineProperty(s,t,{value:h,enumerable:!0,writable:!0});var l={configurable:!0,enumerable:!0,get(){var h=i();return o(h),h}};return a&&(l.set=o),Object.defineProperty(s,t,l)}let z=Object.freeze({__proto__:null,each:v,reduce:m,isObject:R,isPlain:V,merge:Z,values:ne,defineLazyProperty:ee}),P=!1,Y=null,$=!1,J,te=!1,q=!1,K=!1,U=!1,F=null,re=null;var vi=!!(window.cast&&window.cast.framework&&window.cast.framework.CastReceiverContext);let W=null,ie=!1,he=!1,ve=!1,Ne=!1,ze=!1,rt=!1,le=!1,me=!!(We()&&("ontouchstart"in window||window.navigator.maxTouchPoints||window.DocumentTouch&&window.document instanceof window.DocumentTouch));var De,Me=window.navigator&&window.navigator.userAgentData;if(Me&&Me.platform&&Me.brands&&($=Me.platform==="Android",q=!!Me.brands.find(s=>s.brand==="Microsoft Edge"),K=!!Me.brands.find(s=>s.brand==="Chromium"),U=!q&&K,F=re=(Me.brands.find(s=>s.brand==="Chromium")||{}).version||null,he=Me.platform==="Windows"),!K){let s=window.navigator&&window.navigator.userAgent||"";P=/iPod/i.test(s),Y=(Me=s.match(/OS (\d+)_/i))&&Me[1]?Me[1]:null,$=/Android/i.test(s),J=(Me=s.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i))?(er=Me[1]&&parseFloat(Me[1]),De=Me[2]&&parseFloat(Me[2]),er&&De?parseFloat(Me[1]+"."+Me[2]):er||null):null,te=/Firefox/i.test(s),q=/Edg/i.test(s),K=/Chrome/i.test(s)||/CriOS/i.test(s),U=!q&&K,F=re=(De=s.match(/(Chrome|CriOS)\/(\d+)/))&&De[2]?parseFloat(De[2]):null,W=function(){var t=/MSIE\s(\d+)\.\d/.exec(s);let i=t&&parseFloat(t[1]);return i=!i&&/Trident\/7.0/i.test(s)&&/rv:11.0/.test(s)?11:i}(),ze=/Tizen/i.test(s),rt=/Web0S/i.test(s),le=ze||rt,ie=/Safari/i.test(s)&&!U&&!$&&!q&&!le,he=/Windows/i.test(s),ve=/iPad/i.test(s)||ie&&me&&!/iPhone/i.test(s),Ne=/iPhone/i.test(s)&&!ve}let Re=Ne||ve||P,we=(ie||Re)&&!U;var ke=Object.freeze({__proto__:null,get IS_IPOD(){return P},get IOS_VERSION(){return Y},get IS_ANDROID(){return $},get ANDROID_VERSION(){return J},get IS_FIREFOX(){return te},get IS_EDGE(){return q},get IS_CHROMIUM(){return K},get IS_CHROME(){return U},get CHROMIUM_VERSION(){return F},get CHROME_VERSION(){return re},IS_CHROMECAST_RECEIVER:vi,get IE_VERSION(){return W},get IS_SAFARI(){return ie},get IS_WINDOWS(){return he},get IS_IPAD(){return ve},get IS_IPHONE(){return Ne},get IS_TIZEN(){return ze},get IS_WEBOS(){return rt},get IS_SMART_TV(){return le},TOUCH_ENABLED:me,IS_IOS:Re,IS_ANY_SAFARI:we});function Ve(s){return typeof s=="string"&&!!s.trim()}function We(){return document===window.document}function $e(s){return R(s)&&s.nodeType===1}function ue(){try{return window.parent!==window.self}catch{return!0}}function Se(s){return function(t,i){return Ve(t)?(i=$e(i=Ve(i)?document.querySelector(i):i)?i:document)[s]&&i[s](t):document[s](null)}}function be(s="div",t={},i={},a){let o=document.createElement(s);return Object.getOwnPropertyNames(t).forEach(function(l){var h=t[l];l==="textContent"?Fe(o,h):o[l]===h&&l!=="tabIndex"||(o[l]=h)}),Object.getOwnPropertyNames(i).forEach(function(l){o.setAttribute(l,i[l])}),a&&je(o,a),o}function Fe(s,t){return typeof s.textContent>"u"?s.innerText=t:s.textContent=t,s}function ut(s,t){t.firstChild?t.insertBefore(s,t.firstChild):t.appendChild(s)}function Pt(s,t){if(0<=t.indexOf(" "))throw new Error("class has illegal whitespace characters");return s.classList.contains(t)}function yt(s,...t){return s.classList.add(...t.reduce((i,a)=>i.concat(a.split(/\s+/)),[])),s}function At(s,...t){return s?(s.classList.remove(...t.reduce((i,a)=>i.concat(a.split(/\s+/)),[])),s):(S.warn("removeClass was called with an element that doesn't exist"),null)}function ri(s,t,i){return typeof(i=typeof i=="function"?i(s,t):i)!="boolean"&&(i=void 0),t.split(/\s+/).forEach(a=>s.classList.toggle(a,i)),s}function $t(s,t){Object.getOwnPropertyNames(t).forEach(function(i){var a=t[i];a===null||typeof a>"u"||a===!1?s.removeAttribute(i):s.setAttribute(i,a===!0?"":a)})}function Rt(s){var t={},i=["autoplay","controls","playsinline","loop","muted","default","defaultMuted"];if(s&&s.attributes&&0<s.attributes.length){var a=s.attributes;for(let l=a.length-1;0<=l;l--){var o=a[l].name;let h=a[l].value;i.includes(o)&&(h=h!==null),t[o]=h}}return t}function zt(s,t){return s.getAttribute(t)}function et(s,t,i){s.setAttribute(t,i)}function ct(s,t){s.removeAttribute(t)}function It(){document.body.focus(),document.onselectstart=function(){return!1}}function at(){document.onselectstart=function(){return!0}}function vt(s){if(s&&s.getBoundingClientRect&&s.parentNode){let t=s.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(a=>{t[a]!==void 0&&(i[a]=t[a])}),i.height||(i.height=parseFloat(ot(s,"height"))),i.width||(i.width=parseFloat(ot(s,"width"))),i}}function Ke(s){if(!s||!s.offsetParent)return{left:0,top:0,width:0,height:0};var t=s.offsetWidth,i=s.offsetHeight;let a=0,o=0;for(;s.offsetParent&&s!==document[E.fullscreenElement];)a+=s.offsetLeft,o+=s.offsetTop,s=s.offsetParent;return{left:a,top:o,width:t,height:i}}function Je(T,t){var i={x:0,y:0};if(Re){let pe=T;for(;pe&&pe.nodeName.toLowerCase()!=="html";){var a,o=ot(pe,"transform");/^matrix/.test(o)?(a=o.slice(7,-1).split(/,\s/).map(Number),i.x+=a[4],i.y+=a[5]):/^matrix3d/.test(o)&&(a=o.slice(9,-1).split(/,\s/).map(Number),i.x+=a[12],i.y+=a[13]),pe.assignedSlot&&pe.assignedSlot.parentElement&&window.WebKitCSSMatrix&&(o=window.getComputedStyle(pe.assignedSlot.parentElement).transform,o=new window.WebKitCSSMatrix(o),i.x+=o.m41,i.y+=o.m42),pe=pe.parentNode||pe.host}}var l={},h=Ke(t.target),T=Ke(T),B=T.width,G=T.height;let H=t.offsetY-(T.top-h.top),se=t.offsetX-(T.left-h.left);return t.changedTouches&&(se=t.changedTouches[0].pageX-T.left,H=t.changedTouches[0].pageY+T.top,Re)&&(se-=i.x,H-=i.y),l.y=1-Math.max(0,Math.min(1,H/G)),l.x=Math.max(0,Math.min(1,se/B)),l}function ei(s){return R(s)&&s.nodeType===3}function ki(s){for(;s.firstChild;)s.removeChild(s.firstChild);return s}function ti(s){return typeof s=="function"&&(s=s()),(Array.isArray(s)?s:[s]).map(t=>$e(t=typeof t=="function"?t():t)||ei(t)?t:typeof t=="string"&&/\S/.test(t)?document.createTextNode(t):void 0).filter(t=>t)}function je(s,t){return ti(t).forEach(i=>s.appendChild(i)),s}function Xe(s,t){return je(ki(s),t)}function _t(s){return s.button===void 0&&s.buttons===void 0||s.button===0&&s.buttons===void 0||s.type==="mouseup"&&s.button===0&&s.buttons===0||s.type==="mousedown"&&s.button===0&&s.buttons===0||s.button===0&&s.buttons===1}let fe=Se("querySelector"),tt=Se("querySelectorAll");function ot(s,t){if(!s||!t||typeof window.getComputedStyle!="function")return"";{let i;try{i=window.getComputedStyle(s)}catch{return""}return i?i.getPropertyValue(t)||i[t]:""}}function Oe(s){[...document.styleSheets].forEach(t=>{try{var i=[...t.cssRules].map(o=>o.cssText).join(""),a=document.createElement("style");a.textContent=i,s.document.head.appendChild(a)}catch{i=document.createElement("link"),i.rel="stylesheet",i.type=t.type,i.media=t.media.mediaText,i.href=t.href,s.document.head.appendChild(i)}})}var Qe=Object.freeze({__proto__:null,isReal:We,isEl:$e,isInFrame:ue,createEl:be,textContent:Fe,prependTo:ut,hasClass:Pt,addClass:yt,removeClass:At,toggleClass:ri,setAttributes:$t,getAttributes:Rt,getAttribute:zt,setAttribute:et,removeAttribute:ct,blockTextSelection:It,unblockTextSelection:at,getBoundingClientRect:vt,findPosition:Ke,getPointerPosition:Je,isTextNode:ei,emptyEl:ki,normalizeContent:ti,appendContent:je,insertContent:Xe,isSingleLeftClick:_t,$:fe,$$:tt,computedStyle:ot,copyStyleSheetsToWindow:Oe});function de(){if(bt.options.autoSetup!==!1){var s=Array.prototype.slice.call(document.getElementsByTagName("video")),t=Array.prototype.slice.call(document.getElementsByTagName("audio")),i=Array.prototype.slice.call(document.getElementsByTagName("video-js")),a=s.concat(t,i);if(a&&0<a.length)for(let l=0,h=a.length;l<h;l++){var o=a[l];if(!o||!o.getAttribute){Q(1);break}o.player===void 0&&o.getAttribute("data-setup")!==null&&bt(o)}else nt||Q(1)}}let nt=!1,bt;function Q(s,t){We()&&(t&&(bt=t),window.setTimeout(de,s))}function qe(){nt=!0,window.removeEventListener("load",qe)}We()&&(document.readyState==="complete"?qe():window.addEventListener("load",qe));function Ye(s){var t=document.createElement("style");return t.className=s,t}function ye(s,t){s.styleSheet?s.styleSheet.cssText=t:s.textContent=t}var Ee=new WeakMap;let Be=3;function St(s,t){var i;Ee.has(s)&&((i=Ee.get(s)).handlers[t].length===0&&(delete i.handlers[t],s.removeEventListener?s.removeEventListener(t,i.dispatcher,!1):s.detachEvent&&s.detachEvent("on"+t,i.dispatcher)),Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled),Object.getOwnPropertyNames(i).length===0)&&Ee.delete(s)}function pt(s,t,i,a){i.forEach(function(o){s(t,o,a)})}function gt(s){if(!s.fixed_){if(!s||!s.isPropagationStopped||!s.isImmediatePropagationStopped){let T=s||window.event;s={};var t,i,a,o=["layerX","layerY","keyLocation","path","webkitMovementX","webkitMovementY","mozPressure","mozInputSource"];for(t in T)o.includes(t)||t==="returnValue"&&T.preventDefault||(s[t]=T[t]);s.target||(s.target=s.srcElement||document),s.relatedTarget||(s.relatedTarget=s.fromElement===s.target?s.toElement:s.fromElement),s.preventDefault=function(){T.preventDefault&&T.preventDefault(),s.returnValue=!1,T.returnValue=!1,s.defaultPrevented=!0},s.defaultPrevented=!1,s.stopPropagation=function(){T.stopPropagation&&T.stopPropagation(),s.cancelBubble=!0,T.cancelBubble=!0,s.isPropagationStopped=l},s.isPropagationStopped=h,s.stopImmediatePropagation=function(){T.stopImmediatePropagation&&T.stopImmediatePropagation(),s.isImmediatePropagationStopped=l,s.stopPropagation()},s.isImmediatePropagationStopped=h,s.clientX!=null&&(i=document.documentElement,a=document.body,s.pageX=s.clientX+(i&&i.scrollLeft||a&&a.scrollLeft||0)-(i&&i.clientLeft||a&&a.clientLeft||0),s.pageY=s.clientY+(i&&i.scrollTop||a&&a.scrollTop||0)-(i&&i.clientTop||a&&a.clientTop||0)),s.which=s.charCode||s.keyCode,s.button!=null&&(s.button=1&s.button?0:4&s.button?1:2&s.button?2:0)}s.fixed_=!0}return s;function l(){return!0}function h(){return!1}}let qt,Yn=["touchstart","touchmove"];function Vt(s,t,i){if(Array.isArray(t))return pt(Vt,s,t,i);Ee.has(s)||Ee.set(s,{});let a=Ee.get(s);if(a.handlers||(a.handlers={}),a.handlers[t]||(a.handlers[t]=[]),i.guid||(i.guid=Be++),a.handlers[t].push(i),a.dispatcher||(a.disabled=!1,a.dispatcher=function(o,l){if(!a.disabled){o=gt(o);var h=a.handlers[o.type];if(h){var T=h.slice(0);for(let B=0,G=T.length;B<G&&!o.isImmediatePropagationStopped();B++)try{T[B].call(s,o,l)}catch(H){S.error(H)}}}}),a.handlers[t].length===1)if(s.addEventListener){let o=!1;(function(){if(typeof qt!="boolean"){qt=!1;try{var l=Object.defineProperty({},"passive",{get(){qt=!0}});window.addEventListener("test",null,l),window.removeEventListener("test",null,l)}catch{}}return qt})()&&-1<Yn.indexOf(t)&&(o={passive:!0}),s.addEventListener(t,a.dispatcher,o)}else s.attachEvent&&s.attachEvent("on"+t,a.dispatcher)}function kt(s,t,i){if(Ee.has(s)){let h=Ee.get(s);if(h.handlers){if(Array.isArray(t))return pt(kt,s,t,i);var a=function(T,B){h.handlers[B]=[],St(T,B)};if(t===void 0)for(var o in h.handlers)Object.prototype.hasOwnProperty.call(h.handlers||{},o)&&a(s,o);else{var l=h.handlers[t];if(l)if(i){if(i.guid)for(let T=0;T<l.length;T++)l[T].guid===i.guid&&l.splice(T--,1);St(s,t)}else a(s,t)}}}}function oi(s,t,i){var a=Ee.has(s)?Ee.get(s):{},o=s.parentNode||s.ownerDocument;return typeof t=="string"?t={type:t,target:s}:t.target||(t.target=s),t=gt(t),a.dispatcher&&a.dispatcher.call(s,t,i),o&&!t.isPropagationStopped()&&t.bubbles===!0?oi.call(null,o,t,i):!o&&!t.defaultPrevented&&t.target&&t.target[t.type]&&(Ee.has(t.target)||Ee.set(t.target,{}),a=Ee.get(t.target),t.target[t.type])&&(a.disabled=!0,typeof t.target[t.type]=="function"&&t.target[t.type](),a.disabled=!1),!t.defaultPrevented}function Si(s,t,i){if(Array.isArray(t))return pt(Si,s,t,i);function a(){kt(s,t,a),i.apply(this,arguments)}a.guid=i.guid=i.guid||Be++,Vt(s,t,a)}function Pi(s,t,i){function a(){kt(s,t,a),i.apply(this,arguments)}a.guid=i.guid=i.guid||Be++,Vt(s,t,a)}var hr=Object.freeze({__proto__:null,fixEvent:gt,on:Vt,off:kt,trigger:oi,one:Si,any:Pi});function Kt(s,t,i){return t.guid||(t.guid=Be++),(s=t.bind(s)).guid=i?i+"_"+t.guid:t.guid,s}function Yt(s,t){let i=window.performance.now();return function(...a){var o=window.performance.now();o-i>=t&&(s(...a),i=o)}}function Hi(s,t,i,a=window){let o;function l(){let h=this,T=arguments,B=function(){o=null,B=null,i||s.apply(h,T)};!o&&i&&s.apply(h,T),a.clearTimeout(o),o=a.setTimeout(B,t)}return l.cancel=()=>{a.clearTimeout(o),o=null},l}let Ai=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:30,bind_:Kt,throttle:Yt,debounce:Hi}),qi;class ci{on(t,i){var a=this.addEventListener;this.addEventListener=()=>{},Vt(this,t,i),this.addEventListener=a}off(t,i){kt(this,t,i)}one(t,i){var a=this.addEventListener;this.addEventListener=()=>{},Si(this,t,i),this.addEventListener=a}any(t,i){var a=this.addEventListener;this.addEventListener=()=>{},Pi(this,t,i),this.addEventListener=a}trigger(t){var i=t.type||t;t=gt(t=typeof t=="string"?{type:i}:t),this.allowedEvents_[i]&&this["on"+i]&&this["on"+i](t),oi(this,t)}queueTrigger(t){qi=qi||new Map;let i=t.type||t,a=qi.get(this);a||(a=new Map,qi.set(this,a));var o=a.get(i),o=(a.delete(i),window.clearTimeout(o),window.setTimeout(()=>{a.delete(i),a.size===0&&(a=null,qi.delete(this)),this.trigger(t)},0));a.set(i,o)}}ci.prototype.allowedEvents_={},ci.prototype.addEventListener=ci.prototype.on,ci.prototype.removeEventListener=ci.prototype.off,ci.prototype.dispatchEvent=ci.prototype.trigger;let Zn=s=>typeof s.name=="function"?s.name():typeof s.name=="string"?s.name:s.name_||(s.constructor&&s.constructor.name?s.constructor.name:typeof s),On=s=>s instanceof ci||!!s.eventBusEl_&&["on","one","off","trigger"].every(t=>typeof s[t]=="function"),qa=s=>typeof s=="string"&&/\S/.test(s)||Array.isArray(s)&&!!s.length,js=(s,t,i)=>{if(!s||!s.nodeName&&!On(s))throw new Error(`Invalid target for ${Zn(t)}#${i}; must be a DOM node or evented object.`)},ql=(s,t,i)=>{if(!qa(s))throw new Error(`Invalid event type for ${Zn(t)}#${i}; must be a non-empty string or array.`)},Vl=(s,t,i)=>{if(typeof s!="function")throw new Error(`Invalid listener for ${Zn(t)}#${i}; must be a function.`)},Va=(s,t,i)=>{var a=t.length<3||t[0]===s||t[0]===s.eventBusEl_;let o,l,h;return a?(o=s.eventBusEl_,3<=t.length&&t.shift(),[l,h]=t):(o=t[0],l=t[1],h=t[2]),js(o,s,i),ql(l,s,i),Vl(h,s,i),h=Kt(s,h),{isTargetingSelf:a,target:o,type:l,listener:h}},Qn=(s,t,i,a)=>{js(s,s,t),s.nodeName?hr[t](s,i,a):s[t](i,a)},ip={on(...s){let{isTargetingSelf:t,target:i,type:a,listener:o}=Va(this,s,"on");if(Qn(i,"on",a,o),!t){let l=()=>this.off(i,a,o);l.guid=o.guid,s=()=>this.off("dispose",l),s.guid=o.guid,Qn(this,"on","dispose",l),Qn(i,"on","dispose",s)}},one(...s){let{isTargetingSelf:t,target:i,type:a,listener:o}=Va(this,s,"one");if(t)Qn(i,"one",a,o);else{let l=(...h)=>{this.off(i,a,l),o.apply(null,h)};l.guid=o.guid,Qn(i,"one",a,l)}},any(...s){let{isTargetingSelf:t,target:i,type:a,listener:o}=Va(this,s,"any");if(t)Qn(i,"any",a,o);else{let l=(...h)=>{this.off(i,a,l),o.apply(null,h)};l.guid=o.guid,Qn(i,"any",a,l)}},off(s,t,i){!s||qa(s)?kt(this.eventBusEl_,s,t):(s=s,t=t,js(s,this,"off"),ql(t,this,"off"),Vl(i,this,"off"),i=Kt(this,i),this.off("dispose",i),s.nodeName?(kt(s,t,i),kt(s,"dispose",i)):On(s)&&(s.off(t,i),s.off("dispose",i)))},trigger(s,t){js(this.eventBusEl_,this,"trigger");var i=s&&typeof s!="string"?s.type:s;if(qa(i))return oi(this.eventBusEl_,s,t);throw new Error(`Invalid event type for ${Zn(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`)}};function Wa(s,t={}){if(t=t.eventBusKey,t){if(!s[t].nodeName)throw new Error(`The eventBusKey "${t}" does not refer to an element.`);s.eventBusEl_=s[t]}else s.eventBusEl_=be("span",{className:"vjs-event-bus"});Object.assign(s,ip),s.eventedCallbacks&&s.eventedCallbacks.forEach(i=>{i()}),s.on("dispose",()=>{s.off(),[s,s.el_,s.eventBusEl_].forEach(function(i){i&&Ee.has(i)&&Ee.delete(i)}),window.setTimeout(()=>{s.eventBusEl_=null},0)})}let np={state:{},setState(s){typeof s=="function"&&(s=s());let t;return v(s,(i,a)=>{this.state[a]!==i&&((t=t||{})[a]={from:this.state[a],to:i}),this.state[a]=i}),t&&On(this)&&this.trigger({changes:t,type:"statechanged"}),t}};function Wl(s,t){Object.assign(s,np),s.state=Object.assign({},s.state,t),typeof s.handleStateChanged=="function"&&On(s)&&s.on("statechanged",s.handleStateChanged)}function Qr(s){return typeof s!="string"?s:s.replace(/./,t=>t.toLowerCase())}function _i(s){return typeof s!="string"?s:s.replace(/./,t=>t.toUpperCase())}function Xl(s,t){return _i(s)===_i(t)}let rp=Object.freeze({__proto__:null,toLowerCase:Qr,toTitleCase:_i,titleCaseEquals:Xl});class Ze{constructor(t,i,a){!t&&this.play?this.player_=t=this:this.player_=t,this.isDisposed_=!1,this.parentComponent_=null,this.options_=Z({},this.options_),i=this.options_=Z(this.options_,i),this.id_=i.id||i.el&&i.el.id,this.id_||(t=t&&t.id&&t.id()||"no_player",this.id_=t+"_component_"+Be++),this.name_=i.name||null,i.el?this.el_=i.el:i.createEl!==!1&&(this.el_=this.createEl()),i.className&&this.el_&&i.className.split(" ").forEach(o=>this.addClass(o)),["on","off","one","any","trigger"].forEach(o=>{this[o]=void 0}),i.evented!==!1&&(Wa(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),Wl(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,(this.clearingTimersOnDispose_=!1)!==i.initChildren&&this.initChildren(),this.ready(a),i.reportTouchActivity!==!1&&this.enableTouchActivity()}dispose(t={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let i=this.children_.length-1;0<=i;i--)this.children_[i].dispose&&this.children_[i].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(t.restoreEl?this.el_.parentNode.replaceChild(t.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return!!this.isDisposed_}player(){return this.player_}options(t){return t&&(this.options_=Z(this.options_,t)),this.options_}el(){return this.el_}createEl(t,i,a){return be(t,i,a)}localize(t,i,a=t){var l=this.player_.language&&this.player_.language(),h=this.player_.languages&&this.player_.languages(),o=h&&h[l],l=l&&l.split("-")[0],h=h&&h[l];let T=a;return o&&o[t]?T=o[t]:h&&h[t]&&(T=h[t]),T=i?T.replace(/\{(\d+)\}/g,function(B,G){return G=i[G-1],typeof G>"u"?B:G}):T}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(t){return this.childIndex_[t]}getChild(t){if(t)return this.childNameIndex_[t]}getDescendant(...t){t=t.reduce((a,o)=>a.concat(o),[]);let i=this;for(let a=0;a<t.length;a++)if(!(i=i.getChild(t[a]))||!i.getChild)return;return i}setIcon(t,i=this.el()){var a,o,l;if(this.player_.options_.experimentalSvgIcons)return l="http://www.w3.org/2000/svg",a=be("span",{className:"vjs-icon-placeholder vjs-svg-icon"},{"aria-hidden":"true"}),(o=document.createElementNS(l,"svg")).setAttributeNS(null,"viewBox","0 0 512 512"),l=document.createElementNS(l,"use"),o.appendChild(l),l.setAttributeNS(null,"href","#vjs-icon-"+t),a.appendChild(o),this.iconIsSet_?i.replaceChild(a,i.querySelector(".vjs-icon-placeholder")):i.appendChild(a),this.iconIsSet_=!0,a}addChild(t,i={},a=this.children_.length){let o,l;if(typeof t=="string"){l=_i(t);var h=i.componentClass||l,T=(i.name=l,Ze.getComponent(h));if(!T)throw new Error(`Component ${h} does not exist`);if(typeof T!="function")return null;o=new T(this.player_||this,i)}else o=t;if(o.parentComponent_&&o.parentComponent_.removeChild(o),this.children_.splice(a,0,o),o.parentComponent_=this,typeof o.id=="function"&&(this.childIndex_[o.id()]=o),(l=l||o.name&&_i(o.name()))&&(this.childNameIndex_[l]=o,this.childNameIndex_[Qr(l)]=o),typeof o.el=="function"&&o.el()){let B=null;this.children_[a+1]&&(this.children_[a+1].el_?B=this.children_[a+1].el_:$e(this.children_[a+1])&&(B=this.children_[a+1])),this.contentEl().insertBefore(o.el(),B)}return o}removeChild(t){if((t=typeof t=="string"?this.getChild(t):t)&&this.children_){let a=!1;for(let o=this.children_.length-1;0<=o;o--)if(this.children_[o]===t){a=!0,this.children_.splice(o,1);break}var i;a&&(t.parentComponent_=null,this.childIndex_[t.id()]=null,this.childNameIndex_[_i(t.name())]=null,this.childNameIndex_[Qr(t.name())]=null,i=t.el())&&i.parentNode===this.contentEl()&&this.contentEl().removeChild(t.el())}}initChildren(){let t=this.options_.children;if(t){let i=this.options_,a,o=Ze.getComponent("Tech");(a=Array.isArray(t)?t:Object.keys(t)).concat(Object.keys(this.options_).filter(function(l){return!a.some(function(h){return typeof h=="string"?l===h:l===h.name})})).map(l=>{let h,T;return T=typeof l=="string"?(h=l,t[h]||this.options_[h]||{}):(h=l.name,l),{name:h,opts:T}}).filter(l=>(l=Ze.getComponent(l.opts.componentClass||_i(l.name)),l&&!o.isTech(l))).forEach(l=>{var h=l.name;let T=l.opts;(T=i[h]!==void 0?i[h]:T)!==!1&&((T=T===!0?{}:T).playerOptions=this.options_.playerOptions,l=this.addChild(h,T))&&(this[h]=l)})}}buildCSSClass(){return""}ready(t,i=!1){t&&(this.isReady_?i?t.call(this):this.setTimeout(t,1):(this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(t)))}triggerReady(){this.isReady_=!0,this.setTimeout(function(){var t=this.readyQueue_;this.readyQueue_=[],t&&0<t.length&&t.forEach(function(i){i.call(this)},this),this.trigger("ready")},1)}$(t,i){return fe(t,i||this.contentEl())}$$(t,i){return tt(t,i||this.contentEl())}hasClass(t){return Pt(this.el_,t)}addClass(...t){yt(this.el_,...t)}removeClass(...t){At(this.el_,...t)}toggleClass(t,i){ri(this.el_,t,i)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(t){return zt(this.el_,t)}setAttribute(t,i){et(this.el_,t,i)}removeAttribute(t){ct(this.el_,t)}width(t,i){return this.dimension("width",t,i)}height(t,i){return this.dimension("height",t,i)}dimensions(t,i){this.width(t,!0),this.height(i)}dimension(t,i,a){var o,l;if(i===void 0)return this.el_?(l=(o=this.el_.style[t]).indexOf("px"))!==-1?parseInt(o.slice(0,l),10):parseInt(this.el_["offset"+_i(t)],10):0;(""+(i=i!==null&&i==i?i:0)).indexOf("%")!==-1||(""+i).indexOf("px")!==-1?this.el_.style[t]=i:this.el_.style[t]=i==="auto"?"":i+"px",a||this.trigger("componentresize")}currentDimension(t){let i=0;if(t!=="width"&&t!=="height")throw new Error("currentDimension only accepts width or height value");return i=ot(this.el_,t),(i=parseFloat(i))!==0&&!isNaN(i)||(t="offset"+_i(t),i=this.el_[t]),i}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}getPositions(){var t=this.el_.getBoundingClientRect();return{boundingClientRect:{x:t.x,y:t.y,width:t.width,height:t.height,top:t.top,right:t.right,bottom:t.bottom,left:t.left},center:{x:t.left+t.width/2,y:t.top+t.height/2,width:0,height:0,top:t.top+t.height/2,right:t.left+t.width/2,bottom:t.top+t.height/2,left:t.left+t.width/2}}}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(t){this.player_&&(t.key==="Tab"||this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled||t.stopPropagation(),this.player_.handleKeyDown(t))}handleKeyPress(t){this.handleKeyDown(t)}emitTapEvents(){let t=0,i=null,a;this.on("touchstart",function(l){l.touches.length===1&&(i={pageX:l.touches[0].pageX,pageY:l.touches[0].pageY},t=window.performance.now(),a=!0)}),this.on("touchmove",function(l){var h;(1<l.touches.length||i&&(h=l.touches[0].pageX-i.pageX,l=l.touches[0].pageY-i.pageY,10<Math.sqrt(h*h+l*l)))&&(a=!1)});function o(){a=!1}this.on("touchleave",o),this.on("touchcancel",o),this.on("touchend",function(l){!(i=null)===a&&window.performance.now()-t<200&&(l.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(this.player()&&this.player().reportUserActivity){let i=Kt(this.player(),this.player().reportUserActivity),a;this.on("touchstart",function(){i(),this.clearInterval(a),a=this.setInterval(i,250)});var t=function(o){i(),this.clearInterval(a)};this.on("touchmove",i),this.on("touchend",t),this.on("touchcancel",t)}}setTimeout(t,i){var a;return t=Kt(this,t),this.clearTimersOnDispose_(),a=window.setTimeout(()=>{this.setTimeoutIds_.has(a)&&this.setTimeoutIds_.delete(a),t()},i),this.setTimeoutIds_.add(a),a}clearTimeout(t){return this.setTimeoutIds_.has(t)&&(this.setTimeoutIds_.delete(t),window.clearTimeout(t)),t}setInterval(t,i){return t=Kt(this,t),this.clearTimersOnDispose_(),t=window.setInterval(t,i),this.setIntervalIds_.add(t),t}clearInterval(t){return this.setIntervalIds_.has(t)&&(this.setIntervalIds_.delete(t),window.clearInterval(t)),t}requestAnimationFrame(t){var i;return this.clearTimersOnDispose_(),t=Kt(this,t),i=window.requestAnimationFrame(()=>{this.rafIds_.has(i)&&this.rafIds_.delete(i),t()}),this.rafIds_.add(i),i}requestNamedAnimationFrame(t,i){this.namedRafs_.has(t)&&this.cancelNamedAnimationFrame(t),this.clearTimersOnDispose_(),i=Kt(this,i);var a=this.requestAnimationFrame(()=>{i(),this.namedRafs_.has(t)&&this.namedRafs_.delete(t)});return this.namedRafs_.set(t,a),t}cancelNamedAnimationFrame(t){this.namedRafs_.has(t)&&(this.cancelAnimationFrame(this.namedRafs_.get(t)),this.namedRafs_.delete(t))}cancelAnimationFrame(t){return this.rafIds_.has(t)&&(this.rafIds_.delete(t),window.cancelAnimationFrame(t)),t}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([t,i])=>{this[t].forEach((a,o)=>this[i](o))}),this.clearingTimersOnDispose_=!1}))}getIsDisabled(){return!!this.el_.disabled}getIsExpresslyInert(){return this.el_.inert&&!this.el_.ownerDocument.documentElement.inert}getIsFocusable(t){return 0<=(t||this.el_).tabIndex&&!(this.getIsDisabled()||this.getIsExpresslyInert())}getIsAvailableToBeFocused(t){function i(l){var l=window.getComputedStyle(l,null),h=l.getPropertyValue("visibility");return l.getPropertyValue("display")!=="none"&&!["hidden","collapse"].includes(h)}var a;return!(!function(o){if(o.offsetWidth+o.offsetHeight+o.getBoundingClientRect().height+o.getBoundingClientRect().width!==0){var l={x:o.getBoundingClientRect().left+o.offsetWidth/2,y:o.getBoundingClientRect().top+o.offsetHeight/2};if(!(l.x<0||l.x>(document.documentElement.clientWidth||window.innerWidth)||l.y<0||l.y>(document.documentElement.clientHeight||window.innerHeight))){let h=document.elementFromPoint(l.x,l.y);for(;h;){if(h===o)return 1;if(!h.parentNode)return;h=h.parentNode}}}}(t=t||this.el())||!i((a=t).parentElement)||!i(a)||a.style.opacity==="0"||window.getComputedStyle(a).height==="0px"||window.getComputedStyle(a).width==="0px"||t.parentElement&&!(0<=t.tabIndex))}static registerComponent(t,i){if(typeof t!="string"||!t)throw new Error(`Illegal component name, "${t}"; must be a non-empty string.`);var a=Ze.getComponent("Tech"),a=a&&a.isTech(i),o=Ze===i||Ze.prototype.isPrototypeOf(i.prototype);if(a||!o){let l;throw l=a?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error(`Illegal component, "${t}"; ${l}.`)}if(t=_i(t),Ze.components_||(Ze.components_={}),o=Ze.getComponent("Player"),t==="Player"&&o&&o.players){let l=o.players;if(a=Object.keys(l),l&&0<a.length&&a.map(h=>l[h]).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return Ze.components_[t]=i,Ze.components_[Qr(t)]=i}static getComponent(t){if(t&&Ze.components_)return Ze.components_[t]}}function Gl(s,t,i,a){var o=a,l=i.length-1;if(typeof o!="number"||o<0||l<o)throw new Error(`Failed to execute '${s}' on 'TimeRanges': The index provided (${o}) is non-numeric or out of bounds (0-${l}).`);return i[a][t]}function Xa(s){let t;return t=s===void 0||s.length===0?{length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:{length:s.length,start:Gl.bind(null,"start",0,s),end:Gl.bind(null,"end",1,s)},window.Symbol&&window.Symbol.iterator&&(t[window.Symbol.iterator]=()=>(s||[]).values()),t}function hn(s,t){return Array.isArray(s)?Xa(s):s===void 0||t===void 0?Xa():Xa([[s,t]])}Ze.registerComponent("Component",Ze);function $l(s,h){s=s<0?0:s;let i=Math.floor(s%60),a=Math.floor(s/60%60),o=Math.floor(s/3600);var l=Math.floor(h/60%60),h=Math.floor(h/3600);return o=0<(o=!isNaN(s)&&s!==1/0?o:a=i="-")||0<h?o+":":"",a=((o||10<=l)&&a<10?"0"+a:a)+":",i=i<10?"0"+i:i,o+a+i}let Ga=$l;function Kl(s){Ga=s}function Yl(){Ga=$l}function Jn(s,t=s){return Ga(s,t)}Me=Object.freeze({__proto__:null,createTimeRanges:hn,createTimeRange:hn,setFormatTime:Kl,resetFormatTime:Yl,formatTime:Jn});function Zl(s,t){let i=0;var a;let o;if(!t)return 0;s&&s.length||(s=hn(0,0));for(let l=0;l<s.length;l++)a=s.start(l),(o=s.end(l))>t&&(o=t),i+=o-a;return i/t}function yi(s){if(s instanceof yi)return s;typeof s=="number"?this.code=s:typeof s=="string"?this.message=s:R(s)&&(typeof s.code=="number"&&(this.code=s.code),Object.assign(this,s)),this.message||(this.message=yi.defaultMessages[this.code]||"")}function Jr(s){return s!=null&&typeof s.then=="function"}function vn(s){Jr(s)&&s.then(null,t=>{})}yi.prototype.code=0,yi.prototype.message="",yi.prototype.status=null,yi.prototype.metadata=null,yi.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],yi.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."},yi.MEDIA_ERR_CUSTOM=0,yi.prototype.MEDIA_ERR_CUSTOM=0,yi.MEDIA_ERR_ABORTED=1,yi.prototype.MEDIA_ERR_ABORTED=1,yi.MEDIA_ERR_NETWORK=2,yi.prototype.MEDIA_ERR_NETWORK=2,yi.MEDIA_ERR_DECODE=3,yi.prototype.MEDIA_ERR_DECODE=3,yi.MEDIA_ERR_SRC_NOT_SUPPORTED=4,yi.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED=4,yi.MEDIA_ERR_ENCRYPTED=5,yi.prototype.MEDIA_ERR_ENCRYPTED=5;function $a(s){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((t,i,a)=>(s[i]&&(t[i]=s[i]),t),{cues:s.cues&&Array.prototype.map.call(s.cues,function(t){return{startTime:t.startTime,endTime:t.endTime,text:t.text,id:t.id}})})}var Ql,sp=function(s){var t=s.$$("track");let i=Array.prototype.map.call(t,a=>a.track);return Array.prototype.map.call(t,function(a){var o=$a(a.track);return a.src&&(o.src=a.src),o}).concat(Array.prototype.filter.call(s.textTracks(),function(a){return i.indexOf(a)===-1}).map($a))},ap=function(s,t){return s.forEach(function(i){let a=t.addRemoteTextTrack(i).track;!i.src&&i.cues&&i.cues.forEach(o=>a.addCue(o))}),t.textTracks()};let Ka="vjs-modal-dialog";class pr extends Ze{constructor(t,i){super(t,i),this.handleKeyDown_=a=>this.handleKeyDown(a),this.close_=a=>this.close(a),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=be("div",{className:Ka+"-content"},{role:"document"}),this.descEl_=be("p",{className:Ka+"-description vjs-control-text",id:this.el().getAttribute("aria-describedby")}),Fe(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog","aria-live":"polite"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return Ka+" vjs-hidden "+super.buildCSSClass()}label(){return this.localize(this.options_.label||"Modal Window")}description(){let t=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(t+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),t}open(){var t;this.opened_?this.options_.fillAlways&&this.fill():(t=this.player(),this.trigger("beforemodalopen"),this.opened_=!0,!this.options_.fillAlways&&(this.hasBeenOpened_||this.hasBeenFilled_)||this.fill(),this.wasPlaying_=!t.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&t.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=t.controls(),t.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0)}opened(t){return typeof t=="boolean"&&this[t?"open":"close"](),this.opened_}close(){var t;this.opened_&&(t=this.player(),this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&t.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&t.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger({type:"modalclose",bubbles:!0}),this.conditionalBlur_(),this.options_.temporary)&&this.dispose()}closeable(t){if(typeof t=="boolean"){var i,t=this.closeable_=!!t;let o=this.getChild("closeButton");t&&!o&&(i=this.contentEl_,this.contentEl_=this.el_,o=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=i,this.on(o,"close",this.close_)),!t&&o&&(this.off(o,"close",this.close_),this.removeChild(o),o.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(l){var i=this.contentEl(),a=i.parentNode,o=i.nextSibling,l=(this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,a.removeChild(i),this.empty(),Xe(i,l),this.trigger("modalfill"),o?a.insertBefore(i,o):a.appendChild(i),this.getChild("closeButton"));l&&a.appendChild(l.el_),this.trigger("aftermodalfill")}empty(){this.trigger("beforemodalempty"),ki(this.contentEl()),this.trigger("modalempty")}content(t){return typeof t<"u"&&(this.content_=t),this.content_}conditionalFocus_(){var t=document.activeElement,i=this.player_.el_;this.previouslyActiveEl_=null,!i.contains(t)&&i!==t||(this.previouslyActiveEl_=t,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(t){if(this.trigger({type:"modalKeydown",originalEvent:t,target:this,bubbles:!0}),t.stopPropagation(),t.key==="Escape"&&this.closeable())t.preventDefault(),this.close();else if(t.key==="Tab"){var i=this.focusableEls_(),a=this.el_.querySelector(":focus");let o;for(let l=0;l<i.length;l++)if(a===i[l]){o=l;break}document.activeElement===this.el_&&(o=0),t.shiftKey&&o===0?(i[i.length-1].focus(),t.preventDefault()):t.shiftKey||o!==i.length-1||(i[0].focus(),t.preventDefault())}}focusableEls_(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,i=>(i instanceof window.HTMLAnchorElement||i instanceof window.HTMLAreaElement)&&i.hasAttribute("href")||(i instanceof window.HTMLInputElement||i instanceof window.HTMLSelectElement||i instanceof window.HTMLTextAreaElement||i instanceof window.HTMLButtonElement)&&!i.hasAttribute("disabled")||i instanceof window.HTMLIFrameElement||i instanceof window.HTMLObjectElement||i instanceof window.HTMLEmbedElement||i.hasAttribute("tabindex")&&i.getAttribute("tabindex")!==-1||i.hasAttribute("contenteditable"))}}pr.prototype.options_={pauseOnOpen:!0,temporary:!0},Ze.registerComponent("ModalDialog",pr);class es extends ci{constructor(t=[]){super(),this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let i=0;i<t.length;i++)this.addTrack(t[i])}addTrack(t){let i=this.tracks_.length;""+i in this||Object.defineProperty(this,i,{get(){return this.tracks_[i]}}),this.tracks_.indexOf(t)===-1&&(this.tracks_.push(t),this.trigger({track:t,type:"addtrack",target:this})),t.labelchange_=()=>{this.trigger({track:t,type:"labelchange",target:this})},On(t)&&t.addEventListener("labelchange",t.labelchange_)}removeTrack(t){let i;for(let a=0,o=this.length;a<o;a++)if(this[a]===t){(i=this[a]).off&&i.off(),this.tracks_.splice(a,1);break}i&&this.trigger({track:i,type:"removetrack",target:this})}getTrackById(t){let i=null;for(let o=0,l=this.length;o<l;o++){var a=this[o];if(a.id===t){i=a;break}}return i}}for(Ql in es.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"})es.prototype["on"+Ql]=null;function Ya(s,t){for(let i=0;i<s.length;i++)Object.keys(s[i]).length&&t.id!==s[i].id&&(s[i].enabled=!1)}class op extends es{constructor(t=[]){for(let i=t.length-1;0<=i;i--)if(t[i].enabled){Ya(t,t[i]);break}super(t),this.changing_=!1}addTrack(t){t.enabled&&Ya(this,t),super.addTrack(t),t.addEventListener&&(t.enabledChange_=()=>{this.changing_||(this.changing_=!0,Ya(this,t),this.changing_=!1,this.trigger("change"))},t.addEventListener("enabledchange",t.enabledChange_))}removeTrack(t){super.removeTrack(t),t.removeEventListener&&t.enabledChange_&&(t.removeEventListener("enabledchange",t.enabledChange_),t.enabledChange_=null)}}function Za(s,t){for(let i=0;i<s.length;i++)Object.keys(s[i]).length&&t.id!==s[i].id&&(s[i].selected=!1)}class lp extends es{constructor(t=[]){for(let i=t.length-1;0<=i;i--)if(t[i].selected){Za(t,t[i]);break}super(t),this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let i=0;i<this.length;i++)if(this[i].selected)return i;return-1},set(){}})}addTrack(t){t.selected&&Za(this,t),super.addTrack(t),t.addEventListener&&(t.selectedChange_=()=>{this.changing_||(this.changing_=!0,Za(this,t),this.changing_=!1,this.trigger("change"))},t.addEventListener("selectedchange",t.selectedChange_))}removeTrack(t){super.removeTrack(t),t.removeEventListener&&t.selectedChange_&&(t.removeEventListener("selectedchange",t.selectedChange_),t.selectedChange_=null)}}class Jl extends es{addTrack(t){super.addTrack(t),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),t.addEventListener("modechange",this.queueChange_),["metadata","chapters"].indexOf(t.kind)===-1&&t.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(t){super.removeTrack(t),t.removeEventListener&&(this.queueChange_&&t.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_)&&t.removeEventListener("modechange",this.triggerSelectedlanguagechange_)}}class Hs{constructor(t){Hs.prototype.setCues_.call(this,t),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(t){var i=this.length||0;let a=0;function o(h){""+h in this||Object.defineProperty(this,""+h,{get(){return this.cues_[h]}})}var l=t.length;if(this.cues_=t,this.length_=t.length,i<l)for(a=i;a<l;a++)o.call(this,a)}getCueById(t){let i=null;for(let o=0,l=this.length;o<l;o++){var a=this[o];if(a.id===t){i=a;break}}return i}}let up={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},dp={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},cp={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},eu={disabled:"disabled",hidden:"hidden",showing:"showing"};class Qa extends ci{constructor(t={}){super();let i={id:t.id||"vjs_track_"+Be++,kind:t.kind||"",language:t.language||""},a=t.label||"";for(let o in i)Object.defineProperty(this,o,{get(){return i[o]},set(){}});Object.defineProperty(this,"label",{get(){return a},set(o){o!==a&&(a=o,this.trigger("labelchange"))}})}}function Ja(s){return new URL(s,document.baseURI)}function tu(s){return new URL(s,document.baseURI).href}function qs(s,t=window.location){return Ja(s).origin!==t.origin}let eo=function(s){return typeof s=="string"&&(s=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(s),s)?s.pop().toLowerCase():""},hp=Object.freeze({__proto__:null,parseUrl:Ja,getAbsoluteURL:tu,getFileExtension:eo,isCrossOrigin:qs});var er=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vs(s,t){return s(t={exports:{}},t.exports),t.exports}var on=typeof window<"u"?window:typeof er<"u"?er:typeof self<"u"?self:{},iu=Vs(function(s){function t(){return s.exports=t=Object.assign?Object.assign.bind():function(i){for(var a=1;a<arguments.length;a++){var o,l=arguments[a];for(o in l)!{}.hasOwnProperty.call(l,o)||(i[o]=l[o])}return i},s.exports.__esModule=!0,s.exports.default=s.exports,t.apply(null,arguments)}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports}),Ii=(vi=iu)&&vi.__esModule&&Object.prototype.hasOwnProperty.call(vi,"default")?vi.default:vi,pp=function(s){var t;return!!s&&((t=fp.call(s))==="[object Function]"||typeof s=="function"&&t!=="[object RegExp]"||typeof window<"u"&&(s===window.setTimeout||s===window.alert||s===window.confirm||s===window.prompt))},fp=Object.prototype.toString;function mp(s,t){var i,a=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(a)return(a=a.call(s)).next.bind(a);if(Array.isArray(s)||(a=function(o,l){var h;if(o)return typeof o=="string"?nu(o,l):(h=(h=Object.prototype.toString.call(o).slice(8,-1))==="Object"&&o.constructor?o.constructor.name:h)==="Map"||h==="Set"?Array.from(o):h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h)?nu(o,l):void 0}(s))||t&&s&&typeof s.length=="number")return a&&(s=a),i=0,function(){return i>=s.length?{done:!0}:{done:!1,value:s[i++]}};throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nu(s,t){(t==null||t>s.length)&&(t=s.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=s[i];return a}var vi=function(){function s(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1}var t=s.prototype;return t.getIsEnabled=function(){return this.enabled_},t.enable=function(){this.enabled_=!0},t.disable=function(){this.enabled_=!1},t.reset=function(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1},t.addInterceptor=function(i,a){return this.typeToInterceptorsMap_.has(i)||this.typeToInterceptorsMap_.set(i,new Set),i=this.typeToInterceptorsMap_.get(i),!i.has(a)&&(i.add(a),!0)},t.removeInterceptor=function(i,a){return i=this.typeToInterceptorsMap_.get(i),!(!i||!i.has(a)||(i.delete(a),0))},t.clearInterceptorsByType=function(i){return!!this.typeToInterceptorsMap_.get(i)&&(this.typeToInterceptorsMap_.delete(i),this.typeToInterceptorsMap_.set(i,new Set),!0)},t.clear=function(){return!!this.typeToInterceptorsMap_.size&&(this.typeToInterceptorsMap_=new Map,!0)},t.getForType=function(i){return this.typeToInterceptorsMap_.get(i)||new Set},t.execute=function(i,a){for(var o=mp(this.getForType(i));!(l=o()).done;){var l=l.value;try{a=l(a)}catch{}}return a},s}(),Xi=function(){function s(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1}var t=s.prototype;return t.getIsEnabled=function(){return this.enabled_},t.enable=function(){this.enabled_=!0},t.disable=function(){this.enabled_=!1},t.reset=function(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1},t.getMaxAttempts=function(){return this.maxAttempts_},t.setMaxAttempts=function(i){this.maxAttempts_=i},t.getDelayFactor=function(){return this.delayFactor_},t.setDelayFactor=function(i){this.delayFactor_=i},t.getFuzzFactor=function(){return this.fuzzFactor_},t.setFuzzFactor=function(i){this.fuzzFactor_=i},t.getInitialDelay=function(){return this.initialDelay_},t.setInitialDelay=function(i){this.initialDelay_=i},t.createRetry=function(a){var a=a===void 0?{}:a,o=a.maxAttempts;return new gp({maxAttempts:o||this.maxAttempts_,delayFactor:a.delayFactor||this.delayFactor_,fuzzFactor:a.fuzzFactor||this.fuzzFactor_,initialDelay:a.initialDelay||this.initialDelay_})},s}(),gp=function(){function s(i){this.maxAttempts_=i.maxAttempts,this.delayFactor_=i.delayFactor,this.fuzzFactor_=i.fuzzFactor,this.currentDelay_=i.initialDelay,this.currentAttempt_=1}var t=s.prototype;return t.moveToNextAttempt=function(){this.currentAttempt_++;var i=this.currentDelay_*this.delayFactor_;this.currentDelay_=this.currentDelay_+i},t.shouldRetry=function(){return this.currentAttempt_<this.maxAttempts_},t.getCurrentDelay=function(){return this.currentDelay_},t.getCurrentMinPossibleDelay=function(){return(1-this.fuzzFactor_)*this.currentDelay_},t.getCurrentMaxPossibleDelay=function(){return(1+this.fuzzFactor_)*this.currentDelay_},t.getCurrentFuzzedDelay=function(){var i=this.getCurrentMinPossibleDelay(),a=this.getCurrentMaxPossibleDelay();return i+Math.random()*(a-i)},s}();wi.httpHandler=function(s,t){return t===void 0&&(t=!1),function(i,a,o){if(i)s(i);else if(400<=a.statusCode&&a.statusCode<=599){if(i=o,t)if(on.TextDecoder){a=function(l){return l===void 0&&(l=""),l.toLowerCase().split(";").reduce(function(h,G){var G=G.split("="),B=G[0],G=G[1];return B.trim()==="charset"?G.trim():h},"utf-8")}(a.headers&&a.headers["content-type"]);try{i=new TextDecoder(a).decode(o)}catch{}}else i=String.fromCharCode.apply(null,new Uint8Array(o));s({cause:i})}else s(null,o)}},wi.requestInterceptorsStorage=new vi,wi.responseInterceptorsStorage=new vi,wi.retryManager=new Xi;for(var yp=function(t){var i={};return t&&t.trim().split(`
`).forEach(function(h){var o=h.indexOf(":"),l=h.slice(0,o).trim().toLowerCase(),h=h.slice(o+1).trim();typeof i[l]>"u"?i[l]=h:Array.isArray(i[l])?i[l].push(h):i[l]=[i[l],h]}),i},to=wi,vi=wi,ru=(wi.XMLHttpRequest=on.XMLHttpRequest||function(){},wi.XDomainRequest="withCredentials"in new wi.XMLHttpRequest?wi.XMLHttpRequest:on.XDomainRequest,["get","put","post","patch","head","delete"]),vp=function(t){wi[t==="delete"?"del":t]=function(i,a,o){return(a=su(i,a,o)).method=t.toUpperCase(),no(a)}},io=0;io<ru.length;io++)vp(ru[io]);function su(s,t,i){var a=s;return pp(t)?(i=t,typeof s=="string"&&(a={uri:s})):a=iu({},t,{uri:s}),a.callback=i,a}function wi(s,t,i){return no(t=su(s,t,i))}function no(s){if(typeof s.callback>"u")throw new Error("callback argument missing");s.requestType&&wi.requestInterceptorsStorage.getIsEnabled()&&(pe=wi.requestInterceptorsStorage.execute(s.requestType,{uri:s.uri||s.url,headers:s.headers||{},body:s.body,metadata:s.metadata||{},retry:s.retry,timeout:s.timeout}),s.uri=pe.uri,s.headers=pe.headers,s.body=pe.body,s.metadata=pe.metadata,s.retry=pe.retry,s.timeout=pe.timeout);var t=!1,i=function(xe,Pe,Ae){t||(t=!0,s.callback(xe,Pe,Ae))};function a(){var xe=void 0,xe=G.response||G.responseText||function(Pe){try{if(Pe.responseType==="document")return Pe.responseXML;var Ae=Pe.responseXML&&Pe.responseXML.documentElement.nodeName==="parsererror";if(Pe.responseType===""&&!Ae)return Pe.responseXML}catch{}return null}(G);if(Ce)try{xe=JSON.parse(xe)}catch{}return xe}function o(xe){var Pe;if(clearTimeout(B),clearTimeout(s.retryTimeout),(xe=xe instanceof Error?xe:new Error(""+(xe||"Unknown XMLHttpRequest Error"))).statusCode=0,T||!wi.retryManager.getIsEnabled()||!s.retry||!s.retry.shouldRetry())return s.requestType&&wi.responseInterceptorsStorage.getIsEnabled()&&(Pe={headers:Le.headers||{},body:Le.body,responseUrl:G.responseURL,responseType:G.responseType},Pe=wi.responseInterceptorsStorage.execute(s.requestType,Pe),Le.body=Pe.body,Le.headers=Pe.headers),i(xe,Le);s.retryTimeout=setTimeout(function(){s.retry.moveToNextAttempt(),s.xhr=G,no(s)},s.retry.getCurrentFuzzedDelay())}function l(){var xe,Pe,Ae;if(!T)return clearTimeout(B),clearTimeout(s.retryTimeout),Ae=s.useXDR&&G.status===void 0?200:G.status===1223?204:G.status,xe=Le,Pe=null,Ae!==0?(xe={body:a(),statusCode:Ae,method:se,headers:{},url:H,rawRequest:G},G.getAllResponseHeaders&&(xe.headers=yp(G.getAllResponseHeaders()))):Pe=new Error("Internal XMLHttpRequest Error"),s.requestType&&wi.responseInterceptorsStorage.getIsEnabled()&&(Ae={headers:xe.headers||{},body:xe.body,responseUrl:G.responseURL,responseType:G.responseType},Ae=wi.responseInterceptorsStorage.execute(s.requestType,Ae),xe.body=Ae.body,xe.headers=Ae.headers),i(Pe,xe,xe.body)}var h,T,B,G=s.xhr||null,H=(G=G||new(s.cors||s.useXDR?wi.XDomainRequest:wi.XMLHttpRequest)).url=s.uri||s.url,se=G.method=s.method||"GET",pe=s.body||s.data,ae=G.headers=s.headers||{},_e=!!s.sync,Ce=!1,Le={body:void 0,headers:{},statusCode:0,method:se,url:H,rawRequest:G};if("json"in s&&s.json!==!1&&(Ce=!0,ae.accept||ae.Accept||(ae.Accept="application/json"),se!=="GET")&&se!=="HEAD"&&(ae["content-type"]||ae["Content-Type"]||(ae["Content-Type"]="application/json"),pe=JSON.stringify(s.json===!0?pe:s.json)),G.onreadystatechange=function(){G.readyState!==4||wi.responseInterceptorsStorage.getIsEnabled()||setTimeout(l,0)},G.onload=l,G.onerror=o,G.onprogress=function(){},G.onabort=function(){T=!0,clearTimeout(s.retryTimeout)},G.ontimeout=o,G.open(se,H,!_e,s.username,s.password),_e||(G.withCredentials=!!s.withCredentials),!_e&&0<s.timeout&&(B=setTimeout(function(){var xe;T||(T=!0,G.abort("timeout"),(xe=new Error("XMLHttpRequest timeout")).code="ETIMEDOUT",o(xe))},s.timeout)),G.setRequestHeader)for(h in ae)ae.hasOwnProperty(h)&&G.setRequestHeader(h,ae[h]);else if(s.headers&&!function(xe){for(var Pe in xe)if(xe.hasOwnProperty(Pe))return;return 1}(s.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in s&&(G.responseType=s.responseType),"beforeSend"in s&&typeof s.beforeSend=="function"&&s.beforeSend(G),G.send(pe||null),G}to.default=vi;function au(s,t){var i=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder());let a=[];i.oncue=function(o){t.addCue(o)},i.onparsingerror=function(o){a.push(o)},i.onflush=function(){t.trigger({type:"loadeddata",target:t})},i.parse(s),0<a.length&&(window.console&&window.console.groupCollapsed&&window.console.groupCollapsed("Text Track parsing errors for "+t.src),a.forEach(o=>S.error(o)),window.console)&&window.console.groupEnd&&window.console.groupEnd(),i.flush()}function ou(s,t){var i={uri:s};(s=qs(s))&&(i.cors=s),(s=t.tech_.crossOrigin()==="use-credentials")&&(i.withCredentials=s),to(i,Kt(this,function(a,o,l){if(a)return S.error(a,o);t.loaded_=!0,typeof window.WebVTT!="function"?t.tech_&&t.tech_.any(["vttjsloaded","vttjserror"],h=>{if(h.type!=="vttjserror")return au(l,t);S.error("vttjs failed to load, stopping trying to process "+t.src)}):au(l,t)}))}class ts extends Qa{constructor(t={}){if(!t.tech)throw new Error("A tech was not provided.");t=Z(t,{kind:cp[t.kind]||"subtitles",language:t.language||t.srclang||""});let i=eu[t.mode]||"disabled",a=t.default,o=(t.kind!=="metadata"&&t.kind!=="chapters"||(i="hidden"),super(t),this.tech_=t.tech,this.cues_=[],this.activeCues_=[],this.preload_=this.tech_.preloadTextTracks!==!1,new Hs(this.cues_)),l=new Hs(this.activeCues_),h=!1;this.timeupdateHandler=Kt(this,function(T={}){this.tech_.isDisposed()||(this.tech_.isReady_&&(this.activeCues=this.activeCues,h)&&(this.trigger("cuechange"),h=!1),T.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler)))}),this.tech_.one("dispose",()=>{this.stopTracking()}),i!=="disabled"&&this.startTracking(),Object.defineProperties(this,{default:{get(){return a},set(){}},mode:{get(){return i},set(T){eu[T]&&i!==T&&(i=T,this.preload_||i==="disabled"||this.cues.length!==0||ou(this.src,this),this.stopTracking(),i!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?o:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(this.cues.length!==0){var T=this.tech_.currentTime(),B=[];for(let H=0,se=this.cues.length;H<se;H++){var G=this.cues[H];G.startTime<=T&&T<=G.endTime&&B.push(G)}if(h=!1,B.length!==this.activeCues_.length)h=!0;else for(let H=0;H<B.length;H++)this.activeCues_.indexOf(B[H])===-1&&(h=!0);this.activeCues_=B,l.setCues_(this.activeCues_)}return l},set(){}}}),t.src?(this.src=t.src,this.preload_||(this.loaded_=!0),(this.preload_||t.kind!=="subtitles"&&t.kind!=="captions")&&ou(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(t){let i=t;if(!("getCueAsHTML"in i)){for(var a in i=new window.vttjs.VTTCue(t.startTime,t.endTime,t.text),t)a in i||(i[a]=t[a]);i.id=t.id,i.originalCue_=t}var o=this.tech_.textTracks();for(let l=0;l<o.length;l++)o[l]!==this&&o[l].removeCue(i);this.cues_.push(i),this.cues.setCues_(this.cues_)}removeCue(t){let i=this.cues_.length;for(;i--;){var a=this.cues_[i];if(a===t||a.originalCue_&&a.originalCue_===t){this.cues_.splice(i,1),this.cues.setCues_(this.cues_);break}}}}ts.prototype.allowedEvents_={cuechange:"cuechange"};class lu extends Qa{constructor(t={}){t=Z(t,{kind:dp[t.kind]||""}),super(t);let i=!1;Object.defineProperty(this,"enabled",{get(){return i},set(a){typeof a=="boolean"&&a!==i&&(i=a,this.trigger("enabledchange"))}}),t.enabled&&(this.enabled=t.enabled),this.loaded_=!0}}class uu extends Qa{constructor(t={}){t=Z(t,{kind:up[t.kind]||""}),super(t);let i=!1;Object.defineProperty(this,"selected",{get(){return i},set(a){typeof a=="boolean"&&a!==i&&(i=a,this.trigger("selectedchange"))}}),t.selected&&(this.selected=t.selected)}}class Dn extends ci{constructor(t={}){super();let i,a=new ts(t);this.kind=a.kind,this.src=a.src,this.srclang=a.language,this.label=a.label,this.default=a.default,Object.defineProperties(this,{readyState:{get(){return i}},track:{get(){return a}}}),i=Dn.NONE,a.addEventListener("loadeddata",()=>{i=Dn.LOADED,this.trigger({type:"load",target:this})})}}Dn.prototype.allowedEvents_={load:"load"},Dn.NONE=0,Dn.LOADING=1,Dn.LOADED=2,Dn.ERROR=3;let ln={audio:{ListClass:op,TrackClass:lu,capitalName:"Audio"},video:{ListClass:lp,TrackClass:uu,capitalName:"Video"},text:{ListClass:Jl,TrackClass:ts,capitalName:"Text"}},fr=(Object.keys(ln).forEach(function(s){ln[s].getterName=s+"Tracks",ln[s].privateName=s+"Tracks_"}),{remoteText:{ListClass:Jl,TrackClass:ts,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:class{constructor(s=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let t=0,i=s.length;t<i;t++)this.addTrackElement_(s[t])}addTrackElement_(s){let t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.trackElements_[t]}}),this.trackElements_.indexOf(s)===-1&&this.trackElements_.push(s)}getTrackElementByTrack_(s){let t;for(let i=0,a=this.trackElements_.length;i<a;i++)if(s===this.trackElements_[i].track){t=this.trackElements_[i];break}return t}removeTrackElement_(s){for(let t=0,i=this.trackElements_.length;t<i;t++)if(s===this.trackElements_[t]){this.trackElements_[t].track&&typeof this.trackElements_[t].track.off=="function"&&this.trackElements_[t].track.off(),typeof this.trackElements_[t].off=="function"&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}}},TrackClass:Dn,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}}),Vi=Object.assign({},ln,fr);fr.names=Object.keys(fr),ln.names=Object.keys(ln),Vi.names=[].concat(fr.names).concat(ln.names);var Xi=typeof er<"u"?er:typeof window<"u"?window:{},Ws=typeof document<"u"?document:(Ws=Xi["__GLOBAL_DOCUMENT_CACHE@4"])||(Xi["__GLOBAL_DOCUMENT_CACHE@4"]={}),vi=Ws,ro=Object.create||function(s){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return du.prototype=s,new du};function du(){}function pn(s,t){this.name="ParsingError",this.code=s.code,this.message=t||s.message}function so(s){function t(i,a,o,l){return 3600*(0|i)+60*(0|a)+(0|o)+(0|l)/1e3}return s=s.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/),s?s[3]?t(s[1],s[2],s[3].replace(":",""),s[4]):59<s[1]?t(s[1],s[2],0,s[4]):t(0,s[1],s[2],s[4]):null}function is(){this.values=ro(null)}function ns(s,t,i,a){var o,l,h=a?s.split(a):[s];for(o in h)typeof h[o]=="string"&&(l=h[o].split(i)).length===2&&t(l[0].trim(),l[1].trim())}((pn.prototype=ro(Error.prototype)).constructor=pn).Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},is.prototype={set:function(s,t){this.get(s)||t===""||(this.values[s]=t)},get:function(s,t,i){return i?this.has(s)?this.values[s]:t[i]:this.has(s)?this.values[s]:t},has:function(s){return s in this.values},alt:function(s,t,i){for(var a=0;a<i.length;++a)if(t===i[a]){this.set(s,t);break}},integer:function(s,t){/^-?\d+$/.test(t)&&this.set(s,parseInt(t,10))},percent:function(s,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(s,t),!0)}};var ao=vi.createElement&&vi.createElement("textarea"),bp={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},cu={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},_p={v:"title",lang:"lang"},hu={rt:"ruby"};function pu(s,t){for(var i,a,o,l,h,T,B=s.document.createElement("div"),G=B,H=[];T=void 0,(T=t?(T=(T=t.match(/^([^<]*)(<[^>]*>?)?/))[1]||T[2],t=t.substr(T.length),T):null)!==null;)T[0]==="<"?T[1]==="/"?H.length&&H[H.length-1]===T.substr(2).replace(">","")&&(H.pop(),G=G.parentNode):(a=so(T.substr(1,T.length-2)))?(i=s.document.createProcessingInstruction("timestamp",a),G.appendChild(i)):(a=T.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/))&&(o=a[1],l=a[3],h=void 0,h=bp[o],i=h?(h=s.document.createElement(h),(o=_p[o])&&l&&(h[o]=l.trim()),h):null)&&(o=G,hu[(l=i).localName]&&hu[l.localName]!==o.localName||(a[2]&&((h=a[2].split(".")).forEach(function(ae){var pe=/^bg_/.test(ae),ae=pe?ae.slice(3):ae;cu.hasOwnProperty(ae)&&(ae=cu[ae],i.style[pe?"background-color":"color"]=ae)}),i.className=h.join(" ")),H.push(a[1]),G.appendChild(i),G=i)):G.appendChild(s.document.createTextNode((l=T,ao.innerHTML=l,l=ao.textContent,ao.textContent="",l)));return B}var fu=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function Tp(s){var t=[],i="";if(s&&s.childNodes){for(o(t,s);i=function l(h){var T,B,G;return h&&h.length?(B=(T=h.pop()).textContent||T.innerText)?(G=B.match(/^.*(\n|\r)/))?G[h.length=0]:B:T.tagName==="ruby"?l(h):T.childNodes?(o(h,T),l(h)):void 0:null}(t);)for(var a=0;a<i.length;a++)if(function(l){for(var h=0;h<fu.length;h++){var T=fu[h];if(l>=T[0]&&l<=T[1])return 1}}(i.charCodeAt(a)))return"rtl"}return"ltr";function o(l,h){for(var T=h.childNodes.length-1;0<=T;T--)l.push(h.childNodes[T])}}function Xs(){}function oo(s,t,i){Xs.call(this),this.cue=t,this.cueDiv=pu(s,t.text),this.applyStyles({color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:t.vertical===""?"horizontal-tb":t.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"},this.cueDiv),this.div=s.document.createElement("div"),s={direction:Tp(this.cueDiv),writingMode:t.vertical===""?"horizontal-tb":t.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:t.align==="middle"?"center":t.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(s),this.div.appendChild(this.cueDiv);var a=0;switch(t.positionAlign){case"start":case"line-left":a=t.position;break;case"center":a=t.position-t.size/2;break;case"end":case"line-right":a=t.position-t.size}t.vertical===""?this.applyStyles({left:this.formatStyle(a,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(a,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(o){this.applyStyles({top:this.formatStyle(o.top,"px"),bottom:this.formatStyle(o.bottom,"px"),left:this.formatStyle(o.left,"px"),right:this.formatStyle(o.right,"px"),height:this.formatStyle(o.height,"px"),width:this.formatStyle(o.width,"px")})}}function Wi(s){var t,i,a,o;s.div&&(t=s.div.offsetHeight,i=s.div.offsetWidth,a=s.div.offsetTop,o=(o=(o=s.div.childNodes)&&o[0])&&o.getClientRects&&o.getClientRects(),s=s.div.getBoundingClientRect(),o=o?Math.max(o[0]&&o[0].height||0,s.height/o.length):0),this.left=s.left,this.right=s.right,this.top=s.top||a,this.height=s.height||t,this.bottom=s.bottom||a+(s.height||t),this.width=s.width||i,this.lineHeight=o!==void 0?o:s.lineHeight}function Sp(s,t,i,a){var o,l=new Wi(t),h=t.cue,T=function(_e){if(typeof _e.line=="number"&&(_e.snapToLines||0<=_e.line&&_e.line<=100))return _e.line;if(!_e.track||!_e.track.textTrackList||!_e.track.textTrackList.mediaElement)return-1;for(var Ce=_e.track,Le=Ce.textTrackList,xe=0,Pe=0;Pe<Le.length&&Le[Pe]!==Ce;Pe++)Le[Pe].mode==="showing"&&xe++;return-1*++xe}(h),B=[];if(h.snapToLines){switch(h.vertical){case"":B=["+y","-y"],o="height";break;case"rl":B=["+x","-x"],o="width";break;case"lr":B=["-x","+x"],o="width"}var G=l.lineHeight,H=G*Math.round(T),se=i[o]+G,pe=B[0];Math.abs(H)>se&&(H=H<0?-1:1,H*=Math.ceil(se/G)*G),T<0&&(H+=h.vertical===""?i.height:i.width,B=B.reverse()),l.move(pe,H)}else{var ae=l.lineHeight/i.height*100;switch(h.lineAlign){case"center":T-=ae/2;break;case"end":T-=ae}switch(h.vertical){case"":t.applyStyles({top:t.formatStyle(T,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(T,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(T,"%")})}B=["+y","-x","+x","-y"],l=new Wi(t)}se=function(_e,Ce){for(var Le,xe=new Wi(_e),Pe=1,Ae=0;Ae<Ce.length;Ae++){for(;_e.overlapsOppositeAxis(i,Ce[Ae])||_e.within(i)&&_e.overlapsAny(a);)_e.move(Ce[Ae]);if(_e.within(i))return _e;var st=_e.intersectPercentage(i);st<Pe&&(Le=new Wi(_e),Pe=st),_e=new Wi(xe)}return Le||xe}(l,B),t.move(se.toCSSCompatValues(i))}function rs(){}Xs.prototype.applyStyles=function(s,t){for(var i in t=t||this.div,s)s.hasOwnProperty(i)&&(t.style[i]=s[i])},Xs.prototype.formatStyle=function(s,t){return s===0?0:s+t},(oo.prototype=ro(Xs.prototype)).constructor=oo,Wi.prototype.move=function(s,t){switch(t=t!==void 0?t:this.lineHeight,s){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},Wi.prototype.overlaps=function(s){return this.left<s.right&&this.right>s.left&&this.top<s.bottom&&this.bottom>s.top},Wi.prototype.overlapsAny=function(s){for(var t=0;t<s.length;t++)if(this.overlaps(s[t]))return!0;return!1},Wi.prototype.within=function(s){return this.top>=s.top&&this.bottom<=s.bottom&&this.left>=s.left&&this.right<=s.right},Wi.prototype.overlapsOppositeAxis=function(s,t){switch(t){case"+x":return this.left<s.left;case"-x":return this.right>s.right;case"+y":return this.top<s.top;case"-y":return this.bottom>s.bottom}},Wi.prototype.intersectPercentage=function(s){return Math.max(0,Math.min(this.right,s.right)-Math.max(this.left,s.left))*Math.max(0,Math.min(this.bottom,s.bottom)-Math.max(this.top,s.top))/(this.height*this.width)},Wi.prototype.toCSSCompatValues=function(s){return{top:this.top-s.top,bottom:s.bottom-this.bottom,left:this.left-s.left,right:s.right-this.right,height:this.height,width:this.width}},Wi.getSimpleBoxPosition=function(s){var t=s.div?s.div.offsetHeight:s.tagName?s.offsetHeight:0,i=s.div?s.div.offsetWidth:s.tagName?s.offsetWidth:0,a=s.div?s.div.offsetTop:s.tagName?s.offsetTop:0;return{left:(s=s.div?s.div.getBoundingClientRect():s.tagName?s.getBoundingClientRect():s).left,right:s.right,top:s.top||a,height:s.height||t,bottom:s.bottom||a+(s.height||t),width:s.width||i}},rs.StringDecoder=function(){return{decode:function(s){if(!s)return"";if(typeof s!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(s))}}},rs.convertCueToDOMTree=function(s,t){return s&&t?pu(s,t):null},rs.processCues=function(s,t,i){if(!s||!t||!i)return null;for(;i.firstChild;)i.removeChild(i.firstChild);var a=s.document.createElement("div");if(a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.top="0",a.style.bottom="0",a.style.margin="1.5%",i.appendChild(a),function(se){for(var pe=0;pe<se.length;pe++)if(se[pe].hasBeenReset||!se[pe].displayState)return 1}(t))for(var o,l,h=[],T=Wi.getSimpleBoxPosition(a),B={font:Math.round(.05*T.height*100)/100+"px sans-serif"},G=0;G<t.length;G++)o=new oo(s,l=t[G],B),a.appendChild(o.div),Sp(0,o,T,h),l.displayState=o.div,h.push(Wi.getSimpleBoxPosition(o));else for(var H=0;H<t.length;H++)a.appendChild(t[H].displayState)},(rs.Parser=function(s,t,i){i||(i=t,t={}),t=t||{},this.window=s,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=i||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(s){if(!(s instanceof pn))throw s;this.onparsingerror&&this.onparsingerror(s)},parse:function(s){var t=this;function i(){for(var B=t.buffer,G=0;G<B.length&&B[G]!=="\r"&&B[G]!==`
`;)++G;var H=B.substr(0,G);return B[G]==="\r"&&++G,B[G]===`
`&&++G,t.buffer=B.substr(G),H}function a(B){B.match(/X-TIMESTAMP-MAP/)?ns(B,function(G,H){var se;G==="X-TIMESTAMP-MAP"&&(G=H,se=new is,ns(G,function(pe,ae){switch(pe){case"MPEGT":se.integer(pe+"S",ae);break;case"LOCA":se.set(pe+"L",so(ae))}},/[^\d]:/,/,/),t.ontimestampmap)&&t.ontimestampmap({MPEGTS:se.get("MPEGTS"),LOCAL:se.get("LOCAL")})},/=/):ns(B,function(G,H){var se;G==="Region"&&(G=H,se=new is,ns(G,function(pe,ae){switch(pe){case"id":se.set(pe,ae);break;case"width":se.percent(pe,ae);break;case"lines":se.integer(pe,ae);break;case"regionanchor":case"viewportanchor":var _e,Ce=ae.split(",");Ce.length===2&&((_e=new is).percent("x",Ce[0]),_e.percent("y",Ce[1]),_e.has("x")&&_e.has("y"))&&(se.set(pe+"X",_e.get("x")),se.set(pe+"Y",_e.get("y")));break;case"scroll":se.alt(pe,ae,["up"])}},/=/,/\s/),se.has("id"))&&((G=new(t.vttjs.VTTRegion||t.window.VTTRegion)).width=se.get("width",100),G.lines=se.get("lines",3),G.regionAnchorX=se.get("regionanchorX",0),G.regionAnchorY=se.get("regionanchorY",100),G.viewportAnchorX=se.get("viewportanchorX",0),G.viewportAnchorY=se.get("viewportanchorY",100),G.scroll=se.get("scroll",""),t.onregion&&t.onregion(G),t.regionList.push({id:se.get("id"),region:G}))},/:/)}s&&(t.buffer+=t.decoder.decode(s,{stream:!0}));try{if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;var o,l=(o=i()).match(/^WEBVTT([ \t].*)?$/);if(!l||!l[0])throw new pn(pn.Errors.BadSignature);t.state="HEADER"}for(var h=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(h?h=!1:o=i(),t.state){case"HEADER":/:/.test(o)?a(o):o||(t.state="ID");continue;case"NOTE":o||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(o)){t.state="NOTE";break}if(!o)continue;t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,"");try{t.cue.align="center"}catch{t.cue.align="middle"}if(t.state="CUE",o.indexOf("-->")===-1){t.cue.id=o;continue}case"CUE":try{(function(B,G,H){var se=B;function pe(){var Le=so(B);if(Le===null)throw new pn(pn.Errors.BadTimeStamp,"Malformed timestamp: "+se);return B=B.replace(/^[^\sa-zA-Z-]+/,""),Le}function ae(){B=B.replace(/^\s+/,"")}if(ae(),G.startTime=pe(),ae(),B.substr(0,3)!=="-->")throw new pn(pn.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+se);B=B.substr(3),ae(),G.endTime=pe(),ae();var _e=B,Ce=new is;ns(_e,function(Le,xe){switch(Le){case"region":for(var Pe=H.length-1;0<=Pe;Pe--)if(H[Pe].id===xe){Ce.set(Le,H[Pe].region);break}break;case"vertical":Ce.alt(Le,xe,["rl","lr"]);break;case"line":var Ae=xe.split(","),st=Ae[0];Ce.integer(Le,st),Ce.percent(Le,st)&&Ce.set("snapToLines",!1),Ce.alt(Le,st,["auto"]),Ae.length===2&&Ce.alt("lineAlign",Ae[1],["start","center","end"]);break;case"position":Ae=xe.split(","),Ce.percent(Le,Ae[0]),Ae.length===2&&Ce.alt("positionAlign",Ae[1],["start","center","end"]);break;case"size":Ce.percent(Le,xe);break;case"align":Ce.alt(Le,xe,["start","center","end","left","right"])}},/:/,/\s/),G.region=Ce.get("region",null),G.vertical=Ce.get("vertical","");try{G.line=Ce.get("line","auto")}catch{}G.lineAlign=Ce.get("lineAlign","start"),G.snapToLines=Ce.get("snapToLines",!0),G.size=Ce.get("size",100);try{G.align=Ce.get("align","center")}catch{G.align=Ce.get("align","middle")}try{G.position=Ce.get("position","auto")}catch{G.position=Ce.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},G.align)}G.positionAlign=Ce.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},G.align)})(o,t.cue,t.regionList)}catch(B){t.reportOrThrowError(B),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var T=o.indexOf("-->")!==-1;if(!o||T&&(h=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+=`
`),t.cue.text+=o.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":o||(t.state="ID");continue}}}catch(B){t.reportOrThrowError(B),t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var s=this;try{if(s.buffer+=s.decoder.decode(),!s.cue&&s.state!=="HEADER"||(s.buffer+=`

`,s.parse()),s.state==="INITIAL")throw new pn(pn.Errors.BadSignature)}catch(t){s.reportOrThrowError(t)}return s.onflush&&s.onflush(),this}};var wp=rs,Ep={"":1,lr:1,rl:1},Cp={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function lo(s){return typeof s=="string"&&!!Cp[s.toLowerCase()]&&s.toLowerCase()}function mu(s,t,i){this.hasBeenReset=!1;var a="",o=!1,l=s,h=t,T=i,B=null,G="",H=!0,se="auto",pe="start",ae="auto",_e="auto",Ce=100,Le="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return a},set:function(xe){a=""+xe}},pauseOnExit:{enumerable:!0,get:function(){return o},set:function(xe){o=!!xe}},startTime:{enumerable:!0,get:function(){return l},set:function(xe){if(typeof xe!="number")throw new TypeError("Start time must be set to a number.");l=xe,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return h},set:function(xe){if(typeof xe!="number")throw new TypeError("End time must be set to a number.");h=xe,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return T},set:function(xe){T=""+xe,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return B},set:function(xe){B=xe,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return G},set:function(xe){if(xe=typeof(xe=xe)=="string"&&!!Ep[xe.toLowerCase()]&&xe.toLowerCase(),xe===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");G=xe,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return H},set:function(xe){H=!!xe,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return se},set:function(xe){if(typeof xe!="number"&&xe!=="auto")throw new SyntaxError("Line: an invalid number or illegal string was specified.");se=xe,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return pe},set:function(xe){xe=lo(xe),xe&&(pe=xe,this.hasBeenReset=!0)}},position:{enumerable:!0,get:function(){return ae},set:function(xe){if(xe<0||100<xe)throw new Error("Position must be between 0 and 100.");ae=xe,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return _e},set:function(xe){xe=lo(xe),xe&&(_e=xe,this.hasBeenReset=!0)}},size:{enumerable:!0,get:function(){return Ce},set:function(xe){if(xe<0||100<xe)throw new Error("Size must be between 0 and 100.");Ce=xe,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return Le},set:function(xe){if(xe=lo(xe),!xe)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");Le=xe,this.hasBeenReset=!0}}}),this.displayState=void 0}mu.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var xp=mu,kp={"":!0,up:!0};function ss(s){return typeof s=="number"&&0<=s&&s<=100}function Np(){var s=100,t=3,i=0,a=100,o=0,l=100,h="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return s},set:function(T){if(!ss(T))throw new Error("Width must be between 0 and 100.");s=T}},lines:{enumerable:!0,get:function(){return t},set:function(T){if(typeof T!="number")throw new TypeError("Lines must be set to a number.");t=T}},regionAnchorY:{enumerable:!0,get:function(){return a},set:function(T){if(!ss(T))throw new Error("RegionAnchorX must be between 0 and 100.");a=T}},regionAnchorX:{enumerable:!0,get:function(){return i},set:function(T){if(!ss(T))throw new Error("RegionAnchorY must be between 0 and 100.");i=T}},viewportAnchorY:{enumerable:!0,get:function(){return l},set:function(T){if(!ss(T))throw new Error("ViewportAnchorY must be between 0 and 100.");l=T}},viewportAnchorX:{enumerable:!0,get:function(){return o},set:function(T){if(!ss(T))throw new Error("ViewportAnchorX must be between 0 and 100.");o=T}},scroll:{enumerable:!0,get:function(){return h},set:function(T){T=typeof(T=T)=="string"&&!!kp[T.toLowerCase()]&&T.toLowerCase(),T!==!1&&(h=T)}}})}var uo=Vs(function(t){var t=t.exports={WebVTT:wp,VTTCue:xp,VTTRegion:Np},i=(on.vttjs=t,on.WebVTT=t.WebVTT,t.VTTCue),a=t.VTTRegion,o=on.VTTCue,l=on.VTTRegion;t.shim=function(){on.VTTCue=i,on.VTTRegion=a},t.restore=function(){on.VTTCue=o,on.VTTRegion=l},on.VTTCue||t.shim()});uo.WebVTT;class Ut extends Ze{constructor(t={},i=function(){}){t.reportTouchActivity=!1,super(null,t,i),this.onDurationChange_=a=>this.onDurationChange(a),this.trackProgress_=a=>this.trackProgress(a),this.trackCurrentTime_=a=>this.trackCurrentTime(a),this.stopTrackingCurrentTime_=a=>this.stopTrackingCurrentTime(a),this.disposeSourceHandler_=a=>this.disposeSourceHandler(a),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),Vi.names.forEach(a=>{a=Vi[a],t&&t[a.getterName]&&(this[a.privateName]=t[a.getterName])}),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(a=>{t[`native${a}Tracks`]===!1&&(this[`featuresNative${a}Tracks`]=!1)}),t.nativeCaptions===!1||t.nativeTextTracks===!1?this.featuresNativeTextTracks=!1:t.nativeCaptions!==!0&&t.nativeTextTracks!==!0||(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=t.preloadTextTracks!==!1,this.autoRemoteTextTracks_=new Vi.text.ListClass,this.initTrackListeners(),t.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(t){this.isReady_||this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(t),1)),this.trigger({src:t,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(t){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Kt(this,function(){var i=this.bufferedPercent();this.bufferedPercent_!==i&&this.trigger("progress"),(this.bufferedPercent_=i)===1&&this.stopTrackingProgress()}),500)}onDurationChange(t){this.duration_=this.duration()}buffered(){return hn(0,0)}bufferedPercent(){return Zl(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(ln.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(t){(t=[].concat(t)).forEach(i=>{var a=this[i+"Tracks"]()||[];let o=a.length;for(;o--;){var l=a[o];i==="text"&&this.removeRemoteTextTrack(l),a.removeTrack(l)}})}cleanupAutoTextTracks(){var t=this.autoRemoteTextTracks_||[];let i=t.length;for(;i--;){var a=t[i];this.removeRemoteTextTrack(a)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(t){return t!==void 0&&(this.error_=new yi(t),this.trigger("error")),this.error_}played(){return this.hasStarted_?hn(0,0):hn()}play(){}setScrubbing(t){}scrubbing(){}setCurrentTime(t){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){ln.names.forEach(t=>{var i=ln[t];let a=()=>{this.trigger(t+"trackchange")},o=this[i.getterName]();o.addEventListener("removetrack",a),o.addEventListener("addtrack",a),this.on("dispose",()=>{o.removeEventListener("removetrack",a),o.removeEventListener("addtrack",a)})})}addWebVttScript_(){if(!window.WebVTT)if(document.body.contains(this.el()))if(!this.options_["vtt.js"]&&V(uo)&&0<Object.keys(uo).length)this.trigger("vttjsloaded");else{let t=document.createElement("script");t.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",t.onload=()=>{this.trigger("vttjsloaded")},t.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",()=>{t.onload=null,t.onerror=null}),window.WebVTT=!0,this.el().parentNode.appendChild(t)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){let t=this.textTracks(),i=this.remoteTextTracks(),a=T=>t.addTrack(T.track),o=T=>t.removeTrack(T.track),l=(i.on("addtrack",a),i.on("removetrack",o),this.addWebVttScript_(),()=>this.trigger("texttrackchange")),h=()=>{l();for(let B=0;B<t.length;B++){var T=t[B];T.removeEventListener("cuechange",l),T.mode==="showing"&&T.addEventListener("cuechange",l)}};h(),t.addEventListener("change",h),t.addEventListener("addtrack",h),t.addEventListener("removetrack",h),this.on("dispose",function(){i.off("addtrack",a),i.off("removetrack",o),t.removeEventListener("change",h),t.removeEventListener("addtrack",h),t.removeEventListener("removetrack",h);for(let T=0;T<t.length;T++)t[T].removeEventListener("cuechange",l)})}addTextTrack(t,i,a){if(t)return t=t,i=i,a=a,l={},h=(o=this).textTracks(),l.kind=t,i&&(l.label=i),a&&(l.language=a),l.tech=o,t=new Vi.text.TrackClass(l),h.addTrack(t),t;throw new Error("TextTrack kind is required but was not provided");var o,l,h}createRemoteTextTrack(t){return t=Z(t,{tech:this}),new fr.remoteTextEl.TrackClass(t)}addRemoteTextTrack(t={},i){let a=this.createRemoteTextTrack(t);return typeof i!="boolean"&&(i=!1),this.remoteTextTrackEls().addTrackElement_(a),this.remoteTextTracks().addTrack(a.track),i===!1&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(a.track)),a}removeRemoteTextTrack(t){var i=this.remoteTextTrackEls().getTrackElementByTrack_(t);this.remoteTextTrackEls().removeTrackElement_(i),this.remoteTextTracks().removeTrack(t),this.autoRemoteTextTracks_.removeTrack(t)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(t){let i=Be++;return!this.isReady_||this.paused()?(this.queuedHanders_.add(i),this.one("playing",()=>{this.queuedHanders_.has(i)&&(this.queuedHanders_.delete(i),t())})):this.requestNamedAnimationFrame(i,t),i}cancelVideoFrameCallback(t){this.queuedHanders_.has(t)?this.queuedHanders_.delete(t):this.cancelNamedAnimationFrame(t)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(t){}overrideNativeVideoTracks(t){}canPlayType(t){return""}static canPlayType(t){return""}static canPlaySource(t,i){return Ut.canPlayType(t.type)}static isTech(t){return t.prototype instanceof Ut||t instanceof Ut||t===Ut}static registerTech(t,i){if(Ut.techs_||(Ut.techs_={}),!Ut.isTech(i))throw new Error(`Tech ${t} must be a Tech`);if(!Ut.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(Ut.canPlaySource)return t=_i(t),Ut.techs_[t]=i,Ut.techs_[Qr(t)]=i,t!=="Tech"&&Ut.defaultTechOrder_.push(t),i;throw new Error("Techs must have a static canPlaySource method on them")}static getTech(t){if(t)return Ut.techs_&&Ut.techs_[t]?Ut.techs_[t]:(t=_i(t),window&&window.videojs&&window.videojs[t]?(S.warn(`The ${t} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),window.videojs[t]):void 0)}}Vi.names.forEach(function(s){let t=Vi[s];Ut.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}}),Ut.prototype.featuresVolumeControl=!0,Ut.prototype.featuresMuteControl=!0,Ut.prototype.featuresFullscreenResize=!1,Ut.prototype.featuresPlaybackRate=!1,Ut.prototype.featuresProgressEvents=!1,Ut.prototype.featuresSourceset=!1,Ut.prototype.featuresTimeupdateEvents=!1,Ut.prototype.featuresNativeTextTracks=!1,Ut.prototype.featuresVideoFrameCallback=!1,Ut.withSourceHandlers=function(s){s.registerSourceHandler=function(t,i){let a=s.sourceHandlers;a=a||(s.sourceHandlers=[]),i===void 0&&(i=a.length),a.splice(i,0,t)},s.canPlayType=function(t){var i,a=s.sourceHandlers||[];for(let o=0;o<a.length;o++)if(i=a[o].canPlayType(t))return i;return""},s.selectSourceHandler=function(t,i){var a=s.sourceHandlers||[];for(let o=0;o<a.length;o++)if(a[o].canHandleSource(t,i))return a[o];return null},s.canPlaySource=function(t,i){var a=s.selectSourceHandler(t,i);return a?a.canHandleSource(t,i):""},["seekable","seeking","duration"].forEach(function(t){let i=this[t];typeof i=="function"&&(this[t]=function(){return this.sourceHandler_&&this.sourceHandler_[t]?this.sourceHandler_[t].apply(this.sourceHandler_,arguments):i.apply(this,arguments)})},s.prototype),s.prototype.setSource=function(t){let i=s.selectSourceHandler(t,this.options_);i||(s.nativeSourceHandler?i=s.nativeSourceHandler:S.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),i!==s.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=i.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},s.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},Ze.registerComponent("Tech",Ut),Ut.registerTech("Tech",Ut),Ut.defaultTechOrder_=[];let tr={},Gs={},$s={};function Ap(s,t,i){s.setTimeout(()=>function a(o={},l=[],h,T,B=[],G=!1){let[H,...se]=l;if(typeof H=="string")a(o,tr[H],h,T,B,G);else if(H){let pe=Dp(T,H);if(!pe.setSource)return B.push(pe),a(o,se,h,T,B,G);pe.setSource(Object.assign({},o),function(ae,_e){if(ae)return a(o,se,h,T,B,G);B.push(pe),a(_e,o.type===_e.type?se:tr[_e.type],h,T,B,G)})}else se.length?a(o,se,h,T,B,G):G?h(o,B):a(o,tr["*"],h,T,B,!0)}(t,tr[t.type],i,s),1)}function gu(s,h,i,l=null){var o="call"+_i(i),o=s.reduce(co(o),l),l=o===$s,h=l?null:h[i](o),T=s,B=i,G=h,H=l;for(let pe=T.length-1;0<=pe;pe--){var se=T[pe];se[B]&&se[B](H,G)}return h}let Ip={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},Op={setCurrentTime:1,setMuted:1,setVolume:1},yu={play:1,pause:1};function co(s){return(t,i)=>t===$s?$s:i[s]?i[s](t):t}function Dp(s,t){var i=Gs[s.id()];let a=null;if(i==null)a=t(s),Gs[s.id()]=[[t,a]];else{for(let h=0;h<i.length;h++){var[o,l]=i[h];o===t&&(a=l)}a===null&&(a=t(s),i.push([t,a]))}return a}function vu(s){if(Array.isArray(s)){let t=[];s.forEach(function(i){i=vu(i),Array.isArray(i)?t=t.concat(i):R(i)&&t.push(i)}),s=t}else s=typeof s=="string"&&s.trim()?[bu({src:s})]:R(s)&&typeof s.src=="string"&&s.src&&s.src.trim()?[bu(s)]:[];return s}let Pp={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},Ks=function(s=""){return s=eo(s),Pp[s.toLowerCase()]||""};function bu(s){var t;return s.type||(t=Ks(s.src))&&(s.type=t),s}Xi=ze?10009:rt?461:8;let mr={codes:{play:415,pause:19,ff:417,rw:412,back:Xi},names:{415:"play",19:"pause",417:"ff",412:"rw",[Xi]:"back"},isEventKey(s,t){return t=t.toLowerCase(),!(!this.names[s.keyCode]||this.names[s.keyCode]!==t)},getEventName(s){return this.names[s.keyCode]||(this.codes[s.code]?(s=this.codes[s.code],this.names[s]):null)}};class Rp extends ci{constructor(t){super(),this.player_=t,this.focusableComponents=[],this.isListening_=!1,this.isPaused_=!1,this.onKeyDown_=this.onKeyDown_.bind(this),this.lastFocusedComponent_=null}start(){this.isListening_||(this.player_.on("keydown",this.onKeyDown_),this.player_.on("modalKeydown",this.onKeyDown_),this.player_.on("loadedmetadata",()=>{this.focus(this.updateFocusableComponents()[0])}),this.player_.on("modalclose",()=>{this.refocusComponent()}),this.player_.on("focusin",this.handlePlayerFocus_.bind(this)),this.player_.on("focusout",this.handlePlayerBlur_.bind(this)),this.isListening_=!0,this.player_.errorDisplay&&this.player_.errorDisplay.on("aftermodalfill",()=>{this.updateFocusableComponents(),this.focusableComponents.length&&(1<this.focusableComponents.length?this.focusableComponents[1]:this.focusableComponents[0]).focus()}))}stop(){this.player_.off("keydown",this.onKeyDown_),this.isListening_=!1}onKeyDown_(t){var i,a=t.originalEvent||t;["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(a.key)?this.isPaused_||(a.preventDefault(),i=a.key.substring(5).toLowerCase(),this.move(i)):mr.isEventKey(a,"play")||mr.isEventKey(a,"pause")||mr.isEventKey(a,"ff")||mr.isEventKey(a,"rw")?(a.preventDefault(),i=mr.getEventName(a),this.performMediaAction_(i)):mr.isEventKey(a,"Back")&&t.target&&typeof t.target.closeable=="function"&&t.target.closeable()&&(a.preventDefault(),t.target.close())}performMediaAction_(t){if(this.player_)switch(t){case"play":this.player_.paused()&&this.player_.play();break;case"pause":this.player_.paused()||this.player_.pause();break;case"ff":this.userSeek_(this.player_.currentTime()+5);break;case"rw":this.userSeek_(this.player_.currentTime()-5)}}userSeek_(t){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(t)}pause(){this.isPaused_=!0}resume(){this.isPaused_=!1}handlePlayerBlur_(t){var i=t.relatedTarget;let a=null;var o=this.getCurrentComponent(t.target);i&&(a=!!i.closest(".video-js"),i.classList.contains("vjs-text-track-settings"))&&!this.isPaused_&&this.searchForTrackSelect_(),(t.currentTarget.contains(t.relatedTarget)||a)&&i||(o&&o.name()==="CloseButton"?this.refocusComponent():(this.pause(),o&&o.el()&&(this.lastFocusedComponent_=o)))}handlePlayerFocus_(){this.getCurrentComponent()&&this.getCurrentComponent().getIsFocusable()&&this.resume()}updateFocusableComponents(){var t=this.player_;let i=[];function a(o){for(var l of o)l.hasOwnProperty("el_")&&l.getIsFocusable()&&l.getIsAvailableToBeFocused(l.el())&&i.push(l),l.hasOwnProperty("children_")&&0<l.children_.length&&a(l.children_)}return t.children_.forEach(o=>{if(o.hasOwnProperty("el_")){if(o.getIsFocusable&&o.getIsAvailableToBeFocused&&o.getIsFocusable()&&o.getIsAvailableToBeFocused(o.el()))return void i.push(o);o.hasOwnProperty("children_")&&0<o.children_.length?a(o.children_):o.hasOwnProperty("items")&&0<o.items.length?a(o.items):this.findSuitableDOMChild(o)&&i.push(o)}o.name_==="ErrorDisplay"&&o.opened_&&(o=o.el_.querySelector(".vjs-errors-ok-button-container"))&&o.querySelectorAll("button").forEach((l,h)=>{i.push({name:()=>"ModalButton"+(h+1),el:()=>l,getPositions:()=>{var T=l.getBoundingClientRect();return{boundingClientRect:{x:T.x,y:T.y,width:T.width,height:T.height,top:T.top,right:T.right,bottom:T.bottom,left:T.left},center:{x:T.left+T.width/2,y:T.top+T.height/2,width:0,height:0,top:T.top+T.height/2,right:T.left+T.width/2,bottom:T.top+T.height/2,left:T.left+T.width/2}}},getIsAvailableToBeFocused:()=>!0,getIsFocusable:T=>!0,focus:()=>l.focus()})})}),this.focusableComponents=i,this.focusableComponents}findSuitableDOMChild(t){return t.el()?function i(a){if(t.getIsFocusable(a)&&t.getIsAvailableToBeFocused(a))return a;for(let l=0;l<a.children.length;l++){var o=i(a.children[l]);if(o)return o}return null}(t.el()):null}getCurrentComponent(t){this.updateFocusableComponents();var i=t||document.activeElement;if(this.focusableComponents.length){for(var a of this.focusableComponents)if(a.el()===i)return a}}add(t){var i=[...this.focusableComponents];t.hasOwnProperty("el_")&&t.getIsFocusable()&&t.getIsAvailableToBeFocused(t.el())&&i.push(t),this.focusableComponents=i,this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents})}remove(t){for(let i=0;i<this.focusableComponents.length;i++)if(this.focusableComponents[i].name()===t.name())return this.focusableComponents.splice(i,1),void this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents})}clear(){0<this.focusableComponents.length&&(this.focusableComponents=[],this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents}))}move(t){let i=this.getCurrentComponent();if(i){let o=i.getPositions();var a=this.focusableComponents.filter(l=>l!==i&&this.isInDirection_(o.boundingClientRect,l.getPositions().boundingClientRect,t)),a=this.findBestCandidate_(o.center,a,t);a?this.focus(a):this.trigger({type:"endOfFocusableComponents",direction:t,focusedComponent:i})}}findBestCandidate_(t,i,a){let o=1/0,l=null;for(var h of i){var T=h.getPositions().center,T=this.calculateDistance_(t,T,a);T<o&&(o=T,l=h)}return l}isInDirection_(t,i,a){switch(a){case"right":return i.left>=t.right;case"left":return i.right<=t.left;case"down":return i.top>=t.bottom;case"up":return i.bottom<=t.top;default:return!1}}refocusComponent(){if(this.lastFocusedComponent_){this.player_.userActive()||this.player_.userActive(!0),this.updateFocusableComponents();for(let t=0;t<this.focusableComponents.length;t++)if(this.focusableComponents[t].name()===this.lastFocusedComponent_.name())return void this.focus(this.focusableComponents[t])}else this.focus(this.updateFocusableComponents()[0])}focus(t){typeof t=="object"&&(t.getIsAvailableToBeFocused(t.el())?t.focus():this.findSuitableDOMChild(t)&&this.findSuitableDOMChild(t).focus())}calculateDistance_(t,i,a){var o=Math.abs(t.x-i.x),l=Math.abs(t.y-i.y);let h;switch(a){case"right":case"left":h=o+100*l;break;case"up":h=2*l+.5*o;break;case"down":h=5*l+o;break;default:h=o+l}return h}searchForTrackSelect_(){var t;for(t of this.updateFocusableComponents())if(t.constructor.name==="TextTrackSelect"){this.focus(t);break}}}class Lp extends Ze{constructor(t,i,a){if(super(t,Z({createEl:!1},i),a),i.playerOptions.sources&&i.playerOptions.sources.length!==0)t.src(i.playerOptions.sources);else for(let l=0,h=i.playerOptions.techOrder;l<h.length;l++){var o=_i(h[l]);let T=Ut.getTech(o);if((T=o?T:Ze.getComponent(o))&&T.isSupported()){t.loadTech_(o);break}}}}Ze.registerComponent("MediaLoader",Lp);class Ys extends Ze{constructor(t,i){super(t,i),this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=a=>this.handleMouseOver(a),this.handleMouseOut_=a=>this.handleMouseOut(a),this.handleClick_=a=>this.handleClick(a),this.handleKeyDown_=a=>this.handleKeyDown(a),this.emitTapEvents(),this.enable()}createEl(t="div",i={},a={}){return i=Object.assign({className:this.buildCSSClass(),tabIndex:0},i),t==="button"&&S.error(`Creating a ClickableComponent with an HTML element of ${t} is not supported; use a Button instead.`),a=Object.assign({role:"button"},a),this.tabIndex_=i.tabIndex,t=be(t,i,a),this.player_.options_.experimentalSvgIcons||t.appendChild(be("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(t),t}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(t){return this.controlTextEl_=be("span",{className:"vjs-control-text"},{"aria-live":"polite"}),t&&t.appendChild(this.controlTextEl_),this.controlText(this.controlText_,t),this.controlTextEl_}controlText(t,i=this.el()){if(t===void 0)return this.controlText_||"Need Text";var a=this.localize(t);this.controlText_=t,Fe(this.controlTextEl_,a),this.nonIconControl||this.player_.options_.noUITitleAttributes||i.setAttribute("title",a)}buildCSSClass(){return"vjs-control vjs-button "+super.buildCSSClass()}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_<"u"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_<"u"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(t){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(t){t.key===" "||t.key==="Enter"?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):super.handleKeyDown(t)}}Ze.registerComponent("ClickableComponent",Ys);class ho extends Ys{constructor(t,i){super(t,i),this.update(),this.update_=a=>this.update(a),t.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return be("div",{className:"vjs-poster"})}crossOrigin(t){if(typeof t>"u")return this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;t!==null&&t!=="anonymous"&&t!=="use-credentials"?this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${t}"`):this.$("img")&&(this.$("img").crossOrigin=t)}update(t){var i=this.player().poster();this.setSrc(i),i?this.show():this.hide()}setSrc(t){t?(this.$("img")||this.el_.appendChild(be("picture",{className:"vjs-poster",tabIndex:-1},{},be("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=t):this.el_.textContent=""}handleClick(t){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?vn(this.player_.play()):this.player_.pause())}}ho.prototype.crossorigin=ho.prototype.crossOrigin,Ze.registerComponent("PosterImage",ho);let Mp={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function po(s,t){let i;if(s.length===4)i=s[1]+s[1]+s[2]+s[2]+s[3]+s[3];else{if(s.length!==7)throw new Error("Invalid color code provided, "+s+"; must be formatted as e.g. #f0e or #f604e2.");i=s.slice(1)}return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+t+")"}function bn(s,t,i){try{s.style[t]=i}catch{}}function _u(s){return s?s+"px":""}class Up extends Ze{constructor(t,i,a){super(t,i,a);let o=l=>{this.updateDisplayOverlay(),this.updateDisplay(l)};t.on("loadstart",l=>this.toggleDisplay(l)),t.on("texttrackchange",l=>this.updateDisplay(l)),t.on("loadedmetadata",l=>{this.updateDisplayOverlay(),this.preselectTrack(l)}),t.ready(Kt(this,function(){if(t.tech_&&t.tech_.featuresNativeTextTracks)this.hide();else{t.on("fullscreenchange",o),t.on("playerresize",o);let h=window.screen.orientation||window,T=window.screen.orientation?"change":"orientationchange";h.addEventListener(T,o),t.on("dispose",()=>h.removeEventListener(T,o));var l=this.options_.playerOptions.tracks||[];for(let B=0;B<l.length;B++)this.player_.addRemoteTextTrack(l[B],!0);this.preselectTrack()}}))}preselectTrack(){var t={captions:1,subtitles:1},i=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage;let o,l,h;for(let B=0;B<i.length;B++){var T=i[B];a&&a.enabled&&a.language&&a.language===T.language&&T.kind in t?h=T.kind!==a.kind&&h||T:a&&!a.enabled?(h=null,o=null,l=null):T.default&&(T.kind!=="descriptions"||o?T.kind in t&&!l&&(l=T):o=T)}h?h.mode="showing":l?l.mode="showing":o&&(o.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){typeof window.WebVTT=="function"&&window.WebVTT.processCues(window,[],this.el_)}updateDisplay(){var t,i,a,o=this.player_.textTracks(),l=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),l){var h=[];for(let G=0;G<o.length;++G){var T=o[G];T.mode==="showing"&&h.push(T)}this.updateForTrack(h)}else{let G=null,H=null,se=o.length;for(;se--;){var B=o[se];B.mode==="showing"&&(B.kind==="descriptions"?G=B:H=B)}H?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(H)):G&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(G)),window.CSS.supports("inset","10px")||(t=(l=this.el_).querySelectorAll(".vjs-text-track-cue"),i=this.player_.controlBar.el_.getBoundingClientRect().height,a=this.player_.el_.getBoundingClientRect().height,l.style="",bn(l,"position","relative"),bn(l,"height",a-i+"px"),bn(l,"top","unset"),le?bn(l,"bottom",a+"px"):bn(l,"bottom","0px"),0<t.length&&t.forEach(pe=>{var ae;pe.style.inset&&(ae=pe.style.inset.split(" ")).length===3&&Object.assign(pe.style,{top:ae[0],right:ae[1],bottom:ae[2],left:"unset"})}))}}updateDisplayOverlay(){if(this.player_.videoHeight()&&window.CSS.supports("inset-inline: 10px")){var t=this.player_.currentWidth(),i=this.player_.currentHeight(),a=t/i,o=this.player_.videoWidth()/this.player_.videoHeight();let l=0,h=0;.1<Math.abs(a-o)&&(o<a?l=Math.round((t-i*o)/2):h=Math.round((i-t/o)/2)),bn(this.el_,"insetInline",_u(l)),bn(this.el_,"insetBlock",_u(h))}}updateDisplayState(t){var i=this.player_.textTrackSettings.getValues(),a=t.activeCues;let o=a.length;for(;o--;){var l,h=a[o];h&&(h=h.displayState,i.color&&(h.firstChild.style.color=i.color),i.textOpacity&&bn(h.firstChild,"color",po(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(h.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&bn(h.firstChild,"backgroundColor",po(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?bn(h,"backgroundColor",po(i.windowColor,i.windowOpacity)):h.style.backgroundColor=i.windowColor),i.edgeStyle&&(i.edgeStyle==="dropshadow"?h.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":i.edgeStyle==="raised"?h.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":i.edgeStyle==="depressed"?h.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":i.edgeStyle==="uniform"&&(h.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),i.fontPercent&&i.fontPercent!==1&&(l=window.parseFloat(h.style.fontSize),h.style.fontSize=l*i.fontPercent+"px",h.style.height="auto",h.style.top="auto"),i.fontFamily)&&i.fontFamily!=="default"&&(i.fontFamily==="small-caps"?h.firstChild.style.fontVariant="small-caps":h.firstChild.style.fontFamily=Mp[i.fontFamily])}}updateForTrack(t){if(Array.isArray(t)||(t=[t]),typeof window.WebVTT=="function"&&!t.every(h=>!h.activeCues)){var i=[];for(let h=0;h<t.length;++h){var a=t[h];for(let T=0;T<a.activeCues.length;++T)i.push(a.activeCues[T])}window.WebVTT.processCues(window,i,this.el_);for(let h=0;h<t.length;++h){var o=t[h];for(let T=0;T<o.activeCues.length;++T){var l=o.activeCues[T].displayState;yt(l,"vjs-text-track-cue","vjs-text-track-cue-"+(o.language||h)),o.language&&et(l,"lang",o.language)}this.player_.textTrackSettings&&this.updateDisplayState(o)}}}}Ze.registerComponent("TextTrackDisplay",Up);class Fp extends Ze{createEl(){var t=this.player_.isAudio(),t=this.localize(t?"Audio Player":"Video Player"),t=be("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[t])}),i=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return i.appendChild(t),i}handleLanguagechange(){this.$(".vjs-control-text").textContent=this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}}Ze.registerComponent("LoadingSpinner",Fp);class Bi extends Ys{createEl(t,i={},a={}){return i=be("button",i=Object.assign({className:this.buildCSSClass()},i),a=Object.assign({type:"button"},a)),this.player_.options_.experimentalSvgIcons||i.appendChild(be("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(i),i}addChild(t,i={}){var a=this.constructor.name;return S.warn(`Adding an actionable (user controllable) child to a Button (${a}) is not supported; use a ClickableComponent instead.`),Ze.prototype.addChild.call(this,t,i)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(t){t.key===" "||t.key==="Enter"?t.stopPropagation():super.handleKeyDown(t)}}Ze.registerComponent("Button",Bi);class Tu extends Bi{constructor(t,i){super(t,i),this.mouseused_=!1,this.setIcon("play"),this.on("mousedown",a=>this.handleMouseDown(a))}buildCSSClass(){return"vjs-big-play-button"}handleClick(t){var i=this.player_.play();if(this.mouseused_&&"clientX"in t&&"clientY"in t)vn(i),this.player_.tech(!0)&&this.player_.tech(!0).focus();else{var t=this.player_.getChild("controlBar");let o=t&&t.getChild("playToggle");o?(t=()=>o.focus(),Jr(i)?i.then(t,()=>{}):this.setTimeout(t,1)):this.player_.tech(!0).focus()}}handleKeyDown(t){this.mouseused_=!1,super.handleKeyDown(t)}handleMouseDown(t){this.mouseused_=!0}}Tu.prototype.controlText_="Play Video",Ze.registerComponent("BigPlayButton",Tu);class Bp extends Bi{constructor(t,i){super(t,i),this.setIcon("cancel"),this.controlText(i&&i.controlText||this.localize("Close"))}buildCSSClass(){return"vjs-close-button "+super.buildCSSClass()}handleClick(t){this.trigger({type:"close",bubbles:!1})}handleKeyDown(t){t.key==="Escape"?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):super.handleKeyDown(t)}}Ze.registerComponent("CloseButton",Bp);class Su extends Bi{constructor(t,i={}){super(t,i),i.replay=i.replay===void 0||i.replay,this.setIcon("play"),this.on(t,"play",a=>this.handlePlay(a)),this.on(t,"pause",a=>this.handlePause(a)),i.replay&&this.on(t,"ended",a=>this.handleEnded(a))}buildCSSClass(){return"vjs-play-control "+super.buildCSSClass()}handleClick(t){this.player_.paused()?vn(this.player_.play()):this.player_.pause()}handleSeeked(t){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(t):this.handlePlay(t)}handlePlay(t){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.setIcon("pause"),this.controlText("Pause")}handlePause(t){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.setIcon("play"),this.controlText("Play")}handleEnded(t){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.setIcon("replay"),this.controlText("Replay"),this.one(this.player_,"seeked",i=>this.handleSeeked(i))}}Su.prototype.controlText_="Play",Ze.registerComponent("PlayToggle",Su);class gr extends Ze{constructor(t,i){super(t,i),this.on(t,["timeupdate","ended","seeking"],a=>this.update(a)),this.updateTextNode_()}createEl(){var t=this.buildCSSClass(),i=super.createEl("div",{className:t+" vjs-time-control vjs-control"}),a=be("span",{className:"vjs-control-text",textContent:this.localize(this.labelText_)+"\xA0"},{role:"presentation"});return i.appendChild(a),this.contentEl_=be("span",{className:t+"-display"},{role:"presentation"}),i.appendChild(this.contentEl_),i}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}update(t){!this.player_.options_.enableSmoothSeeking&&t.type==="seeking"||this.updateContent(t)}updateTextNode_(t=0){t=Jn(t),this.formattedTime_!==t&&(this.formattedTime_=t,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(this.contentEl_){let i=this.textNode_;i&&this.contentEl_.firstChild!==i&&(i=null,S.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=document.createTextNode(this.formattedTime_),this.textNode_&&(i?this.contentEl_.replaceChild(this.textNode_,i):this.contentEl_.appendChild(this.textNode_))}}))}updateContent(t){}}gr.prototype.labelText_="Time",gr.prototype.controlText_="Time",Ze.registerComponent("TimeDisplay",gr);class fo extends gr{buildCSSClass(){return"vjs-current-time"}updateContent(t){let i;i=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(i)}}fo.prototype.labelText_="Current Time",fo.prototype.controlText_="Current Time",Ze.registerComponent("CurrentTimeDisplay",fo);class mo extends gr{constructor(t,i){super(t,i),i=a=>this.updateContent(a),this.on(t,"durationchange",i),this.on(t,"loadstart",i),this.on(t,"loadedmetadata",i)}buildCSSClass(){return"vjs-duration"}updateContent(t){var i=this.player_.duration();this.updateTextNode_(i)}}mo.prototype.labelText_="Duration",mo.prototype.controlText_="Duration",Ze.registerComponent("DurationDisplay",mo);class zp extends Ze{createEl(){var t=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),i=super.createEl("div"),a=super.createEl("span",{textContent:"/"});return i.appendChild(a),t.appendChild(i),t}}Ze.registerComponent("TimeDivider",zp);class go extends gr{constructor(t,i){super(t,i),this.on(t,"durationchange",a=>this.updateContent(a))}buildCSSClass(){return"vjs-remaining-time"}createEl(){var t=super.createEl();return this.options_.displayNegative!==!1&&t.insertBefore(be("span",{},{"aria-hidden":!0},"-"),this.contentEl_),t}updateContent(t){if(typeof this.player_.duration()=="number"){let i;i=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(i)}}}go.prototype.labelText_="Remaining Time",go.prototype.controlText_="Remaining Time",Ze.registerComponent("RemainingTimeDisplay",go);class jp extends Ze{constructor(t,i){super(t,i),this.updateShowing(),this.on(this.player(),"durationchange",a=>this.updateShowing(a))}createEl(){var t=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=be("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(be("span",{className:"vjs-control-text",textContent:this.localize("Stream Type")+"\xA0"})),this.contentEl_.appendChild(document.createTextNode(this.localize("LIVE"))),t.appendChild(this.contentEl_),t}dispose(){this.contentEl_=null,super.dispose()}updateShowing(t){this.player().duration()===1/0?this.show():this.hide()}}Ze.registerComponent("LiveDisplay",jp);class wu extends Bi{constructor(t,i){super(t,i),this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=a=>this.updateLiveEdgeStatus(a),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){var t=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.setIcon("circle",t),this.textEl_=be("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),t.appendChild(this.textEl_),t}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}function as(s,t,i){return s=Number(s),Math.min(i,Math.max(t,isNaN(s)?t:s))}wu.prototype.controlText_="Seek to live, currently playing live",Ze.registerComponent("SeekToLive",wu),Ws=Object.freeze({__proto__:null,clamp:as});class yo extends Ze{constructor(t,i){super(t,i),this.handleMouseDown_=a=>this.handleMouseDown(a),this.handleMouseUp_=a=>this.handleMouseUp(a),this.handleKeyDown_=a=>this.handleKeyDown(a),this.handleClick_=a=>this.handleClick(a),this.handleMouseMove_=a=>this.handleMouseMove(a),this.update_=a=>this.update(a),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){var t;this.enabled()&&(t=this.bar.el_.ownerDocument,this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(t,"mousemove",this.handleMouseMove_),this.off(t,"mouseup",this.handleMouseUp_),this.off(t,"touchmove",this.handleMouseMove_),this.off(t,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1)}createEl(t,i={},a={}){return i.className=i.className+" vjs-slider",i=Object.assign({tabIndex:0},i),a=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},a),super.createEl(t,i,a)}handleMouseDown(t){var i=this.bar.el_.ownerDocument;t.type==="mousedown"&&t.preventDefault(),t.type!=="touchstart"||U||t.preventDefault(),It(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(i,"mousemove",this.handleMouseMove_),this.on(i,"mouseup",this.handleMouseUp_),this.on(i,"touchmove",this.handleMouseMove_),this.on(i,"touchend",this.handleMouseUp_),this.handleMouseMove(t,!0)}handleMouseMove(t){}handleMouseUp(t){var i=this.bar.el_.ownerDocument;at(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(i,"mousemove",this.handleMouseMove_),this.off(i,"mouseup",this.handleMouseUp_),this.off(i,"touchmove",this.handleMouseMove_),this.off(i,"touchend",this.handleMouseUp_),this.update()}update(){if(this.el_&&this.bar){let t=this.getProgress();return t!==this.progress_&&(this.progress_=t,this.requestNamedAnimationFrame("Slider#update",()=>{var i=this.vertical()?"height":"width";this.bar.el().style[i]=(100*t).toFixed(2)+"%"})),t}}getProgress(){return Number(as(this.getPercent(),0,1).toFixed(4))}calculateDistance(t){return t=Je(this.el_,t),this.vertical()?t.y:t.x}handleKeyDown(t){var a=this.options_.playerOptions.spatialNavigation,i=a&&a.enabled,a=a&&a.horizontalSeek;i?a&&t.key==="ArrowLeft"||!a&&t.key==="ArrowDown"?(t.preventDefault(),t.stopPropagation(),this.stepBack()):a&&t.key==="ArrowRight"||!a&&t.key==="ArrowUp"?(t.preventDefault(),t.stopPropagation(),this.stepForward()):super.handleKeyDown(t):t.key==="ArrowLeft"||t.key==="ArrowDown"?(t.preventDefault(),t.stopPropagation(),this.stepBack()):t.key==="ArrowUp"||t.key==="ArrowRight"?(t.preventDefault(),t.stopPropagation(),this.stepForward()):super.handleKeyDown(t)}handleClick(t){t.stopPropagation(),t.preventDefault()}vertical(t){if(t===void 0)return this.vertical_||!1;this.vertical_=!!t,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}Ze.registerComponent("Slider",yo);let vo=(s,t)=>as(s/t*100,0,100).toFixed(2)+"%";class Hp extends Ze{constructor(t,i){super(t,i),this.partEls_=[],this.on(t,"progress",a=>this.update(a))}createEl(){var t=super.createEl("div",{className:"vjs-load-progress"}),i=be("span",{className:"vjs-control-text"}),a=be("span",{textContent:this.localize("Loaded")}),o=document.createTextNode(": ");return this.percentageEl_=be("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),t.appendChild(i),i.appendChild(a),i.appendChild(o),i.appendChild(this.percentageEl_),t}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(t){this.requestNamedAnimationFrame("LoadProgressBar#update",()=>{var l=this.player_.liveTracker,i=this.player_.buffered(),l=l&&l.isLive()?l.seekableEnd():this.player_.duration(),a=this.player_.bufferedEnd(),o=this.partEls_,l=vo(a,l);this.percent_!==l&&(this.el_.style.width=l,Fe(this.percentageEl_,l),this.percent_=l);for(let B=0;B<i.length;B++){var h=i.start(B),T=i.end(B);let G=o[B];G||(G=this.el_.appendChild(be()),o[B]=G),G.dataset.start===h&&G.dataset.end===T||(G.dataset.start=h,G.dataset.end=T,G.style.left=vo(h,a),G.style.width=vo(T-h,a))}for(let B=o.length;B>i.length;B--)this.el_.removeChild(o[B-1]);o.length=i.length})}}Ze.registerComponent("LoadProgressBar",Hp);class qp extends Ze{constructor(t,i){super(t,i),this.update=Yt(Kt(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(t,h,a){var o=Ke(this.el_),l=vt(this.player_.el()),h=t.width*h;if(l&&o){let T=t.left-l.left+h,B=t.width-h+(l.right-t.right),G=(B||(B=t.width-h,T=h),o.width/2);T<G?G+=G-T:B<G&&(G=B),G<0?G=0:G>o.width&&(G=o.width),G=Math.round(G),this.el_.style.right=`-${G}px`,this.write(a)}}write(t){Fe(this.el_,t)}updateTime(t,i,a,o){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{let l;var h,T,B=this.player_.duration();l=this.player_.liveTracker&&this.player_.liveTracker.isLive()?((T=(h=this.player_.liveTracker.liveWindow())-i*h)<1?"":"-")+Jn(T,h):Jn(a,B),this.update(t,i,l),o&&o()})}}Ze.registerComponent("TimeTooltip",qp);class bo extends Ze{constructor(t,i){super(t,i),this.setIcon("circle"),this.update=Yt(Kt(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(t,i){var a,o=this.getChild("timeTooltip");o&&(a=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),o.updateTime(t,i,a))}}bo.prototype.options_={children:[]},Re||$||bo.prototype.options_.children.push("timeTooltip"),Ze.registerComponent("PlayProgressBar",bo);class Eu extends Ze{constructor(t,i){super(t,i),this.update=Yt(Kt(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(t,i){var a=i*this.player_.duration();this.getChild("timeTooltip").updateTime(t,i,a,()=>{this.el_.style.left=t.width*i+"px"})}}Eu.prototype.options_={children:["timeTooltip"]},Ze.registerComponent("MouseTimeDisplay",Eu);class Zs extends yo{constructor(t,i){(i=Z(Zs.prototype.options_,i)).children=[...i.children];var a=t.options_.disableSeekWhileScrubbingOnMobile&&(Re||$);(Re||$)&&!a||i.children.splice(1,0,"mouseTimeDisplay"),super(t,i),this.shouldDisableSeekWhileScrubbingOnMobile_=a,this.pendingSeekTime_=null,this.setEventHandlers_()}setEventHandlers_(){this.update_=Kt(this,this.update),this.update=Yt(this.update_,30),this.on(this.player_,["durationchange","timeupdate"],this.update),this.on(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=t=>this.enableInterval_(t),this.disableIntervalHandler_=t=>this.disableInterval_(t),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in document&&"visibilityState"in document&&this.on(document,"visibilitychange",this.toggleVisibility_)}toggleVisibility_(t){document.visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(t)):(this.player_.ended()||this.player_.paused()||this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,30))}disableInterval_(t){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&t&&t.type!=="ended"||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(t){if(document.visibilityState!=="hidden"){let i=super.update();return this.requestNamedAnimationFrame("SeekBar#update",()=>{var a=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),o=this.player_.liveTracker;let l=this.player_.duration();o&&o.isLive()&&(l=this.player_.liveTracker.liveCurrentTime()),this.percent_!==i&&(this.el_.setAttribute("aria-valuenow",(100*i).toFixed(2)),this.percent_=i),this.currentTime_===a&&this.duration_===l||(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[Jn(a,l),Jn(l,l)],"{1} of {2}")),this.currentTime_=a,this.duration_=l),this.bar&&this.bar.update(vt(this.el()),this.getProgress())}),i}}userSeek_(t){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(t)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}getPercent(){if(this.pendingSeekTime_)return this.pendingSeekTime_/this.player_.duration();var t=this.getCurrentTime_();let i;var a=this.player_.liveTracker;return a&&a.isLive()?(i=(t-a.seekableStart())/a.liveWindow(),a.atLiveEdge()&&(i=1)):i=t/this.player_.duration(),i}handleMouseDown(t){_t(t)&&(t.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.shouldDisableSeekWhileScrubbingOnMobile_||this.player_.pause(),super.handleMouseDown(t))}handleMouseMove(t,i=!1){if(_t(t)&&!isNaN(this.player_.duration())){i||this.player_.scrubbing()||this.player_.scrubbing(!0);let l;if(i=this.calculateDistance(t),t=this.player_.liveTracker,t&&t.isLive()){if(.99<=i)return void t.seekToLiveEdge();var a=t.seekableStart(),o=t.liveCurrentTime();if((l=(l=(l=a+i*t.liveWindow())>=o?o:l)<=a?a+.1:l)===1/0)return}else(l=i*this.player_.duration())===this.player_.duration()&&(l-=.1);this.shouldDisableSeekWhileScrubbingOnMobile_?this.pendingSeekTime_=l:this.userSeek_(l),this.player_.options_.enableSmoothSeeking&&this.update()}}enable(){super.enable();var t=this.getChild("mouseTimeDisplay");t&&t.show()}disable(){super.disable();var t=this.getChild("mouseTimeDisplay");t&&t.hide()}handleMouseUp(t){super.handleMouseUp(t),t&&t.stopPropagation(),this.player_.scrubbing(!1),this.pendingSeekTime_&&(this.userSeek_(this.pendingSeekTime_),this.pendingSeekTime_=null),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?vn(this.player_.play()):this.update_()}stepForward(){this.userSeek_(this.player_.currentTime()+5)}stepBack(){this.userSeek_(this.player_.currentTime()-5)}handleAction(t){this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(t){var i,a=this.player_.liveTracker;t.key===" "||t.key==="Enter"?(t.preventDefault(),t.stopPropagation(),this.handleAction(t)):t.key==="Home"?(t.preventDefault(),t.stopPropagation(),this.userSeek_(0)):t.key==="End"?(t.preventDefault(),t.stopPropagation(),a&&a.isLive()?this.userSeek_(a.liveCurrentTime()):this.userSeek_(this.player_.duration())):/^[0-9]$/.test(t.key)?(t.preventDefault(),t.stopPropagation(),i=.1*parseInt(t.key,10),a&&a.isLive()?this.userSeek_(a.seekableStart()+a.liveWindow()*i):this.userSeek_(this.player_.duration()*i)):t.key==="PageDown"?(t.preventDefault(),t.stopPropagation(),this.userSeek_(this.player_.currentTime()-60)):t.key==="PageUp"?(t.preventDefault(),t.stopPropagation(),this.userSeek_(this.player_.currentTime()+60)):super.handleKeyDown(t)}dispose(){this.disableInterval_(),this.off(this.player_,["durationchange","timeupdate"],this.update),this.off(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in document&&"visibilityState"in document&&this.off(document,"visibilitychange",this.toggleVisibility_),super.dispose()}}Zs.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},Ze.registerComponent("SeekBar",Zs);class Cu extends Ze{constructor(t,i){super(t,i),this.handleMouseMove=Yt(Kt(this,this.handleMouseMove),30),this.throttledHandleMouseSeek=Yt(Kt(this,this.handleMouseSeek),30),this.handleMouseUpHandler_=a=>this.handleMouseUp(a),this.handleMouseDownHandler_=a=>this.handleMouseDown(a),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(t){var i,a,o,l,h=this.getChild("seekBar");h&&(i=h.getChild("playProgressBar"),a=h.getChild("mouseTimeDisplay"),i||a)&&(o=Ke(l=h.el()),l=as(l=Je(l,t).x,0,1),a&&a.update(o,l),i)&&i.update(o,h.getProgress())}handleMouseSeek(t){var i=this.getChild("seekBar");i&&i.handleMouseMove(t)}enabled(){return this.enabled_}disable(){var t;this.children().forEach(i=>i.disable&&i.disable()),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,["mousemove","touchmove"],this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())&&(t=this.getChild("seekBar"),this.player_.scrubbing(!1),t.videoWasPlaying)&&vn(this.player_.play())}enable(){this.children().forEach(t=>t.enable&&t.enable()),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,["mousemove","touchmove"],this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseSeek),this.off(t,"touchmove",this.throttledHandleMouseSeek),this.off(t,"mouseup",this.handleMouseUpHandler_),this.off(t,"touchend",this.handleMouseUpHandler_)}handleMouseDown(t){var i=this.el_.ownerDocument,a=this.getChild("seekBar");a&&a.handleMouseDown(t),this.on(i,"mousemove",this.throttledHandleMouseSeek),this.on(i,"touchmove",this.throttledHandleMouseSeek),this.on(i,"mouseup",this.handleMouseUpHandler_),this.on(i,"touchend",this.handleMouseUpHandler_)}handleMouseUp(t){var i=this.getChild("seekBar");i&&i.handleMouseUp(t),this.removeListenersAddedOnMousedownAndTouchstart()}}Cu.prototype.options_={children:["seekBar"]},Ze.registerComponent("ProgressControl",Cu);class xu extends Bi{constructor(t,i){super(t,i),this.setIcon("picture-in-picture-enter"),this.on(t,["enterpictureinpicture","leavepictureinpicture"],a=>this.handlePictureInPictureChange(a)),this.on(t,["disablepictureinpicturechanged","loadedmetadata"],a=>this.handlePictureInPictureEnabledChange(a)),this.on(t,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>this.handlePictureInPictureAudioModeChange()),this.disable()}buildCSSClass(){return"vjs-picture-in-picture-control vjs-hidden "+super.buildCSSClass()}handlePictureInPictureAudioModeChange(){this.player_.currentType().substring(0,5)==="audio"||this.player_.audioPosterMode()||this.player_.audioOnlyMode()?(this.player_.isInPictureInPicture()&&this.player_.exitPictureInPicture(),this.hide()):this.show()}handlePictureInPictureEnabledChange(){document.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in window?this.enable():this.disable()}handlePictureInPictureChange(t){this.player_.isInPictureInPicture()?(this.setIcon("picture-in-picture-exit"),this.controlText("Exit Picture-in-Picture")):(this.setIcon("picture-in-picture-enter"),this.controlText("Picture-in-Picture")),this.handlePictureInPictureEnabledChange()}handleClick(t){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}show(){typeof document.exitPictureInPicture=="function"&&super.show()}}xu.prototype.controlText_="Picture-in-Picture",Ze.registerComponent("PictureInPictureToggle",xu);class ku extends Bi{constructor(t,i){super(t,i),this.setIcon("fullscreen-enter"),this.on(t,"fullscreenchange",a=>this.handleFullscreenChange(a)),document[t.fsApi_.fullscreenEnabled]===!1&&this.disable()}buildCSSClass(){return"vjs-fullscreen-control "+super.buildCSSClass()}handleFullscreenChange(t){this.player_.isFullscreen()?(this.controlText("Exit Fullscreen"),this.setIcon("fullscreen-exit")):(this.controlText("Fullscreen"),this.setIcon("fullscreen-enter"))}handleClick(t){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}ku.prototype.controlText_="Fullscreen",Ze.registerComponent("FullscreenToggle",ku);class Vp extends Ze{createEl(){var t=super.createEl("div",{className:"vjs-volume-level"});return this.setIcon("circle",t),t.appendChild(super.createEl("span",{className:"vjs-control-text"})),t}}Ze.registerComponent("VolumeLevel",Vp);class Wp extends Ze{constructor(t,i){super(t,i),this.update=Yt(Kt(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(t,i,a,o){if(!a){var a=vt(this.el_),l=vt(this.player_.el()),i=t.width*i;if(!l||!a)return;var h=t.left-l.left+i,i=t.width-i+(l.right-t.right);let G=a.width/2;h<G?G+=G-h:i<G&&(G=i),G<0?G=0:G>a.width&&(G=a.width),this.el_.style.right=`-${G}px`}this.write(o+"%")}write(t){Fe(this.el_,t)}updateVolume(t,i,a,o,l){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",()=>{this.update(t,i,a,o.toFixed(0)),l&&l()})}}Ze.registerComponent("VolumeLevelTooltip",Wp);class Nu extends Ze{constructor(t,i){super(t,i),this.update=Yt(Kt(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(t,i,a){var o=100*i;this.getChild("volumeLevelTooltip").updateVolume(t,i,a,o,()=>{a?this.el_.style.bottom=t.height*i+"px":this.el_.style.left=t.width*i+"px"})}}Nu.prototype.options_={children:["volumeLevelTooltip"]},Ze.registerComponent("MouseVolumeLevelDisplay",Nu);class Qs extends yo{constructor(t,i){super(t,i),this.on("slideractive",a=>this.updateLastVolume_(a)),this.on(t,"volumechange",a=>this.updateARIAAttributes(a)),t.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(t){_t(t)&&super.handleMouseDown(t)}handleMouseMove(t){var i,a,o,l=this.getChild("mouseVolumeLevelDisplay");l&&(i=vt(o=this.el()),a=this.vertical(),o=Je(o,t),o=as(o=a?o.y:o.x,0,1),l.update(i,o,a)),_t(t)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(t)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(t){var i=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",i),this.el_.setAttribute("aria-valuetext",i+"%")}volumeAsPercentage_(){return Math.round(100*this.player_.volume())}updateLastVolume_(){let t=this.player_.volume();this.one("sliderinactive",()=>{this.player_.volume()===0&&this.player_.lastVolume_(t)})}}Qs.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},Re||$||Qs.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),Qs.prototype.playerEvent="volumechange",Ze.registerComponent("VolumeBar",Qs);class Au extends Ze{constructor(t,i={}){var a,o;i.vertical=i.vertical||!1,typeof i.volumeBar<"u"&&!V(i.volumeBar)||(i.volumeBar=i.volumeBar||{},i.volumeBar.vertical=i.vertical),super(t,i),a=this,(o=t).tech_&&!o.tech_.featuresVolumeControl&&a.addClass("vjs-hidden"),a.on(o,"loadstart",function(){o.tech_.featuresVolumeControl?a.removeClass("vjs-hidden"):a.addClass("vjs-hidden")}),this.throttledHandleMouseMove=Yt(Kt(this,this.handleMouseMove),30),this.handleMouseUpHandler_=l=>this.handleMouseUp(l),this.on("mousedown",l=>this.handleMouseDown(l)),this.on("touchstart",l=>this.handleMouseDown(l)),this.on("mousemove",l=>this.handleMouseMove(l)),this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")}),this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")})}createEl(){let t="vjs-volume-horizontal";return this.options_.vertical&&(t="vjs-volume-vertical"),super.createEl("div",{className:"vjs-volume-control vjs-control "+t})}handleMouseDown(t){var i=this.el_.ownerDocument;this.on(i,"mousemove",this.throttledHandleMouseMove),this.on(i,"touchmove",this.throttledHandleMouseMove),this.on(i,"mouseup",this.handleMouseUpHandler_),this.on(i,"touchend",this.handleMouseUpHandler_)}handleMouseUp(t){var i=this.el_.ownerDocument;this.off(i,"mousemove",this.throttledHandleMouseMove),this.off(i,"touchmove",this.throttledHandleMouseMove),this.off(i,"mouseup",this.handleMouseUpHandler_),this.off(i,"touchend",this.handleMouseUpHandler_)}handleMouseMove(t){this.volumeBar.handleMouseMove(t)}}Au.prototype.options_={children:["volumeBar"]},Ze.registerComponent("VolumeControl",Au);class Iu extends Bi{constructor(t,i){var a,o;super(t,i),a=this,(o=t).tech_&&!o.tech_.featuresMuteControl&&a.addClass("vjs-hidden"),a.on(o,"loadstart",function(){o.tech_.featuresMuteControl?a.removeClass("vjs-hidden"):a.addClass("vjs-hidden")}),this.on(t,["loadstart","volumechange"],l=>this.update(l))}buildCSSClass(){return"vjs-mute-control "+super.buildCSSClass()}handleClick(t){var i=this.player_.volume(),a=this.player_.lastVolume_();i===0?(this.player_.volume(a<.1?.1:a),this.player_.muted(!1)):this.player_.muted(!this.player_.muted())}update(t){this.updateIcon_(),this.updateControlText_()}updateIcon_(){var t=this.player_.volume();let i=3;this.setIcon("volume-high"),Re&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),t===0||this.player_.muted()?(this.setIcon("volume-mute"),i=0):t<.33?(this.setIcon("volume-low"),i=1):t<.67&&(this.setIcon("volume-medium"),i=2),At(this.el_,[0,1,2,3].reduce((a,o)=>a+`${o?" ":""}vjs-vol-`+o,"")),yt(this.el_,"vjs-vol-"+i)}updateControlText_(){var t=this.player_.muted()||this.player_.volume()===0?"Unmute":"Mute";this.controlText()!==t&&this.controlText(t)}}Iu.prototype.controlText_="Mute",Ze.registerComponent("MuteToggle",Iu);class Ou extends Ze{constructor(t,i={}){typeof i.inline<"u"?i.inline=i.inline:i.inline=!0,typeof i.volumeControl<"u"&&!V(i.volumeControl)||(i.volumeControl=i.volumeControl||{},i.volumeControl.vertical=!i.inline),super(t,i),this.handleKeyPressHandler_=a=>this.handleKeyPress(a),this.on(t,["loadstart"],a=>this.volumePanelState_(a)),this.on(this.muteToggle,"keyup",a=>this.handleKeyPress(a)),this.on(this.volumeControl,"keyup",a=>this.handleVolumeControlKeyUp(a)),this.on("keydown",a=>this.handleKeyPress(a)),this.on("mouseover",a=>this.handleMouseOver(a)),this.on("mouseout",a=>this.handleMouseOut(a)),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let t="vjs-volume-panel-horizontal";return this.options_.inline||(t="vjs-volume-panel-vertical"),super.createEl("div",{className:"vjs-volume-panel vjs-control "+t})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(t){t.key==="Escape"&&this.muteToggle.focus()}handleMouseOver(t){this.addClass("vjs-hover"),Vt(document,"keyup",this.handleKeyPressHandler_)}handleMouseOut(t){this.removeClass("vjs-hover"),kt(document,"keyup",this.handleKeyPressHandler_)}handleKeyPress(t){t.key==="Escape"&&this.handleMouseOut()}}Ou.prototype.options_={children:["muteToggle","volumeControl"]},Ze.registerComponent("VolumePanel",Ou);class Du extends Bi{constructor(t,i){super(t,i),this.validOptions=[5,10,30],this.skipTime=this.getSkipForwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon("forward-"+this.skipTime),this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime.toLocaleString(t.language())])),this.show()):this.hide()}getSkipForwardTime(){var t=this.options_.playerOptions;return t.controlBar&&t.controlBar.skipButtons&&t.controlBar.skipButtons.forward}buildCSSClass(){return`vjs-skip-forward-${this.getSkipForwardTime()} `+super.buildCSSClass()}handleClick(t){if(!isNaN(this.player_.duration())){var i=this.player_.currentTime(),a=this.player_.liveTracker,a=a&&a.isLive()?a.seekableEnd():this.player_.duration();let o;o=i+this.skipTime<=a?i+this.skipTime:a,this.player_.currentTime(o)}}handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime]))}}Du.prototype.controlText_="Skip Forward",Ze.registerComponent("SkipForward",Du);class Pu extends Bi{constructor(t,i){super(t,i),this.validOptions=[5,10,30],this.skipTime=this.getSkipBackwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon("replay-"+this.skipTime),this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime.toLocaleString(t.language())])),this.show()):this.hide()}getSkipBackwardTime(){var t=this.options_.playerOptions;return t.controlBar&&t.controlBar.skipButtons&&t.controlBar.skipButtons.backward}buildCSSClass(){return`vjs-skip-backward-${this.getSkipBackwardTime()} `+super.buildCSSClass()}handleClick(t){var i=this.player_.currentTime(),a=this.player_.liveTracker,a=a&&a.isLive()&&a.seekableStart();let o;o=a&&i-this.skipTime<=a?a:i>=this.skipTime?i-this.skipTime:0,this.player_.currentTime(o)}handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}Pu.prototype.controlText_="Skip Backward",Ze.registerComponent("SkipBackward",Pu);class Ru extends Ze{constructor(t,i){super(t,i),i&&(this.menuButton_=i.menuButton),this.focusedChild_=-1,this.on("keydown",a=>this.handleKeyDown(a)),this.boundHandleBlur_=a=>this.handleBlur(a),this.boundHandleTapClick_=a=>this.handleTapClick(a)}addEventListenerForItem(t){t instanceof Ze&&(this.on(t,"blur",this.boundHandleBlur_),this.on(t,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(t){t instanceof Ze&&(this.off(t,"blur",this.boundHandleBlur_),this.off(t,["tap","click"],this.boundHandleTapClick_))}removeChild(t){typeof t=="string"&&(t=this.getChild(t)),this.removeEventListenerForItem(t),super.removeChild(t)}addItem(t){t=this.addChild(t),t&&this.addEventListenerForItem(t)}createEl(){var t=this.options_.contentElType||"ul",t=(this.contentEl_=be(t,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu"),super.createEl("div",{append:this.contentEl_,className:"vjs-menu"}));return t.appendChild(this.contentEl_),Vt(t,"click",function(i){i.preventDefault(),i.stopImmediatePropagation()}),t}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(t){let i=t.relatedTarget||document.activeElement;this.children().some(a=>a.el()===i)||(t=this.menuButton_)&&t.buttonPressed_&&i!==t.el().firstChild&&t.unpressButton()}handleTapClick(t){var i;this.menuButton_&&(this.menuButton_.unpressButton(),i=this.children(),Array.isArray(i))&&(i=i.filter(a=>a.el()===t.target)[0])&&i.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}handleKeyDown(t){t.key==="ArrowLeft"||t.key==="ArrowDown"?(t.preventDefault(),t.stopPropagation(),this.stepForward()):t.key!=="ArrowRight"&&t.key!=="ArrowUp"||(t.preventDefault(),t.stopPropagation(),this.stepBack())}stepForward(){let t=0;this.focusedChild_!==void 0&&(t=this.focusedChild_+1),this.focus(t)}stepBack(){let t=0;this.focusedChild_!==void 0&&(t=this.focusedChild_-1),this.focus(t)}focus(t=0){var i=this.children().slice();i.length&&i[0].hasClass("vjs-menu-title")&&i.shift(),0<i.length&&(t<0?t=0:i.length<=t&&(t=i.length-1),i[this.focusedChild_=t].el_.focus())}}Ze.registerComponent("Menu",Ru);class _o extends Ze{constructor(t,i={}){super(t,i),this.menuButton_=new Bi(t,i),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true"),t=Bi.prototype.buildCSSClass(),this.menuButton_.el_.className=this.buildCSSClass()+" "+t,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0,i=a=>this.handleClick(a),this.handleMenuKeyUp_=a=>this.handleMenuKeyUp(a),this.on(this.menuButton_,"tap",i),this.on(this.menuButton_,"click",i),this.on(this.menuButton_,"keydown",a=>this.handleKeyDown(a)),this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover"),this.menu.show(),Vt(document,"keyup",this.handleMenuKeyUp_)}),this.on("mouseleave",a=>this.handleMouseLeave(a)),this.on("keydown",a=>this.handleSubmenuKeyDown(a))}update(){var t=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=t,this.addChild(t),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){var t,i=new Ru(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title&&(t=be("li",{className:"vjs-menu-title",textContent:_i(this.options_.title),tabIndex:-1}),t=new Ze(this.player_,{el:t}),i.addItem(t)),this.items=this.createItems(),this.items)for(let a=0;a<this.items.length;a++)i.addItem(this.items[a]);return i}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}setIcon(t){super.setIcon(t,this.menuButton_.el_)}buildWrapperCSSClass(){let t="vjs-menu-button";this.options_.inline===!0?t+="-inline":t+="-popup";var i=Bi.prototype.buildCSSClass();return`vjs-menu-button ${t} ${i} `+super.buildCSSClass()}buildCSSClass(){let t="vjs-menu-button";return this.options_.inline===!0?t+="-inline":t+="-popup",`vjs-menu-button ${t} `+super.buildCSSClass()}controlText(t,i=this.menuButton_.el()){return this.menuButton_.controlText(t,i)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(t){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(t){this.removeClass("vjs-hover"),kt(document,"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(t){t.key==="Escape"||t.key==="Tab"?(this.buttonPressed_&&this.unpressButton(),!t.key==="Tab"&&(t.preventDefault(),this.menuButton_.focus())):t.key!=="Up"&&(t.key!=="Down"||this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled)||this.buttonPressed_||(t.preventDefault(),this.pressButton())}handleMenuKeyUp(t){t.key!=="Escape"&&t.key!=="Tab"||this.removeClass("vjs-hover")}handleSubmenuKeyPress(t){this.handleSubmenuKeyDown(t)}handleSubmenuKeyDown(t){t.key!=="Escape"&&t.key!=="Tab"||(this.buttonPressed_&&this.unpressButton(),!t.key==="Tab"&&(t.preventDefault(),this.menuButton_.focus()))}pressButton(){this.enabled_&&(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Re&&ue()||this.menu.focus())}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}Ze.registerComponent("MenuButton",_o);class To extends _o{constructor(t,i){let a=i.tracks;if(super(t,i),this.items.length<=1&&this.hide(),a){let o=Kt(this,this.update);a.addEventListener("removetrack",o),a.addEventListener("addtrack",o),a.addEventListener("labelchange",o),this.player_.on("ready",o),this.player_.on("dispose",function(){a.removeEventListener("removetrack",o),a.removeEventListener("addtrack",o),a.removeEventListener("labelchange",o)})}}}Ze.registerComponent("TrackButton",To);class os extends Ys{constructor(t,i){super(t,i),this.selectable=i.selectable,this.isSelected_=i.selected||!1,this.multiSelectable=i.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(t,i,a){return this.nonIconControl=!0,i=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},i),a),a=be("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),this.player_.options_.experimentalSvgIcons?i.appendChild(a):i.replaceChild(a,i.querySelector(".vjs-icon-placeholder")),i}handleKeyDown(t){["Tab","Escape","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"].includes(t.key)||super.handleKeyDown(t)}handleClick(t){this.selected(!0)}selected(t){this.selectable&&(t?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}Ze.registerComponent("MenuItem",os);class ls extends os{constructor(t,i){var a=i.track;let o=t.textTracks(),l=(i.label=a.label||a.language||"Unknown",i.selected=a.mode==="showing",super(t,i),this.track=a,this.kinds=(i.kinds||[i.kind||this.track.kind]).filter(Boolean),(...T)=>{this.handleTracksChange.apply(this,T)}),h=(...T)=>{this.handleSelectedLanguageChange.apply(this,T)};if(t.on(["loadstart","texttrackchange"],l),o.addEventListener("change",l),o.addEventListener("selectedlanguagechange",h),this.on("dispose",function(){t.off(["loadstart","texttrackchange"],l),o.removeEventListener("change",l),o.removeEventListener("selectedlanguagechange",h)}),o.onchange===void 0){let T;this.on(["tap","click"],function(){if(typeof window.Event!="object")try{T=new window.Event("change")}catch{}T||(T=document.createEvent("Event")).initEvent("change",!0,!0),o.dispatchEvent(T)})}this.handleTracksChange()}handleClick(t){var i=this.track,a=this.player_.textTracks();if(super.handleClick(t),a)for(let l=0;l<a.length;l++){var o=a[l];this.kinds.indexOf(o.kind)!==-1&&(o===i?o.mode!=="showing"&&(o.mode="showing"):o.mode!=="disabled"&&(o.mode="disabled"))}}handleTracksChange(t){var i=this.track.mode==="showing";i!==this.isSelected_&&this.selected(i)}handleSelectedLanguageChange(t){var i;this.track.mode!=="showing"||(i=this.player_.cache_.selectedLanguage)&&i.enabled&&i.language===this.track.language&&i.kind!==this.track.kind||(this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind})}dispose(){this.track=null,super.dispose()}}Ze.registerComponent("TextTrackMenuItem",ls);class Lu extends ls{constructor(t,i){i.track={player:t,kind:i.kind,kinds:i.kinds,default:!1,mode:"disabled"},i.kinds||(i.kinds=[i.kind]),i.track.label=i.label||i.kinds.join(" and ")+" off",i.selectable=!0,i.multiSelectable=!1,super(t,i)}handleTracksChange(t){var i=this.player().textTracks();let a=!0;for(let l=0,h=i.length;l<h;l++){var o=i[l];if(-1<this.options_.kinds.indexOf(o.kind)&&o.mode==="showing"){a=!1;break}}a!==this.isSelected_&&this.selected(a)}handleSelectedLanguageChange(t){var i=this.player().textTracks();let a=!0;for(let l=0,h=i.length;l<h;l++){var o=i[l];if(-1<["captions","descriptions","subtitles"].indexOf(o.kind)&&o.mode==="showing"){a=!1;break}}a&&(this.player_.cache_.selectedLanguage={enabled:!1})}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label),super.handleLanguagechange()}}Ze.registerComponent("OffTextTrackMenuItem",Lu);class yr extends To{constructor(t,i={}){i.tracks=t.textTracks(),super(t,i)}createItems(t=[],i=ls){let a;this.label_&&(a=this.label_+" off"),t.push(new Lu(this.player_,{kinds:this.kinds_,kind:this.kind_,label:a})),this.hideThreshold_+=1;var o=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let T=0;T<o.length;T++){var l,h=o[T];-1<this.kinds_.indexOf(h.kind)&&((l=new i(this.player_,{track:h,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1})).addClass(`vjs-${h.kind}-menu-item`),t.push(l))}return t}}Ze.registerComponent("TextTrackButton",yr);class Mu extends os{constructor(t,i){var a=i.track,o=i.cue,l=t.currentTime();i.selectable=!0,i.multiSelectable=!1,i.label=o.text,i.selected=o.startTime<=l&&l<o.endTime,super(t,i),this.track=a,this.cue=o}handleClick(t){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}Ze.registerComponent("ChaptersTrackMenuItem",Mu);class So extends yr{constructor(t,i,a){super(t,i,a),this.setIcon("chapters"),this.selectCurrentItem_=()=>{this.items.forEach(o=>{o.selected(this.track_.activeCues[0]===o.cue)})}}buildCSSClass(){return"vjs-chapters-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-chapters-button "+super.buildWrapperCSSClass()}update(t){t&&t.track&&t.track.kind!=="chapters"||((t=this.findChaptersTrack())!==this.track_?(this.setTrack(t),super.update()):(!this.items||t&&t.cues&&t.cues.length!==this.items.length)&&super.update())}setTrack(t){var i;this.track_!==t&&(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_&&((i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_))&&i.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null),this.track_=t,this.track_)&&(this.track_.mode="hidden",(i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_))&&i.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_))}findChaptersTrack(){var t=this.player_.textTracks()||[];for(let a=t.length-1;0<=a;a--){var i=t[a];if(i.kind===this.kind_)return i}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(_i(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){var t=[];if(this.track_){var i=this.track_.cues;if(i)for(let o=0,l=i.length;o<l;o++){var a=i[o],a=new Mu(this.player_,{track:this.track_,cue:a});t.push(a)}}return t}}So.prototype.kind_="chapters",So.prototype.controlText_="Chapters",Ze.registerComponent("ChaptersButton",So);class wo extends yr{constructor(t,i,a){super(t,i,a),this.setIcon("audio-description");let o=t.textTracks(),l=Kt(this,this.handleTracksChange);o.addEventListener("change",l),this.on("dispose",function(){o.removeEventListener("change",l)})}handleTracksChange(t){var i=this.player().textTracks();let a=!1;for(let l=0,h=i.length;l<h;l++){var o=i[l];if(o.kind!==this.kind_&&o.mode==="showing"){a=!0;break}}a?this.disable():this.enable()}buildCSSClass(){return"vjs-descriptions-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-descriptions-button "+super.buildWrapperCSSClass()}}wo.prototype.kind_="descriptions",wo.prototype.controlText_="Descriptions",Ze.registerComponent("DescriptionsButton",wo);class Eo extends yr{constructor(t,i,a){super(t,i,a),this.setIcon("subtitles")}buildCSSClass(){return"vjs-subtitles-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-subtitles-button "+super.buildWrapperCSSClass()}}Eo.prototype.kind_="subtitles",Eo.prototype.controlText_="Subtitles",Ze.registerComponent("SubtitlesButton",Eo);class Co extends ls{constructor(t,i){i.track={player:t,kind:i.kind,label:i.kind+" settings",selectable:!1,default:!1,mode:"disabled"},i.selectable=!1,i.name="CaptionSettingsMenuItem",super(t,i),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+i.kind+" settings dialog")}handleClick(t){this.player().getChild("textTrackSettings").open()}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.kind+" settings"),super.handleLanguagechange()}}Ze.registerComponent("CaptionSettingsMenuItem",Co);class xo extends yr{constructor(t,i,a){super(t,i,a),this.setIcon("captions")}buildCSSClass(){return"vjs-captions-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-captions-button "+super.buildWrapperCSSClass()}createItems(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new Co(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(t)}}xo.prototype.kind_="captions",xo.prototype.controlText_="Captions",Ze.registerComponent("CaptionsButton",xo);class Uu extends ls{createEl(t,i,a){return t=super.createEl(t,i,a),i=t.querySelector(".vjs-menu-item-text"),this.options_.track.kind==="captions"&&(this.player_.options_.experimentalSvgIcons?this.setIcon("captions",t):i.appendChild(be("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),i.appendChild(be("span",{className:"vjs-control-text",textContent:" "+this.localize("Captions")}))),t}}Ze.registerComponent("SubsCapsMenuItem",Uu);class ko extends yr{constructor(t,i={}){super(t,i),this.label_="subtitles",this.setIcon("subtitles"),-1<["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)&&(this.label_="captions",this.setIcon("captions")),this.menuButton_.controlText(_i(this.label_))}buildCSSClass(){return"vjs-subs-caps-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-subs-caps-button "+super.buildWrapperCSSClass()}createItems(){let t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new Co(this.player_,{kind:this.label_})),this.hideThreshold_+=1),t=super.createItems(t,Uu)}}ko.prototype.kinds_=["captions","subtitles"],ko.prototype.controlText_="Subtitles",Ze.registerComponent("SubsCapsButton",ko);class Fu extends os{constructor(t,i){var a=i.track;let o=t.audioTracks(),l=(i.label=a.label||a.language||"Unknown",i.selected=a.enabled,super(t,i),this.track=a,this.addClass(`vjs-${a.kind}-menu-item`),(...h)=>{this.handleTracksChange.apply(this,h)});o.addEventListener("change",l),this.on("dispose",()=>{o.removeEventListener("change",l)})}createEl(t,i,a){return t=super.createEl(t,i,a),i=t.querySelector(".vjs-menu-item-text"),0<=["main-desc","descriptions"].indexOf(this.options_.track.kind)&&(i.appendChild(be("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),i.appendChild(be("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),t}handleClick(t){if(super.handleClick(t),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){var i=this.player_.audioTracks();for(let o=0;o<i.length;o++){var a=i[o];a!==this.track&&(a.enabled=a===this.track)}}}handleTracksChange(t){this.selected(this.track.enabled)}}Ze.registerComponent("AudioTrackMenuItem",Fu);class Bu extends To{constructor(t,i={}){i.tracks=t.audioTracks(),super(t,i),this.setIcon("audio")}buildCSSClass(){return"vjs-audio-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-audio-button "+super.buildWrapperCSSClass()}createItems(t=[]){this.hideThreshold_=1;var i=this.player_.audioTracks();for(let o=0;o<i.length;o++){var a=i[o];t.push(new Fu(this.player_,{track:a,selectable:!0,multiSelectable:!1}))}return t}}Bu.prototype.controlText_="Audio Track",Ze.registerComponent("AudioTrackButton",Bu);class No extends os{constructor(t,i){var a=i.rate,o=parseFloat(a,10);i.label=a,i.selected=o===t.playbackRate(),i.selectable=!0,i.multiSelectable=!1,super(t,i),this.label=a,this.rate=o,this.on(t,"ratechange",l=>this.update(l))}handleClick(t){super.handleClick(),this.player().playbackRate(this.rate)}update(t){this.selected(this.player().playbackRate()===this.rate)}}No.prototype.contentElType="button",Ze.registerComponent("PlaybackRateMenuItem",No);class zu extends _o{constructor(t,i){super(t,i),this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(t,"loadstart",a=>this.updateVisibility(a)),this.on(t,"ratechange",a=>this.updateLabel(a)),this.on(t,"playbackrateschange",a=>this.handlePlaybackRateschange(a))}createEl(){var t=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=be("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),t.appendChild(this.labelEl_),t}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return"vjs-playback-rate "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-playback-rate "+super.buildWrapperCSSClass()}createItems(){var t=this.playbackRates(),i=[];for(let a=t.length-1;0<=a;a--)i.push(new No(this.player(),{rate:t[a]+"x"}));return i}handlePlaybackRateschange(t){this.update()}playbackRates(){var t=this.player();return t.playbackRates&&t.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&0<this.playbackRates().length}updateVisibility(t){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(t){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}zu.prototype.controlText_="Playback Rate",Ze.registerComponent("PlaybackRateMenuButton",zu);class ju extends Ze{buildCSSClass(){return"vjs-spacer "+super.buildCSSClass()}createEl(t="div",i={},a={}){return i.className||(i.className=this.buildCSSClass()),super.createEl(t,i,a)}}Ze.registerComponent("Spacer",ju);class Xp extends ju{buildCSSClass(){return"vjs-custom-control-spacer "+super.buildCSSClass()}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:"\xA0"})}}Ze.registerComponent("CustomControlSpacer",Xp);class Hu extends Ze{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}Hu.prototype.options_={children:["playToggle","skipBackward","skipForward","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","pictureInPictureToggle","fullscreenToggle"]},Ze.registerComponent("ControlBar",Hu);class qu extends pr{constructor(t,i){super(t,i),this.on(t,"error",a=>{this.open(a)})}buildCSSClass(){return"vjs-error-display "+super.buildCSSClass()}content(){var t=this.player().error();return t?this.localize(t.message):""}}qu.prototype.options_=Object.assign({},pr.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),Ze.registerComponent("ErrorDisplay",qu);class Vu extends Ze{constructor(t,i={}){super(t,i),this.el_.setAttribute("aria-labelledby",this.selectLabelledbyIds)}createEl(){return this.selectLabelledbyIds=[this.options_.legendId,this.options_.labelId].join(" ").trim(),be("select",{id:this.options_.id},{},this.options_.SelectOptions.map(a=>{var i=(this.options_.labelId||"vjs-track-option-"+Be++)+"-"+a[1].replace(/\W+/g,""),a=be("option",{id:i,value:this.localize(a[0]),textContent:this.localize(a[1])});return a.setAttribute("aria-labelledby",this.selectLabelledbyIds+" "+i),a}))}}Ze.registerComponent("TextTrackSelect",Vu);class ir extends Ze{constructor(t,o={}){super(t,o);var a,o=be("legend",{textContent:this.localize(this.options_.legendText),id:this.options_.legendId}),o=(this.el().appendChild(o),this.options_.selects);for(a of o){var l=this.options_.selectConfigs[a],B=l.className,h=l.id.replace("%s",this.options_.id_);let G=null;var T="vjs_select_"+Be++,B=(this.options_.type==="colors"&&(G=be("span",{className:B}),(B=be("label",{id:h,className:"vjs-label",textContent:this.localize(l.label)})).setAttribute("for",T),G.appendChild(B)),new Vu(t,{SelectOptions:l.options,legendId:this.options_.legendId,id:T,labelId:h}));this.addChild(B),this.options_.type==="colors"&&(G.appendChild(B.el()),this.el().appendChild(G))}}createEl(){return be("fieldset",{className:this.options_.className})}}Ze.registerComponent("TextTrackFieldset",ir);class Wu extends Ze{constructor(t,a={}){super(t,a);var a=this.options_.textTrackComponentid,o=new ir(t,{id_:a,legendId:"captions-text-legend-"+a,legendText:this.localize("Text"),className:"vjs-fg vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"colors"}),o=(this.addChild(o),new ir(t,{id_:a,legendId:"captions-background-"+a,legendText:this.localize("Text Background"),className:"vjs-bg vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"colors"})),o=(this.addChild(o),new ir(t,{id_:a,legendId:"captions-window-"+a,legendText:this.localize("Caption Area Background"),className:"vjs-window vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"colors"}));this.addChild(o)}createEl(){return be("div",{className:"vjs-track-settings-colors"})}}Ze.registerComponent("TextTrackSettingsColors",Wu);class Xu extends Ze{constructor(t,a={}){super(t,a);var a=this.options_.textTrackComponentid,o=new ir(t,{id_:a,legendId:"captions-font-size-"+a,legendText:"Font Size",className:"vjs-font-percent vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"font"}),o=(this.addChild(o),new ir(t,{id_:a,legendId:"captions-edge-style-"+a,legendText:this.localize("Text Edge Style"),className:"vjs-edge-style vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"font"})),o=(this.addChild(o),new ir(t,{id_:a,legendId:"captions-font-family-"+a,legendText:this.localize("Font Family"),className:"vjs-font-family vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"font"}));this.addChild(o)}createEl(){return be("div",{className:"vjs-track-settings-font"})}}Ze.registerComponent("TextTrackSettingsFont",Xu);class Gu extends Ze{constructor(t,a={}){super(t,a);var a=this.localize("restore all settings to the default values"),o=new Bi(t,{controlText:a,className:"vjs-default-button"}),o=(o.el().classList.remove("vjs-control","vjs-button"),o.el().textContent=this.localize("Reset"),this.addChild(o),new Bi(t,{controlText:a,className:"vjs-done-button"}));o.el().classList.remove("vjs-control","vjs-button"),o.el().textContent=this.localize("Done"),this.addChild(o)}createEl(){return be("div",{className:"vjs-track-settings-controls"})}}Ze.registerComponent("TrackSettingsControls",Gu);let Ao="vjs-text-track-settings";var vi=["#000","Black"],Xi=["#00F","Blue"],da=["#0FF","Cyan"],_r=["#0F0","Green"],Oi=["#F0F","Magenta"],nr=["#F00","Red"],_n=["#FFF","White"],Fi=["#FF0","Yellow"],Ar=["1","Opaque"],xr=["0.5","Semi-Transparent"],Cr=["0","Transparent"];let Bn={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[vi,_n,nr,_r,Xi,Fi,Oi,da],className:"vjs-bg-color"},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Opacity",options:[Ar,xr,Cr],className:"vjs-bg-opacity vjs-opacity"},color:{selector:".vjs-text-color > select",id:"captions-foreground-color-%s",label:"Color",options:[_n,vi,nr,_r,Xi,Fi,Oi,da],className:"vjs-text-color"},edgeStyle:{selector:".vjs-edge-style > select",id:"",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Drop shadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:s=>s==="1.00"?null:Number(s)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Opacity",options:[Ar,xr],className:"vjs-text-opacity vjs-opacity"},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color",className:"vjs-window-color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Opacity",options:[Cr,xr,Ar],className:"vjs-window-opacity vjs-opacity"}};function $u(s,t){if((s=t?t(s):s)&&s!=="none")return s}Bn.windowColor.options=Bn.backgroundColor.options;class Gp extends pr{constructor(t,i){i.temporary=!1,super(t,i),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.renderModalComponents(t),this.endDialog=be("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),i.persistTextTrackSettings===void 0&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.bindFunctionsToSelectsAndButtons(),this.options_.persistTextTrackSettings&&this.restoreSettings()}renderModalComponents(t){var i=new Wu(t,{textTrackComponentid:this.id_,selectConfigs:Bn,fieldSets:[["color","textOpacity"],["backgroundColor","backgroundOpacity"],["windowColor","windowOpacity"]]}),i=(this.addChild(i),new Xu(t,{textTrackComponentid:this.id_,selectConfigs:Bn,fieldSets:[["fontPercent"],["edgeStyle"],["fontFamily"]]})),i=(this.addChild(i),new Gu(t));this.addChild(i)}bindFunctionsToSelectsAndButtons(){this.on(this.$(".vjs-done-button"),["click","tap"],()=>{this.saveSettings(),this.close()}),this.on(this.$(".vjs-default-button"),["click","tap"],()=>{this.setDefaults(),this.updateDisplay()}),v(Bn,t=>{this.on(this.$(t.selector),"change",this.updateDisplay)})}dispose(){this.endDialog=null,super.dispose()}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return m(Bn,(t,i,a)=>{o=this.$(i.selector),i=i.parser;var o=$u(o.options[o.options.selectedIndex].value,i);return o!==void 0&&(t[a]=o),t},{})}setValues(t){v(Bn,(i,a)=>{var o=this.$(i.selector),l=t[a],h=i.parser;if(l){for(let T=0;T<o.options.length;T++)if($u(o.options[T].value,h)===l){o.selectedIndex=T;break}}})}setDefaults(){v(Bn,t=>{var i=t.hasOwnProperty("default")?t.default:0;this.$(t.selector).selectedIndex=i})}restoreSettings(){let t;try{t=JSON.parse(window.localStorage.getItem(Ao))}catch(i){S.warn(i)}t&&this.setValues(t)}saveSettings(){if(this.options_.persistTextTrackSettings){var t=this.getValues();try{Object.keys(t).length?window.localStorage.setItem(Ao,JSON.stringify(t)):window.localStorage.removeItem(Ao)}catch(i){S.warn(i)}}}updateDisplay(){var t=this.player_.getChild("textTrackDisplay");t&&t.updateDisplay()}handleLanguagechange(){this.fill(),this.renderModalComponents(this.player_),this.bindFunctionsToSelectsAndButtons()}}Ze.registerComponent("TextTrackSettings",Gp);class $p extends Ze{constructor(t,i){let a=i.ResizeObserver||window.ResizeObserver;super(t,Z({createEl:!(a=i.ResizeObserver===null?!1:a),reportTouchActivity:!1},i)),this.ResizeObserver=i.ResizeObserver||window.ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=Hi(()=>{this.resizeHandler()},100,!1,this),a?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(t.el())):(this.loadListener_=()=>{if(this.el_&&this.el_.contentWindow){let o=this.debouncedHandler_,l=this.unloadListener_=function(){kt(this,"resize",o),kt(this,"unload",l),l=null};Vt(this.el_.contentWindow,"unload",l),Vt(this.el_.contentWindow,"resize",o)}},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}}Ze.registerComponent("ResizeManager",$p);let Kp={trackingThreshold:20,liveTolerance:15};class Yp extends Ze{constructor(t,i){super(t,Z(Kp,i,{createEl:!1})),this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=a=>this.handlePlay(a),this.handleFirstTimeupdate_=a=>this.handleFirstTimeupdate(a),this.handleSeeked_=a=>this.handleSeeked(a),this.seekToLiveEdge_=a=>this.seekToLiveEdge(a),this.reset_(),this.on(this.player_,"durationchange",a=>this.handleDurationchange(a)),this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){var t=this.player_.seekable();if(t&&t.length){var t=Number(window.performance.now().toFixed(4)),i=this.lastTime_===-1?0:(t-this.lastTime_)/1e3,t=(this.lastTime_=t,this.pastSeekEnd_=this.pastSeekEnd()+i,this.liveCurrentTime()),i=this.player_.currentTime();let o=this.player_.paused()||this.seekedBehindLive_||Math.abs(t-i)>this.options_.liveTolerance;(o=this.timeupdateSeen_&&t!==1/0?o:!1)!==this.behindLiveEdge_&&(this.behindLiveEdge_=o,this.trigger("liveedgechange"))}}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,30),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){var t=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&2<t,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){var t=this.player_.seekable(),i=[];let a=t?t.length:0;for(;a--;)i.push(t.end(a));return i.length?i.sort()[i.length-1]:1/0}seekableStart(){var t=this.player_.seekable(),i=[];let a=t?t.length:0;for(;a--;)i.push(t.start(a));return i.length?i.sort()[0]:0}liveWindow(){var t=this.liveCurrentTime();return t===1/0?0:t-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){var t=this.seekableEnd();return this.lastSeekEnd_!==-1&&t!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=t,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return typeof this.trackingInterval_=="number"}seekToLiveEdge(){this.seekedBehindLive_=!1,this.atLiveEdge()||(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}}Ze.registerComponent("LiveTracker",Yp);class Zp extends Ze{constructor(t,i){super(t,i),this.on("statechanged",a=>this.updateDom_()),this.updateDom_()}createEl(){return this.els={title:be("div",{className:"vjs-title-bar-title",id:"vjs-title-bar-title-"+Be++}),description:be("div",{className:"vjs-title-bar-description",id:"vjs-title-bar-description-"+Be++})},be("div",{className:"vjs-title-bar"},{},ne(this.els))}updateDom_(){var t=this.player_.tech_;let i=t&&t.el_,a={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach(T=>{var l=this.state[T],h=this.els[T],T=a[T];ki(h),l&&Fe(h,l),i&&(i.removeAttribute(T),l)&&i.setAttribute(T,h.id)}),this.state.title||this.state.description?this.show():this.hide()}update(t){this.setState(t)}dispose(){var t=this.player_.tech_,t=t&&t.el_;t&&(t.removeAttribute("aria-labelledby"),t.removeAttribute("aria-describedby")),super.dispose(),this.els=null}}Ze.registerComponent("TitleBar",Zp);let Qp={initialDisplay:4e3,position:[],takeFocus:!1};class Jp extends Bi{constructor(t,i){super(t,i=Z(Qp,i)),this.controlText(i.controlText),this.hide(),this.on(this.player_,["useractive","userinactive"],a=>{this.removeClass("force-display")})}buildCSSClass(){return"vjs-transient-button focus-visible "+this.options_.position.map(t=>"vjs-"+t).join(" ")}createEl(){var t=be("button",{},{type:"button",class:this.buildCSSClass()},be("span"));return this.controlTextEl_=t.querySelector("span"),t}show(){super.show(),this.addClass("force-display"),this.options_.takeFocus&&this.el().focus({preventScroll:!0}),this.forceDisplayTimeout=this.player_.setTimeout(()=>{this.removeClass("force-display")},this.options_.initialDisplay)}hide(){this.removeClass("force-display"),super.hide()}dispose(){this.player_.clearTimeout(this.forceDisplayTimeout),super.dispose()}}Ze.registerComponent("TransientButton",Jp);function Ku(s){let t=s.el();if(!t.resetSourceWatch_){let i={},a=nf(s),o=l=>(...h)=>(h=l.apply(t,h),Io(s),h);["append","appendChild","insertAdjacentHTML"].forEach(l=>{t[l]&&(i[l]=t[l],t[l]=o(i[l]))}),Object.defineProperty(t,"innerHTML",Z(a,{set:o(a.set)})),t.resetSourceWatch_=()=>{t.resetSourceWatch_=null,Object.keys(i).forEach(l=>{t[l]=i[l]}),Object.defineProperty(t,"innerHTML",a)},s.one("sourceset",t.resetSourceWatch_)}}function ef(s){if(s.featuresSourceset){let i=s.el();if(!i.resetSourceset_){t=s;let a=Yu([t.el(),window.HTMLMediaElement.prototype,rf],"src");var t;let o=i.setAttribute,l=i.load;Object.defineProperty(i,"src",Z(a,{set:h=>(h=a.set.call(i,h),s.triggerSourceset(i.src),h)})),i.setAttribute=(h,T)=>(T=o.call(i,h,T),/src/i.test(h)&&s.triggerSourceset(i.src),T),i.load=()=>{var h=l.call(i);return Io(s)||(s.triggerSourceset(""),Ku(s)),h},i.currentSrc?s.triggerSourceset(i.currentSrc):Io(s)||Ku(s),i.resetSourceset_=()=>{i.resetSourceset_=null,i.load=l,i.setAttribute=o,Object.defineProperty(i,"src",a),i.resetSourceWatch_&&i.resetSourceWatch_()}}}}let Io=s=>{var t=s.el();if(t.hasAttribute("src"))s.triggerSourceset(t.src);else{var i=s.$$("source"),a=[];let l="";if(!i.length)return!1;for(let h=0;h<i.length;h++){var o=i[h].src;o&&a.indexOf(o)===-1&&a.push(o)}if(!a.length)return!1;a.length===1&&(l=a[0]),s.triggerSourceset(l)}return!0},tf=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(s){for(var t=document.createElement(this.nodeName.toLowerCase()),i=(t.innerHTML=s,document.createDocumentFragment());t.childNodes.length;)i.appendChild(t.childNodes[0]);return this.innerText="",window.Element.prototype.appendChild.call(this,i),this.innerHTML}}),Yu=(s,t)=>{let i={};for(let a=0;a<s.length&&!((i=Object.getOwnPropertyDescriptor(s[a],t))&&i.set&&i.get);a++);return i.enumerable=!0,i.configurable=!0,i},nf=s=>Yu([s.el(),window.HTMLMediaElement.prototype,window.Element.prototype,tf],"innerHTML"),rf=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?tu(window.Element.prototype.getAttribute.call(this,"src")):""},set(s){return window.Element.prototype.setAttribute.call(this,"src",s),s}});class mt extends Ut{constructor(t,i){super(t,i),i=t.source;let a=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&this.el_.tagName==="VIDEO",i&&(this.el_.currentSrc!==i.src||t.tag&&t.tag.initNetworkState_===3)?this.setSource(i):this.handleLateInit_(this.el_),t.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){var o=this.el_.childNodes;let T=o.length;for(var l=[];T--;){var h=o[T];h.nodeName.toLowerCase()==="track"&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(h),this.remoteTextTracks().addTrack(h.track),this.textTracks().addTrack(h.track),a||this.el_.hasAttribute("crossorigin")||!qs(h.src)||(a=!0)):l.push(h))}for(let B=0;B<l.length;B++)this.el_.removeChild(l[B])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&a&&S.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),this.restoreMetadataTracksInIOSNativePlayer_(),(me||Ne)&&t.nativeControlsForTouch===!0&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),mt.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){ef(this)}restoreMetadataTracksInIOSNativePlayer_(){let t=this.textTracks(),i,a=()=>{i=[];for(let h=0;h<t.length;h++){var l=t[h];l.kind==="metadata"&&i.push({track:l,storedMode:l.mode})}},o=(a(),t.addEventListener("change",a),this.on("dispose",()=>t.removeEventListener("change",a)),()=>{for(let h=0;h<i.length;h++){var l=i[h];l.track.mode==="disabled"&&l.track.mode!==l.storedMode&&(l.track.mode=l.storedMode)}t.removeEventListener("change",o)});this.on("webkitbeginfullscreen",()=>{t.removeEventListener("change",a),t.removeEventListener("change",o),t.addEventListener("change",o)}),this.on("webkitendfullscreen",()=>{t.removeEventListener("change",a),t.addEventListener("change",a),t.removeEventListener("change",o)})}overrideNative_(t,i){if(i===this[`featuresNative${t}Tracks`]){let a=t.toLowerCase();this[a+"TracksListeners_"]&&Object.keys(this[a+"TracksListeners_"]).forEach(o=>{this.el()[a+"Tracks"].removeEventListener(o,this[a+"TracksListeners_"][o])}),this[`featuresNative${t}Tracks`]=!i,this[a+"TracksListeners_"]=null,this.proxyNativeTracksForType_(a)}}overrideNativeAudioTracks(t){this.overrideNative_("Audio",t)}overrideNativeVideoTracks(t){this.overrideNative_("Video",t)}proxyNativeTracksForType_(t){var i=ln[t];let a=this.el()[i.getterName],o=this[i.getterName]();if(this[`featuresNative${i.capitalName}Tracks`]&&a&&a.addEventListener){let l={change:T=>{var B={type:"change",target:o,currentTarget:o,srcElement:o};o.trigger(B),t==="text"&&this[fr.remoteText.getterName]().trigger(B)},addtrack(T){o.addTrack(T.track)},removetrack(T){o.removeTrack(T.track)}},h=function(){var T=[];for(let B=0;B<o.length;B++){let G=!1;for(let H=0;H<a.length;H++)if(a[H]===o[B]){G=!0;break}G||T.push(o[B])}for(;T.length;)o.removeTrack(T.shift())};this[i.getterName+"Listeners_"]=l,Object.keys(l).forEach(T=>{let B=l[T];a.addEventListener(T,B),this.on("dispose",G=>a.removeEventListener(T,B))}),this.on("loadstart",h),this.on("dispose",T=>this.off("loadstart",h))}}proxyNativeTracks_(){ln.names.forEach(t=>{this.proxyNativeTracksForType_(t)})}createEl(){let t=this.options_.tag;t&&(this.options_.playerElIngest||this.movingMediaElementInDOM)||(t?(i=t.cloneNode(!0),t.parentNode&&t.parentNode.insertBefore(i,t),mt.disposeMediaElement(t),t=i):(t=document.createElement("video"),i=Z({},this.options_.tag&&Rt(this.options_.tag)),me&&this.options_.nativeControlsForTouch===!0||delete i.controls,$t(t,Object.assign(i,{id:this.options_.techId,class:"vjs-tech"}))),t.playerId=this.options_.playerId),typeof this.options_.preload<"u"&&et(t,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(t.disablePictureInPicture=this.options_.disablePictureInPicture);var i,a=["loop","muted","playsinline","autoplay"];for(let h=0;h<a.length;h++){var o=a[h],l=this.options_[o];typeof l<"u"&&(l?et(t,o,o):ct(t,o),t[o]=l)}return t}handleLateInit_(t){if(t.networkState!==0&&t.networkState!==3)if(t.readyState===0){let i=!1,a=function(){i=!0},o=(this.on("loadstart",a),function(){i||this.trigger("loadstart")});this.on("loadedmetadata",o),this.ready(function(){this.off("loadstart",a),this.off("loadedmetadata",o),i||this.trigger("loadstart")})}else{let i=["loadstart"];i.push("loadedmetadata"),2<=t.readyState&&i.push("loadeddata"),3<=t.readyState&&i.push("canplay"),4<=t.readyState&&i.push("canplaythrough"),this.ready(function(){i.forEach(function(a){this.trigger(a)},this)})}}setScrubbing(t){this.isScrubbing_=t}scrubbing(){return this.isScrubbing_}setCurrentTime(t){try{this.isScrubbing_&&this.el_.fastSeek&&we?this.el_.fastSeek(t):this.el_.currentTime=t}catch(i){S(i,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===1/0&&$&&U&&this.el_.currentTime===0){let t=()=>{0<this.el_.currentTime&&(this.el_.duration===1/0&&this.trigger("durationchange"),this.off("timeupdate",t))};return this.on("timeupdate",t),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if("webkitDisplayingFullscreen"in this.el_){let t=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},i=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",i),this.on("dispose",()=>{this.off("webkitbeginfullscreen",i),this.off("webkitendfullscreen",t)})}}supportsFullScreen(){return typeof this.el_.webkitEnterFullScreen=="function"}enterFullScreen(){let t=this.el_;if(t.paused&&t.networkState<=t.HAVE_METADATA)vn(this.el_.play()),this.setTimeout(function(){t.pause();try{t.webkitEnterFullScreen()}catch(i){this.trigger("fullscreenerror",i)}},0);else try{t.webkitEnterFullScreen()}catch(i){this.trigger("fullscreenerror",i)}}exitFullScreen(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",new Error("The video is not fullscreen"))}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(t){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(t):super.requestVideoFrameCallback(t)}cancelVideoFrameCallback(t){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(t):super.cancelVideoFrameCallback(t)}src(t){if(t===void 0)return this.el_.src;this.setSrc(t)}addSourceElement(t,i){return t?(t={src:t},i&&(t.type=i),i=be("source",{},t),this.el_.appendChild(i),!0):(S.error("Invalid source URL."),!1)}removeSourceElement(t){if(t){var i;for(i of this.el_.querySelectorAll("source"))if(i.src===t)return this.el_.removeChild(i),!0;S.warn("No matching source element found with src: "+t)}else S.error("Source URL is required to remove the source element.");return!1}reset(){mt.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(t){this.el_.controls=!!t}addTextTrack(t,i,a){return this.featuresNativeTextTracks?this.el_.addTextTrack(t,i,a):super.addTextTrack(t,i,a)}createRemoteTextTrack(t){var i;return this.featuresNativeTextTracks?(i=document.createElement("track"),t.kind&&(i.kind=t.kind),t.label&&(i.label=t.label),(t.language||t.srclang)&&(i.srclang=t.language||t.srclang),t.default&&(i.default=t.default),t.id&&(i.id=t.id),t.src&&(i.src=t.src),i):super.createRemoteTextTrack(t)}addRemoteTextTrack(t,i){return t=super.addRemoteTextTrack(t,i),this.featuresNativeTextTracks&&this.el().appendChild(t),t}removeRemoteTextTrack(t){if(super.removeRemoteTextTrack(t),this.featuresNativeTextTracks){var i=this.$$("track");let a=i.length;for(;a--;)t!==i[a]&&t!==i[a].track||this.el().removeChild(i[a])}}getVideoPlaybackQuality(){var t;return typeof this.el().getVideoPlaybackQuality=="function"?this.el().getVideoPlaybackQuality():(t={},typeof this.el().webkitDroppedFrameCount<"u"&&typeof this.el().webkitDecodedFrameCount<"u"&&(t.droppedVideoFrames=this.el().webkitDroppedFrameCount,t.totalVideoFrames=this.el().webkitDecodedFrameCount),window.performance&&(t.creationTime=window.performance.now()),t)}}ee(mt,"TEST_VID",function(){var s,t;if(We())return s=document.createElement("video"),(t=document.createElement("track")).kind="captions",t.srclang="en",t.label="English",s.appendChild(t),s}),mt.isSupported=function(){try{mt.TEST_VID.volume=.5}catch{return!1}return!(!mt.TEST_VID||!mt.TEST_VID.canPlayType)},mt.canPlayType=function(s){return mt.TEST_VID.canPlayType(s)},mt.canPlaySource=function(s,t){return mt.canPlayType(s.type)},mt.canControlVolume=function(){try{let t=mt.TEST_VID.volume;mt.TEST_VID.volume=t/2+.1;var s=t!==mt.TEST_VID.volume;return s&&Re?(window.setTimeout(()=>{mt&&mt.prototype&&(mt.prototype.featuresVolumeControl=t!==mt.TEST_VID.volume)}),!1):s}catch{return!1}},mt.canMuteVolume=function(){try{var s=mt.TEST_VID.muted;return mt.TEST_VID.muted=!s,mt.TEST_VID.muted?et(mt.TEST_VID,"muted","muted"):ct(mt.TEST_VID,"muted"),s!==mt.TEST_VID.muted}catch{return!1}},mt.canControlPlaybackRate=function(){if($&&U&&re<58)return!1;try{var s=mt.TEST_VID.playbackRate;return mt.TEST_VID.playbackRate=s/2+.1,s!==mt.TEST_VID.playbackRate}catch{return!1}},mt.canOverrideAttributes=function(){try{var s=()=>{};Object.defineProperty(document.createElement("video"),"src",{get:s,set:s}),Object.defineProperty(document.createElement("audio"),"src",{get:s,set:s}),Object.defineProperty(document.createElement("video"),"innerHTML",{get:s,set:s}),Object.defineProperty(document.createElement("audio"),"innerHTML",{get:s,set:s})}catch{return!1}return!0},mt.supportsNativeTextTracks=function(){return we||Re&&U},mt.supportsNativeVideoTracks=function(){return!(!mt.TEST_VID||!mt.TEST_VID.videoTracks)},mt.supportsNativeAudioTracks=function(){return!(!mt.TEST_VID||!mt.TEST_VID.audioTracks)},mt.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([s,t]){ee(mt.prototype,s,()=>mt[t](),!0)}),mt.prototype.featuresVolumeControl=mt.canControlVolume(),mt.prototype.movingMediaElementInDOM=!Re,mt.prototype.featuresFullscreenResize=!0,mt.prototype.featuresProgressEvents=!0,mt.prototype.featuresTimeupdateEvents=!0,mt.prototype.featuresVideoFrameCallback=!(!mt.TEST_VID||!mt.TEST_VID.requestVideoFrameCallback),mt.disposeMediaElement=function(s){if(s){for(s.parentNode&&s.parentNode.removeChild(s);s.hasChildNodes();)s.removeChild(s.firstChild);if(s.removeAttribute("src"),typeof s.load=="function")try{s.load()}catch{}}},mt.resetMediaElement=function(s){if(s){var t=s.querySelectorAll("source");let i=t.length;for(;i--;)s.removeChild(t[i]);if(s.removeAttribute("src"),typeof s.load=="function")try{s.load()}catch{}}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(s){mt.prototype[s]=function(){return this.el_[s]||this.el_.hasAttribute(s)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(s){mt.prototype["set"+_i(s)]=function(t){(this.el_[s]=t)?this.el_.setAttribute(s,s):this.el_.removeAttribute(s)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(s){mt.prototype[s]=function(){return this.el_[s]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(s){mt.prototype["set"+_i(s)]=function(t){this.el_[s]=t}}),["pause","load","play"].forEach(function(s){mt.prototype[s]=function(){return this.el_[s]()}}),Ut.withSourceHandlers(mt),mt.nativeSourceHandler={},mt.nativeSourceHandler.canPlayType=function(s){try{return mt.TEST_VID.canPlayType(s)}catch{return""}},mt.nativeSourceHandler.canHandleSource=function(s,t){return s.type?mt.nativeSourceHandler.canPlayType(s.type):s.src?(s=eo(s.src),mt.nativeSourceHandler.canPlayType("video/"+s)):""},mt.nativeSourceHandler.handleSource=function(s,t,i){t.setSrc(s.src)},mt.nativeSourceHandler.dispose=function(){},mt.registerSourceHandler(mt.nativeSourceHandler),Ut.registerTech("Html5",mt);let Zu=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Oo={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Do=["tiny","xsmall","small","medium","large","xlarge","huge"],Js={},sf=(Do.forEach(s=>{var t=s.charAt(0)==="x"?"x-"+s.substring(1):s;Js[s]="vjs-layout-"+t}),{tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0});class ui extends Ze{constructor(t,i,l){if(t.id=t.id||i.id||"vjs_video_"+Be++,(i=Object.assign(ui.getTagSettings(t),i)).initChildren=!1,i.createEl=!1,i.evented=!1,i.reportTouchActivity=!1,i.language||(o=t.closest("[lang]"))&&(i.language=o.getAttribute("lang")),super(null,i,l),this.boundDocumentFullscreenChange_=h=>this.documentFullscreenChange_(h),this.boundFullWindowOnEscKey_=h=>this.fullWindowOnEscKey(h),this.boundUpdateStyleEl_=h=>this.updateStyleEl_(h),this.boundApplyInitTime_=h=>this.applyInitTime_(h),this.boundUpdateCurrentBreakpoint_=h=>this.updateCurrentBreakpoint_(h),this.boundHandleTechClick_=h=>this.handleTechClick_(h),this.boundHandleTechDoubleClick_=h=>this.handleTechDoubleClick_(h),this.boundHandleTechTouchStart_=h=>this.handleTechTouchStart_(h),this.boundHandleTechTouchMove_=h=>this.handleTechTouchMove_(h),this.boundHandleTechTouchEnd_=h=>this.handleTechTouchEnd_(h),this.boundHandleTechTap_=h=>this.handleTechTap_(h),this.boundUpdatePlayerHeightOnAudioOnlyMode_=h=>this.updatePlayerHeightOnAudioOnlyMode_(h),this.isFullscreen_=!1,this.log=u(this.id_),this.fsApi_=E,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={controlBarHeight:null,playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=t,this.tagAttributes=t&&Rt(t),this.language(this.options_.language),i.languages){let h={};Object.getOwnPropertyNames(i.languages).forEach(function(T){h[T.toLowerCase()]=i.languages[T]}),this.languages_=h}else this.languages_=ui.prototype.options_.languages;this.resetCache_(),this.poster_=i.poster||"",this.controls_=!!i.controls,t.controls=!1,t.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],t.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),i.plugins&&Object.keys(i.plugins).forEach(h=>{if(typeof this[h]!="function")throw new Error(`plugin "${h}" does not exist`)}),this.scrubbing_=!1,this.el_=this.createEl(),Wa(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(Vt(document,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);var o=Z(this.options_),l=(i.plugins&&Object.keys(i.plugins).forEach(h=>{this[h](i.plugins[h])}),i.debug&&this.debug(!0),this.options_.playerOptions=o,this.middleware_=[],this.playbackRates(i.playbackRates),i.experimentalSvgIcons&&((l=new window.DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg">
  <defs>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play">
      <path d="M16 10v28l22-14z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-pause">
      <path d="M12 38h8V10h-8v28zm16-28v28h8V10h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-audio">
      <path d="M24 2C14.06 2 6 10.06 6 20v14c0 3.31 2.69 6 6 6h6V24h-8v-4c0-7.73 6.27-14 14-14s14 6.27 14 14v4h-8v16h6c3.31 0 6-2.69 6-6V20c0-9.94-8.06-18-18-18z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-captions">
      <path d="M38 8H10c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h28c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM22 22h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2zm14 0h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-subtitles">
      <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-enter">
      <path d="M14 28h-4v10h10v-4h-6v-6zm-4-8h4v-6h6v-4H10v10zm24 14h-6v4h10V28h-4v6zm-6-24v4h6v6h4V10H28z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-exit">
      <path d="M10 32h6v6h4V28H10v4zm6-16h-6v4h10V10h-4v6zm12 22h4v-6h6v-4H28v10zm4-22v-6h-4v10h10v-4h-6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play-circle">
      <path d="M20 33l12-9-12-9v18zm4-29C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-mute">
      <path d="M33 24c0-3.53-2.04-6.58-5-8.05v4.42l4.91 4.91c.06-.42.09-.85.09-1.28zm5 0c0 1.88-.41 3.65-1.08 5.28l3.03 3.03C41.25 29.82 42 27 42 24c0-8.56-5.99-15.72-14-17.54v4.13c5.78 1.72 10 7.07 10 13.41zM8.55 6L6 8.55 15.45 18H6v12h8l10 10V26.55l8.51 8.51c-1.34 1.03-2.85 1.86-4.51 2.36v4.13a17.94 17.94 0 0 0 7.37-3.62L39.45 42 42 39.45l-18-18L8.55 6zM24 8l-4.18 4.18L24 16.36V8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-low">
      <path d="M14 18v12h8l10 10V8L22 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-medium">
      <path d="M37 24c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zm-27-6v12h8l10 10V8L18 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-high">
      <path d="M6 18v12h8l10 10V8L14 18H6zm27 6c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zM28 6.46v4.13c5.78 1.72 10 7.07 10 13.41s-4.22 11.69-10 13.41v4.13c8.01-1.82 14-8.97 14-17.54S36.01 8.28 28 6.46z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-spinner">
      <path d="M18.8 21l9.53-16.51C26.94 4.18 25.49 4 24 4c-4.8 0-9.19 1.69-12.64 4.51l7.33 12.69.11-.2zm24.28-3c-1.84-5.85-6.3-10.52-11.99-12.68L23.77 18h19.31zm.52 2H28.62l.58 1 9.53 16.5C41.99 33.94 44 29.21 44 24c0-1.37-.14-2.71-.4-4zm-26.53 4l-7.8-13.5C6.01 14.06 4 18.79 4 24c0 1.37.14 2.71.4 4h14.98l-2.31-4zM4.92 30c1.84 5.85 6.3 10.52 11.99 12.68L24.23 30H4.92zm22.54 0l-7.8 13.51c1.4.31 2.85.49 4.34.49 4.8 0 9.19-1.69 12.64-4.51L29.31 26.8 27.46 30z"></path>
    </symbol>
    <symbol viewBox="0 0 24 24" id="vjs-icon-hd">
      <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-chapters">
      <path d="M6 26h4v-4H6v4zm0 8h4v-4H6v4zm0-16h4v-4H6v4zm8 8h28v-4H14v4zm0 8h28v-4H14v4zm0-20v4h28v-4H14z"></path>
    </symbol>
    <symbol viewBox="0 0 40 40" id="vjs-icon-downloading">
      <path d="M18.208 36.875q-3.208-.292-5.979-1.729-2.771-1.438-4.812-3.729-2.042-2.292-3.188-5.229-1.146-2.938-1.146-6.23 0-6.583 4.334-11.416 4.333-4.834 10.833-5.5v3.166q-5.167.75-8.583 4.646Q6.25 14.75 6.25 19.958q0 5.209 3.396 9.104 3.396 3.896 8.562 4.646zM20 28.417L11.542 20l2.083-2.083 4.917 4.916v-11.25h2.916v11.25l4.875-4.916L28.417 20zm1.792 8.458v-3.167q1.833-.25 3.541-.958 1.709-.708 3.167-1.875l2.333 2.292q-1.958 1.583-4.25 2.541-2.291.959-4.791 1.167zm6.791-27.792q-1.541-1.125-3.25-1.854-1.708-.729-3.541-1.021V3.042q2.5.25 4.77 1.208 2.271.958 4.271 2.5zm4.584 21.584l-2.25-2.25q1.166-1.5 1.854-3.209.687-1.708.937-3.541h3.209q-.292 2.5-1.229 4.791-.938 2.292-2.521 4.209zm.541-12.417q-.291-1.833-.958-3.562-.667-1.73-1.833-3.188l2.375-2.208q1.541 1.916 2.458 4.208.917 2.292 1.167 4.75z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download">
      <path d="M10.8 40.55q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h26.35v-7.7h3.4v7.7q0 1.4-1 2.4t-2.4 1zM24 32.1L13.9 22.05l2.45-2.45 5.95 5.95V7.15h3.4v18.4l5.95-5.95 2.45 2.45z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-done">
      <path d="M9.8 40.5v-3.45h28.4v3.45zm9.2-9.05L7.4 19.85l2.45-2.35L19 26.65l19.2-19.2 2.4 2.4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-off">
      <path d="M4.9 4.75L43.25 43.1 41 45.3l-4.75-4.75q-.05.05-.075.025-.025-.025-.075-.025H10.8q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h22.05l-7-7-1.85 1.8L13.9 21.9l1.85-1.85L2.7 7zm26.75 14.7l2.45 2.45-3.75 3.8-2.45-2.5zM25.7 7.15V21.1l-3.4-3.45V7.15z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-share">
      <path d="M36 32.17c-1.52 0-2.89.59-3.93 1.54L17.82 25.4c.11-.45.18-.92.18-1.4s-.07-.95-.18-1.4l14.1-8.23c1.07 1 2.5 1.62 4.08 1.62 3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6c0 .48.07.95.18 1.4l-14.1 8.23c-1.07-1-2.5-1.62-4.08-1.62-3.31 0-6 2.69-6 6s2.69 6 6 6c1.58 0 3.01-.62 4.08-1.62l14.25 8.31c-.1.42-.16.86-.16 1.31A5.83 5.83 0 1 0 36 32.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cog">
      <path d="M38.86 25.95c.08-.64.14-1.29.14-1.95s-.06-1.31-.14-1.95l4.23-3.31c.38-.3.49-.84.24-1.28l-4-6.93c-.25-.43-.77-.61-1.22-.43l-4.98 2.01c-1.03-.79-2.16-1.46-3.38-1.97L29 4.84c-.09-.47-.5-.84-1-.84h-8c-.5 0-.91.37-.99.84l-.75 5.3a14.8 14.8 0 0 0-3.38 1.97L9.9 10.1a1 1 0 0 0-1.22.43l-4 6.93c-.25.43-.14.97.24 1.28l4.22 3.31C9.06 22.69 9 23.34 9 24s.06 1.31.14 1.95l-4.22 3.31c-.38.3-.49.84-.24 1.28l4 6.93c.25.43.77.61 1.22.43l4.98-2.01c1.03.79 2.16 1.46 3.38 1.97l.75 5.3c.08.47.49.84.99.84h8c.5 0 .91-.37.99-.84l.75-5.3a14.8 14.8 0 0 0 3.38-1.97l4.98 2.01a1 1 0 0 0 1.22-.43l4-6.93c.25-.43.14-.97-.24-1.28l-4.22-3.31zM24 31c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-square">
      <path d="M36 8H12c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h24c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zm0 28H12V12h24v24z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle">
      <circle cx="24" cy="24" r="20"></circle>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-outline">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-inner-circle">
      <path d="M24 4C12.97 4 4 12.97 4 24s8.97 20 20 20 20-8.97 20-20S35.03 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16zm6-16c0 3.31-2.69 6-6 6s-6-2.69-6-6 2.69-6 6-6 6 2.69 6 6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cancel">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm10 27.17L31.17 34 24 26.83 16.83 34 14 31.17 21.17 24 14 16.83 16.83 14 24 21.17 31.17 14 34 16.83 26.83 24 34 31.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-replay">
      <path d="M24 10V2L14 12l10 10v-8c6.63 0 12 5.37 12 12s-5.37 12-12 12-12-5.37-12-12H8c0 8.84 7.16 16 16 16s16-7.16 16-16-7.16-16-16-16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-repeat">
      <path d="M14 14h20v6l8-8-8-8v6H10v12h4v-8zm20 20H14v-6l-8 8 8 8v-6h24V26h-4v8z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-5">
      <path d="M17.689 98l-8.697 8.696 8.697 8.697 2.486-2.485-4.32-4.319h1.302c4.93 0 9.071 1.722 12.424 5.165 3.352 3.443 5.029 7.638 5.029 12.584h3.55c0-2.958-.553-5.73-1.658-8.313-1.104-2.583-2.622-4.841-4.555-6.774-1.932-1.932-4.19-3.45-6.773-4.555-2.584-1.104-5.355-1.657-8.313-1.657H15.5l4.615-4.615zm-8.08 21.659v13.861h11.357v5.008H9.609V143h12.7c.834 0 1.55-.298 2.146-.894.596-.597.895-1.31.895-2.145v-7.781c0-.835-.299-1.55-.895-2.147a2.929 2.929 0 0 0-2.147-.894h-8.227v-5.096H25.35v-4.384z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-10">
      <path d="M42.315 125.63c0-4.997-1.694-9.235-5.08-12.713-3.388-3.479-7.571-5.218-12.552-5.218h-1.315l4.363 4.363-2.51 2.51-8.787-8.786L25.221 97l2.45 2.45-4.662 4.663h1.375c2.988 0 5.788.557 8.397 1.673 2.61 1.116 4.892 2.65 6.844 4.602 1.953 1.953 3.487 4.234 4.602 6.844 1.116 2.61 1.674 5.41 1.674 8.398zM8.183 142v-19.657H3.176V117.8h9.643V142zm13.63 0c-1.156 0-2.127-.393-2.912-1.178-.778-.778-1.168-1.746-1.168-2.902v-16.04c0-1.156.393-2.127 1.178-2.912.779-.779 1.746-1.168 2.902-1.168h7.696c1.156 0 2.126.392 2.911 1.177.779.78 1.168 1.747 1.168 2.903v16.04c0 1.156-.392 2.127-1.177 2.912-.779.779-1.746 1.168-2.902 1.168zm.556-4.636h6.583v-15.02H22.37z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-30">
      <path d="M26.047 97l-8.733 8.732 8.733 8.733 2.496-2.494-4.336-4.338h1.307c4.95 0 9.108 1.73 12.474 5.187 3.367 3.458 5.051 7.668 5.051 12.635h3.565c0-2.97-.556-5.751-1.665-8.346-1.109-2.594-2.633-4.862-4.574-6.802-1.94-1.941-4.208-3.466-6.803-4.575-2.594-1.109-5.375-1.664-8.345-1.664H23.85l4.634-4.634zM2.555 117.531v4.688h10.297v5.25H5.873v4.687h6.979v5.156H2.555V142H13.36c1.061 0 1.95-.395 2.668-1.186.718-.79 1.076-1.772 1.076-2.94v-16.218c0-1.168-.358-2.149-1.076-2.94-.717-.79-1.607-1.185-2.668-1.185zm22.482.14c-1.149 0-2.11.39-2.885 1.165-.78.78-1.172 1.744-1.172 2.893v15.943c0 1.149.388 2.11 1.163 2.885.78.78 1.745 1.172 2.894 1.172h7.649c1.148 0 2.11-.388 2.884-1.163.78-.78 1.17-1.745 1.17-2.894v-15.943c0-1.15-.386-2.111-1.16-2.885-.78-.78-1.746-1.172-2.894-1.172zm.553 4.518h6.545v14.93H25.59z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-5">
      <path d="M29.508 97l-2.431 2.43 4.625 4.625h-1.364c-2.965 0-5.742.554-8.332 1.66-2.589 1.107-4.851 2.629-6.788 4.566-1.937 1.937-3.458 4.2-4.565 6.788-1.107 2.59-1.66 5.367-1.66 8.331h3.557c0-4.957 1.68-9.16 5.04-12.611 3.36-3.45 7.51-5.177 12.451-5.177h1.304l-4.326 4.33 2.49 2.49 8.715-8.716zm-9.783 21.61v13.89h11.382v5.018H19.725V142h12.727a2.93 2.93 0 0 0 2.15-.896 2.93 2.93 0 0 0 .896-2.15v-7.798c0-.837-.299-1.554-.896-2.152a2.93 2.93 0 0 0-2.15-.896h-8.245V123h11.29v-4.392z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-10">
      <path d="M23.119 97l-2.386 2.383 4.538 4.538h-1.339c-2.908 0-5.633.543-8.173 1.63-2.54 1.085-4.76 2.577-6.66 4.478-1.9 1.9-3.392 4.12-4.478 6.66-1.085 2.54-1.629 5.264-1.629 8.172h3.49c0-4.863 1.648-8.986 4.944-12.372 3.297-3.385 7.368-5.078 12.216-5.078h1.279l-4.245 4.247 2.443 2.442 8.55-8.55zm-9.52 21.45v4.42h4.871V142h4.513v-23.55zm18.136 0c-1.125 0-2.066.377-2.824 1.135-.764.764-1.148 1.709-1.148 2.834v15.612c0 1.124.38 2.066 1.139 2.824.764.764 1.708 1.145 2.833 1.145h7.489c1.125 0 2.066-.378 2.824-1.136.764-.764 1.145-1.709 1.145-2.833v-15.612c0-1.125-.378-2.067-1.136-2.825-.764-.764-1.708-1.145-2.833-1.145zm.54 4.42h6.408v14.617h-6.407z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-30">
      <path d="M25.549 97l-2.437 2.434 4.634 4.635H26.38c-2.97 0-5.753.555-8.347 1.664-2.594 1.109-4.861 2.633-6.802 4.574-1.94 1.94-3.465 4.207-4.574 6.802-1.109 2.594-1.664 5.377-1.664 8.347h3.565c0-4.967 1.683-9.178 5.05-12.636 3.366-3.458 7.525-5.187 12.475-5.187h1.307l-4.335 4.338 2.495 2.494 8.732-8.732zm-11.553 20.53v4.689h10.297v5.249h-6.978v4.688h6.978v5.156H13.996V142h10.808c1.06 0 1.948-.395 2.666-1.186.718-.79 1.077-1.771 1.077-2.94v-16.217c0-1.169-.36-2.15-1.077-2.94-.718-.79-1.605-1.186-2.666-1.186zm21.174.168c-1.149 0-2.11.389-2.884 1.163-.78.78-1.172 1.745-1.172 2.894v15.942c0 1.15.388 2.11 1.162 2.885.78.78 1.745 1.17 2.894 1.17h7.649c1.149 0 2.11-.386 2.885-1.16.78-.78 1.17-1.746 1.17-2.895v-15.942c0-1.15-.387-2.11-1.161-2.885-.78-.78-1.745-1.172-2.894-1.172zm.552 4.516h6.542v14.931h-6.542z"></path>
    </symbol>
    <symbol viewBox="0 0 512 512" id="vjs-icon-audio-description">
      <g fill-rule="evenodd"><path d="M227.29 381.351V162.993c50.38-1.017 89.108-3.028 117.631 17.126 27.374 19.342 48.734 56.965 44.89 105.325-4.067 51.155-41.335 94.139-89.776 98.475-24.085 2.155-71.972 0-71.972 0s-.84-1.352-.773-2.568m48.755-54.804c31.43 1.26 53.208-16.633 56.495-45.386 4.403-38.51-21.188-63.552-58.041-60.796v103.612c-.036 1.466.575 2.22 1.546 2.57"></path><path d="M383.78 381.328c13.336 3.71 17.387-11.06 23.215-21.408 12.722-22.571 22.294-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.226 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M425.154 381.328c13.336 3.71 17.384-11.061 23.215-21.408 12.721-22.571 22.291-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.511c-.586 3.874 2.226 7.315 3.866 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M466.26 381.328c13.337 3.71 17.385-11.061 23.216-21.408 12.722-22.571 22.292-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.225 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894M4.477 383.005H72.58l18.573-28.484 64.169-.135s.065 19.413.065 28.62h48.756V160.307h-58.816c-5.653 9.537-140.85 222.697-140.85 222.697zm152.667-145.282v71.158l-40.453-.27 40.453-70.888z"></path></g>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-next-item">
      <path d="M12 36l17-12-17-12v24zm20-24v24h4V12h-4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-previous-item">
      <path d="M12 12h4v24h-4zm7 12l17 12V12z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-shuffle">
      <path d="M21.17 18.34L10.83 8 8 10.83l10.34 10.34 2.83-2.83zM29 8l4.09 4.09L8 37.17 10.83 40l25.09-25.09L40 19V8H29zm.66 18.83l-2.83 2.83 6.26 6.26L29 40h11V29l-4.09 4.09-6.25-6.26z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cast">
      <path d="M42 6H6c-2.21 0-4 1.79-4 4v6h4v-6h36v28H28v4h14c2.21 0 4-1.79 4-4V10c0-2.21-1.79-4-4-4zM2 36v6h6c0-3.31-2.69-6-6-6zm0-8v4c5.52 0 10 4.48 10 10h4c0-7.73-6.27-14-14-14zm0-8v4c9.94 0 18 8.06 18 18h4c0-12.15-9.85-22-22-22z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-picture-in-picture-enter">
      <path d="M38 22H22v11.99h16V22zm8 16V9.96C46 7.76 44.2 6 42 6H6C3.8 6 2 7.76 2 9.96V38c0 2.2 1.8 4 4 4h36c2.2 0 4-1.8 4-4zm-4 .04H6V9.94h36v28.1z"></path>
    </symbol>
    <symbol viewBox="0 0 22 18" id="vjs-icon-picture-in-picture-exit">
      <path d="M18 4H4v10h14V4zm4 12V1.98C22 .88 21.1 0 20 0H2C.9 0 0 .88 0 1.98V16c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H2V1.97h18v14.05z"></path>
      <path fill="none" d="M-1-3h24v24H-1z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-facebook">
      <path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759H734V905H479V609h255V391q0-186 104-288.5T1115 0q147 0 228 12z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-linkedin">
      <path d="M477 625v991H147V625h330zm21-306q1 73-50.5 122T312 490h-2q-82 0-132-49t-50-122q0-74 51.5-122.5T314 148t133 48.5T498 319zm1166 729v568h-329v-530q0-105-40.5-164.5T1168 862q-63 0-105.5 34.5T999 982q-11 30-11 81v553H659q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5T1285 602q171 0 275 113.5t104 332.5z"></path>
    </symbol>
    <symbol viewBox="0 0 1200 1227" id="vjs-icon-twitter">
      <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z"/>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-tumblr">
      <path d="M1328 1329l80 237q-23 35-111 66t-177 32q-104 2-190.5-26T787 1564t-95-106-55.5-120-16.5-118V676H452V461q72-26 129-69.5t91-90 58-102 34-99T779 12q1-5 4.5-8.5T791 0h244v424h333v252h-334v518q0 30 6.5 56t22.5 52.5 49.5 41.5 81.5 14q78-2 134-29z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-pinterest">
      <path d="M1664 896q0 209-103 385.5T1281.5 1561 896 1664q-111 0-218-32 59-93 78-164 9-34 54-211 20 39 73 67.5t114 28.5q121 0 216-68.5t147-188.5 52-270q0-114-59.5-214T1180 449t-255-63q-105 0-196 29t-154.5 77-109 110.5-67 129.5T377 866q0 104 40 183t117 111q30 12 38-20 2-7 8-31t8-30q6-23-11-43-51-61-51-151 0-151 104.5-259.5T904 517q151 0 235.5 82t84.5 213q0 170-68.5 289T980 1220q-61 0-98-43.5T859 1072q8-35 26.5-93.5t30-103T927 800q0-50-27-83t-77-33q-62 0-105 57t-43 142q0 73 25 122l-99 418q-17 70-13 177-206-91-333-281T128 896q0-209 103-385.5T510.5 231 896 128t385.5 103T1561 510.5 1664 896z"></path>
    </symbol>
  </defs>
</svg>`,"image/svg+xml")).querySelector("parsererror")?(S.warn("Failed to load SVG Icons. Falling back to Font Icons."),this.options_.experimentalSvgIcons=null):((o=l.documentElement).style.display="none",this.el_.appendChild(o),this.addClass("vjs-svg-icons-enabled"))),this.initChildren(),this.isAudio(t.nodeName.toLowerCase()==="audio"),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),i.spatialNavigation&&i.spatialNavigation.enabled&&(this.spatialNavigation=new Rp(this),this.addClass("vjs-spatial-navigation-enabled")),me&&this.addClass("vjs-touch-enabled"),Re||this.addClass("vjs-workinghover"),ui.players[this.id_]=this,A.split(".")[0]);this.addClass("vjs-v"+l),this.userActive(!0),this.reportUserActivity(),this.one("play",h=>this.listenForUserActivity_(h)),this.on("keydown",h=>this.handleKeyDown(h)),this.on("languagechange",h=>this.handleLanguagechange(h)),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){var t;this.trigger("dispose"),this.off("dispose"),kt(document,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),kt(document,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),ui.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),t=this,Gs.hasOwnProperty(t.id())&&delete Gs[t.id()],Vi.names.forEach(i=>{i=this[Vi[i].getterName](),i&&i.off&&i.off()}),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let t=this.tag,i,a=this.playerElIngest_=t.parentNode&&t.parentNode.hasAttribute&&t.parentNode.hasAttribute("data-vjs-player"),o=this.tag.tagName.toLowerCase()==="video-js",l=(a?i=this.el_=t.parentNode:o||(i=this.el_=super.createEl("div")),Rt(t));if(o){for(i=this.el_=t,t=this.tag=document.createElement("video");i.children.length;)t.appendChild(i.firstChild);Pt(i,"video-js")||yt(i,"video-js"),i.appendChild(t),a=this.playerElIngest_=i,Object.keys(i).forEach(H=>{try{t[H]=i[H]}catch{}})}t.setAttribute("tabindex","-1"),l.tabindex="-1",U&&he&&(t.setAttribute("role","application"),l.role="application"),t.removeAttribute("width"),t.removeAttribute("height"),"width"in l&&delete l.width,"height"in l&&delete l.height,Object.getOwnPropertyNames(l).forEach(function(H){o&&H==="class"||i.setAttribute(H,l[H]),o&&t.setAttribute(H,l[H])}),t.playerId=t.id,t.id+="_html5_api",t.className="vjs-tech",(t.player=i.player=this).addClass("vjs-paused");var h,T=["IS_SMART_TV","IS_TIZEN","IS_WEBOS","IS_ANDROID","IS_IPAD","IS_IPHONE","IS_CHROMECAST_RECEIVER"].filter(H=>ke[H]).map(H=>"vjs-device-"+H.substring(3).toLowerCase().replace(/\_/g,"-")),B=(this.addClass(...T),window.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&(this.styleEl_=Ye("vjs-styles-dimensions"),T=fe(".vjs-styles-defaults"),(h=fe("head")).insertBefore(this.styleEl_,T?T.nextSibling:h.firstChild)),this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin),t.getElementsByTagName("a"));for(let H=0;H<B.length;H++){var G=B.item(H);yt(G,"vjs-hidden"),G.setAttribute("hidden","hidden")}return t.initNetworkState_=t.networkState,t.parentNode&&!a&&t.parentNode.insertBefore(i,t),ut(t,i),this.children_.unshift(t),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=i}crossOrigin(t){if(typeof t>"u")return this.techGet_("crossOrigin");t!==null&&t!=="anonymous"&&t!=="use-credentials"?S.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${t}"`):(this.techCall_("setCrossOrigin",t),this.posterImage&&this.posterImage.crossOrigin(t))}width(t){return this.dimension("width",t)}height(t){return this.dimension("height",t)}dimension(t,i){var a,o=t+"_";if(i===void 0)return this[o]||0;i===""||i==="auto"?(this[o]=void 0,this.updateStyleEl_()):(a=parseFloat(i),isNaN(a)?S.error(`Improper value "${i}" supplied for for `+t):(this[o]=a,this.updateStyleEl_()))}fluid(t){if(t===void 0)return!!this.fluid_;var i;this.fluid_=!!t,On(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),t?(this.addClass("vjs-fluid"),this.fill(!1),t=this,i=()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)},On(t)?i():(t.eventedCallbacks||(t.eventedCallbacks=[]),t.eventedCallbacks.push(i))):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(t){if(t===void 0)return!!this.fill_;this.fill_=!!t,t?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(t){if(t===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(t))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=t,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(window.VIDEOJS_NO_DYNAMIC_STYLE===!0){let i=typeof this.width_=="number"?this.width_:this.options_.width,a=typeof this.height_=="number"?this.height_:this.options_.height;var t=this.tech_&&this.tech_.el();t&&(0<=i&&(t.width=i),0<=a)&&(t.height=a)}else{let i,a,o,l;t=(o=this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?this.aspectRatio_:0<this.videoWidth()?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),t=t[1]/t[0],i=this.width_!==void 0?this.width_:this.height_!==void 0?this.height_/t:this.videoWidth()||300,a=this.height_!==void 0?this.height_:i*t,l=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(l),ye(this.styleEl_,`
      .${l} {
        width: ${i}px;
        height: ${a}px;
      }

      .${l}.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: ${100*t}%;
      }
    `)}}loadTech_(t,i){this.tech_&&this.unloadTech_();var a=_i(t),o=t.charAt(0).toLowerCase()+t.slice(1);a!=="Html5"&&this.tag&&(Ut.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=a,this.isReady_=!1;let l=this.autoplay(),h={source:i,autoplay:l=typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay?!1:l,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+`_${o}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};if(Vi.names.forEach(T=>{T=Vi[T],h[T.getterName]=this[T.privateName]}),Object.assign(h,this.options_[a]),Object.assign(h,this.options_[o]),Object.assign(h,this.options_[t.toLowerCase()]),this.tag&&(h.tag=this.tag),i&&i.src===this.cache_.src&&0<this.cache_.currentTime&&(h.startTime=this.cache_.currentTime),o=Ut.getTech(t),!o)throw new Error(`No Tech named '${a}' exists! '${a}' should be registered using videojs.registerTech()'`);this.tech_=new o(h),this.tech_.ready(Kt(this,this.handleTechReady_),!0),ap(this.textTracksJson_||[],this.tech_),Zu.forEach(T=>{this.on(this.tech_,T,B=>this[`handleTech${_i(T)}_`](B))}),Object.keys(Oo).forEach(T=>{this.on(this.tech_,T,B=>{this.tech_.playbackRate()===0&&this.tech_.seeking()?this.queuedCallbacks_.push({callback:this[`handleTech${Oo[T]}_`].bind(this),event:B}):this[`handleTech${Oo[T]}_`](B)})}),this.on(this.tech_,"loadstart",T=>this.handleTechLoadStart_(T)),this.on(this.tech_,"sourceset",T=>this.handleTechSourceset_(T)),this.on(this.tech_,"waiting",T=>this.handleTechWaiting_(T)),this.on(this.tech_,"ended",T=>this.handleTechEnded_(T)),this.on(this.tech_,"seeking",T=>this.handleTechSeeking_(T)),this.on(this.tech_,"play",T=>this.handleTechPlay_(T)),this.on(this.tech_,"pause",T=>this.handleTechPause_(T)),this.on(this.tech_,"durationchange",T=>this.handleTechDurationChange_(T)),this.on(this.tech_,"fullscreenchange",(T,B)=>this.handleTechFullscreenChange_(T,B)),this.on(this.tech_,"fullscreenerror",(T,B)=>this.handleTechFullscreenError_(T,B)),this.on(this.tech_,"enterpictureinpicture",T=>this.handleTechEnterPictureInPicture_(T)),this.on(this.tech_,"leavepictureinpicture",T=>this.handleTechLeavePictureInPicture_(T)),this.on(this.tech_,"error",T=>this.handleTechError_(T)),this.on(this.tech_,"posterchange",T=>this.handleTechPosterChange_(T)),this.on(this.tech_,"textdata",T=>this.handleTechTextData_(T)),this.on(this.tech_,"ratechange",T=>this.handleTechRateChange_(T)),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||a==="Html5"&&this.tag||ut(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){Vi.names.forEach(t=>{t=Vi[t],this[t.privateName]=this[t.getterName]()}),this.textTracksJson_=sp(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(t){return t===void 0&&S.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_}version(){return{"video.js":A}}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()&&this.hasStarted(!1),this.trigger("loadstart"),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(t){if(this.tech_&&typeof t=="string"){var i=()=>{let o=this.muted(),l=(this.muted(!0),()=>{this.muted(o)});this.playTerminatedQueue_.push(l);var h=this.play();if(Jr(h))return h.catch(T=>{throw l(),new Error("Rejection at manualAutoplay. Restoring muted value. "+(T||""))})};let a;if(t!=="any"||this.muted()?a=t!=="muted"||this.muted()?this.play():i():Jr(a=this.play())&&(a=a.catch(i)),Jr(a))return a.then(()=>{this.trigger({type:"autoplay-success",autoplay:t})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:t})})}}updateSourceCaches_(o=""){let i=o,a="";typeof i!="string"&&(i=o.src,a=o.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],i&&!a&&(a=((G,H)=>{if(!H)return"";if(G.cache_.source.src===H&&G.cache_.source.type)return G.cache_.source.type;var se=G.cache_.sources.filter(_e=>_e.src===H);if(se.length)return se[0].type;var pe=G.$$("source");for(let _e=0;_e<pe.length;_e++){var ae=pe[_e];if(ae.type&&ae.src&&ae.src===H)return ae.type}return Ks(H)})(this,i)),this.cache_.source=Z({},o,{src:i,type:a});var o=this.cache_.sources.filter(G=>G.src&&G.src===i),l=[],h=this.$$("source"),T=[];for(let G=0;G<h.length;G++){var B=Rt(h[G]);l.push(B),B.src&&B.src===i&&T.push(B.src)}T.length&&!o.length?this.cache_.sources=l:o.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=i}handleTechSourceset_(t){if(!this.changingSrc_){let o=l=>this.updateSourceCaches_(l);var i=this.currentSource().src,a=t.src;(o=!i||/^blob:/.test(i)||!/^blob:/.test(a)||this.lastSource_&&(this.lastSource_.tech===a||this.lastSource_.player===i)?o:()=>{})(a),t.src||this.tech_.any(["sourceset","loadstart"],l=>{l.type!=="sourceset"&&(l=this.techGet_("currentSrc"),this.lastSource_.tech=l,this.updateSourceCaches_(l))})}this.lastSource_={player:this.currentSource().src,tech:t.src},this.trigger({src:t.src,type:"sourceset"})}hasStarted(t){if(t===void 0)return this.hasStarted_;t!==this.hasStarted_&&(this.hasStarted_=t,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){0<this.tech_.playbackRate()&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(t=>t.callback(t.event)),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");let t=this.currentTime(),i=()=>{t!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",i))};this.on("timeupdate",i)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(t){!this.controls_||this.options_!==void 0&&this.options_.userActions!==void 0&&this.options_.userActions.click!==void 0&&this.options_.userActions.click===!1||(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,t):this.paused()?vn(this.play()):this.pause())}handleTechDoubleClick_(t){!this.controls_||Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),i=>i.contains(t.target))||this.options_!==void 0&&this.options_.userActions!==void 0&&this.options_.userActions.doubleClick!==void 0&&this.options_.userActions.doubleClick===!1||(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,t):this.isInPictureInPicture()&&!document.pictureInPictureElement?this.exitPictureInPicture():this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(t){t.cancelable&&t.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(t){if(t=t.target.player,!t||t===this){t=this.el();let i=document[this.fsApi_.fullscreenElement]===t;!i&&t.matches&&(i=t.matches(":"+this.fsApi_.fullscreen)),this.isFullscreen(i)}}handleTechFullscreenChange_(t,i){i&&(i.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(i.isFullscreen))}handleTechFullscreenError_(t,i){this.trigger("fullscreenerror",i)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(t){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(t){this.isInPictureInPicture(!1)}handleTechError_(){var t=this.tech_.error();t&&this.error(t)}handleTechTextData_(){let t=1<arguments.length?arguments[1]:null;this.trigger("textdata",t)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(t,i){this.ready(function(){if(t in Op)return a=this.middleware_,this.tech_[t](a.reduce(co(t),i));if(t in yu)return gu(this.middleware_,this.tech_,t,i);var a;try{this.tech_&&this.tech_[t](i)}catch(o){throw S(o),o}},!0)}techGet_(t){if(this.tech_&&this.tech_.isReady_){if(t in Ip)return i=this.middleware_,a=this.tech_,i.reduceRight(co(t),a[t]());if(t in yu)return gu(this.middleware_,this.tech_,t);var i,a;try{return this.tech_[t]()}catch(o){throw this.tech_[t]===void 0?S(`Video.js: ${t} method not defined for ${this.techName_} playback technology.`,o):o.name==="TypeError"?(S(`Video.js: ${t} unavailable on ${this.techName_} playback technology element.`,o),this.tech_.isReady_=!1):S(o),o}}}play(){return new Promise(t=>{this.play_(t)})}play_(a=vn){this.playCallbacks_.push(a);var i,a=!!(!this.changingSrc_&&(this.src()||this.currentSrc())),o=!!(we||Re);this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),this.isReady_&&a?(i=this.techGet_("play"),o&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),i===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(i)):(this.waitToPlay_=l=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!a&&o&&this.load())}runPlayTerminatedQueue_(){var t=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],t.forEach(function(i){i()})}runPlayCallbacks_(t){var i=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],i.forEach(function(a){a(t)})}pause(){this.techCall_("pause")}paused(){return this.techGet_("paused")!==!1}played(){return this.techGet_("played")||hn(0,0)}scrubbing(t){if(typeof t>"u")return this.scrubbing_;this.scrubbing_=!!t,this.techCall_("setScrubbing",this.scrubbing_),t?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(t){if(t===void 0)return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime;t<0&&(t=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",t),this.cache_.initTime=0,isFinite(t)&&(this.cache_.currentTime=Number(t))):(this.cache_.initTime=t,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_))}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(t){if(t===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;(t=(t=parseFloat(t))<0?1/0:t)!==this.cache_.duration&&((this.cache_.duration=t)===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(t)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let t=this.techGet_("buffered");return t=t&&t.length?t:hn(0,0)}seekable(){let t=this.techGet_("seekable");return t=t&&t.length?t:hn(0,0)}seeking(){return this.techGet_("seeking")}ended(){return this.techGet_("ended")}networkState(){return this.techGet_("networkState")}readyState(){return this.techGet_("readyState")}bufferedPercent(){return Zl(this.buffered(),this.duration())}bufferedEnd(){var t=this.buffered(),i=this.duration();let a=t.end(t.length-1);return a=a>i?i:a}volume(t){let i;if(t===void 0)return i=parseFloat(this.techGet_("volume")),isNaN(i)?1:i;i=Math.max(0,Math.min(1,t)),this.cache_.volume=i,this.techCall_("setVolume",i),0<i&&this.lastVolume_(i)}muted(t){if(t===void 0)return this.techGet_("muted")||!1;this.techCall_("setMuted",t)}defaultMuted(t){return t!==void 0&&this.techCall_("setDefaultMuted",t),this.techGet_("defaultMuted")||!1}lastVolume_(t){if(t===void 0||t===0)return this.cache_.lastVolume;this.cache_.lastVolume=t}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(t){var i;if(t===void 0)return this.isFullscreen_;i=this.isFullscreen_,this.isFullscreen_=!!t,this.isFullscreen_!==i&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_()}requestFullscreen(t){this.isInPictureInPicture()&&this.exitPictureInPicture();let i=this;return new Promise((a,o)=>{function l(){i.off("fullscreenerror",T),i.off("fullscreenchange",h)}function h(){l(),a()}function T(G,H){l(),o(H)}i.one("fullscreenchange",h),i.one("fullscreenerror",T);var B=i.requestFullscreenHelper_(t);B&&(B.then(l,l),B.then(a,o))})}requestFullscreenHelper_(t){let i;if(this.fsApi_.prefixed||(i=this.options_.fullscreen&&this.options_.fullscreen.options||{},t!==void 0&&(i=t)),this.fsApi_.requestFullscreen)return(t=this.el_[this.fsApi_.requestFullscreen](i))&&t.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),t;this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){let t=this;return new Promise((i,a)=>{function o(){t.off("fullscreenerror",h),t.off("fullscreenchange",l)}function l(){o(),i()}function h(B,G){o(),a(G)}t.one("fullscreenchange",l),t.one("fullscreenerror",h);var T=t.exitFullscreenHelper_();T&&(T.then(o,o),T.then(i,a))})}exitFullscreenHelper_(){var t;if(this.fsApi_.requestFullscreen)return(t=document[this.fsApi_.exitFullscreen]())&&vn(t.then(()=>this.isFullscreen(!1))),t;this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=document.documentElement.style.overflow,Vt(document,"keydown",this.boundFullWindowOnEscKey_),document.documentElement.style.overflow="hidden",yt(document.body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(t){t.key==="Escape"&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,kt(document,"keydown",this.boundFullWindowOnEscKey_),document.documentElement.style.overflow=this.docOrigOverflow,At(document.body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(t){if(t===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",t),this.options_.disablePictureInPicture=t,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(t){if(t===void 0)return!!this.isInPictureInPicture_;this.isInPictureInPicture_=!!t,this.togglePictureInPictureClass_()}requestPictureInPicture(){if(this.options_.enableDocumentPictureInPicture&&window.documentPictureInPicture){let t=document.createElement(this.el().tagName);return t.classList=this.el().classList,t.classList.add("vjs-pip-container"),this.posterImage&&t.appendChild(this.posterImage.el().cloneNode(!0)),this.titleBar&&t.appendChild(this.titleBar.el().cloneNode(!0)),t.appendChild(be("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture"))),window.documentPictureInPicture.requestWindow({width:this.videoWidth(),height:this.videoHeight()}).then(i=>(Oe(i),this.el_.parentNode.insertBefore(t,this.el_),i.document.body.appendChild(this.el_),i.document.body.classList.add("vjs-pip-window"),this.player_.isInPictureInPicture(!0),this.player_.trigger({type:"enterpictureinpicture",pipWindow:i}),i.addEventListener("pagehide",a=>{a=a.target.querySelector(".video-js"),t.parentNode.replaceChild(a,t),this.player_.isInPictureInPicture(!1),this.player_.trigger("leavepictureinpicture")}),i))}return"pictureInPictureEnabled"in document&&this.disablePictureInPicture()===!1?this.techGet_("requestPictureInPicture"):Promise.reject("No PiP mode is available")}exitPictureInPicture(){return window.documentPictureInPicture&&window.documentPictureInPicture.window?(window.documentPictureInPicture.window.close(),Promise.resolve()):"pictureInPictureEnabled"in document?document.exitPictureInPicture():void 0}handleKeyDown(t){var i,a,o=this.options_.userActions;o&&o.hotkeys&&(i=this.el_.ownerDocument.activeElement,a=i.tagName.toLowerCase(),i.isContentEditable||(a==="input"?["button","checkbox","hidden","radio","reset","submit"].indexOf(i.type)===-1:["textarea"].indexOf(a)!==-1)||(typeof o.hotkeys=="function"?o.hotkeys.call(this,t):this.handleHotkeys(t)))}handleHotkeys(t){var{fullscreenKey:i=l=>t.key.toLowerCase()==="f",muteKey:a=l=>t.key.toLowerCase()==="m",playPauseKey:o=l=>t.key.toLowerCase()==="k"||t.key.toLowerCase()===" "}=this.options_.userActions?this.options_.userActions.hotkeys:{};i.call(this,t)?(t.preventDefault(),t.stopPropagation(),i=Ze.getComponent("FullscreenToggle"),document[this.fsApi_.fullscreenEnabled]!==!1&&i.prototype.handleClick.call(this,t)):a.call(this,t)?(t.preventDefault(),t.stopPropagation(),Ze.getComponent("MuteToggle").prototype.handleClick.call(this,t)):o.call(this,t)&&(t.preventDefault(),t.stopPropagation(),Ze.getComponent("PlayToggle").prototype.handleClick.call(this,t))}canPlayType(t){var i;for(let o=0,l=this.options_.techOrder;o<l.length;o++){var a=l[o];let h=Ut.getTech(a);if(h=h||Ze.getComponent(a)){if(h.isSupported()&&(i=h.canPlayType(t)))return i}else S.error(`The "${a}" tech is undefined. Skipped browser support check for that tech.`)}return""}selectSource(t){function i(T,B,G){let H;return T.some(se=>B.some(pe=>{if(H=G(se,pe))return!0})),H}var a=this.options_.techOrder.map(T=>[T,Ut.getTech(T)]).filter(([T,B])=>B?B.isSupported():(S.error(`The "${T}" tech is undefined. Skipped browser support check for that tech.`),!1));let o;var l,h=([T,B],G)=>{if(B.canPlaySource(G,this.options_[T.toLowerCase()]))return{source:G,tech:T}};return(o=this.options_.sourceOrder?i(t,a,(l=h,(T,B)=>l(B,T))):i(a,t,h))||!1}handleSrc_(t,i){if(typeof t>"u")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();let a=vu(t);if(a.length){if(this.changingSrc_=!0,i||(this.cache_.sources=a),this.updateSourceCaches_(a[0]),Ap(this,a[0],(o,l)=>{var h;if(this.middleware_=l,i||(this.cache_.sources=a),this.updateSourceCaches_(o),this.src_(o))return 1<a.length?this.handleSrc_(a.slice(1)):(this.changingSrc_=!1,this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),void this.triggerReady());h=this.tech_,l.forEach(T=>T.setTech&&T.setTech(h))}),1<a.length){let o=()=>{this.error(null),this.handleSrc_(a.slice(1),!0)},l=()=>{this.off("error",o)};this.one("error",o),this.one("playing",l),this.resetRetryOnError_=()=>{this.off("error",o),this.off("playing",l)}}}else this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0)}src(t){return this.handleSrc_(t,!1)}src_(t){var i=this.selectSource([t]);return!i||(Xl(i.tech,this.techName_)?this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",t):this.techCall_("src",t.src),this.changingSrc_=!1},!0):(this.changingSrc_=!0,this.loadTech_(i.tech,i.source),this.tech_.ready(()=>{this.changingSrc_=!1})),!1)}addSourceElement(t,i){return!!this.tech_&&this.tech_.addSourceElement(t,i)}removeSourceElement(t){return!!this.tech_&&this.tech_.removeSourceElement(t)}load(){this.tech_&&this.tech_.vhs?this.src(this.currentSource()):this.techCall_("load")}reset(){this.paused()?this.doReset_():vn(this.play().then(()=>this.doReset_()))}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),this.error(null),this.titleBar&&this.titleBar.update({title:void 0,description:void 0}),On(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);var{currentTimeDisplay:t,durationDisplay:i,progressControl:o,remainingTimeDisplay:a}=this.controlBar||{},o=(o||{}).seekBar;t&&t.updateContent(),i&&i.updateContent(),a&&a.updateContent(),o&&(o.update(),o.loadProgressBar)&&o.loadProgressBar.update()}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){var t=this.currentSource(),i=[];return Object.keys(t).length!==0&&i.push(t),this.cache_.sources||i}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(t){if(t===void 0)return this.techGet_("preload");this.techCall_("setPreload",t),this.options_.preload=t}autoplay(t){if(t===void 0)return this.options_.autoplay||!1;let i;typeof t=="string"&&/(any|play|muted)/.test(t)||t===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=t,this.manualAutoplay_(typeof t=="string"?t:"play"),i=!1):this.options_.autoplay=!!t,i=typeof i>"u"?this.options_.autoplay:i,this.tech_&&this.techCall_("setAutoplay",i)}playsinline(t){return t!==void 0&&(this.techCall_("setPlaysinline",t),this.options_.playsinline=t),this.techGet_("playsinline")}loop(t){if(t===void 0)return this.techGet_("loop");this.techCall_("setLoop",t),this.options_.loop=t}poster(t){if(t===void 0)return this.poster_;(t=t||"")!==this.poster_&&(this.poster_=t,this.techCall_("setPoster",t),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){var t;(!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster&&(t=this.tech_.poster()||"")!==this.poster_&&(this.poster_=t,this.isPosterFromTech_=!0,this.trigger("posterchange"))}controls(t){if(t===void 0)return!!this.controls_;this.controls_!==(t=!!t)&&(this.controls_=t,this.usingNativeControls()&&this.techCall_("setControls",t),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(t){if(t===void 0)return!!this.usingNativeControls_;this.usingNativeControls_!==(t=!!t)&&(this.usingNativeControls_=t,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(t){if(t===void 0)return this.error_||null;if(M("beforeerror").forEach(i=>{i=i(this,t),R(i)&&!Array.isArray(i)||typeof i=="string"||typeof i=="number"||i===null?t=i:this.log.error("please return a value that MediaError expects in beforeerror hooks")}),this.options_.suppressNotSupportedError&&t&&t.code===4){let i=function(){this.error(t)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],i),this.one("loadstart",function(){this.off(["click","touchstart"],i)})}else t===null?(this.error_=null,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close()):(this.error_=new yi(t),this.addClass("vjs-error"),S.error(`(CODE:${this.error_.code} ${yi.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),M("error").forEach(i=>i(this,this.error_)))}reportUserActivity(t){this.userActivity_=!0}userActive(t){if(t===void 0)return this.userActive_;(t=!!t)!==this.userActive_&&(this.userActive_=t,this.userActive_?(this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive")):(this.tech_&&this.tech_.one("mousemove",function(i){i.stopPropagation(),i.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")))}listenForUserActivity_(){let t,i,a,o=Kt(this,this.reportUserActivity);function l(B){o(),this.clearInterval(t)}this.on("mousedown",function(){o(),this.clearInterval(t),t=this.setInterval(o,250)}),this.on("mousemove",function(B){B.screenX===i&&B.screenY===a||(i=B.screenX,a=B.screenY,o())}),this.on("mouseup",l),this.on("mouseleave",l);var h=this.getChild("controlBar");!h||Re||$||(h.on("mouseenter",function(B){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),h.on("mouseleave",function(B){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",o),this.on("keyup",o);let T;this.setInterval(function(){var B;this.userActivity_&&(this.userActivity_=!1,this.userActive(!0),this.clearTimeout(T),(B=this.options_.inactivityTimeout)<=0||(T=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},B)))},250)}playbackRate(t){if(t===void 0)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",t)}defaultPlaybackRate(t){return t!==void 0?this.techCall_("setDefaultPlaybackRate",t):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(t){if(t===void 0)return!!this.isAudio_;this.isAudio_=!!t}updatePlayerHeightOnAudioOnlyMode_(){var t=this.getChild("ControlBar");t&&this.audioOnlyCache_.controlBarHeight!==t.currentHeight()&&(this.audioOnlyCache_.controlBarHeight=t.currentHeight(),this.height(this.audioOnlyCache_.controlBarHeight))}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");var t=this.children();let i=this.getChild("ControlBar");var a=i&&i.currentHeight();t.forEach(o=>{o!==i&&o.el_&&!o.hasClass("vjs-hidden")&&(o.hide(),this.audioOnlyCache_.hiddenChildren.push(o))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.audioOnlyCache_.controlBarHeight=a,this.on("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.height(a),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.off("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.audioOnlyCache_.hiddenChildren.forEach(t=>t.show()),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(t){return typeof t!="boolean"||t===this.audioOnlyMode_?this.audioOnlyMode_:(this.audioOnlyMode_=t)?(t=[],this.isInPictureInPicture()&&t.push(this.exitPictureInPicture()),this.isFullscreen()&&t.push(this.exitFullscreen()),this.audioPosterMode()&&t.push(this.audioPosterMode(!1)),Promise.all(t).then(()=>this.enableAudioOnlyUI_())):Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(t){return typeof t!="boolean"||t===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=t)?(this.audioOnlyMode()?this.audioOnlyMode(!1):Promise.resolve()).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()})}addTextTrack(t,i,a){if(this.tech_)return this.tech_.addTextTrack(t,i,a)}addRemoteTextTrack(t,i){if(this.tech_)return this.tech_.addRemoteTextTrack(t,i)}removeRemoteTextTrack(t={}){let i=t.track;if(i=i||t,this.tech_)return this.tech_.removeRemoteTextTrack(i)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(t){if(t===void 0)return this.language_;this.language_!==String(t).toLowerCase()&&(this.language_=String(t).toLowerCase(),On(this))&&this.trigger("languagechange")}languages(){return Z(ui.prototype.options_.languages,this.languages_)}toJSON(){var t=Z(this.options_),i=t.tracks;t.tracks=[];for(let o=0;o<i.length;o++){var a=i[o];(a=Z(a)).player=void 0,t.tracks[o]=a}return t}createModal(t,i){(i=i||{}).content=t||"";let a=new pr(this,i);return this.addChild(a),a.on("dispose",()=>{this.removeChild(a)}),a.open(),a}updateCurrentBreakpoint_(){if(this.responsive()){var t=this.currentBreakpoint(),i=this.currentWidth();for(let o=0;o<Do.length;o++){var a=Do[o];if(i<=this.breakpoints_[a]){if(t===a)return;t&&this.removeClass(Js[t]),this.addClass(Js[a]),this.breakpoint_=a;break}}}}removeCurrentBreakpoint_(){var t=this.currentBreakpointClass();this.breakpoint_="",t&&this.removeClass(t)}breakpoints(t){return t!==void 0&&(this.breakpoint_="",this.breakpoints_=Object.assign({},sf,t),this.updateCurrentBreakpoint_()),Object.assign(this.breakpoints_)}responsive(t){return t===void 0?this.responsive_:(t=!!t)!==this.responsive_?((this.responsive_=t)?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),t):void 0}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return Js[this.breakpoint_]||""}loadMedia(t,i){var a,o,l,h,T,B,G;t&&typeof t=="object"&&(a=this.crossOrigin(),{artist:t,artwork:o,description:l,poster:h,src:T,textTracks:B,title:G}=(this.reset(),this.cache_.media=Z(t),this.cache_.media),!o&&h&&(this.cache_.media.artwork=[{src:h,type:Ks(h)}]),a&&this.crossOrigin(a),T&&this.src(T),h&&this.poster(h),Array.isArray(B)&&B.forEach(H=>this.addRemoteTextTrack(H,!1)),this.titleBar&&this.titleBar.update({title:G,description:l||t||""}),this.ready(i))}getMedia(){var t,i;return this.cache_.media?Z(this.cache_.media):(t=this.poster(),i={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),a=>({kind:a.kind,label:a.label,language:a.language,src:a.src}))},t&&(i.poster=t,i.artwork=[{src:i.poster,type:Ks(i.poster)}]),i)}static getTagSettings(t){var i={sources:[],tracks:[]},a=Rt(t),o=a["data-setup"];if(Pt(t,"vjs-fill")&&(a.fill=!0),Pt(t,"vjs-fluid")&&(a.fluid=!0),o!==null)try{Object.assign(a,JSON.parse(o||"{}"))}catch(B){S.error("data-setup",B)}if(Object.assign(i,a),t.hasChildNodes()){var l=t.childNodes;for(let B=0,G=l.length;B<G;B++){var h=l[B],T=h.nodeName.toLowerCase();T==="source"?i.sources.push(Rt(h)):T==="track"&&i.tracks.push(Rt(h))}}return i}debug(t){if(t===void 0)return this.debugEnabled_;t?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(t){if(t===void 0)return this.cache_.playbackRates;Array.isArray(t)&&t.every(i=>typeof i=="number")&&(this.cache_.playbackRates=t,this.trigger("playbackrateschange"))}}Vi.names.forEach(function(s){let t=Vi[s];ui.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}}),ui.prototype.crossorigin=ui.prototype.crossOrigin,ui.players={},_n=window.navigator,ui.prototype.options_={techOrder:Ut.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:_n&&(_n.languages&&_n.languages[0]||_n.userLanguage||_n.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1,spatialNavigation:{enabled:!1,horizontalSeek:!1},enableSmoothSeeking:!1,disableSeekWhileScrubbingOnMobile:!1},Zu.forEach(function(s){ui.prototype[`handleTech${_i(s)}_`]=function(){return this.trigger(s)}}),Ze.registerComponent("Player",ui);function af(s,t){function i(){na(this,{name:s,plugin:t,instance:null},!0);var a=t.apply(this,arguments);return Qu(this,s),na(this,{name:s,plugin:t,instance:a}),a}return Object.keys(t).forEach(function(a){i[a]=t[a]}),i}let ea="plugin",vr="activePlugins_",br={},ta=s=>br.hasOwnProperty(s),ia=s=>ta(s)?br[s]:void 0,Qu=(s,t)=>{s[vr]=s[vr]||{},s[vr][t]=!0},na=(s,t,i)=>{i=(i?"before":"")+"pluginsetup",s.trigger(i,t),s.trigger(i+":"+t.name,t)},Ju=(s,t)=>(t.prototype.name=s,function(...i){na(this,{name:s,plugin:t,instance:null},!0);let a=new t(this,...i);return this[s]=()=>a,na(this,a.getEventHash()),a});class Zi{constructor(t){if(this.constructor===Zi)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=t,this.log||(this.log=this.player.log.createLogger(this.name)),Wa(this),delete this.trigger,Wl(this,this.constructor.defaultState),Qu(t,this.name),this.dispose=this.dispose.bind(this),t.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(t={}){return t.name=this.name,t.plugin=this.constructor,t.instance=this,t}trigger(t,i={}){return oi(this.eventBusEl_,t,this.getEventHash(i))}handleStateChanged(t){}dispose(){var{name:t,player:i}=this;this.trigger("dispose"),this.off(),i.off("dispose",this.dispose),i[vr][t]=!1,this.player=this.state=null,i[t]=Ju(t,br[t])}static isBasic(t){return t=typeof t=="string"?ia(t):t,typeof t=="function"&&!Zi.prototype.isPrototypeOf(t.prototype)}static registerPlugin(t,i){if(typeof t!="string")throw new Error(`Illegal plugin name, "${t}", must be a string, was ${typeof t}.`);if(ta(t))S.warn(`A plugin named "${t}" already exists. You may want to avoid re-registering plugins!`);else if(ui.prototype.hasOwnProperty(t))throw new Error(`Illegal plugin name, "${t}", cannot share a name with an existing player method!`);if(typeof i!="function")throw new Error(`Illegal plugin for "${t}", must be a function, was ${typeof i}.`);return br[t]=i,t!==ea&&(Zi.isBasic(i)?ui.prototype[t]=af(t,i):ui.prototype[t]=Ju(t,i)),i}static deregisterPlugin(t){if(t===ea)throw new Error("Cannot de-register base plugin.");ta(t)&&(delete br[t],delete ui.prototype[t])}static getPlugins(t=Object.keys(br)){let i;return t.forEach(a=>{var o=ia(a);o&&((i=i||{})[a]=o)}),i}static getPluginVersion(t){return t=ia(t),t&&t.VERSION||""}}function fn(s,t,i,a){{var o=t+` is deprecated and will be removed in ${s}.0; please use ${i} instead.`,l=a;let h=!1;return function(...T){return h||S.warn(o),h=!0,l.apply(this,T)}}}Zi.getPlugin=ia,Zi.BASE_PLUGIN_NAME=ea,Zi.registerPlugin(ea,Zi),ui.prototype.usingPlugin=function(s){return!!this[vr]&&this[vr][s]===!0},ui.prototype.hasPlugin=function(s){return!!ta(s)};let ed=s=>s.indexOf("#")===0?s.slice(1):s;function He(s,t,i){let a=He.getPlayer(s);if(a)t&&S.warn(`Player "${s}" is already initialised. Options will not be applied.`),i&&a.ready(i);else{let o=typeof s=="string"?fe("#"+ed(s)):s;if(!$e(o))throw new TypeError("The element or ID supplied is not valid. (videojs)");s="getRootNode"in o&&o.getRootNode()instanceof window.ShadowRoot?o.getRootNode():o.ownerDocument.body,s=(o.ownerDocument.defaultView&&s.contains(o)||S.warn("The element supplied is not included in the DOM"),(t=t||{}).restoreEl===!0&&(t.restoreEl=(o.parentNode&&o.parentNode.hasAttribute&&o.parentNode.hasAttribute("data-vjs-player")?o.parentNode:o).cloneNode(!0)),M("beforesetup").forEach(l=>{l=l(o,Z(t)),!R(l)||Array.isArray(l)?S.error("please return an object in beforesetup hooks"):t=Z(t,l)}),Ze.getComponent("Player")),a=new s(o,t,i),M("setup").forEach(l=>l(a))}return a}He.hooks_=j,He.hooks=M,He.hook=function(s,t){M(s,t)},He.hookOnce=function(s,t){M(s,[].concat(t).map(i=>{let a=(...o)=>(w(s,a),i(...o));return a}))},He.removeHook=w,window.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&We()&&!(vi=fe(".vjs-styles-defaults"))&&(vi=Ye("vjs-styles-defaults"),(nr=fe("head"))&&nr.insertBefore(vi,nr.firstChild),ye(vi,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)),Q(1,He),He.VERSION=A,He.options=ui.prototype.options_,He.getPlayers=()=>ui.players,He.getPlayer=s=>{var t=ui.players;let i;if(typeof s=="string"){var a=ed(s),o=t[a];if(o)return o;i=fe("#"+a)}else i=s;if($e(i)){var{player:o,playerId:a}=i;if(o||t[a])return o||t[a]}},He.getAllPlayers=()=>Object.keys(ui.players).map(s=>ui.players[s]).filter(Boolean),He.players=ui.players,He.getComponent=Ze.getComponent,He.registerComponent=(s,t)=>(Ut.isTech(t)&&S.warn(`The ${s} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),Ze.registerComponent.call(Ze,s,t)),He.getTech=Ut.getTech,He.registerTech=Ut.registerTech,He.use=function(s,t){tr[s]=tr[s]||[],tr[s].push(t)},Object.defineProperty(He,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(He.middleware,"TERMINATOR",{value:$s,writeable:!1,enumerable:!0}),He.browser=ke,He.obj=z,He.mergeOptions=fn(9,"videojs.mergeOptions","videojs.obj.merge",Z),He.defineLazyProperty=fn(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",ee),He.bind=fn(9,"videojs.bind","native Function.prototype.bind",Kt),He.registerPlugin=Zi.registerPlugin,He.deregisterPlugin=Zi.deregisterPlugin,He.plugin=(s,t)=>(S.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Zi.registerPlugin(s,t)),He.getPlugins=Zi.getPlugins,He.getPlugin=Zi.getPlugin,He.getPluginVersion=Zi.getPluginVersion,He.addLanguage=function(s,t){return s=(""+s).toLowerCase(),He.options.languages=Z(He.options.languages,{[s]:t}),He.options.languages[s]},He.log=S,He.createLogger=u,He.time=Me,He.createTimeRange=fn(9,"videojs.createTimeRange","videojs.time.createTimeRanges",hn),He.createTimeRanges=fn(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",hn),He.formatTime=fn(9,"videojs.formatTime","videojs.time.formatTime",Jn),He.setFormatTime=fn(9,"videojs.setFormatTime","videojs.time.setFormatTime",Kl),He.resetFormatTime=fn(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",Yl),He.parseUrl=fn(9,"videojs.parseUrl","videojs.url.parseUrl",Ja),He.isCrossOrigin=fn(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",qs),He.EventTarget=ci,He.any=Pi,He.on=Vt,He.one=Si,He.off=kt,He.trigger=oi,He.xhr=to,He.TextTrack=ts,He.AudioTrack=lu,He.VideoTrack=uu,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(s=>{He[s]=function(){return S.warn(`videojs.${s}() is deprecated; use videojs.dom.${s}() instead`),Qe[s].apply(null,arguments)}}),He.computedStyle=fn(9,"videojs.computedStyle","videojs.dom.computedStyle",ot),He.dom=Qe,He.fn=Ai,He.num=Ws,He.str=rp,He.url=hp,He.Error={NetworkBadStatus:"networkbadstatus",NetworkRequestFailed:"networkrequestfailed",NetworkRequestAborted:"networkrequestaborted",NetworkRequestTimeout:"networkrequesttimeout",NetworkBodyParserFailed:"networkbodyparserfailed",StreamingHlsPlaylistParserError:"streaminghlsplaylistparsererror",StreamingDashManifestParserError:"streamingdashmanifestparsererror",StreamingContentSteeringParserError:"streamingcontentsteeringparsererror",StreamingVttParserError:"streamingvttparsererror",StreamingFailedToSelectNextSegment:"streamingfailedtoselectnextsegment",StreamingFailedToDecryptSegment:"streamingfailedtodecryptsegment",StreamingFailedToTransmuxSegment:"streamingfailedtotransmuxsegment",StreamingFailedToAppendSegment:"streamingfailedtoappendsegment",StreamingCodecsChangeError:"streamingcodecschangeerror"},Vs(function(s,t){/*! @name videojs-contrib-quality-levels @version 4.1.0 @license Apache-2.0 */s.exports=function(i){function a(H){return H&&typeof H=="object"&&"default"in H?H:{default:H}}var o=a(i);class l{constructor(se){let pe=this;return pe.id=se.id,pe.label=pe.id,pe.width=se.width,pe.height=se.height,pe.bitrate=se.bandwidth,pe.frameRate=se.frameRate,pe.enabled_=se.enabled,Object.defineProperty(pe,"enabled",{get(){return pe.enabled_()},set(ae){pe.enabled_(ae)}}),pe}}class h extends o.default.EventTarget{constructor(){super();let se=this;return se.levels_=[],se.selectedIndex_=-1,Object.defineProperty(se,"selectedIndex",{get(){return se.selectedIndex_}}),Object.defineProperty(se,"length",{get(){return se.levels_.length}}),se[Symbol.iterator]=()=>se.levels_.values(),se}addQualityLevel(se){let pe=this.getQualityLevelById(se.id);if(pe)return pe;const ae=this.levels_.length;return pe=new l(se),""+ae in this||Object.defineProperty(this,ae,{get(){return this.levels_[ae]}}),this.levels_.push(pe),this.trigger({qualityLevel:pe,type:"addqualitylevel"}),pe}removeQualityLevel(se){let pe=null;for(let ae=0,_e=this.length;ae<_e;ae++)if(this[ae]===se){pe=this.levels_.splice(ae,1)[0],this.selectedIndex_===ae?this.selectedIndex_=-1:this.selectedIndex_>ae&&this.selectedIndex_--;break}return pe&&this.trigger({qualityLevel:se,type:"removequalitylevel"}),pe}getQualityLevelById(se){for(let pe=0,ae=this.length;pe<ae;pe++){const _e=this[pe];if(_e.id===se)return _e}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}h.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const H in h.prototype.allowedEvents_)h.prototype["on"+H]=null;var T="4.1.0";const B=function(H,se){const pe=H.qualityLevels,ae=new h,_e=function(){ae.dispose(),H.qualityLevels=pe,H.off("dispose",_e)};return H.on("dispose",_e),H.qualityLevels=()=>ae,H.qualityLevels.VERSION=T,ae},G=function(H){return B(this,o.default.obj.merge({},H))};return o.default.registerPlugin("qualityLevels",G),G.VERSION=T,G}(He)});function of(s){return window.atob?window.atob(s):Buffer.from(s,"base64").toString("binary")}var td="https://example.com",ra=function(s,o){if(/^[a-z]+:/i.test(o))return o;/^data:/.test(s)&&(s=window.location&&window.location.href||"");var i=/^\/\//.test(s),a=!window.location&&!/\/\//i.test(s),o=(s=new window.URL(s,window.location||td),new URL(o,s));return a?o.href.slice(td.length):i?o.href.slice(o.protocol.length):o.href},_r=function(){function s(){this.listeners={}}var t=s.prototype;return t.on=function(i,a){this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(a)},t.off=function(i,a){return!!this.listeners[i]&&(a=this.listeners[i].indexOf(a),this.listeners[i]=this.listeners[i].slice(0),this.listeners[i].splice(a,1),-1<a)},t.trigger=function(i){var a=this.listeners[i];if(a)if(arguments.length===2)for(var o=a.length,l=0;l<o;++l)a[l].call(this,arguments[1]);else for(var h=Array.prototype.slice.call(arguments,1),T=a.length,B=0;B<T;++B)a[B].apply(this,h)},t.dispose=function(){this.listeners={}},t.pipe=function(i){this.on("data",function(a){i.push(a)})},s}();function id(s){for(var t=of(s),i=new Uint8Array(t.length),a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return i}/*! @name m3u8-parser @version 7.2.0 @license Apache-2.0 */class lf extends _r{constructor(){super(),this.buffer=""}push(t){let i;for(this.buffer+=t,i=this.buffer.indexOf(`
`);-1<i;i=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,i)),this.buffer=this.buffer.substring(i+1)}}function Po(t){var t=/([0-9.]*)?@?([0-9.]*)?/.exec(t||""),i={};return t[1]&&(i.length=parseInt(t[1],10)),t[2]&&(i.offset=parseInt(t[2],10)),i}function Gi(s){var t={};if(s){var i,a=s.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))'));let o=a.length;for(;o--;)a[o]!==""&&((i=/([^=]*)=(.*)/.exec(a[o]).slice(1))[0]=i[0].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^['"](.*)['"]$/g,"$1"),t[i[0]]=i[1])}return t}let uf="	",nd=t=>{var t=t.split("x"),i={};return t[0]&&(i.width=parseInt(t[0],10)),t[1]&&(i.height=parseInt(t[1],10)),i};class df extends _r{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(t){let i,a;(t=t.trim()).length!==0&&(t[0]!=="#"?this.trigger("data",{type:"uri",uri:t}):this.tagMappers.reduce((o,l)=>(l=l(t),l===t?o:o.concat([l])),[t]).forEach(o=>{for(let H=0;H<this.customParsers.length;H++)if(this.customParsers[H].call(this,o))return;var l;if(o.indexOf("#EXT")!==0)this.trigger("data",{type:"comment",text:o.slice(1)});else if(o=o.replace("\r",""),i=/^#EXTM3U/.exec(o))this.trigger("data",{type:"tag",tagType:"m3u"});else if(i=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(o))a={type:"tag",tagType:"inf"},i[1]&&(a.duration=parseFloat(i[1])),i[2]&&(a.title=i[2]),this.trigger("data",a);else if(i=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(o))a={type:"tag",tagType:"targetduration"},i[1]&&(a.duration=parseInt(i[1],10)),this.trigger("data",a);else if(i=/^#EXT-X-VERSION:([0-9.]*)?/.exec(o))a={type:"tag",tagType:"version"},i[1]&&(a.version=parseInt(i[1],10)),this.trigger("data",a);else if(i=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(o))a={type:"tag",tagType:"media-sequence"},i[1]&&(a.number=parseInt(i[1],10)),this.trigger("data",a);else if(i=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(o))a={type:"tag",tagType:"discontinuity-sequence"},i[1]&&(a.number=parseInt(i[1],10)),this.trigger("data",a);else if(i=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(o))a={type:"tag",tagType:"playlist-type"},i[1]&&(a.playlistType=i[1]),this.trigger("data",a);else if(i=/^#EXT-X-BYTERANGE:(.*)?$/.exec(o))a=Ii(Po(i[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",a);else if(i=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(o))a={type:"tag",tagType:"allow-cache"},i[1]&&(a.allowed=!/NO/.test(i[1])),this.trigger("data",a);else if(i=/^#EXT-X-MAP:(.*)$/.exec(o))a={type:"tag",tagType:"map"},i[1]&&((l=Gi(i[1])).URI&&(a.uri=l.URI),l.BYTERANGE)&&(a.byterange=Po(l.BYTERANGE)),this.trigger("data",a);else if(i=/^#EXT-X-STREAM-INF:(.*)$/.exec(o))a={type:"tag",tagType:"stream-inf"},i[1]&&(a.attributes=Gi(i[1]),a.attributes.RESOLUTION&&(a.attributes.RESOLUTION=nd(a.attributes.RESOLUTION)),a.attributes.BANDWIDTH&&(a.attributes.BANDWIDTH=parseInt(a.attributes.BANDWIDTH,10)),a.attributes["FRAME-RATE"]&&(a.attributes["FRAME-RATE"]=parseFloat(a.attributes["FRAME-RATE"])),a.attributes["PROGRAM-ID"])&&(a.attributes["PROGRAM-ID"]=parseInt(a.attributes["PROGRAM-ID"],10)),this.trigger("data",a);else if(i=/^#EXT-X-MEDIA:(.*)$/.exec(o))a={type:"tag",tagType:"media"},i[1]&&(a.attributes=Gi(i[1])),this.trigger("data",a);else if(i=/^#EXT-X-ENDLIST/.exec(o))this.trigger("data",{type:"tag",tagType:"endlist"});else if(i=/^#EXT-X-DISCONTINUITY/.exec(o))this.trigger("data",{type:"tag",tagType:"discontinuity"});else if(i=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(o))a={type:"tag",tagType:"program-date-time"},i[1]&&(a.dateTimeString=i[1],a.dateTimeObject=new Date(i[1])),this.trigger("data",a);else if(i=/^#EXT-X-KEY:(.*)$/.exec(o))a={type:"tag",tagType:"key"},i[1]&&(a.attributes=Gi(i[1]),a.attributes.IV)&&(a.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(a.attributes.IV=a.attributes.IV.substring(2)),a.attributes.IV=a.attributes.IV.match(/.{8}/g),a.attributes.IV[0]=parseInt(a.attributes.IV[0],16),a.attributes.IV[1]=parseInt(a.attributes.IV[1],16),a.attributes.IV[2]=parseInt(a.attributes.IV[2],16),a.attributes.IV[3]=parseInt(a.attributes.IV[3],16),a.attributes.IV=new Uint32Array(a.attributes.IV)),this.trigger("data",a);else if(i=/^#EXT-X-START:(.*)$/.exec(o))a={type:"tag",tagType:"start"},i[1]&&(a.attributes=Gi(i[1]),a.attributes["TIME-OFFSET"]=parseFloat(a.attributes["TIME-OFFSET"]),a.attributes.PRECISE=/YES/.test(a.attributes.PRECISE)),this.trigger("data",a);else if(i=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(o))a={type:"tag",tagType:"cue-out-cont"},i[1]?a.data=i[1]:a.data="",this.trigger("data",a);else if(i=/^#EXT-X-CUE-OUT:(.*)?$/.exec(o))a={type:"tag",tagType:"cue-out"},i[1]?a.data=i[1]:a.data="",this.trigger("data",a);else if(i=/^#EXT-X-CUE-IN:?(.*)?$/.exec(o))a={type:"tag",tagType:"cue-in"},i[1]?a.data=i[1]:a.data="",this.trigger("data",a);else if((i=/^#EXT-X-SKIP:(.*)$/.exec(o))&&i[1])(a={type:"tag",tagType:"skip"}).attributes=Gi(i[1]),a.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(a.attributes["SKIPPED-SEGMENTS"]=parseInt(a.attributes["SKIPPED-SEGMENTS"],10)),a.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(a.attributes["RECENTLY-REMOVED-DATERANGES"]=a.attributes["RECENTLY-REMOVED-DATERANGES"].split(uf)),this.trigger("data",a);else if((i=/^#EXT-X-PART:(.*)$/.exec(o))&&i[1])(a={type:"tag",tagType:"part"}).attributes=Gi(i[1]),["DURATION"].forEach(function(H){a.attributes.hasOwnProperty(H)&&(a.attributes[H]=parseFloat(a.attributes[H]))}),["INDEPENDENT","GAP"].forEach(function(H){a.attributes.hasOwnProperty(H)&&(a.attributes[H]=/YES/.test(a.attributes[H]))}),a.attributes.hasOwnProperty("BYTERANGE")&&(a.attributes.byterange=Po(a.attributes.BYTERANGE)),this.trigger("data",a);else if((i=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(o))&&i[1])(a={type:"tag",tagType:"server-control"}).attributes=Gi(i[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(H){a.attributes.hasOwnProperty(H)&&(a.attributes[H]=parseFloat(a.attributes[H]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(H){a.attributes.hasOwnProperty(H)&&(a.attributes[H]=/YES/.test(a.attributes[H]))}),this.trigger("data",a);else if((i=/^#EXT-X-PART-INF:(.*)$/.exec(o))&&i[1])(a={type:"tag",tagType:"part-inf"}).attributes=Gi(i[1]),["PART-TARGET"].forEach(function(H){a.attributes.hasOwnProperty(H)&&(a.attributes[H]=parseFloat(a.attributes[H]))}),this.trigger("data",a);else if((i=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(o))&&i[1])(a={type:"tag",tagType:"preload-hint"}).attributes=Gi(i[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(H){var se;a.attributes.hasOwnProperty(H)&&(a.attributes[H]=parseInt(a.attributes[H],10),se=H==="BYTERANGE-LENGTH"?"length":"offset",a.attributes.byterange=a.attributes.byterange||{},a.attributes.byterange[se]=a.attributes[H],delete a.attributes[H])}),this.trigger("data",a);else if((i=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(o))&&i[1])(a={type:"tag",tagType:"rendition-report"}).attributes=Gi(i[1]),["LAST-MSN","LAST-PART"].forEach(function(H){a.attributes.hasOwnProperty(H)&&(a.attributes[H]=parseInt(a.attributes[H],10))}),this.trigger("data",a);else if((i=/^#EXT-X-DATERANGE:(.*)$/.exec(o))&&i[1]){(a={type:"tag",tagType:"daterange"}).attributes=Gi(i[1]),["ID","CLASS"].forEach(function(H){a.attributes.hasOwnProperty(H)&&(a.attributes[H]=String(a.attributes[H]))}),["START-DATE","END-DATE"].forEach(function(H){a.attributes.hasOwnProperty(H)&&(a.attributes[H]=new Date(a.attributes[H]))}),["DURATION","PLANNED-DURATION"].forEach(function(H){a.attributes.hasOwnProperty(H)&&(a.attributes[H]=parseFloat(a.attributes[H]))}),["END-ON-NEXT"].forEach(function(H){a.attributes.hasOwnProperty(H)&&(a.attributes[H]=/YES/i.test(a.attributes[H]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(H){a.attributes.hasOwnProperty(H)&&(a.attributes[H]=a.attributes[H].toString(16))});var h,T,B,G=/^X-([A-Z]+-)+[A-Z]+$/;for(h in a.attributes)G.test(h)&&(T=/[0-9A-Fa-f]{6}/g.test(a.attributes[h]),B=/^\d+(\.\d+)?$/.test(a.attributes[h]),a.attributes[h]=T?a.attributes[h].toString(16):(B?parseFloat:String)(a.attributes[h]));this.trigger("data",a)}else(i=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(o))?this.trigger("data",{type:"tag",tagType:"independent-segments"}):(i=/^#EXT-X-I-FRAMES-ONLY/.exec(o))?this.trigger("data",{type:"tag",tagType:"i-frames-only"}):(i=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(o))?((a={type:"tag",tagType:"content-steering"}).attributes=Gi(i[1]),this.trigger("data",a)):(i=/^#EXT-X-I-FRAME-STREAM-INF:(.*)$/.exec(o))?((a={type:"tag",tagType:"i-frame-playlist"}).attributes=Gi(i[1]),a.attributes.URI&&(a.uri=a.attributes.URI),a.attributes.BANDWIDTH&&(a.attributes.BANDWIDTH=parseInt(a.attributes.BANDWIDTH,10)),a.attributes.RESOLUTION&&(a.attributes.RESOLUTION=nd(a.attributes.RESOLUTION)),a.attributes["AVERAGE-BANDWIDTH"]&&(a.attributes["AVERAGE-BANDWIDTH"]=parseInt(a.attributes["AVERAGE-BANDWIDTH"],10)),a.attributes["FRAME-RATE"]&&(a.attributes["FRAME-RATE"]=parseFloat(a.attributes["FRAME-RATE"])),this.trigger("data",a)):(i=/^#EXT-X-DEFINE:(.*)$/.exec(o))?((a={type:"tag",tagType:"define"}).attributes=Gi(i[1]),this.trigger("data",a)):this.trigger("data",{type:"tag",data:o.slice(4)})}))}addParser({expression:t,customType:i,dataParser:a,segment:o}){typeof a!="function"&&(a=l=>l),this.customParsers.push(l=>{if(t.exec(l))return this.trigger("data",{type:"custom",data:a(l),customType:i,segment:o}),!0})}addTagMapper({expression:t,map:i}){this.tagMappers.push(a=>t.test(a)?i(a):a)}}function zn(s){let t={};return Object.keys(s).forEach(function(i){t[i.toLowerCase().replace(/-(\w)/g,a=>a[1].toUpperCase())]=s[i]}),t}function Ro(h){var t,i,a,o,l,{serverControl:h,targetDuration:T,partTargetDuration:B}=h;h&&(t="#EXT-X-SERVER-CONTROL",i="holdBack",a="partHoldBack",o=T&&3*T,l=B&&2*B,T&&!h.hasOwnProperty(i)&&(h[i]=o,this.trigger("info",{message:t+` defaulting HOLD-BACK to targetDuration * 3 (${o}).`})),o&&h[i]<o&&(this.trigger("warn",{message:t+` clamping HOLD-BACK (${h[i]}) to targetDuration * 3 (${o})`}),h[i]=o),B&&!h.hasOwnProperty(a)&&(h[a]=3*B,this.trigger("info",{message:t+` defaulting PART-HOLD-BACK to partTargetDuration * 3 (${h[a]}).`})),B)&&h[a]<l&&(this.trigger("warn",{message:t+` clamping PART-HOLD-BACK (${h[a]}) to partTargetDuration * 2 (${l}).`}),h[a]=l)}class cf extends _r{constructor(t={}){super(),this.lineStream=new lf,this.parseStream=new df,this.lineStream.pipe(this.parseStream),this.mainDefinitions=t.mainDefinitions||{},this.params=new URL(t.uri,"https://a.com").searchParams,this.lastProgramDateTime=null;let i=this,a=[],o={},l,h,T=!1,B={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},G=0,H=(this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],iFramePlaylists:[],segments:[]},0),se=0,pe={};this.on("end",()=>{o.uri||!o.parts&&!o.preloadHints||(!o.map&&l&&(o.map=l),!o.key&&h&&(o.key=h),o.timeline||typeof G!="number"||(o.timeline=G),this.manifest.preloadSegment=o)}),this.parseStream.on("data",function(ae){let _e,Ce;if(i.manifest.definitions){for(var Le in i.manifest.definitions)if(ae.uri&&(ae.uri=ae.uri.replace(`{$${Le}}`,i.manifest.definitions[Le])),ae.attributes)for(var xe in ae.attributes)typeof ae.attributes[xe]=="string"&&(ae.attributes[xe]=ae.attributes[xe].replace(`{$${Le}}`,i.manifest.definitions[Le]))}({tag(){({version(){ae.version&&(this.manifest.version=ae.version)},"allow-cache"(){this.manifest.allowCache=ae.allowed,"allowed"in ae||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){var Pe={};"length"in ae&&((o.byterange=Pe).length=ae.length,"offset"in ae||(ae.offset=H)),"offset"in ae&&((o.byterange=Pe).offset=ae.offset),H=Pe.offset+Pe.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),ae.title&&(o.title=ae.title),0<ae.duration&&(o.duration=ae.duration),ae.duration===0&&(o.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key(){if(ae.attributes)if(ae.attributes.METHOD==="NONE")h=null;else if(ae.attributes.URI)if(ae.attributes.KEYFORMAT==="com.apple.streamingkeydelivery")this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:ae.attributes};else if(ae.attributes.KEYFORMAT==="com.microsoft.playready")this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:ae.attributes.URI};else{if(ae.attributes.KEYFORMAT==="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed")return["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(ae.attributes.METHOD)===-1?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):(ae.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),ae.attributes.URI.substring(0,23)!=="data:text/plain;base64,"?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):ae.attributes.KEYID&&ae.attributes.KEYID.substring(0,2)==="0x"?(this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:ae.attributes.KEYFORMAT,keyId:ae.attributes.KEYID.substring(2)},pssh:id(ae.attributes.URI.split(",")[1])})):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}));ae.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),h={method:ae.attributes.METHOD||"AES-128",uri:ae.attributes.URI},typeof ae.attributes.IV<"u"&&(h.iv=ae.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence"(){isFinite(ae.number)?this.manifest.mediaSequence=ae.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+ae.number})},"discontinuity-sequence"(){isFinite(ae.number)?(this.manifest.discontinuitySequence=ae.number,G=ae.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+ae.number})},"playlist-type"(){/VOD|EVENT/.test(ae.playlistType)?this.manifest.playlistType=ae.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+ae.playlist})},map(){l={},ae.uri&&(l.uri=ae.uri),ae.byterange&&(l.byterange=ae.byterange),h&&(l.key=h)},"stream-inf"(){this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||B,ae.attributes?(o.attributes||(o.attributes={}),Ii(o.attributes,ae.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media(){var Pe;this.manifest.mediaGroups=this.manifest.mediaGroups||B,ae.attributes&&ae.attributes.TYPE&&ae.attributes["GROUP-ID"]&&ae.attributes.NAME?((Pe=this.manifest.mediaGroups[ae.attributes.TYPE])[ae.attributes["GROUP-ID"]]=Pe[ae.attributes["GROUP-ID"]]||{},_e=Pe[ae.attributes["GROUP-ID"]],(Ce={default:/yes/i.test(ae.attributes.DEFAULT)}).default?Ce.autoselect=!0:Ce.autoselect=/yes/i.test(ae.attributes.AUTOSELECT),ae.attributes.LANGUAGE&&(Ce.language=ae.attributes.LANGUAGE),ae.attributes.URI&&(Ce.uri=ae.attributes.URI),ae.attributes["INSTREAM-ID"]&&(Ce.instreamId=ae.attributes["INSTREAM-ID"]),ae.attributes.CHARACTERISTICS&&(Ce.characteristics=ae.attributes.CHARACTERISTICS),ae.attributes.FORCED&&(Ce.forced=/yes/i.test(ae.attributes.FORCED)),_e[ae.attributes.NAME]=Ce):this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity(){G+=1,o.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=ae.dateTimeString,this.manifest.dateTimeObject=ae.dateTimeObject),o.dateTimeString=ae.dateTimeString,o.dateTimeObject=ae.dateTimeObject;var Pe=this.lastProgramDateTime;this.lastProgramDateTime=new Date(ae.dateTimeString).getTime(),Pe===null&&this.manifest.segments.reduceRight((Ae,st)=>(st.programDateTime=Ae-1e3*st.duration,st.programDateTime),this.lastProgramDateTime)},targetduration(){!isFinite(ae.duration)||ae.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+ae.duration}):(this.manifest.targetDuration=ae.duration,Ro.call(this,this.manifest))},start(){!ae.attributes||isNaN(ae.attributes["TIME-OFFSET"])?this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"}):this.manifest.start={timeOffset:ae.attributes["TIME-OFFSET"],precise:ae.attributes.PRECISE}},"cue-out"(){o.cueOut=ae.data},"cue-out-cont"(){o.cueOutCont=ae.data},"cue-in"(){o.cueIn=ae.data},skip(){this.manifest.skip=zn(ae.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",ae.attributes,["SKIPPED-SEGMENTS"])},part(){T=!0;var Pe=this.manifest.segments.length,Ae=zn(ae.attributes),Ae=(o.parts=o.parts||[],o.parts.push(Ae),Ae.byterange&&(Ae.byterange.hasOwnProperty("offset")||(Ae.byterange.offset=se),se=Ae.byterange.offset+Ae.byterange.length),o.parts.length-1);this.warnOnMissingAttributes_(`#EXT-X-PART #${Ae} for segment #`+Pe,ae.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((st,Ue)=>{st.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${Ue} lacks required attribute(s): LAST-PART`})})},"server-control"(){var Pe=this.manifest.serverControl=zn(ae.attributes);Pe.hasOwnProperty("canBlockReload")||(Pe.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),Ro.call(this,this.manifest),Pe.canSkipDateranges&&!Pe.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){var Pe=this.manifest.segments.length,Ae=zn(ae.attributes),st=Ae.type&&Ae.type==="PART",Ue=(o.preloadHints=o.preloadHints||[],o.preloadHints.push(Ae),!Ae.byterange||Ae.byterange.hasOwnProperty("offset")||(Ae.byterange.offset=st?se:0,st&&(se=Ae.byterange.offset+Ae.byterange.length)),o.preloadHints.length-1);if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${Ue} for segment #`+Pe,ae.attributes,["TYPE","URI"]),Ae.type)for(let Et=0;Et<o.preloadHints.length-1;Et++){var ft=o.preloadHints[Et];ft.type&&ft.type===Ae.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${Ue} for segment #${Pe} has the same TYPE ${Ae.type} as preload hint #`+Et})}},"rendition-report"(){var Pe=zn(ae.attributes),Pe=(this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(Pe),this.manifest.renditionReports.length-1),Ae=["LAST-MSN","URI"];T&&Ae.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #"+Pe,ae.attributes,Ae)},"part-inf"(){this.manifest.partInf=zn(ae.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",ae.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),Ro.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(zn(ae.attributes));var Pe=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_("#EXT-X-DATERANGE #"+Pe,ae.attributes,["ID","START-DATE"]);let Ae=this.manifest.dateRanges[Pe];Ae.endDate&&Ae.startDate&&new Date(Ae.endDate)<new Date(Ae.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),Ae.duration&&Ae.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),Ae.plannedDuration&&Ae.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});var st=!!Ae.endOnNext;if(st&&!Ae.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),st&&(Ae.duration||Ae.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),Ae.duration&&Ae.endDate&&(st=Ae.startDate.getTime()+1e3*Ae.duration,this.manifest.dateRanges[Pe].endDate=new Date(st)),pe[Ae.id]){for(var Ue in pe[Ae.id])if(Ae[Ue]&&JSON.stringify(pe[Ae.id][Ue])!==JSON.stringify(Ae[Ue])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}Pe=this.manifest.dateRanges.findIndex(ft=>ft.id===Ae.id),this.manifest.dateRanges[Pe]=Ii(this.manifest.dateRanges[Pe],Ae),pe[Ae.id]=Ii(pe[Ae.id],Ae),this.manifest.dateRanges.pop()}else pe[Ae.id]=Ae},"independent-segments"(){this.manifest.independentSegments=!0},"i-frames-only"(){this.manifest.iFramesOnly=!0,this.requiredCompatibilityversion(this.manifest.version,4)},"content-steering"(){this.manifest.contentSteering=zn(ae.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",ae.attributes,["SERVER-URI"])},define(){this.manifest.definitions=this.manifest.definitions||{};var Pe,Ae=(st,Ue)=>{st in this.manifest.definitions?this.trigger("error",{message:"EXT-X-DEFINE: Duplicate name "+st}):this.manifest.definitions[st]=Ue};return"QUERYPARAM"in ae.attributes?"NAME"in ae.attributes||"IMPORT"in ae.attributes?void this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"}):(Pe=this.params.get(ae.attributes.QUERYPARAM))?void Ae(ae.attributes.QUERYPARAM,decodeURIComponent(Pe)):void this.trigger("error",{message:"EXT-X-DEFINE: No query param "+ae.attributes.QUERYPARAM}):"NAME"in ae.attributes?"IMPORT"in ae.attributes?void this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"}):"VALUE"in ae.attributes&&typeof ae.attributes.VALUE=="string"?void Ae(ae.attributes.NAME,ae.attributes.VALUE):void this.trigger("error",{message:"EXT-X-DEFINE: No value for "+ae.attributes.NAME}):"IMPORT"in ae.attributes?this.mainDefinitions[ae.attributes.IMPORT]?void Ae(ae.attributes.IMPORT,this.mainDefinitions[ae.attributes.IMPORT]):void this.trigger("error",{message:`EXT-X-DEFINE: No value ${ae.attributes.IMPORT} to import, or IMPORT used on main playlist`}):void this.trigger("error",{message:"EXT-X-DEFINE: No attribute"})},"i-frame-playlist"(){this.manifest.iFramePlaylists.push({attributes:ae.attributes,uri:ae.uri,timeline:G}),this.warnOnMissingAttributes_("#EXT-X-I-FRAME-STREAM-INF",ae.attributes,["BANDWIDTH","URI"])}}[ae.tagType]||function(){}).call(i)},uri(){o.uri=ae.uri,a.push(o),!this.manifest.targetDuration||"duration"in o||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),o.duration=this.manifest.targetDuration),h&&(o.key=h),o.timeline=G,l&&(o.map=l),se=0,this.lastProgramDateTime!==null&&(o.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=1e3*o.duration),o={}},comment(){},custom(){ae.segment?(o.custom=o.custom||{},o.custom[ae.customType]=ae.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[ae.customType]=ae.data)}})[ae.type].call(i)})}requiredCompatibilityversion(t,i){(t<i||!t)&&this.trigger("warn",{message:"manifest must be at least version "+i})}warnOnMissingAttributes_(t,i,a){let o=[];a.forEach(function(l){i.hasOwnProperty(l)||o.push(l)}),o.length&&this.trigger("warn",{message:t+" lacks required attribute(s): "+o.join(", ")})}push(t){this.lineStream.push(t)}end(){this.lineStream.push(`
`),this.manifest.dateRanges.length&&this.lastProgramDateTime===null&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(t){this.parseStream.addParser(t)}addTagMapper(t){this.parseStream.addTagMapper(t)}}function rd(s){return rr.audio.test((s=s===void 0?"":s).trim().toLowerCase())}function hf(s){return rr.text.test((s=s===void 0?"":s).trim().toLowerCase())}function us(s,t){return s===void 0&&(s=""),t===void 0&&(t=!1),window.MediaSource&&window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported(Tr(s))||t&&window.ManagedMediaSource&&window.ManagedMediaSource.isTypeSupported&&window.ManagedMediaSource.isTypeSupported(Tr(s))||!1}function Lo(s){return(s=s===void 0?"":s).toLowerCase().split(",").every(function(t){t=t.trim();for(var i=0;i<ad.length;i++){var a=ad[i];if(rr["muxer"+a].test(t))return!0}return!1})}function sd(s){return mf.test(s)?"hls":gf.test(s)?"dash":s==="application/vnd.videojs.vhs+json"?"vhs-json":null}function pf(s){return ud(s)}var rr={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},ff=["video","audio","text"],ad=["Video","Audio","Text"],od=function(s){return s&&s.replace(/avc1\.(\d+)\.(\d+)/i,function(t,i,a){return"avc1."+("00"+Number(i).toString(16)).slice(-2)+"00"+("00"+Number(a).toString(16)).slice(-2)})},Tn=function(t){var t=(t=t===void 0?"":t).split(","),i=[];return t.forEach(function(a){var o;a=a.trim(),ff.forEach(function(l){var h,T=rr[l].exec(a.toLowerCase());!T||T.length<=1||(o=l,T=a.substring(0,T[1].length),h=a.replace(T,""),i.push({type:T,details:h,mediaType:l}))}),o||i.push({type:a,details:"",mediaType:"unknown"})}),i},Tr=function(s){var t,i,a;if(s&&typeof s=="string")return i="video",(t=s.toLowerCase().split(",").map(function(o){return od(o.trim())})).length===1&&rd(t[0])?i="audio":t.length===1&&hf(t[0])&&(i="application"),a="mp4",t.every(function(o){return rr.mp4.test(o)})?a="mp4":t.every(function(o){return rr.webm.test(o)})?a="webm":t.every(function(o){return rr.ogg.test(o)})&&(a="ogg"),i+"/"+a+';codecs="'+s+'"'},ld="mp4a.40.2",mf=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,gf=/^application\/dash\+xml/i,yf=function(s){return s.toString(2).length},vf=function(s){return Math.ceil(yf(s)/8)},ud=function(s){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer},wt=function(s){return s instanceof Uint8Array?s:(Array.isArray(s)||pf(s)||s instanceof ArrayBuffer||(s=typeof s!="number"||typeof s=="number"&&s!=s?0:[s]),new Uint8Array(s&&s.buffer||s,s&&s.byteOffset||0,s&&s.byteLength||0))},Ui=window.BigInt||Number,Mo=[Ui("0x1"),Ui("0x100"),Ui("0x10000"),Ui("0x1000000"),Ui("0x100000000"),Ui("0x10000000000"),Ui("0x1000000000000"),Ui("0x100000000000000"),Ui("0x10000000000000000")],bf=(Xi=new Uint16Array([65484]),(Xi=new Uint8Array(Xi.buffer,Xi.byteOffset,Xi.byteLength))[0],function(s,o){var o=o===void 0?{}:o,i=o.signed,i=i!==void 0&&i,o=o.le,a=o!==void 0&&o,o=(s=wt(s),a?"reduce":"reduceRight"),o=(s[o]||Array.prototype[o]).call(s,function(l,h,T){return T=a?T:Math.abs(T+1-s.length),l+Ui(h)*Mo[T]},Ui(0));return i&&(i=Mo[s.length]/Ui(2)-Ui(1))<(o=Ui(o))&&(o=(o=o-i-i)-Ui(2)),Number(o)}),_f=function(s,t){for(var t=(t===void 0?{}:t).le,i=t!==void 0&&t,a=(s=Ui(s=typeof s!="bigint"&&typeof s!="number"||typeof s=="number"&&s!=s?0:s),vf(s)),o=new Uint8Array(new ArrayBuffer(a)),l=0;l<a;l++){var h=i?l:Math.abs(l+1-o.length);o[h]=Number(s/Mo[l]&Ui(255)),s<0&&(o[h]=Math.abs(~o[h]),o[h]-=l===0?1:2)}return o},dd=function(s,t){if(typeof(s=typeof s!="string"&&s&&typeof s.toString=="function"?s.toString():s)!="string")return new Uint8Array;t||(s=unescape(encodeURIComponent(s)));for(var i=new Uint8Array(s.length),a=0;a<s.length;a++)i[a]=s.charCodeAt(a);return i},hi=function(s,t,h){var h=h===void 0?{}:h,o=h.offset,a=o===void 0?0:o,o=h.mask,l=o===void 0?[]:o,h=(s=wt(s),(t=wt(t)).every||Array.prototype.every);return t.length&&s.length-a>=t.length&&h.call(t,function(T,B){return T===(l[B]?l[B]&s[a+B]:s[a+B])})},Tf=function(s,t,i){t.forEach(function(a){for(var o in s.mediaGroups[a])for(var l in s.mediaGroups[a][o]){var h=s.mediaGroups[a][o][l];i(h,a,o,l)}})};function Uo(s,t){return(t=t===void 0?Object:t)&&typeof t.freeze=="function"?t.freeze(s):s}var cd=Uo({HTML:"text/html",isHTML:function(s){return s===cd.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),hd=Uo({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(s){return s===hd.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"}),ds={assign:function(s,t){if(s===null||typeof s!="object")throw new TypeError("target is not an object");for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=t[i]);return s},find:function(s,t,i){if(i===void 0&&(i=Array.prototype),s&&typeof i.find=="function")return i.find.call(s,t);for(var a=0;a<s.length;a++)if(Object.prototype.hasOwnProperty.call(s,a)){var o=s[a];if(t.call(void 0,o,a,s))return o}},freeze:Uo,MIME_TYPE:cd,NAMESPACE:hd},Sn=ds.find,cs=ds.NAMESPACE;function Sf(s){return s!==""}function wf(s,t){return s.hasOwnProperty(t)||(s[t]=!0),s}function pd(s){return s?(s=(s=s)?s.split(/[\t\n\f\r ]+/).filter(Sf):[],Object.keys(s.reduce(wf,{}))):[]}function hs(s,t){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i])}function Qi(s,t){var i=s.prototype;function a(){}i instanceof t||(a.prototype=t.prototype,hs(i,a=new a),s.prototype=i=a),i.constructor!=s&&(i.constructor=s)}var Fi={},Oi=(Fi.ELEMENT_NODE=1,Fi.ATTRIBUTE_NODE=2,Fi.TEXT_NODE=3,Fi.CDATA_SECTION_NODE=4,Fi.ENTITY_REFERENCE_NODE=5,Fi.ENTITY_NODE=6,Fi.PROCESSING_INSTRUCTION_NODE=7,Fi.COMMENT_NODE=8,Fi.DOCUMENT_NODE=9,Fi.DOCUMENT_TYPE_NODE=10,Fi.DOCUMENT_FRAGMENT_NODE=11,Fi.NOTATION_NODE=12,{}),Ri={},Ji=(Oi.INDEX_SIZE_ERR=(Ri[1]="Index size error",1),Oi.DOMSTRING_SIZE_ERR=(Ri[2]="DOMString size error",2),Oi.HIERARCHY_REQUEST_ERR=(Ri[3]="Hierarchy request error",3)),fd=(Oi.WRONG_DOCUMENT_ERR=(Ri[4]="Wrong document",4),Oi.INVALID_CHARACTER_ERR=(Ri[5]="Invalid character",5),Oi.NO_DATA_ALLOWED_ERR=(Ri[6]="No data allowed",6),Oi.NO_MODIFICATION_ALLOWED_ERR=(Ri[7]="No modification allowed",7),Oi.NOT_FOUND_ERR=(Ri[8]="Not found",8));Oi.NOT_SUPPORTED_ERR=(Ri[9]="Not supported",9),Oi.INUSE_ATTRIBUTE_ERR=(Ri[10]="Attribute in use",10);function Ei(s,t){var i;return t instanceof Error?i=t:(i=this,Error.call(this,Ri[s]),this.message=Ri[s],Error.captureStackTrace&&Error.captureStackTrace(this,Ei)),i.code=s,t&&(this.message=this.message+": "+t),i}function Pn(){}function Sr(s,t){this._node=s,this._refresh=t,Fo(this)}function Fo(s){var t=s._node._inc||s._node.ownerDocument._inc;if(s._inc!==t){var i=s._refresh(s._node);if(Id(s,"length",i.length),!s.$$length||i.length<s.$$length)for(var a=i.length;a in s;a++)Object.prototype.hasOwnProperty.call(s,a)&&delete s[a];hs(i,s),s._inc=t}}function sa(){}function md(s,t){for(var i=s.length;i--;)if(s[i]===t)return i}function gd(s,t,i,a){a?t[md(t,a)]=i:t[t.length++]=i,s&&(t=(i.ownerElement=s).ownerDocument)&&(a&&_d(t,s,a),a=s,s=i,(i=t)&&i._inc++,s.namespaceURI===cs.XMLNS)&&(a._nsMap[s.prefix?s.localName:""]=s.value)}function yd(s,t,i){var a=md(t,i);if(!(0<=a))throw new Ei(fd,new Error(s.tagName+"@"+i));for(var o,l=t.length-1;a<l;)t[a]=t[++a];t.length=l,s&&(o=s.ownerDocument)&&(_d(o,s,i),i.ownerElement=null)}function vd(){}function ii(){}function bd(s){return(s=="<"?"&lt;":s==">"&&"&gt;")||(s=="&"?"&amp;":s=='"'&&"&quot;")||"&#"+s.charCodeAt()+";"}function ps(s,t){if(t(s))return 1;if(s=s.firstChild)do if(ps(s,t))return 1;while(s=s.nextSibling)}function fs(){this.ownerDocument=this}function _d(s,t,i){s&&s._inc++,i.namespaceURI===cs.XMLNS&&delete t._nsMap[i.prefix?i.localName:""]}function Bo(s,t,i){if(s&&s._inc){s._inc++;var a=t.childNodes;if(i)a[a.length++]=i;else{for(var o=t.firstChild,l=0;o;)o=(a[l++]=o).nextSibling;a.length=l,delete a[a.length]}}}function Td(s,t){var i=t.previousSibling,a=t.nextSibling;return i?i.nextSibling=a:s.firstChild=a,a?a.previousSibling=i:s.lastChild=i,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,Bo(s.ownerDocument,s),t}function Rn(s){return s&&s.nodeType===ii.DOCUMENT_TYPE_NODE}function wn(s){return s&&s.nodeType===ii.ELEMENT_NODE}function zo(s){return s&&s.nodeType===ii.TEXT_NODE}function Sd(a,t){var i,a=a.childNodes||[];if(!Sn(a,wn)&&!Rn(t))return i=Sn(a,Rn),!(t&&i&&a.indexOf(i)>a.indexOf(t))}function wd(a,t){var i,a=a.childNodes||[];if(!Sn(a,function(o){return wn(o)&&o!==t}))return i=Sn(a,Rn),!(t&&i&&a.indexOf(i)>a.indexOf(t))}function Ef(s,t,i){if(!(a=s)||a.nodeType!==ii.DOCUMENT_NODE&&a.nodeType!==ii.DOCUMENT_FRAGMENT_NODE&&a.nodeType!==ii.ELEMENT_NODE)throw new Ei(Ji,"Unexpected parent node type "+s.nodeType);var a;if(i&&i.parentNode!==s)throw new Ei(fd,"child not in parent");if(!(a=t)||!(wn(a)||zo(a)||Rn(a)||a.nodeType===ii.DOCUMENT_FRAGMENT_NODE||a.nodeType===ii.COMMENT_NODE||a.nodeType===ii.PROCESSING_INSTRUCTION_NODE)||Rn(t)&&s.nodeType!==ii.DOCUMENT_NODE)throw new Ei(Ji,"Unexpected node type "+t.nodeType+" for parent node type "+s.nodeType)}function Cf(s,t,i){var a=s.childNodes||[],o=t.childNodes||[];if(t.nodeType===ii.DOCUMENT_FRAGMENT_NODE){var l=o.filter(wn);if(1<l.length||Sn(o,zo))throw new Ei(Ji,"More than one element or text in fragment");if(l.length===1&&!Sd(s,i))throw new Ei(Ji,"Element in fragment can not be inserted before doctype")}if(wn(t)&&!Sd(s,i))throw new Ei(Ji,"Only one element can be added and only after doctype");if(Rn(t)){if(Sn(a,Rn))throw new Ei(Ji,"Only one doctype is allowed");if(o=Sn(a,wn),i&&a.indexOf(o)<a.indexOf(i))throw new Ei(Ji,"Doctype can only be inserted before an element");if(!i&&o)throw new Ei(Ji,"Doctype can not be appended since element is present")}}function Ed(s,t,i){var a=s.childNodes||[],o=t.childNodes||[];if(t.nodeType===ii.DOCUMENT_FRAGMENT_NODE){var l=o.filter(wn);if(1<l.length||Sn(o,zo))throw new Ei(Ji,"More than one element or text in fragment");if(l.length===1&&!wd(s,i))throw new Ei(Ji,"Element in fragment can not be inserted before doctype")}if(wn(t)&&!wd(s,i))throw new Ei(Ji,"Only one element can be added and only after doctype");if(Rn(t)){if(Sn(a,function(h){return Rn(h)&&h!==i}))throw new Ei(Ji,"Only one doctype is allowed");if(o=Sn(a,wn),i&&a.indexOf(o)<a.indexOf(i))throw new Ei(Ji,"Doctype can only be inserted before an element")}}function aa(s,t,i,a){if(Ef(s,t,i),s.nodeType===ii.DOCUMENT_NODE&&(a||Cf)(s,t,i),a=t.parentNode,a&&a.removeChild(t),t.nodeType===11){var o=t.firstChild;if(o==null)return t;var l=t.lastChild}else o=l=t;for(a=i?i.previousSibling:s.lastChild,o.previousSibling=a,l.nextSibling=i,a?a.nextSibling=o:s.firstChild=o,i==null?s.lastChild=l:i.previousSibling=l;o.parentNode=s,o!==l&&(o=o.nextSibling););return Bo(s.ownerDocument||s,s),t.nodeType==11&&(t.firstChild=t.lastChild=null),t}function wr(){this._nsMap={}}function oa(){}function ms(){}function jo(){}function Ho(){}function qo(){}function la(){}function Cd(){}function xd(){}function Vo(){}function ua(){}function Wo(){}function kd(){}function Nd(s,t){var i,a=[],o=this.nodeType==9&&this.documentElement||this,l=o.prefix,h=o.namespaceURI;return Er(this,a,s,t,i=h&&l==null&&o.lookupPrefix(h)==null?[{namespace:h,prefix:null}]:i),a.join("")}function Ad(s,t,i){var a=s.prefix||"",o=s.namespaceURI;if(o&&(a!=="xml"||o!==cs.XML)&&o!==cs.XMLNS){for(var l=i.length;l--;){var h=i[l];if(h.prefix===a)return h.namespace!==o}return 1}}function Xo(s,t,i){s.push(" ",t,'="',i.replace(/[<>&"\t\n\r]/g,bd),'"')}function Er(s,t,i,a,o){if(o=o||[],a){if(!(s=a(s)))return;if(typeof s=="string")return void t.push(s)}switch(s.nodeType){case 1:var l=s.attributes,h=l.length,T=s.firstChild,B=s.tagName,G=B;if(!(i=cs.isHTML(s.namespaceURI)||i)&&!s.prefix&&s.namespaceURI){for(var H,se=0;se<l.length;se++)if(l.item(se).name==="xmlns"){H=l.item(se).value;break}if(!H){for(var pe=o.length-1;0<=pe;pe--)if((ae=o[pe]).prefix===""&&ae.namespace===s.namespaceURI){H=ae.namespace;break}}if(H!==s.namespaceURI){for(var ae,pe=o.length-1;0<=pe;pe--)if((ae=o[pe]).namespace===s.namespaceURI){ae.prefix&&(G=ae.prefix+":"+B);break}}}t.push("<",G);for(var _e=0;_e<h;_e++)(Ce=l.item(_e)).prefix=="xmlns"?o.push({prefix:Ce.localName,namespace:Ce.value}):Ce.nodeName=="xmlns"&&o.push({prefix:"",namespace:Ce.value});for(var Ce,Le,xe,_e=0;_e<h;_e++)Ad(Ce=l.item(_e),0,o)&&(Xo(t,(Le=Ce.prefix||"")?"xmlns:"+Le:"xmlns",xe=Ce.namespaceURI),o.push({prefix:Le,namespace:xe})),Er(Ce,t,i,a,o);if(B===G&&Ad(s,0,o)&&(Xo(t,(Le=s.prefix||"")?"xmlns:"+Le:"xmlns",xe=s.namespaceURI),o.push({prefix:Le,namespace:xe})),T||i&&!/^(?:meta|link|img|br|hr|input)$/i.test(B)){if(t.push(">"),i&&/^script$/i.test(B))for(;T;)T.data?t.push(T.data):Er(T,t,i,a,o.slice()),T=T.nextSibling;else for(;T;)Er(T,t,i,a,o.slice()),T=T.nextSibling;t.push("</",G,">")}else t.push("/>");return;case 9:case 11:for(T=s.firstChild;T;)Er(T,t,i,a,o.slice()),T=T.nextSibling;return;case 2:return Xo(t,s.name,s.value);case 3:return t.push(s.data.replace(/[<&>]/g,bd));case 4:return t.push("<![CDATA[",s.data,"]]>");case 8:return t.push("<!--",s.data,"-->");case 10:var Pe=s.publicId,Ae=s.systemId;return t.push("<!DOCTYPE ",s.name),void(Pe?(t.push(" PUBLIC ",Pe),Ae&&Ae!="."&&t.push(" ",Ae),t.push(">")):Ae&&Ae!="."?t.push(" SYSTEM ",Ae,">"):((Pe=s.internalSubset)&&t.push(" [",Pe,"]"),t.push(">")));case 7:return t.push("<?",s.target," ",s.data,"?>");case 5:return t.push("&",s.nodeName,";");default:t.push("??",s.nodeName)}}function Id(s,t,i){s[t]=i}Oi.INVALID_STATE_ERR=(Ri[11]="Invalid state",11),Oi.SYNTAX_ERR=(Ri[12]="Syntax error",12),Oi.INVALID_MODIFICATION_ERR=(Ri[13]="Invalid modification",13),Oi.NAMESPACE_ERR=(Ri[14]="Invalid namespace",14),Oi.INVALID_ACCESS_ERR=(Ri[15]="Invalid access",15),Ei.prototype=Error.prototype,hs(Oi,Ei),Pn.prototype={length:0,item:function(s){return 0<=s&&s<this.length?this[s]:null},toString:function(s,t){for(var i=[],a=0;a<this.length;a++)Er(this[a],i,s,t);return i.join("")},filter:function(s){return Array.prototype.filter.call(this,s)},indexOf:function(s){return Array.prototype.indexOf.call(this,s)}},Sr.prototype.item=function(s){return Fo(this),this[s]||null},Qi(Sr,Pn),sa.prototype={length:0,item:Pn.prototype.item,getNamedItem:function(s){for(var t=this.length;t--;){var i=this[t];if(i.nodeName==s)return i}},setNamedItem:function(s){var t=s.ownerElement;if(t&&t!=this._ownerElement)throw new Ei(10);return t=this.getNamedItem(s.nodeName),gd(this._ownerElement,this,s,t),t},setNamedItemNS:function(s){var t=s.ownerElement;if(t&&t!=this._ownerElement)throw new Ei(10);return t=this.getNamedItemNS(s.namespaceURI,s.localName),gd(this._ownerElement,this,s,t),t},removeNamedItem:function(s){return s=this.getNamedItem(s),yd(this._ownerElement,this,s),s},removeNamedItemNS:function(s,t){return s=this.getNamedItemNS(s,t),yd(this._ownerElement,this,s),s},getNamedItemNS:function(s,t){for(var i=this.length;i--;){var a=this[i];if(a.localName==t&&a.namespaceURI==s)return a}return null}},vd.prototype={hasFeature:function(s,t){return!0},createDocument:function(s,t,i){var a=new fs;return a.implementation=this,a.childNodes=new Pn,a.doctype=i||null,i&&a.appendChild(i),t&&(i=a.createElementNS(s,t),a.appendChild(i)),a},createDocumentType:function(s,t,i){var a=new la;return a.name=s,a.nodeName=s,a.publicId=t||"",a.systemId=i||"",a}},ii.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(s,t){return aa(this,s,t)},replaceChild:function(s,t){aa(this,s,t,Ed),t&&this.removeChild(t)},removeChild:function(s){return Td(this,s)},appendChild:function(s){return this.insertBefore(s,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(s){return function t(i,a,o){var l=new a.constructor;for(var h in a){var T;Object.prototype.hasOwnProperty.call(a,h)&&typeof(T=a[h])!="object"&&T!=l[h]&&(l[h]=T)}switch(a.childNodes&&(l.childNodes=new Pn),l.ownerDocument=i,l.nodeType){case 1:var B=a.attributes,G=l.attributes=new sa,H=B.length;G._ownerElement=l;for(var se=0;se<H;se++)l.setAttributeNode(t(i,B.item(se),!0));break;case 2:o=!0}if(o)for(var pe=a.firstChild;pe;)l.appendChild(t(i,pe,o)),pe=pe.nextSibling;return l}(this.ownerDocument||this,this,s)},normalize:function(){for(var s=this.firstChild;s;){var t=s.nextSibling;t&&t.nodeType==3&&s.nodeType==3?(this.removeChild(t),s.appendData(t.data)):(s.normalize(),s=t)}},isSupported:function(s,t){return this.ownerDocument.implementation.hasFeature(s,t)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(s){for(var t=this;t;){var i=t._nsMap;if(i){for(var a in i)if(Object.prototype.hasOwnProperty.call(i,a)&&i[a]===s)return a}t=t.nodeType==2?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(s){for(var t=this;t;){var i=t._nsMap;if(i&&Object.prototype.hasOwnProperty.call(i,s))return i[s];t=t.nodeType==2?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(s){return this.lookupPrefix(s)==null}},hs(Fi,ii),hs(Fi,ii.prototype),fs.prototype={nodeName:"#document",nodeType:9,doctype:null,documentElement:null,_inc:1,insertBefore:function(s,t){if(s.nodeType==11)for(var i=s.firstChild;i;){var a=i.nextSibling;this.insertBefore(i,t),i=a}else aa(this,s,t),(s.ownerDocument=this).documentElement===null&&s.nodeType===1&&(this.documentElement=s);return s},removeChild:function(s){return this.documentElement==s&&(this.documentElement=null),Td(this,s)},replaceChild:function(s,t){aa(this,s,t,Ed),s.ownerDocument=this,t&&this.removeChild(t),wn(s)&&(this.documentElement=s)},importNode:function(s,t){return function i(a,o,l){var h;switch(o.nodeType){case 1:(h=o.cloneNode(!1)).ownerDocument=a;case 11:break;case 2:l=!0}if(h=h||o.cloneNode(!1),h.ownerDocument=a,h.parentNode=null,l)for(var T=o.firstChild;T;)h.appendChild(i(a,T,l)),T=T.nextSibling;return h}(this,s,t)},getElementById:function(s){var t=null;return ps(this.documentElement,function(i){if(i.nodeType==1&&i.getAttribute("id")==s)return t=i,!0}),t},getElementsByClassName:function(s){var t=pd(s);return new Sr(this,function(i){var a=[];return 0<t.length&&ps(i.documentElement,function(o){var l,h,T;o!==i&&o.nodeType===1&&(l=o.getAttribute("class"))&&((h=s===l)||(l=pd(l),h=t.every((T=l,function(B){return T&&T.indexOf(B)!==-1}))),h)&&a.push(o)}),a})},createElement:function(s){var t=new wr;return t.ownerDocument=this,t.nodeName=s,t.tagName=s,t.localName=s,t.childNodes=new Pn,(t.attributes=new sa)._ownerElement=t},createDocumentFragment:function(){var s=new ua;return s.ownerDocument=this,s.childNodes=new Pn,s},createTextNode:function(s){var t=new jo;return t.ownerDocument=this,t.appendData(s),t},createComment:function(s){var t=new Ho;return t.ownerDocument=this,t.appendData(s),t},createCDATASection:function(s){var t=new qo;return t.ownerDocument=this,t.appendData(s),t},createProcessingInstruction:function(s,t){var i=new Wo;return i.ownerDocument=this,i.tagName=i.nodeName=i.target=s,i.nodeValue=i.data=t,i},createAttribute:function(s){var t=new oa;return t.ownerDocument=this,t.name=s,t.nodeName=s,t.localName=s,t.specified=!0,t},createEntityReference:function(s){var t=new Vo;return t.ownerDocument=this,t.nodeName=s,t},createElementNS:function(s,t){var i=new wr,a=t.split(":"),o=i.attributes=new sa;return i.childNodes=new Pn,i.ownerDocument=this,i.nodeName=t,i.tagName=t,i.namespaceURI=s,a.length==2?(i.prefix=a[0],i.localName=a[1]):i.localName=t,o._ownerElement=i},createAttributeNS:function(s,t){var i=new oa,a=t.split(":");return i.ownerDocument=this,i.nodeName=t,i.name=t,i.namespaceURI=s,i.specified=!0,a.length==2?(i.prefix=a[0],i.localName=a[1]):i.localName=t,i}},Qi(fs,ii),fs.prototype.getElementsByTagName=(wr.prototype={nodeType:1,hasAttribute:function(s){return this.getAttributeNode(s)!=null},getAttribute:function(s){return s=this.getAttributeNode(s),s&&s.value||""},getAttributeNode:function(s){return this.attributes.getNamedItem(s)},setAttribute:function(s,t){s=this.ownerDocument.createAttribute(s),s.value=s.nodeValue=""+t,this.setAttributeNode(s)},removeAttribute:function(s){s=this.getAttributeNode(s),s&&this.removeAttributeNode(s)},appendChild:function(s){return s.nodeType===11?this.insertBefore(s,null):(t=this,(s=s).parentNode&&s.parentNode.removeChild(s),s.parentNode=t,s.previousSibling=t.lastChild,s.nextSibling=null,s.previousSibling?s.previousSibling.nextSibling=s:t.firstChild=s,t.lastChild=s,Bo(t.ownerDocument,t,s),s);var t},setAttributeNode:function(s){return this.attributes.setNamedItem(s)},setAttributeNodeNS:function(s){return this.attributes.setNamedItemNS(s)},removeAttributeNode:function(s){return this.attributes.removeNamedItem(s.nodeName)},removeAttributeNS:function(s,t){s=this.getAttributeNodeNS(s,t),s&&this.removeAttributeNode(s)},hasAttributeNS:function(s,t){return this.getAttributeNodeNS(s,t)!=null},getAttributeNS:function(s,t){return s=this.getAttributeNodeNS(s,t),s&&s.value||""},setAttributeNS:function(s,t,i){s=this.ownerDocument.createAttributeNS(s,t),s.value=s.nodeValue=""+i,this.setAttributeNode(s)},getAttributeNodeNS:function(s,t){return this.attributes.getNamedItemNS(s,t)},getElementsByTagName:function(s){return new Sr(this,function(t){var i=[];return ps(t,function(a){a===t||a.nodeType!=1||s!=="*"&&a.tagName!=s||i.push(a)}),i})},getElementsByTagNameNS:function(s,t){return new Sr(this,function(i){var a=[];return ps(i,function(o){o===i||o.nodeType!==1||s!=="*"&&o.namespaceURI!==s||t!=="*"&&o.localName!=t||a.push(o)}),a})}}).getElementsByTagName,fs.prototype.getElementsByTagNameNS=wr.prototype.getElementsByTagNameNS,Qi(wr,ii),oa.prototype.nodeType=2,Qi(oa,ii),ms.prototype={data:"",substringData:function(s,t){return this.data.substring(s,s+t)},appendData:function(s){s=this.data+s,this.nodeValue=this.data=s,this.length=s.length},insertData:function(s,t){this.replaceData(s,0,t)},appendChild:function(s){throw new Error(Ri[Ji])},deleteData:function(s,t){this.replaceData(s,t,"")},replaceData:function(o,t,i){var a=this.data.substring(0,o),o=this.data.substring(o+t);this.nodeValue=this.data=i=a+i+o,this.length=i.length}},Qi(ms,ii),jo.prototype={nodeName:"#text",nodeType:3,splitText:function(a){var t=(i=this.data).substring(a),i=i.substring(0,a),a=(this.data=this.nodeValue=i,this.length=i.length,this.ownerDocument.createTextNode(t));return this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling),a}},Qi(jo,ms),Ho.prototype={nodeName:"#comment",nodeType:8},Qi(Ho,ms),qo.prototype={nodeName:"#cdata-section",nodeType:4},Qi(qo,ms),la.prototype.nodeType=10,Qi(la,ii),Cd.prototype.nodeType=12,Qi(Cd,ii),xd.prototype.nodeType=6,Qi(xd,ii),Vo.prototype.nodeType=5,Qi(Vo,ii),ua.prototype.nodeName="#document-fragment",ua.prototype.nodeType=11,Qi(ua,ii),Wo.prototype.nodeType=7,Qi(Wo,ii),kd.prototype.serializeToString=function(s,t,i){return Nd.call(s,t,i)},ii.prototype.toString=Nd;try{Object.defineProperty&&(Object.defineProperty(Sr.prototype,"length",{get:function(){return Fo(this),this.$$length}}),Object.defineProperty(ii.prototype,"textContent",{get:function(){return function s(t){switch(t.nodeType){case 1:case 11:var i=[];for(t=t.firstChild;t;)t.nodeType!==7&&t.nodeType!==8&&i.push(s(t)),t=t.nextSibling;return i.join("");default:return t.nodeValue}}(this)},set:function(s){switch(this.nodeType){case 1:case 11:for(;this.firstChild;)this.removeChild(this.firstChild);(s||String(s))&&this.appendChild(this.ownerDocument.createTextNode(s));break;default:this.data=s,this.value=s,this.nodeValue=s}}}),Id=function(s,t,i){s["$$"+t]=i})}catch{}var da={DocumentType:la,DOMException:Ei,DOMImplementation:vd,Element:wr,Node:ii,NodeList:Pn,XMLSerializer:kd},Go=Vs(function(s,t){var i=ds.freeze;t.XML_ENTITIES=i({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=i({Aacute:"\xC1",aacute:"\xE1",Abreve:"\u0102",abreve:"\u0103",ac:"\u223E",acd:"\u223F",acE:"\u223E\u0333",Acirc:"\xC2",acirc:"\xE2",acute:"\xB4",Acy:"\u0410",acy:"\u0430",AElig:"\xC6",aelig:"\xE6",af:"\u2061",Afr:"\u{1D504}",afr:"\u{1D51E}",Agrave:"\xC0",agrave:"\xE0",alefsym:"\u2135",aleph:"\u2135",Alpha:"\u0391",alpha:"\u03B1",Amacr:"\u0100",amacr:"\u0101",amalg:"\u2A3F",AMP:"&",amp:"&",And:"\u2A53",and:"\u2227",andand:"\u2A55",andd:"\u2A5C",andslope:"\u2A58",andv:"\u2A5A",ang:"\u2220",ange:"\u29A4",angle:"\u2220",angmsd:"\u2221",angmsdaa:"\u29A8",angmsdab:"\u29A9",angmsdac:"\u29AA",angmsdad:"\u29AB",angmsdae:"\u29AC",angmsdaf:"\u29AD",angmsdag:"\u29AE",angmsdah:"\u29AF",angrt:"\u221F",angrtvb:"\u22BE",angrtvbd:"\u299D",angsph:"\u2222",angst:"\xC5",angzarr:"\u237C",Aogon:"\u0104",aogon:"\u0105",Aopf:"\u{1D538}",aopf:"\u{1D552}",ap:"\u2248",apacir:"\u2A6F",apE:"\u2A70",ape:"\u224A",apid:"\u224B",apos:"'",ApplyFunction:"\u2061",approx:"\u2248",approxeq:"\u224A",Aring:"\xC5",aring:"\xE5",Ascr:"\u{1D49C}",ascr:"\u{1D4B6}",Assign:"\u2254",ast:"*",asymp:"\u2248",asympeq:"\u224D",Atilde:"\xC3",atilde:"\xE3",Auml:"\xC4",auml:"\xE4",awconint:"\u2233",awint:"\u2A11",backcong:"\u224C",backepsilon:"\u03F6",backprime:"\u2035",backsim:"\u223D",backsimeq:"\u22CD",Backslash:"\u2216",Barv:"\u2AE7",barvee:"\u22BD",Barwed:"\u2306",barwed:"\u2305",barwedge:"\u2305",bbrk:"\u23B5",bbrktbrk:"\u23B6",bcong:"\u224C",Bcy:"\u0411",bcy:"\u0431",bdquo:"\u201E",becaus:"\u2235",Because:"\u2235",because:"\u2235",bemptyv:"\u29B0",bepsi:"\u03F6",bernou:"\u212C",Bernoullis:"\u212C",Beta:"\u0392",beta:"\u03B2",beth:"\u2136",between:"\u226C",Bfr:"\u{1D505}",bfr:"\u{1D51F}",bigcap:"\u22C2",bigcirc:"\u25EF",bigcup:"\u22C3",bigodot:"\u2A00",bigoplus:"\u2A01",bigotimes:"\u2A02",bigsqcup:"\u2A06",bigstar:"\u2605",bigtriangledown:"\u25BD",bigtriangleup:"\u25B3",biguplus:"\u2A04",bigvee:"\u22C1",bigwedge:"\u22C0",bkarow:"\u290D",blacklozenge:"\u29EB",blacksquare:"\u25AA",blacktriangle:"\u25B4",blacktriangledown:"\u25BE",blacktriangleleft:"\u25C2",blacktriangleright:"\u25B8",blank:"\u2423",blk12:"\u2592",blk14:"\u2591",blk34:"\u2593",block:"\u2588",bne:"=\u20E5",bnequiv:"\u2261\u20E5",bNot:"\u2AED",bnot:"\u2310",Bopf:"\u{1D539}",bopf:"\u{1D553}",bot:"\u22A5",bottom:"\u22A5",bowtie:"\u22C8",boxbox:"\u29C9",boxDL:"\u2557",boxDl:"\u2556",boxdL:"\u2555",boxdl:"\u2510",boxDR:"\u2554",boxDr:"\u2553",boxdR:"\u2552",boxdr:"\u250C",boxH:"\u2550",boxh:"\u2500",boxHD:"\u2566",boxHd:"\u2564",boxhD:"\u2565",boxhd:"\u252C",boxHU:"\u2569",boxHu:"\u2567",boxhU:"\u2568",boxhu:"\u2534",boxminus:"\u229F",boxplus:"\u229E",boxtimes:"\u22A0",boxUL:"\u255D",boxUl:"\u255C",boxuL:"\u255B",boxul:"\u2518",boxUR:"\u255A",boxUr:"\u2559",boxuR:"\u2558",boxur:"\u2514",boxV:"\u2551",boxv:"\u2502",boxVH:"\u256C",boxVh:"\u256B",boxvH:"\u256A",boxvh:"\u253C",boxVL:"\u2563",boxVl:"\u2562",boxvL:"\u2561",boxvl:"\u2524",boxVR:"\u2560",boxVr:"\u255F",boxvR:"\u255E",boxvr:"\u251C",bprime:"\u2035",Breve:"\u02D8",breve:"\u02D8",brvbar:"\xA6",Bscr:"\u212C",bscr:"\u{1D4B7}",bsemi:"\u204F",bsim:"\u223D",bsime:"\u22CD",bsol:"\\",bsolb:"\u29C5",bsolhsub:"\u27C8",bull:"\u2022",bullet:"\u2022",bump:"\u224E",bumpE:"\u2AAE",bumpe:"\u224F",Bumpeq:"\u224E",bumpeq:"\u224F",Cacute:"\u0106",cacute:"\u0107",Cap:"\u22D2",cap:"\u2229",capand:"\u2A44",capbrcup:"\u2A49",capcap:"\u2A4B",capcup:"\u2A47",capdot:"\u2A40",CapitalDifferentialD:"\u2145",caps:"\u2229\uFE00",caret:"\u2041",caron:"\u02C7",Cayleys:"\u212D",ccaps:"\u2A4D",Ccaron:"\u010C",ccaron:"\u010D",Ccedil:"\xC7",ccedil:"\xE7",Ccirc:"\u0108",ccirc:"\u0109",Cconint:"\u2230",ccups:"\u2A4C",ccupssm:"\u2A50",Cdot:"\u010A",cdot:"\u010B",cedil:"\xB8",Cedilla:"\xB8",cemptyv:"\u29B2",cent:"\xA2",CenterDot:"\xB7",centerdot:"\xB7",Cfr:"\u212D",cfr:"\u{1D520}",CHcy:"\u0427",chcy:"\u0447",check:"\u2713",checkmark:"\u2713",Chi:"\u03A7",chi:"\u03C7",cir:"\u25CB",circ:"\u02C6",circeq:"\u2257",circlearrowleft:"\u21BA",circlearrowright:"\u21BB",circledast:"\u229B",circledcirc:"\u229A",circleddash:"\u229D",CircleDot:"\u2299",circledR:"\xAE",circledS:"\u24C8",CircleMinus:"\u2296",CirclePlus:"\u2295",CircleTimes:"\u2297",cirE:"\u29C3",cire:"\u2257",cirfnint:"\u2A10",cirmid:"\u2AEF",cirscir:"\u29C2",ClockwiseContourIntegral:"\u2232",CloseCurlyDoubleQuote:"\u201D",CloseCurlyQuote:"\u2019",clubs:"\u2663",clubsuit:"\u2663",Colon:"\u2237",colon:":",Colone:"\u2A74",colone:"\u2254",coloneq:"\u2254",comma:",",commat:"@",comp:"\u2201",compfn:"\u2218",complement:"\u2201",complexes:"\u2102",cong:"\u2245",congdot:"\u2A6D",Congruent:"\u2261",Conint:"\u222F",conint:"\u222E",ContourIntegral:"\u222E",Copf:"\u2102",copf:"\u{1D554}",coprod:"\u2210",Coproduct:"\u2210",COPY:"\xA9",copy:"\xA9",copysr:"\u2117",CounterClockwiseContourIntegral:"\u2233",crarr:"\u21B5",Cross:"\u2A2F",cross:"\u2717",Cscr:"\u{1D49E}",cscr:"\u{1D4B8}",csub:"\u2ACF",csube:"\u2AD1",csup:"\u2AD0",csupe:"\u2AD2",ctdot:"\u22EF",cudarrl:"\u2938",cudarrr:"\u2935",cuepr:"\u22DE",cuesc:"\u22DF",cularr:"\u21B6",cularrp:"\u293D",Cup:"\u22D3",cup:"\u222A",cupbrcap:"\u2A48",CupCap:"\u224D",cupcap:"\u2A46",cupcup:"\u2A4A",cupdot:"\u228D",cupor:"\u2A45",cups:"\u222A\uFE00",curarr:"\u21B7",curarrm:"\u293C",curlyeqprec:"\u22DE",curlyeqsucc:"\u22DF",curlyvee:"\u22CE",curlywedge:"\u22CF",curren:"\xA4",curvearrowleft:"\u21B6",curvearrowright:"\u21B7",cuvee:"\u22CE",cuwed:"\u22CF",cwconint:"\u2232",cwint:"\u2231",cylcty:"\u232D",Dagger:"\u2021",dagger:"\u2020",daleth:"\u2138",Darr:"\u21A1",dArr:"\u21D3",darr:"\u2193",dash:"\u2010",Dashv:"\u2AE4",dashv:"\u22A3",dbkarow:"\u290F",dblac:"\u02DD",Dcaron:"\u010E",dcaron:"\u010F",Dcy:"\u0414",dcy:"\u0434",DD:"\u2145",dd:"\u2146",ddagger:"\u2021",ddarr:"\u21CA",DDotrahd:"\u2911",ddotseq:"\u2A77",deg:"\xB0",Del:"\u2207",Delta:"\u0394",delta:"\u03B4",demptyv:"\u29B1",dfisht:"\u297F",Dfr:"\u{1D507}",dfr:"\u{1D521}",dHar:"\u2965",dharl:"\u21C3",dharr:"\u21C2",DiacriticalAcute:"\xB4",DiacriticalDot:"\u02D9",DiacriticalDoubleAcute:"\u02DD",DiacriticalGrave:"`",DiacriticalTilde:"\u02DC",diam:"\u22C4",Diamond:"\u22C4",diamond:"\u22C4",diamondsuit:"\u2666",diams:"\u2666",die:"\xA8",DifferentialD:"\u2146",digamma:"\u03DD",disin:"\u22F2",div:"\xF7",divide:"\xF7",divideontimes:"\u22C7",divonx:"\u22C7",DJcy:"\u0402",djcy:"\u0452",dlcorn:"\u231E",dlcrop:"\u230D",dollar:"$",Dopf:"\u{1D53B}",dopf:"\u{1D555}",Dot:"\xA8",dot:"\u02D9",DotDot:"\u20DC",doteq:"\u2250",doteqdot:"\u2251",DotEqual:"\u2250",dotminus:"\u2238",dotplus:"\u2214",dotsquare:"\u22A1",doublebarwedge:"\u2306",DoubleContourIntegral:"\u222F",DoubleDot:"\xA8",DoubleDownArrow:"\u21D3",DoubleLeftArrow:"\u21D0",DoubleLeftRightArrow:"\u21D4",DoubleLeftTee:"\u2AE4",DoubleLongLeftArrow:"\u27F8",DoubleLongLeftRightArrow:"\u27FA",DoubleLongRightArrow:"\u27F9",DoubleRightArrow:"\u21D2",DoubleRightTee:"\u22A8",DoubleUpArrow:"\u21D1",DoubleUpDownArrow:"\u21D5",DoubleVerticalBar:"\u2225",DownArrow:"\u2193",Downarrow:"\u21D3",downarrow:"\u2193",DownArrowBar:"\u2913",DownArrowUpArrow:"\u21F5",DownBreve:"\u0311",downdownarrows:"\u21CA",downharpoonleft:"\u21C3",downharpoonright:"\u21C2",DownLeftRightVector:"\u2950",DownLeftTeeVector:"\u295E",DownLeftVector:"\u21BD",DownLeftVectorBar:"\u2956",DownRightTeeVector:"\u295F",DownRightVector:"\u21C1",DownRightVectorBar:"\u2957",DownTee:"\u22A4",DownTeeArrow:"\u21A7",drbkarow:"\u2910",drcorn:"\u231F",drcrop:"\u230C",Dscr:"\u{1D49F}",dscr:"\u{1D4B9}",DScy:"\u0405",dscy:"\u0455",dsol:"\u29F6",Dstrok:"\u0110",dstrok:"\u0111",dtdot:"\u22F1",dtri:"\u25BF",dtrif:"\u25BE",duarr:"\u21F5",duhar:"\u296F",dwangle:"\u29A6",DZcy:"\u040F",dzcy:"\u045F",dzigrarr:"\u27FF",Eacute:"\xC9",eacute:"\xE9",easter:"\u2A6E",Ecaron:"\u011A",ecaron:"\u011B",ecir:"\u2256",Ecirc:"\xCA",ecirc:"\xEA",ecolon:"\u2255",Ecy:"\u042D",ecy:"\u044D",eDDot:"\u2A77",Edot:"\u0116",eDot:"\u2251",edot:"\u0117",ee:"\u2147",efDot:"\u2252",Efr:"\u{1D508}",efr:"\u{1D522}",eg:"\u2A9A",Egrave:"\xC8",egrave:"\xE8",egs:"\u2A96",egsdot:"\u2A98",el:"\u2A99",Element:"\u2208",elinters:"\u23E7",ell:"\u2113",els:"\u2A95",elsdot:"\u2A97",Emacr:"\u0112",emacr:"\u0113",empty:"\u2205",emptyset:"\u2205",EmptySmallSquare:"\u25FB",emptyv:"\u2205",EmptyVerySmallSquare:"\u25AB",emsp:"\u2003",emsp13:"\u2004",emsp14:"\u2005",ENG:"\u014A",eng:"\u014B",ensp:"\u2002",Eogon:"\u0118",eogon:"\u0119",Eopf:"\u{1D53C}",eopf:"\u{1D556}",epar:"\u22D5",eparsl:"\u29E3",eplus:"\u2A71",epsi:"\u03B5",Epsilon:"\u0395",epsilon:"\u03B5",epsiv:"\u03F5",eqcirc:"\u2256",eqcolon:"\u2255",eqsim:"\u2242",eqslantgtr:"\u2A96",eqslantless:"\u2A95",Equal:"\u2A75",equals:"=",EqualTilde:"\u2242",equest:"\u225F",Equilibrium:"\u21CC",equiv:"\u2261",equivDD:"\u2A78",eqvparsl:"\u29E5",erarr:"\u2971",erDot:"\u2253",Escr:"\u2130",escr:"\u212F",esdot:"\u2250",Esim:"\u2A73",esim:"\u2242",Eta:"\u0397",eta:"\u03B7",ETH:"\xD0",eth:"\xF0",Euml:"\xCB",euml:"\xEB",euro:"\u20AC",excl:"!",exist:"\u2203",Exists:"\u2203",expectation:"\u2130",ExponentialE:"\u2147",exponentiale:"\u2147",fallingdotseq:"\u2252",Fcy:"\u0424",fcy:"\u0444",female:"\u2640",ffilig:"\uFB03",fflig:"\uFB00",ffllig:"\uFB04",Ffr:"\u{1D509}",ffr:"\u{1D523}",filig:"\uFB01",FilledSmallSquare:"\u25FC",FilledVerySmallSquare:"\u25AA",fjlig:"fj",flat:"\u266D",fllig:"\uFB02",fltns:"\u25B1",fnof:"\u0192",Fopf:"\u{1D53D}",fopf:"\u{1D557}",ForAll:"\u2200",forall:"\u2200",fork:"\u22D4",forkv:"\u2AD9",Fouriertrf:"\u2131",fpartint:"\u2A0D",frac12:"\xBD",frac13:"\u2153",frac14:"\xBC",frac15:"\u2155",frac16:"\u2159",frac18:"\u215B",frac23:"\u2154",frac25:"\u2156",frac34:"\xBE",frac35:"\u2157",frac38:"\u215C",frac45:"\u2158",frac56:"\u215A",frac58:"\u215D",frac78:"\u215E",frasl:"\u2044",frown:"\u2322",Fscr:"\u2131",fscr:"\u{1D4BB}",gacute:"\u01F5",Gamma:"\u0393",gamma:"\u03B3",Gammad:"\u03DC",gammad:"\u03DD",gap:"\u2A86",Gbreve:"\u011E",gbreve:"\u011F",Gcedil:"\u0122",Gcirc:"\u011C",gcirc:"\u011D",Gcy:"\u0413",gcy:"\u0433",Gdot:"\u0120",gdot:"\u0121",gE:"\u2267",ge:"\u2265",gEl:"\u2A8C",gel:"\u22DB",geq:"\u2265",geqq:"\u2267",geqslant:"\u2A7E",ges:"\u2A7E",gescc:"\u2AA9",gesdot:"\u2A80",gesdoto:"\u2A82",gesdotol:"\u2A84",gesl:"\u22DB\uFE00",gesles:"\u2A94",Gfr:"\u{1D50A}",gfr:"\u{1D524}",Gg:"\u22D9",gg:"\u226B",ggg:"\u22D9",gimel:"\u2137",GJcy:"\u0403",gjcy:"\u0453",gl:"\u2277",gla:"\u2AA5",glE:"\u2A92",glj:"\u2AA4",gnap:"\u2A8A",gnapprox:"\u2A8A",gnE:"\u2269",gne:"\u2A88",gneq:"\u2A88",gneqq:"\u2269",gnsim:"\u22E7",Gopf:"\u{1D53E}",gopf:"\u{1D558}",grave:"`",GreaterEqual:"\u2265",GreaterEqualLess:"\u22DB",GreaterFullEqual:"\u2267",GreaterGreater:"\u2AA2",GreaterLess:"\u2277",GreaterSlantEqual:"\u2A7E",GreaterTilde:"\u2273",Gscr:"\u{1D4A2}",gscr:"\u210A",gsim:"\u2273",gsime:"\u2A8E",gsiml:"\u2A90",Gt:"\u226B",GT:">",gt:">",gtcc:"\u2AA7",gtcir:"\u2A7A",gtdot:"\u22D7",gtlPar:"\u2995",gtquest:"\u2A7C",gtrapprox:"\u2A86",gtrarr:"\u2978",gtrdot:"\u22D7",gtreqless:"\u22DB",gtreqqless:"\u2A8C",gtrless:"\u2277",gtrsim:"\u2273",gvertneqq:"\u2269\uFE00",gvnE:"\u2269\uFE00",Hacek:"\u02C7",hairsp:"\u200A",half:"\xBD",hamilt:"\u210B",HARDcy:"\u042A",hardcy:"\u044A",hArr:"\u21D4",harr:"\u2194",harrcir:"\u2948",harrw:"\u21AD",Hat:"^",hbar:"\u210F",Hcirc:"\u0124",hcirc:"\u0125",hearts:"\u2665",heartsuit:"\u2665",hellip:"\u2026",hercon:"\u22B9",Hfr:"\u210C",hfr:"\u{1D525}",HilbertSpace:"\u210B",hksearow:"\u2925",hkswarow:"\u2926",hoarr:"\u21FF",homtht:"\u223B",hookleftarrow:"\u21A9",hookrightarrow:"\u21AA",Hopf:"\u210D",hopf:"\u{1D559}",horbar:"\u2015",HorizontalLine:"\u2500",Hscr:"\u210B",hscr:"\u{1D4BD}",hslash:"\u210F",Hstrok:"\u0126",hstrok:"\u0127",HumpDownHump:"\u224E",HumpEqual:"\u224F",hybull:"\u2043",hyphen:"\u2010",Iacute:"\xCD",iacute:"\xED",ic:"\u2063",Icirc:"\xCE",icirc:"\xEE",Icy:"\u0418",icy:"\u0438",Idot:"\u0130",IEcy:"\u0415",iecy:"\u0435",iexcl:"\xA1",iff:"\u21D4",Ifr:"\u2111",ifr:"\u{1D526}",Igrave:"\xCC",igrave:"\xEC",ii:"\u2148",iiiint:"\u2A0C",iiint:"\u222D",iinfin:"\u29DC",iiota:"\u2129",IJlig:"\u0132",ijlig:"\u0133",Im:"\u2111",Imacr:"\u012A",imacr:"\u012B",image:"\u2111",ImaginaryI:"\u2148",imagline:"\u2110",imagpart:"\u2111",imath:"\u0131",imof:"\u22B7",imped:"\u01B5",Implies:"\u21D2",in:"\u2208",incare:"\u2105",infin:"\u221E",infintie:"\u29DD",inodot:"\u0131",Int:"\u222C",int:"\u222B",intcal:"\u22BA",integers:"\u2124",Integral:"\u222B",intercal:"\u22BA",Intersection:"\u22C2",intlarhk:"\u2A17",intprod:"\u2A3C",InvisibleComma:"\u2063",InvisibleTimes:"\u2062",IOcy:"\u0401",iocy:"\u0451",Iogon:"\u012E",iogon:"\u012F",Iopf:"\u{1D540}",iopf:"\u{1D55A}",Iota:"\u0399",iota:"\u03B9",iprod:"\u2A3C",iquest:"\xBF",Iscr:"\u2110",iscr:"\u{1D4BE}",isin:"\u2208",isindot:"\u22F5",isinE:"\u22F9",isins:"\u22F4",isinsv:"\u22F3",isinv:"\u2208",it:"\u2062",Itilde:"\u0128",itilde:"\u0129",Iukcy:"\u0406",iukcy:"\u0456",Iuml:"\xCF",iuml:"\xEF",Jcirc:"\u0134",jcirc:"\u0135",Jcy:"\u0419",jcy:"\u0439",Jfr:"\u{1D50D}",jfr:"\u{1D527}",jmath:"\u0237",Jopf:"\u{1D541}",jopf:"\u{1D55B}",Jscr:"\u{1D4A5}",jscr:"\u{1D4BF}",Jsercy:"\u0408",jsercy:"\u0458",Jukcy:"\u0404",jukcy:"\u0454",Kappa:"\u039A",kappa:"\u03BA",kappav:"\u03F0",Kcedil:"\u0136",kcedil:"\u0137",Kcy:"\u041A",kcy:"\u043A",Kfr:"\u{1D50E}",kfr:"\u{1D528}",kgreen:"\u0138",KHcy:"\u0425",khcy:"\u0445",KJcy:"\u040C",kjcy:"\u045C",Kopf:"\u{1D542}",kopf:"\u{1D55C}",Kscr:"\u{1D4A6}",kscr:"\u{1D4C0}",lAarr:"\u21DA",Lacute:"\u0139",lacute:"\u013A",laemptyv:"\u29B4",lagran:"\u2112",Lambda:"\u039B",lambda:"\u03BB",Lang:"\u27EA",lang:"\u27E8",langd:"\u2991",langle:"\u27E8",lap:"\u2A85",Laplacetrf:"\u2112",laquo:"\xAB",Larr:"\u219E",lArr:"\u21D0",larr:"\u2190",larrb:"\u21E4",larrbfs:"\u291F",larrfs:"\u291D",larrhk:"\u21A9",larrlp:"\u21AB",larrpl:"\u2939",larrsim:"\u2973",larrtl:"\u21A2",lat:"\u2AAB",lAtail:"\u291B",latail:"\u2919",late:"\u2AAD",lates:"\u2AAD\uFE00",lBarr:"\u290E",lbarr:"\u290C",lbbrk:"\u2772",lbrace:"{",lbrack:"[",lbrke:"\u298B",lbrksld:"\u298F",lbrkslu:"\u298D",Lcaron:"\u013D",lcaron:"\u013E",Lcedil:"\u013B",lcedil:"\u013C",lceil:"\u2308",lcub:"{",Lcy:"\u041B",lcy:"\u043B",ldca:"\u2936",ldquo:"\u201C",ldquor:"\u201E",ldrdhar:"\u2967",ldrushar:"\u294B",ldsh:"\u21B2",lE:"\u2266",le:"\u2264",LeftAngleBracket:"\u27E8",LeftArrow:"\u2190",Leftarrow:"\u21D0",leftarrow:"\u2190",LeftArrowBar:"\u21E4",LeftArrowRightArrow:"\u21C6",leftarrowtail:"\u21A2",LeftCeiling:"\u2308",LeftDoubleBracket:"\u27E6",LeftDownTeeVector:"\u2961",LeftDownVector:"\u21C3",LeftDownVectorBar:"\u2959",LeftFloor:"\u230A",leftharpoondown:"\u21BD",leftharpoonup:"\u21BC",leftleftarrows:"\u21C7",LeftRightArrow:"\u2194",Leftrightarrow:"\u21D4",leftrightarrow:"\u2194",leftrightarrows:"\u21C6",leftrightharpoons:"\u21CB",leftrightsquigarrow:"\u21AD",LeftRightVector:"\u294E",LeftTee:"\u22A3",LeftTeeArrow:"\u21A4",LeftTeeVector:"\u295A",leftthreetimes:"\u22CB",LeftTriangle:"\u22B2",LeftTriangleBar:"\u29CF",LeftTriangleEqual:"\u22B4",LeftUpDownVector:"\u2951",LeftUpTeeVector:"\u2960",LeftUpVector:"\u21BF",LeftUpVectorBar:"\u2958",LeftVector:"\u21BC",LeftVectorBar:"\u2952",lEg:"\u2A8B",leg:"\u22DA",leq:"\u2264",leqq:"\u2266",leqslant:"\u2A7D",les:"\u2A7D",lescc:"\u2AA8",lesdot:"\u2A7F",lesdoto:"\u2A81",lesdotor:"\u2A83",lesg:"\u22DA\uFE00",lesges:"\u2A93",lessapprox:"\u2A85",lessdot:"\u22D6",lesseqgtr:"\u22DA",lesseqqgtr:"\u2A8B",LessEqualGreater:"\u22DA",LessFullEqual:"\u2266",LessGreater:"\u2276",lessgtr:"\u2276",LessLess:"\u2AA1",lesssim:"\u2272",LessSlantEqual:"\u2A7D",LessTilde:"\u2272",lfisht:"\u297C",lfloor:"\u230A",Lfr:"\u{1D50F}",lfr:"\u{1D529}",lg:"\u2276",lgE:"\u2A91",lHar:"\u2962",lhard:"\u21BD",lharu:"\u21BC",lharul:"\u296A",lhblk:"\u2584",LJcy:"\u0409",ljcy:"\u0459",Ll:"\u22D8",ll:"\u226A",llarr:"\u21C7",llcorner:"\u231E",Lleftarrow:"\u21DA",llhard:"\u296B",lltri:"\u25FA",Lmidot:"\u013F",lmidot:"\u0140",lmoust:"\u23B0",lmoustache:"\u23B0",lnap:"\u2A89",lnapprox:"\u2A89",lnE:"\u2268",lne:"\u2A87",lneq:"\u2A87",lneqq:"\u2268",lnsim:"\u22E6",loang:"\u27EC",loarr:"\u21FD",lobrk:"\u27E6",LongLeftArrow:"\u27F5",Longleftarrow:"\u27F8",longleftarrow:"\u27F5",LongLeftRightArrow:"\u27F7",Longleftrightarrow:"\u27FA",longleftrightarrow:"\u27F7",longmapsto:"\u27FC",LongRightArrow:"\u27F6",Longrightarrow:"\u27F9",longrightarrow:"\u27F6",looparrowleft:"\u21AB",looparrowright:"\u21AC",lopar:"\u2985",Lopf:"\u{1D543}",lopf:"\u{1D55D}",loplus:"\u2A2D",lotimes:"\u2A34",lowast:"\u2217",lowbar:"_",LowerLeftArrow:"\u2199",LowerRightArrow:"\u2198",loz:"\u25CA",lozenge:"\u25CA",lozf:"\u29EB",lpar:"(",lparlt:"\u2993",lrarr:"\u21C6",lrcorner:"\u231F",lrhar:"\u21CB",lrhard:"\u296D",lrm:"\u200E",lrtri:"\u22BF",lsaquo:"\u2039",Lscr:"\u2112",lscr:"\u{1D4C1}",Lsh:"\u21B0",lsh:"\u21B0",lsim:"\u2272",lsime:"\u2A8D",lsimg:"\u2A8F",lsqb:"[",lsquo:"\u2018",lsquor:"\u201A",Lstrok:"\u0141",lstrok:"\u0142",Lt:"\u226A",LT:"<",lt:"<",ltcc:"\u2AA6",ltcir:"\u2A79",ltdot:"\u22D6",lthree:"\u22CB",ltimes:"\u22C9",ltlarr:"\u2976",ltquest:"\u2A7B",ltri:"\u25C3",ltrie:"\u22B4",ltrif:"\u25C2",ltrPar:"\u2996",lurdshar:"\u294A",luruhar:"\u2966",lvertneqq:"\u2268\uFE00",lvnE:"\u2268\uFE00",macr:"\xAF",male:"\u2642",malt:"\u2720",maltese:"\u2720",Map:"\u2905",map:"\u21A6",mapsto:"\u21A6",mapstodown:"\u21A7",mapstoleft:"\u21A4",mapstoup:"\u21A5",marker:"\u25AE",mcomma:"\u2A29",Mcy:"\u041C",mcy:"\u043C",mdash:"\u2014",mDDot:"\u223A",measuredangle:"\u2221",MediumSpace:"\u205F",Mellintrf:"\u2133",Mfr:"\u{1D510}",mfr:"\u{1D52A}",mho:"\u2127",micro:"\xB5",mid:"\u2223",midast:"*",midcir:"\u2AF0",middot:"\xB7",minus:"\u2212",minusb:"\u229F",minusd:"\u2238",minusdu:"\u2A2A",MinusPlus:"\u2213",mlcp:"\u2ADB",mldr:"\u2026",mnplus:"\u2213",models:"\u22A7",Mopf:"\u{1D544}",mopf:"\u{1D55E}",mp:"\u2213",Mscr:"\u2133",mscr:"\u{1D4C2}",mstpos:"\u223E",Mu:"\u039C",mu:"\u03BC",multimap:"\u22B8",mumap:"\u22B8",nabla:"\u2207",Nacute:"\u0143",nacute:"\u0144",nang:"\u2220\u20D2",nap:"\u2249",napE:"\u2A70\u0338",napid:"\u224B\u0338",napos:"\u0149",napprox:"\u2249",natur:"\u266E",natural:"\u266E",naturals:"\u2115",nbsp:"\xA0",nbump:"\u224E\u0338",nbumpe:"\u224F\u0338",ncap:"\u2A43",Ncaron:"\u0147",ncaron:"\u0148",Ncedil:"\u0145",ncedil:"\u0146",ncong:"\u2247",ncongdot:"\u2A6D\u0338",ncup:"\u2A42",Ncy:"\u041D",ncy:"\u043D",ndash:"\u2013",ne:"\u2260",nearhk:"\u2924",neArr:"\u21D7",nearr:"\u2197",nearrow:"\u2197",nedot:"\u2250\u0338",NegativeMediumSpace:"\u200B",NegativeThickSpace:"\u200B",NegativeThinSpace:"\u200B",NegativeVeryThinSpace:"\u200B",nequiv:"\u2262",nesear:"\u2928",nesim:"\u2242\u0338",NestedGreaterGreater:"\u226B",NestedLessLess:"\u226A",NewLine:`
`,nexist:"\u2204",nexists:"\u2204",Nfr:"\u{1D511}",nfr:"\u{1D52B}",ngE:"\u2267\u0338",nge:"\u2271",ngeq:"\u2271",ngeqq:"\u2267\u0338",ngeqslant:"\u2A7E\u0338",nges:"\u2A7E\u0338",nGg:"\u22D9\u0338",ngsim:"\u2275",nGt:"\u226B\u20D2",ngt:"\u226F",ngtr:"\u226F",nGtv:"\u226B\u0338",nhArr:"\u21CE",nharr:"\u21AE",nhpar:"\u2AF2",ni:"\u220B",nis:"\u22FC",nisd:"\u22FA",niv:"\u220B",NJcy:"\u040A",njcy:"\u045A",nlArr:"\u21CD",nlarr:"\u219A",nldr:"\u2025",nlE:"\u2266\u0338",nle:"\u2270",nLeftarrow:"\u21CD",nleftarrow:"\u219A",nLeftrightarrow:"\u21CE",nleftrightarrow:"\u21AE",nleq:"\u2270",nleqq:"\u2266\u0338",nleqslant:"\u2A7D\u0338",nles:"\u2A7D\u0338",nless:"\u226E",nLl:"\u22D8\u0338",nlsim:"\u2274",nLt:"\u226A\u20D2",nlt:"\u226E",nltri:"\u22EA",nltrie:"\u22EC",nLtv:"\u226A\u0338",nmid:"\u2224",NoBreak:"\u2060",NonBreakingSpace:"\xA0",Nopf:"\u2115",nopf:"\u{1D55F}",Not:"\u2AEC",not:"\xAC",NotCongruent:"\u2262",NotCupCap:"\u226D",NotDoubleVerticalBar:"\u2226",NotElement:"\u2209",NotEqual:"\u2260",NotEqualTilde:"\u2242\u0338",NotExists:"\u2204",NotGreater:"\u226F",NotGreaterEqual:"\u2271",NotGreaterFullEqual:"\u2267\u0338",NotGreaterGreater:"\u226B\u0338",NotGreaterLess:"\u2279",NotGreaterSlantEqual:"\u2A7E\u0338",NotGreaterTilde:"\u2275",NotHumpDownHump:"\u224E\u0338",NotHumpEqual:"\u224F\u0338",notin:"\u2209",notindot:"\u22F5\u0338",notinE:"\u22F9\u0338",notinva:"\u2209",notinvb:"\u22F7",notinvc:"\u22F6",NotLeftTriangle:"\u22EA",NotLeftTriangleBar:"\u29CF\u0338",NotLeftTriangleEqual:"\u22EC",NotLess:"\u226E",NotLessEqual:"\u2270",NotLessGreater:"\u2278",NotLessLess:"\u226A\u0338",NotLessSlantEqual:"\u2A7D\u0338",NotLessTilde:"\u2274",NotNestedGreaterGreater:"\u2AA2\u0338",NotNestedLessLess:"\u2AA1\u0338",notni:"\u220C",notniva:"\u220C",notnivb:"\u22FE",notnivc:"\u22FD",NotPrecedes:"\u2280",NotPrecedesEqual:"\u2AAF\u0338",NotPrecedesSlantEqual:"\u22E0",NotReverseElement:"\u220C",NotRightTriangle:"\u22EB",NotRightTriangleBar:"\u29D0\u0338",NotRightTriangleEqual:"\u22ED",NotSquareSubset:"\u228F\u0338",NotSquareSubsetEqual:"\u22E2",NotSquareSuperset:"\u2290\u0338",NotSquareSupersetEqual:"\u22E3",NotSubset:"\u2282\u20D2",NotSubsetEqual:"\u2288",NotSucceeds:"\u2281",NotSucceedsEqual:"\u2AB0\u0338",NotSucceedsSlantEqual:"\u22E1",NotSucceedsTilde:"\u227F\u0338",NotSuperset:"\u2283\u20D2",NotSupersetEqual:"\u2289",NotTilde:"\u2241",NotTildeEqual:"\u2244",NotTildeFullEqual:"\u2247",NotTildeTilde:"\u2249",NotVerticalBar:"\u2224",npar:"\u2226",nparallel:"\u2226",nparsl:"\u2AFD\u20E5",npart:"\u2202\u0338",npolint:"\u2A14",npr:"\u2280",nprcue:"\u22E0",npre:"\u2AAF\u0338",nprec:"\u2280",npreceq:"\u2AAF\u0338",nrArr:"\u21CF",nrarr:"\u219B",nrarrc:"\u2933\u0338",nrarrw:"\u219D\u0338",nRightarrow:"\u21CF",nrightarrow:"\u219B",nrtri:"\u22EB",nrtrie:"\u22ED",nsc:"\u2281",nsccue:"\u22E1",nsce:"\u2AB0\u0338",Nscr:"\u{1D4A9}",nscr:"\u{1D4C3}",nshortmid:"\u2224",nshortparallel:"\u2226",nsim:"\u2241",nsime:"\u2244",nsimeq:"\u2244",nsmid:"\u2224",nspar:"\u2226",nsqsube:"\u22E2",nsqsupe:"\u22E3",nsub:"\u2284",nsubE:"\u2AC5\u0338",nsube:"\u2288",nsubset:"\u2282\u20D2",nsubseteq:"\u2288",nsubseteqq:"\u2AC5\u0338",nsucc:"\u2281",nsucceq:"\u2AB0\u0338",nsup:"\u2285",nsupE:"\u2AC6\u0338",nsupe:"\u2289",nsupset:"\u2283\u20D2",nsupseteq:"\u2289",nsupseteqq:"\u2AC6\u0338",ntgl:"\u2279",Ntilde:"\xD1",ntilde:"\xF1",ntlg:"\u2278",ntriangleleft:"\u22EA",ntrianglelefteq:"\u22EC",ntriangleright:"\u22EB",ntrianglerighteq:"\u22ED",Nu:"\u039D",nu:"\u03BD",num:"#",numero:"\u2116",numsp:"\u2007",nvap:"\u224D\u20D2",nVDash:"\u22AF",nVdash:"\u22AE",nvDash:"\u22AD",nvdash:"\u22AC",nvge:"\u2265\u20D2",nvgt:">\u20D2",nvHarr:"\u2904",nvinfin:"\u29DE",nvlArr:"\u2902",nvle:"\u2264\u20D2",nvlt:"<\u20D2",nvltrie:"\u22B4\u20D2",nvrArr:"\u2903",nvrtrie:"\u22B5\u20D2",nvsim:"\u223C\u20D2",nwarhk:"\u2923",nwArr:"\u21D6",nwarr:"\u2196",nwarrow:"\u2196",nwnear:"\u2927",Oacute:"\xD3",oacute:"\xF3",oast:"\u229B",ocir:"\u229A",Ocirc:"\xD4",ocirc:"\xF4",Ocy:"\u041E",ocy:"\u043E",odash:"\u229D",Odblac:"\u0150",odblac:"\u0151",odiv:"\u2A38",odot:"\u2299",odsold:"\u29BC",OElig:"\u0152",oelig:"\u0153",ofcir:"\u29BF",Ofr:"\u{1D512}",ofr:"\u{1D52C}",ogon:"\u02DB",Ograve:"\xD2",ograve:"\xF2",ogt:"\u29C1",ohbar:"\u29B5",ohm:"\u03A9",oint:"\u222E",olarr:"\u21BA",olcir:"\u29BE",olcross:"\u29BB",oline:"\u203E",olt:"\u29C0",Omacr:"\u014C",omacr:"\u014D",Omega:"\u03A9",omega:"\u03C9",Omicron:"\u039F",omicron:"\u03BF",omid:"\u29B6",ominus:"\u2296",Oopf:"\u{1D546}",oopf:"\u{1D560}",opar:"\u29B7",OpenCurlyDoubleQuote:"\u201C",OpenCurlyQuote:"\u2018",operp:"\u29B9",oplus:"\u2295",Or:"\u2A54",or:"\u2228",orarr:"\u21BB",ord:"\u2A5D",order:"\u2134",orderof:"\u2134",ordf:"\xAA",ordm:"\xBA",origof:"\u22B6",oror:"\u2A56",orslope:"\u2A57",orv:"\u2A5B",oS:"\u24C8",Oscr:"\u{1D4AA}",oscr:"\u2134",Oslash:"\xD8",oslash:"\xF8",osol:"\u2298",Otilde:"\xD5",otilde:"\xF5",Otimes:"\u2A37",otimes:"\u2297",otimesas:"\u2A36",Ouml:"\xD6",ouml:"\xF6",ovbar:"\u233D",OverBar:"\u203E",OverBrace:"\u23DE",OverBracket:"\u23B4",OverParenthesis:"\u23DC",par:"\u2225",para:"\xB6",parallel:"\u2225",parsim:"\u2AF3",parsl:"\u2AFD",part:"\u2202",PartialD:"\u2202",Pcy:"\u041F",pcy:"\u043F",percnt:"%",period:".",permil:"\u2030",perp:"\u22A5",pertenk:"\u2031",Pfr:"\u{1D513}",pfr:"\u{1D52D}",Phi:"\u03A6",phi:"\u03C6",phiv:"\u03D5",phmmat:"\u2133",phone:"\u260E",Pi:"\u03A0",pi:"\u03C0",pitchfork:"\u22D4",piv:"\u03D6",planck:"\u210F",planckh:"\u210E",plankv:"\u210F",plus:"+",plusacir:"\u2A23",plusb:"\u229E",pluscir:"\u2A22",plusdo:"\u2214",plusdu:"\u2A25",pluse:"\u2A72",PlusMinus:"\xB1",plusmn:"\xB1",plussim:"\u2A26",plustwo:"\u2A27",pm:"\xB1",Poincareplane:"\u210C",pointint:"\u2A15",Popf:"\u2119",popf:"\u{1D561}",pound:"\xA3",Pr:"\u2ABB",pr:"\u227A",prap:"\u2AB7",prcue:"\u227C",prE:"\u2AB3",pre:"\u2AAF",prec:"\u227A",precapprox:"\u2AB7",preccurlyeq:"\u227C",Precedes:"\u227A",PrecedesEqual:"\u2AAF",PrecedesSlantEqual:"\u227C",PrecedesTilde:"\u227E",preceq:"\u2AAF",precnapprox:"\u2AB9",precneqq:"\u2AB5",precnsim:"\u22E8",precsim:"\u227E",Prime:"\u2033",prime:"\u2032",primes:"\u2119",prnap:"\u2AB9",prnE:"\u2AB5",prnsim:"\u22E8",prod:"\u220F",Product:"\u220F",profalar:"\u232E",profline:"\u2312",profsurf:"\u2313",prop:"\u221D",Proportion:"\u2237",Proportional:"\u221D",propto:"\u221D",prsim:"\u227E",prurel:"\u22B0",Pscr:"\u{1D4AB}",pscr:"\u{1D4C5}",Psi:"\u03A8",psi:"\u03C8",puncsp:"\u2008",Qfr:"\u{1D514}",qfr:"\u{1D52E}",qint:"\u2A0C",Qopf:"\u211A",qopf:"\u{1D562}",qprime:"\u2057",Qscr:"\u{1D4AC}",qscr:"\u{1D4C6}",quaternions:"\u210D",quatint:"\u2A16",quest:"?",questeq:"\u225F",QUOT:'"',quot:'"',rAarr:"\u21DB",race:"\u223D\u0331",Racute:"\u0154",racute:"\u0155",radic:"\u221A",raemptyv:"\u29B3",Rang:"\u27EB",rang:"\u27E9",rangd:"\u2992",range:"\u29A5",rangle:"\u27E9",raquo:"\xBB",Rarr:"\u21A0",rArr:"\u21D2",rarr:"\u2192",rarrap:"\u2975",rarrb:"\u21E5",rarrbfs:"\u2920",rarrc:"\u2933",rarrfs:"\u291E",rarrhk:"\u21AA",rarrlp:"\u21AC",rarrpl:"\u2945",rarrsim:"\u2974",Rarrtl:"\u2916",rarrtl:"\u21A3",rarrw:"\u219D",rAtail:"\u291C",ratail:"\u291A",ratio:"\u2236",rationals:"\u211A",RBarr:"\u2910",rBarr:"\u290F",rbarr:"\u290D",rbbrk:"\u2773",rbrace:"}",rbrack:"]",rbrke:"\u298C",rbrksld:"\u298E",rbrkslu:"\u2990",Rcaron:"\u0158",rcaron:"\u0159",Rcedil:"\u0156",rcedil:"\u0157",rceil:"\u2309",rcub:"}",Rcy:"\u0420",rcy:"\u0440",rdca:"\u2937",rdldhar:"\u2969",rdquo:"\u201D",rdquor:"\u201D",rdsh:"\u21B3",Re:"\u211C",real:"\u211C",realine:"\u211B",realpart:"\u211C",reals:"\u211D",rect:"\u25AD",REG:"\xAE",reg:"\xAE",ReverseElement:"\u220B",ReverseEquilibrium:"\u21CB",ReverseUpEquilibrium:"\u296F",rfisht:"\u297D",rfloor:"\u230B",Rfr:"\u211C",rfr:"\u{1D52F}",rHar:"\u2964",rhard:"\u21C1",rharu:"\u21C0",rharul:"\u296C",Rho:"\u03A1",rho:"\u03C1",rhov:"\u03F1",RightAngleBracket:"\u27E9",RightArrow:"\u2192",Rightarrow:"\u21D2",rightarrow:"\u2192",RightArrowBar:"\u21E5",RightArrowLeftArrow:"\u21C4",rightarrowtail:"\u21A3",RightCeiling:"\u2309",RightDoubleBracket:"\u27E7",RightDownTeeVector:"\u295D",RightDownVector:"\u21C2",RightDownVectorBar:"\u2955",RightFloor:"\u230B",rightharpoondown:"\u21C1",rightharpoonup:"\u21C0",rightleftarrows:"\u21C4",rightleftharpoons:"\u21CC",rightrightarrows:"\u21C9",rightsquigarrow:"\u219D",RightTee:"\u22A2",RightTeeArrow:"\u21A6",RightTeeVector:"\u295B",rightthreetimes:"\u22CC",RightTriangle:"\u22B3",RightTriangleBar:"\u29D0",RightTriangleEqual:"\u22B5",RightUpDownVector:"\u294F",RightUpTeeVector:"\u295C",RightUpVector:"\u21BE",RightUpVectorBar:"\u2954",RightVector:"\u21C0",RightVectorBar:"\u2953",ring:"\u02DA",risingdotseq:"\u2253",rlarr:"\u21C4",rlhar:"\u21CC",rlm:"\u200F",rmoust:"\u23B1",rmoustache:"\u23B1",rnmid:"\u2AEE",roang:"\u27ED",roarr:"\u21FE",robrk:"\u27E7",ropar:"\u2986",Ropf:"\u211D",ropf:"\u{1D563}",roplus:"\u2A2E",rotimes:"\u2A35",RoundImplies:"\u2970",rpar:")",rpargt:"\u2994",rppolint:"\u2A12",rrarr:"\u21C9",Rrightarrow:"\u21DB",rsaquo:"\u203A",Rscr:"\u211B",rscr:"\u{1D4C7}",Rsh:"\u21B1",rsh:"\u21B1",rsqb:"]",rsquo:"\u2019",rsquor:"\u2019",rthree:"\u22CC",rtimes:"\u22CA",rtri:"\u25B9",rtrie:"\u22B5",rtrif:"\u25B8",rtriltri:"\u29CE",RuleDelayed:"\u29F4",ruluhar:"\u2968",rx:"\u211E",Sacute:"\u015A",sacute:"\u015B",sbquo:"\u201A",Sc:"\u2ABC",sc:"\u227B",scap:"\u2AB8",Scaron:"\u0160",scaron:"\u0161",sccue:"\u227D",scE:"\u2AB4",sce:"\u2AB0",Scedil:"\u015E",scedil:"\u015F",Scirc:"\u015C",scirc:"\u015D",scnap:"\u2ABA",scnE:"\u2AB6",scnsim:"\u22E9",scpolint:"\u2A13",scsim:"\u227F",Scy:"\u0421",scy:"\u0441",sdot:"\u22C5",sdotb:"\u22A1",sdote:"\u2A66",searhk:"\u2925",seArr:"\u21D8",searr:"\u2198",searrow:"\u2198",sect:"\xA7",semi:";",seswar:"\u2929",setminus:"\u2216",setmn:"\u2216",sext:"\u2736",Sfr:"\u{1D516}",sfr:"\u{1D530}",sfrown:"\u2322",sharp:"\u266F",SHCHcy:"\u0429",shchcy:"\u0449",SHcy:"\u0428",shcy:"\u0448",ShortDownArrow:"\u2193",ShortLeftArrow:"\u2190",shortmid:"\u2223",shortparallel:"\u2225",ShortRightArrow:"\u2192",ShortUpArrow:"\u2191",shy:"\xAD",Sigma:"\u03A3",sigma:"\u03C3",sigmaf:"\u03C2",sigmav:"\u03C2",sim:"\u223C",simdot:"\u2A6A",sime:"\u2243",simeq:"\u2243",simg:"\u2A9E",simgE:"\u2AA0",siml:"\u2A9D",simlE:"\u2A9F",simne:"\u2246",simplus:"\u2A24",simrarr:"\u2972",slarr:"\u2190",SmallCircle:"\u2218",smallsetminus:"\u2216",smashp:"\u2A33",smeparsl:"\u29E4",smid:"\u2223",smile:"\u2323",smt:"\u2AAA",smte:"\u2AAC",smtes:"\u2AAC\uFE00",SOFTcy:"\u042C",softcy:"\u044C",sol:"/",solb:"\u29C4",solbar:"\u233F",Sopf:"\u{1D54A}",sopf:"\u{1D564}",spades:"\u2660",spadesuit:"\u2660",spar:"\u2225",sqcap:"\u2293",sqcaps:"\u2293\uFE00",sqcup:"\u2294",sqcups:"\u2294\uFE00",Sqrt:"\u221A",sqsub:"\u228F",sqsube:"\u2291",sqsubset:"\u228F",sqsubseteq:"\u2291",sqsup:"\u2290",sqsupe:"\u2292",sqsupset:"\u2290",sqsupseteq:"\u2292",squ:"\u25A1",Square:"\u25A1",square:"\u25A1",SquareIntersection:"\u2293",SquareSubset:"\u228F",SquareSubsetEqual:"\u2291",SquareSuperset:"\u2290",SquareSupersetEqual:"\u2292",SquareUnion:"\u2294",squarf:"\u25AA",squf:"\u25AA",srarr:"\u2192",Sscr:"\u{1D4AE}",sscr:"\u{1D4C8}",ssetmn:"\u2216",ssmile:"\u2323",sstarf:"\u22C6",Star:"\u22C6",star:"\u2606",starf:"\u2605",straightepsilon:"\u03F5",straightphi:"\u03D5",strns:"\xAF",Sub:"\u22D0",sub:"\u2282",subdot:"\u2ABD",subE:"\u2AC5",sube:"\u2286",subedot:"\u2AC3",submult:"\u2AC1",subnE:"\u2ACB",subne:"\u228A",subplus:"\u2ABF",subrarr:"\u2979",Subset:"\u22D0",subset:"\u2282",subseteq:"\u2286",subseteqq:"\u2AC5",SubsetEqual:"\u2286",subsetneq:"\u228A",subsetneqq:"\u2ACB",subsim:"\u2AC7",subsub:"\u2AD5",subsup:"\u2AD3",succ:"\u227B",succapprox:"\u2AB8",succcurlyeq:"\u227D",Succeeds:"\u227B",SucceedsEqual:"\u2AB0",SucceedsSlantEqual:"\u227D",SucceedsTilde:"\u227F",succeq:"\u2AB0",succnapprox:"\u2ABA",succneqq:"\u2AB6",succnsim:"\u22E9",succsim:"\u227F",SuchThat:"\u220B",Sum:"\u2211",sum:"\u2211",sung:"\u266A",Sup:"\u22D1",sup:"\u2283",sup1:"\xB9",sup2:"\xB2",sup3:"\xB3",supdot:"\u2ABE",supdsub:"\u2AD8",supE:"\u2AC6",supe:"\u2287",supedot:"\u2AC4",Superset:"\u2283",SupersetEqual:"\u2287",suphsol:"\u27C9",suphsub:"\u2AD7",suplarr:"\u297B",supmult:"\u2AC2",supnE:"\u2ACC",supne:"\u228B",supplus:"\u2AC0",Supset:"\u22D1",supset:"\u2283",supseteq:"\u2287",supseteqq:"\u2AC6",supsetneq:"\u228B",supsetneqq:"\u2ACC",supsim:"\u2AC8",supsub:"\u2AD4",supsup:"\u2AD6",swarhk:"\u2926",swArr:"\u21D9",swarr:"\u2199",swarrow:"\u2199",swnwar:"\u292A",szlig:"\xDF",Tab:"	",target:"\u2316",Tau:"\u03A4",tau:"\u03C4",tbrk:"\u23B4",Tcaron:"\u0164",tcaron:"\u0165",Tcedil:"\u0162",tcedil:"\u0163",Tcy:"\u0422",tcy:"\u0442",tdot:"\u20DB",telrec:"\u2315",Tfr:"\u{1D517}",tfr:"\u{1D531}",there4:"\u2234",Therefore:"\u2234",therefore:"\u2234",Theta:"\u0398",theta:"\u03B8",thetasym:"\u03D1",thetav:"\u03D1",thickapprox:"\u2248",thicksim:"\u223C",ThickSpace:"\u205F\u200A",thinsp:"\u2009",ThinSpace:"\u2009",thkap:"\u2248",thksim:"\u223C",THORN:"\xDE",thorn:"\xFE",Tilde:"\u223C",tilde:"\u02DC",TildeEqual:"\u2243",TildeFullEqual:"\u2245",TildeTilde:"\u2248",times:"\xD7",timesb:"\u22A0",timesbar:"\u2A31",timesd:"\u2A30",tint:"\u222D",toea:"\u2928",top:"\u22A4",topbot:"\u2336",topcir:"\u2AF1",Topf:"\u{1D54B}",topf:"\u{1D565}",topfork:"\u2ADA",tosa:"\u2929",tprime:"\u2034",TRADE:"\u2122",trade:"\u2122",triangle:"\u25B5",triangledown:"\u25BF",triangleleft:"\u25C3",trianglelefteq:"\u22B4",triangleq:"\u225C",triangleright:"\u25B9",trianglerighteq:"\u22B5",tridot:"\u25EC",trie:"\u225C",triminus:"\u2A3A",TripleDot:"\u20DB",triplus:"\u2A39",trisb:"\u29CD",tritime:"\u2A3B",trpezium:"\u23E2",Tscr:"\u{1D4AF}",tscr:"\u{1D4C9}",TScy:"\u0426",tscy:"\u0446",TSHcy:"\u040B",tshcy:"\u045B",Tstrok:"\u0166",tstrok:"\u0167",twixt:"\u226C",twoheadleftarrow:"\u219E",twoheadrightarrow:"\u21A0",Uacute:"\xDA",uacute:"\xFA",Uarr:"\u219F",uArr:"\u21D1",uarr:"\u2191",Uarrocir:"\u2949",Ubrcy:"\u040E",ubrcy:"\u045E",Ubreve:"\u016C",ubreve:"\u016D",Ucirc:"\xDB",ucirc:"\xFB",Ucy:"\u0423",ucy:"\u0443",udarr:"\u21C5",Udblac:"\u0170",udblac:"\u0171",udhar:"\u296E",ufisht:"\u297E",Ufr:"\u{1D518}",ufr:"\u{1D532}",Ugrave:"\xD9",ugrave:"\xF9",uHar:"\u2963",uharl:"\u21BF",uharr:"\u21BE",uhblk:"\u2580",ulcorn:"\u231C",ulcorner:"\u231C",ulcrop:"\u230F",ultri:"\u25F8",Umacr:"\u016A",umacr:"\u016B",uml:"\xA8",UnderBar:"_",UnderBrace:"\u23DF",UnderBracket:"\u23B5",UnderParenthesis:"\u23DD",Union:"\u22C3",UnionPlus:"\u228E",Uogon:"\u0172",uogon:"\u0173",Uopf:"\u{1D54C}",uopf:"\u{1D566}",UpArrow:"\u2191",Uparrow:"\u21D1",uparrow:"\u2191",UpArrowBar:"\u2912",UpArrowDownArrow:"\u21C5",UpDownArrow:"\u2195",Updownarrow:"\u21D5",updownarrow:"\u2195",UpEquilibrium:"\u296E",upharpoonleft:"\u21BF",upharpoonright:"\u21BE",uplus:"\u228E",UpperLeftArrow:"\u2196",UpperRightArrow:"\u2197",Upsi:"\u03D2",upsi:"\u03C5",upsih:"\u03D2",Upsilon:"\u03A5",upsilon:"\u03C5",UpTee:"\u22A5",UpTeeArrow:"\u21A5",upuparrows:"\u21C8",urcorn:"\u231D",urcorner:"\u231D",urcrop:"\u230E",Uring:"\u016E",uring:"\u016F",urtri:"\u25F9",Uscr:"\u{1D4B0}",uscr:"\u{1D4CA}",utdot:"\u22F0",Utilde:"\u0168",utilde:"\u0169",utri:"\u25B5",utrif:"\u25B4",uuarr:"\u21C8",Uuml:"\xDC",uuml:"\xFC",uwangle:"\u29A7",vangrt:"\u299C",varepsilon:"\u03F5",varkappa:"\u03F0",varnothing:"\u2205",varphi:"\u03D5",varpi:"\u03D6",varpropto:"\u221D",vArr:"\u21D5",varr:"\u2195",varrho:"\u03F1",varsigma:"\u03C2",varsubsetneq:"\u228A\uFE00",varsubsetneqq:"\u2ACB\uFE00",varsupsetneq:"\u228B\uFE00",varsupsetneqq:"\u2ACC\uFE00",vartheta:"\u03D1",vartriangleleft:"\u22B2",vartriangleright:"\u22B3",Vbar:"\u2AEB",vBar:"\u2AE8",vBarv:"\u2AE9",Vcy:"\u0412",vcy:"\u0432",VDash:"\u22AB",Vdash:"\u22A9",vDash:"\u22A8",vdash:"\u22A2",Vdashl:"\u2AE6",Vee:"\u22C1",vee:"\u2228",veebar:"\u22BB",veeeq:"\u225A",vellip:"\u22EE",Verbar:"\u2016",verbar:"|",Vert:"\u2016",vert:"|",VerticalBar:"\u2223",VerticalLine:"|",VerticalSeparator:"\u2758",VerticalTilde:"\u2240",VeryThinSpace:"\u200A",Vfr:"\u{1D519}",vfr:"\u{1D533}",vltri:"\u22B2",vnsub:"\u2282\u20D2",vnsup:"\u2283\u20D2",Vopf:"\u{1D54D}",vopf:"\u{1D567}",vprop:"\u221D",vrtri:"\u22B3",Vscr:"\u{1D4B1}",vscr:"\u{1D4CB}",vsubnE:"\u2ACB\uFE00",vsubne:"\u228A\uFE00",vsupnE:"\u2ACC\uFE00",vsupne:"\u228B\uFE00",Vvdash:"\u22AA",vzigzag:"\u299A",Wcirc:"\u0174",wcirc:"\u0175",wedbar:"\u2A5F",Wedge:"\u22C0",wedge:"\u2227",wedgeq:"\u2259",weierp:"\u2118",Wfr:"\u{1D51A}",wfr:"\u{1D534}",Wopf:"\u{1D54E}",wopf:"\u{1D568}",wp:"\u2118",wr:"\u2240",wreath:"\u2240",Wscr:"\u{1D4B2}",wscr:"\u{1D4CC}",xcap:"\u22C2",xcirc:"\u25EF",xcup:"\u22C3",xdtri:"\u25BD",Xfr:"\u{1D51B}",xfr:"\u{1D535}",xhArr:"\u27FA",xharr:"\u27F7",Xi:"\u039E",xi:"\u03BE",xlArr:"\u27F8",xlarr:"\u27F5",xmap:"\u27FC",xnis:"\u22FB",xodot:"\u2A00",Xopf:"\u{1D54F}",xopf:"\u{1D569}",xoplus:"\u2A01",xotime:"\u2A02",xrArr:"\u27F9",xrarr:"\u27F6",Xscr:"\u{1D4B3}",xscr:"\u{1D4CD}",xsqcup:"\u2A06",xuplus:"\u2A04",xutri:"\u25B3",xvee:"\u22C1",xwedge:"\u22C0",Yacute:"\xDD",yacute:"\xFD",YAcy:"\u042F",yacy:"\u044F",Ycirc:"\u0176",ycirc:"\u0177",Ycy:"\u042B",ycy:"\u044B",yen:"\xA5",Yfr:"\u{1D51C}",yfr:"\u{1D536}",YIcy:"\u0407",yicy:"\u0457",Yopf:"\u{1D550}",yopf:"\u{1D56A}",Yscr:"\u{1D4B4}",yscr:"\u{1D4CE}",YUcy:"\u042E",yucy:"\u044E",Yuml:"\u0178",yuml:"\xFF",Zacute:"\u0179",zacute:"\u017A",Zcaron:"\u017D",zcaron:"\u017E",Zcy:"\u0417",zcy:"\u0437",Zdot:"\u017B",zdot:"\u017C",zeetrf:"\u2128",ZeroWidthSpace:"\u200B",Zeta:"\u0396",zeta:"\u03B6",Zfr:"\u2128",zfr:"\u{1D537}",ZHcy:"\u0416",zhcy:"\u0436",zigrarr:"\u21DD",Zopf:"\u2124",zopf:"\u{1D56B}",Zscr:"\u{1D4B5}",zscr:"\u{1D4CF}",zwj:"\u200D",zwnj:"\u200C"}),t.entityMap=t.HTML_ENTITIES}),gs=(Go.XML_ENTITIES,ds.NAMESPACE),Cr=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,xr=new RegExp("[\\-\\.0-9"+Cr.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Od=new RegExp("^"+Cr.source+xr.source+"*(?::"+Cr.source+xr.source+"*)?$"),ys=0,jn=1,kr=2,ca=3,Nr=4,vs=5,bs=6,ha=7;function _s(s,t){this.message=s,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,_s)}function Dd(){}function Pd(s,t){return t.lineNumber=s.lineNumber,t.columnNumber=s.columnNumber,t}function Rd(s,t,i){for(var a=s.tagName,o=null,l=s.length;l--;){var h=s[l],B=h.qName,T=h.value,B=0<(H=B.indexOf(":"))?(G=h.prefix=B.slice(0,H),se=B.slice(H+1),G==="xmlns"&&se):(G=null,(se=B)==="xmlns"&&"");h.localName=se,B!==!1&&(o==null&&(o={},Ld(i,i={})),i[B]=o[B]=T,h.uri=gs.XMLNS,t.startPrefixMapping(B,T))}for(var G,l=s.length;l--;)(G=(h=s[l]).prefix)&&(G==="xml"&&(h.uri=gs.XML),G!=="xmlns")&&(h.uri=i[G||""]);var H,se=0<(H=a.indexOf(":"))?(G=s.prefix=a.slice(0,H),s.localName=a.slice(H+1)):(G=null,s.localName=a),pe=s.uri=i[G||""];if(t.startElement(pe,se,a,s),!s.closed)return s.currentNSMap=i,s.localNSMap=o,1;if(t.endElement(pe,se,a),o)for(G in o)Object.prototype.hasOwnProperty.call(o,G)&&t.endPrefixMapping(G)}function Ld(s,t){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i])}function Md(){this.attributeNames={}}(_s.prototype=new Error).name=_s.name,Dd.prototype={parse:function(s,t,i){var a=this.domBuilder;a.startDocument(),Ld(t,t={}),function(o,l,h,T,B){function G(lt){var ht=lt.slice(1,-1);return Object.hasOwnProperty.call(h,ht)?h[ht]:ht.charAt(0)==="#"?65535<(ht=parseInt(ht.substr(1).replace("x","0x")))?(ht-=65536,String.fromCharCode(55296+(ht>>10),56320+(1023&ht))):String.fromCharCode(ht):(B.error("entity not found:"+lt),lt)}function H(lt){var ht;Pe<lt&&(ht=o.substring(Pe,lt).replace(/&#?\w+;/g,G),Ce&&se(Pe),T.characters(ht,0,lt-Pe),Pe=lt)}function se(lt,ht){for(;ae<=lt&&(ht=_e.exec(o));)pe=ht.index,ae=pe+ht[0].length,Ce.lineNumber++;Ce.columnNumber=lt-pe+1}for(var pe=0,ae=0,_e=/.*(?:\r\n?|\n)|.*$/g,Ce=T.locator,Le=[{currentNSMap:l}],xe={},Pe=0;;){try{var Ae,st,Ue=o.indexOf("<",Pe);if(Ue<0)return o.substr(Pe).match(/^\s*$/)||(Ae=T.doc,st=Ae.createTextNode(o.substr(Pe)),Ae.appendChild(st),T.currentElement=st);switch(Pe<Ue&&H(Ue),o.charAt(Ue+1)){case"/":var xt=o.indexOf(">",Ue+3),ft=o.substring(Ue+2,xt).replace(/[ \t\n\r]+$/g,""),Et=Le.pop(),dt=(xt<0?(ft=o.substring(Ue+2).replace(/[\s<].*/,""),B.error("end tag name: "+ft+" is not complete:"+Et.tagName),xt=Ue+1+ft.length):ft.match(/\s</)&&(ft=ft.replace(/[\s<].*/,""),B.error("end tag name: "+ft+" maybe not complete"),xt=Ue+1+ft.length),Et.localNSMap),Ot=Et.tagName==ft;if(Ot||Et.tagName&&Et.tagName.toLowerCase()==ft.toLowerCase()){if(T.endElement(Et.uri,Et.localName,ft),dt)for(var Ct in dt)Object.prototype.hasOwnProperty.call(dt,Ct)&&T.endPrefixMapping(Ct);Ot||B.fatalError("end tag name: "+ft+" is not match the current start tagName:"+Et.tagName)}else Le.push(Et);xt++;break;case"?":Ce&&se(Ue),xt=function(lt,ht,Ft){var Xt=lt.indexOf("?>",ht);return Xt&&(lt=lt.substring(ht,Xt).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/),lt)?(lt[0].length,Ft.processingInstruction(lt[1],lt[2]),Xt+2):-1}(o,Ue,T);break;case"!":Ce&&se(Ue),xt=function(lt,ht,Ft,Xt){{if(lt.charAt(ht+2)==="-")return lt.charAt(ht+3)==="-"?(Jt=lt.indexOf("-->",ht+4),ht<Jt?(Ft.comment(lt,ht+4,Jt-ht-4),Jt+3):(Xt.error("Unclosed comment"),-1)):-1;if(lt.substr(ht+3,6)=="CDATA[")return Jt=lt.indexOf("]]>",ht+9),Ft.startCDATA(),Ft.characters(lt,ht+9,Jt-ht-9),Ft.endCDATA(),Jt+3;var Ci,Xt=function(fi,Wt){var Gt,Mt=[],Ht=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(Ht.lastIndex=Wt,Ht.exec(fi);Gt=Ht.exec(fi);)if(Mt.push(Gt),Gt[1])return Mt}(lt,ht),Jt=Xt.length;if(1<Jt&&/!doctype/i.test(Xt[0][0]))return lt=Xt[1][0],Ci=ht=!1,3<Jt&&(/^public$/i.test(Xt[2][0])?(ht=Xt[3][0],Ci=4<Jt&&Xt[4][0]):/^system$/i.test(Xt[2][0])&&(Ci=Xt[3][0])),Xt=Xt[Jt-1],Ft.startDTD(lt,ht,Ci),Ft.endDTD(),Xt.index+Xt[0].length}return-1}(o,Ue,T,B);break;default:Ce&&se(Ue);var Lt=new Md,jt=Le[Le.length-1].currentNSMap,xt=function(lt,ht,Ft,Xt,Ci,Jt){function ji(sn,an,Mn){Ft.attributeNames.hasOwnProperty(sn)&&Jt.fatalError("Attribute "+sn+" redefined"),Ft.addValue(sn,an.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,Ci),Mn)}for(var fi,Wt=++ht,Gt=ys;;){var Mt=lt.charAt(Wt);switch(Mt){case"=":if(Gt===jn)fi=lt.slice(ht,Wt);else if(Gt!==kr)throw new Error("attribute equal must after attrName");Gt=ca;break;case"'":case'"':if(Gt===ca||Gt===jn){if(Gt===jn&&(Jt.warning('attribute value must after "="'),fi=lt.slice(ht,Wt)),ht=Wt+1,!(0<(Wt=lt.indexOf(Mt,ht))))throw new Error("attribute value no end '"+Mt+"' match");Ht=lt.slice(ht,Wt),ji(fi,Ht,ht-1)}else{if(Gt!=Nr)throw new Error('attribute value must after "="');Ht=lt.slice(ht,Wt),ji(fi,Ht,ht),Jt.warning('attribute "'+fi+'" missed start quot('+Mt+")!!"),ht=Wt+1}Gt=vs;break;case"/":switch(Gt){case ys:Ft.setTagName(lt.slice(ht,Wt));case vs:case bs:case ha:Gt=ha,Ft.closed=!0;case Nr:case jn:break;case kr:Ft.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return Jt.error("unexpected end of input"),Gt==ys&&Ft.setTagName(lt.slice(ht,Wt)),Wt;case">":switch(Gt){case ys:Ft.setTagName(lt.slice(ht,Wt));case vs:case bs:case ha:break;case Nr:case jn:(Ht=lt.slice(ht,Wt)).slice(-1)==="/"&&(Ft.closed=!0,Ht=Ht.slice(0,-1));case kr:Gt===kr&&(Ht=fi),Gt==Nr?(Jt.warning('attribute "'+Ht+'" missed quot(")!'),ji(fi,Ht,ht)):(gs.isHTML(Xt[""])&&Ht.match(/^(?:disabled|checked|selected)$/i)||Jt.warning('attribute "'+Ht+'" missed value!! "'+Ht+'" instead!!'),ji(Ht,Ht,ht));break;case ca:throw new Error("attribute value missed!!")}return Wt;case"\x80":Mt=" ";default:if(Mt<=" ")switch(Gt){case ys:Ft.setTagName(lt.slice(ht,Wt)),Gt=bs;break;case jn:fi=lt.slice(ht,Wt),Gt=kr;break;case Nr:var Ht=lt.slice(ht,Wt);Jt.warning('attribute "'+Ht+'" missed quot(")!!'),ji(fi,Ht,ht);case vs:Gt=bs}else switch(Gt){case kr:Ft.tagName,gs.isHTML(Xt[""])&&fi.match(/^(?:disabled|checked|selected)$/i)||Jt.warning('attribute "'+fi+'" missed value!! "'+fi+'" instead2!!'),ji(fi,fi,ht),ht=Wt,Gt=jn;break;case vs:Jt.warning('attribute space is required"'+fi+'"!!');case bs:Gt=jn,ht=Wt;break;case ca:Gt=Nr,ht=Wt;break;case ha:throw new Error("elements closed character '/' and '>' must be connected to")}}Wt++}}(o,Ue,Lt,jt,G,B),Zt=Lt.length;if(!Lt.closed&&function(lt,ht,Ft,Xt){var Ci=Xt[Ft];return Ci==null&&((Ci=lt.lastIndexOf("</"+Ft+">"))<ht&&(Ci=lt.lastIndexOf("</"+Ft)),Xt[Ft]=Ci),Ci<ht}(o,xt,Lt.tagName,xe)&&(Lt.closed=!0,h.nbsp||B.warning("unclosed xml attribute")),Ce&&Zt){for(var Ti=Pd(Ce,{}),mn=0;mn<Zt;mn++){var si=Lt[mn];se(si.offset),si.locator=Pd(Ce,{})}T.locator=Ti,Rd(Lt,T,jt)&&Le.push(Lt),T.locator=Ce}else Rd(Lt,T,jt)&&Le.push(Lt);gs.isHTML(Lt.uri)&&!Lt.closed?xt=function(lt,ht,Ft,Xt,Ci){if(/^(?:script|textarea)$/i.test(Ft)){var Jt=lt.indexOf("</"+Ft+">",ht),lt=lt.substring(ht+1,Jt);if(/[&<]/.test(lt))return/^script$/i.test(Ft)||(lt=lt.replace(/&#?\w+;/g,Xt)),Ci.characters(lt,0,lt.length),Jt}return ht+1}(o,xt,Lt.tagName,G,T):xt++}}catch(lt){if(lt instanceof _s)throw lt;B.error("element parse error: "+lt),xt=-1}Pe<xt?Pe=xt:H(Math.max(Ue,Pe)+1)}}(s,t,i,a,this.errorHandler),a.endDocument()}},Md.prototype={setTagName:function(s){if(!Od.test(s))throw new Error("invalid tagName:"+s);this.tagName=s},addValue:function(s,t,i){if(!Od.test(s))throw new Error("invalid attribute:"+s);this.attributeNames[s]=this.length,this[this.length++]={qName:s,value:t,offset:i}},length:0,getLocalName:function(s){return this[s].localName},getLocator:function(s){return this[s].locator},getQName:function(s){return this[s].qName},getURI:function(s){return this[s].uri},getValue:function(s){return this[s].value}};var Ar={XMLReader:Dd,ParseError:_s},xf=da.DOMImplementation,Ud=ds.NAMESPACE,kf=Ar.ParseError,Nf=Ar.XMLReader;function Fd(s){return s.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function Bd(s){this.options=s||{locator:{}}}function Ts(){this.cdata=!1}function Ir(s,t){t.lineNumber=s.lineNumber,t.columnNumber=s.columnNumber}function Af(s){if(s)return`
@`+(s.systemId||"")+"#[line:"+s.lineNumber+",col:"+s.columnNumber+"]"}function zd(s,t,i){return typeof s=="string"?s.substr(t,i):s.length>=t+i||t?new java.lang.String(s,t,i)+"":s}function pa(s,t){(s.currentElement||s.doc).appendChild(t)}Bd.prototype.parseFromString=function(s,T){var i=this.options,a=new Nf,o=i.domBuilder||new Ts,G=i.errorHandler,l=i.locator,h=i.xmlns||{},T=/\/x?html?$/.test(T),B=T?Go.HTML_ENTITIES:Go.XML_ENTITIES,G=(l&&o.setDocumentLocator(l),a.errorHandler=function(H,se,pe){if(!H){if(se instanceof Ts)return se;H=se}var ae={},_e=H instanceof Function;function Ce(Le){var xe=H[Le];!xe&&_e&&(xe=H.length==2?function(Pe){H(Le,Pe)}:H),ae[Le]=xe?function(Pe){xe("[xmldom "+Le+"]	"+Pe+Af(pe))}:function(){}}return pe=pe||{},Ce("warning"),Ce("error"),Ce("fatalError"),ae}(G,o,l),a.domBuilder=i.domBuilder||o,T&&(h[""]=Ud.HTML),h.xml=h.xml||Ud.XML,i.normalizeLineEndings||Fd);return s&&typeof s=="string"?a.parse(G(s),h,B):a.errorHandler.error("invalid doc source"),o.doc},Ts.prototype={startDocument:function(){this.doc=new xf().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(s,t,i,a){var o=this.doc,l=o.createElementNS(s,i||t),h=a.length;pa(this,l),this.currentElement=l,this.locator&&Ir(this.locator,l);for(var T=0;T<h;T++){var s=a.getURI(T),B=a.getValue(T),i=a.getQName(T),G=o.createAttributeNS(s,i);this.locator&&Ir(a.getLocator(T),G),G.value=G.nodeValue=B,l.setAttributeNode(G)}},endElement:function(s,t,i){var a=this.currentElement;a.tagName,this.currentElement=a.parentNode},startPrefixMapping:function(s,t){},endPrefixMapping:function(s){},processingInstruction:function(s,t){s=this.doc.createProcessingInstruction(s,t),this.locator&&Ir(this.locator,s),pa(this,s)},ignorableWhitespace:function(s,t,i){},characters:function(s,t,i){var a;(s=zd.apply(this,arguments))&&(a=this.cdata?this.doc.createCDATASection(s):this.doc.createTextNode(s),this.currentElement?this.currentElement.appendChild(a):/^\s*$/.test(s)&&this.doc.appendChild(a),this.locator)&&Ir(this.locator,a)},skippedEntity:function(s){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(s){(this.locator=s)&&(s.lineNumber=0)},comment:function(s,t,i){s=zd.apply(this,arguments),s=this.doc.createComment(s),this.locator&&Ir(this.locator,s),pa(this,s)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(s,t,i){var a=this.doc.implementation;a&&a.createDocumentType&&(a=a.createDocumentType(s,t,i),this.locator&&Ir(this.locator,a),pa(this,a),this.doc.doctype=a)},warning:function(s){},error:function(s){},fatalError:function(s){throw new kf(s,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(s){Ts.prototype[s]=function(){return null}});var If=Bd;/*! @name mpd-parser @version 1.3.1 @license Apache-2.0 */let jd=s=>!!s&&typeof s=="object",Li=(...s)=>s.reduce((t,i)=>(typeof i=="object"&&Object.keys(i).forEach(a=>{Array.isArray(t[a])&&Array.isArray(i[a])?t[a]=t[a].concat(i[a]):jd(t[a])&&jd(i[a])?t[a]=Li(t[a],i[a]):t[a]=i[a]}),t),{}),Hd=s=>Object.keys(s).map(t=>s[t]),Of=(s,t)=>{var i=[];for(let a=s;a<t;a++)i.push(a);return i},Or=s=>s.reduce((t,i)=>t.concat(i),[]),qd=s=>{if(!s.length)return[];var t=[];for(let i=0;i<s.length;i++)t.push(s[i]);return t},Df=(s,t)=>s.reduce((i,a,o)=>(a[t]&&i.push(o),i),[]),Pf=(s,t)=>Hd(s.reduce((i,a)=>(a.forEach(o=>{i[t(o)]=o}),i),{}));var Dr={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",INVALID_NUMBER_OF_CONTENT_STEERING:"INVALID_NUMBER_OF_CONTENT_STEERING",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};let Ss=({baseUrl:s="",source:t="",range:i="",indexRange:a=""})=>{if(s={uri:t,resolvedUri:ra(s||"",t)},i||a){t=(i||a).split("-");let o=window.BigInt?window.BigInt(t[0]):parseInt(t[0],10),l=window.BigInt?window.BigInt(t[1]):parseInt(t[1],10);o<Number.MAX_SAFE_INTEGER&&typeof o=="bigint"&&(o=Number(o)),l<Number.MAX_SAFE_INTEGER&&typeof l=="bigint"&&(l=Number(l));let h;typeof(h=typeof l=="bigint"||typeof o=="bigint"?window.BigInt(l)-window.BigInt(o)+window.BigInt(1):l-o+1)=="bigint"&&h<Number.MAX_SAFE_INTEGER&&(h=Number(h)),s.byterange={length:h,offset:o}}return s},Rf=s=>{let t;return t=typeof s.offset=="bigint"||typeof s.length=="bigint"?window.BigInt(s.offset)+window.BigInt(s.length)-window.BigInt(1):s.offset+s.length-1,s.offset+"-"+t},Vd=s=>(s&&typeof s!="number"&&(s=parseInt(s,10)),isNaN(s)?null:s),Lf={static(o){var{duration:l,timescale:t=1,sourceDuration:i,periodDuration:a}=o,o=Vd(o.endNumber),l=l/t;return typeof o=="number"?{start:0,end:o}:typeof a=="number"?{start:0,end:a/l}:{start:0,end:i/l}},dynamic(o){var{NOW:l,clientOffset:h,availabilityStartTime:T,timescale:t=1,duration:i,periodStart:B=0,minimumUpdatePeriod:G=0,timeShiftBufferDepth:a=1/0}=o,o=Vd(o.endNumber),l=(l+h)/1e3,h=T+B,T=Math.ceil((l+G-h)*t/i),B=Math.floor((l-h-a)*t/i),G=Math.floor((l-h)*t/i);return{start:Math.max(0,B),end:typeof o=="number"?o:Math.min(T,G)}}},Mf=s=>t=>{var{duration:i,timescale:a=1,periodStart:o,startNumber:l=1}=s;return{number:l+t,duration:i/a,timeline:o,time:t*i}},$o=s=>{var{type:t,duration:i,timescale:a=1,periodDuration:o,sourceDuration:l}=s,{start:T,end:h}=Lf[t](s),T=Of(T,h).map(Mf(s));return t==="static"&&(T[h=T.length-1].duration=(typeof o=="number"?o:l)-i/a*h),T},Wd=s=>{var{baseUrl:t,initialization:i={},sourceDuration:a,indexRange:o="",periodStart:l,presentationTime:h,number:T=0,duration:B}=s;if(t)return i=Ss({baseUrl:t,source:i.sourceURL,range:i.range}),(t=Ss({baseUrl:t,source:t,indexRange:o})).map=i,B?(o=$o(s)).length&&(t.duration=o[0].duration,t.timeline=o[0].timeline):a&&(t.duration=a,t.timeline=l),t.presentationTime=h||l,t.number=T,[t];throw new Error(Dr.NO_BASE_URL)},Ko=(s,t,i)=>{var a=s.sidx.map||null,o=s.sidx.duration,l=s.timeline||0,h=s.sidx.byterange,h=h.offset+h.length,T=t.timescale,B=t.references.filter(Pe=>Pe.referenceType!==1),G=[],H=s.endList?"static":"dynamic",se=s.sidx.timeline;let pe=se,ae=s.mediaSequence||0,_e;_e=typeof t.firstOffset=="bigint"?window.BigInt(h)+t.firstOffset:h+t.firstOffset;for(let Pe=0;Pe<B.length;Pe++){var Le=t.references[Pe],Ce=Le.referencedSize,Le=Le.subsegmentDuration;let Ae;Ae=typeof _e=="bigint"?_e+window.BigInt(Ce)-window.BigInt(1):_e+Ce-1;var xe=_e+"-"+Ae,xe={baseUrl:i,timescale:T,timeline:l,periodStart:se,presentationTime:pe,number:ae,duration:Le,sourceDuration:o,indexRange:xe,type:H},xe=Wd(xe)[0];a&&(xe.map=a),G.push(xe),typeof _e=="bigint"?_e+=window.BigInt(Ce):_e+=Ce,pe+=Le/T,ae++}return s.segments=G,s},Uf=["AUDIO","SUBTITLES"],Ff=1/60,Xd=s=>Pf(s,({timeline:t})=>t).sort((t,i)=>t.timeline>i.timeline?1:-1),Bf=(s,t)=>{for(let i=0;i<s.length;i++)if(s[i].attributes.NAME===t)return s[i];return null},Gd=s=>{let t=[];return Tf(s,Uf,(i,a,o,l)=>{t=t.concat(i.playlists||[])}),t},$d=({playlist:s,mediaSequence:t})=>{s.mediaSequence=t,s.segments.forEach((i,a)=>{i.number=s.mediaSequence+a})},zf=({oldPlaylists:s,newPlaylists:t,timelineStarts:i})=>{t.forEach(a=>{a.discontinuitySequence=i.findIndex(function({timeline:h}){return h===a.timeline});var o=Bf(s,a.attributes.NAME);if(o&&!a.sidx){let h=a.segments[0];var l=o.segments.findIndex(function(T){return Math.abs(T.presentationTime-h.presentationTime)<Ff});l===-1?($d({playlist:a,mediaSequence:o.mediaSequence+o.segments.length}),a.segments[0].discontinuity=!0,a.discontinuityStarts.unshift(0),(!o.segments.length&&a.timeline>o.timeline||o.segments.length&&a.timeline>o.segments[o.segments.length-1].timeline)&&a.discontinuitySequence--):(o.segments[l].discontinuity&&!h.discontinuity&&(h.discontinuity=!0,a.discontinuityStarts.unshift(0),a.discontinuitySequence--),$d({playlist:a,mediaSequence:o.segments[l].number}))}})},jf=({oldManifest:s,newManifest:t})=>{var i=s.playlists.concat(Gd(s)),a=t.playlists.concat(Gd(t));return t.timelineStarts=Xd([s.timelineStarts,t.timelineStarts]),zf({oldPlaylists:i,newPlaylists:a,timelineStarts:t.timelineStarts}),t},fa=s=>s&&s.uri+"-"+Rf(s.byterange),Yo=s=>{s=s.reduce(function(i,a){return i[a.attributes.baseUrl]||(i[a.attributes.baseUrl]=[]),i[a.attributes.baseUrl].push(a),i},{});let t=[];return Object.values(s).forEach(i=>{i=Hd(i.reduce((a,o)=>{var l=o.attributes.id+(o.attributes.lang||"");return a[l]?(o.segments&&(o.segments[0]&&(o.segments[0].discontinuity=!0),a[l].segments.push(...o.segments)),o.attributes.contentProtection&&(a[l].attributes.contentProtection=o.attributes.contentProtection)):(a[l]=o,a[l].attributes.timelineStarts=[]),a[l].attributes.timelineStarts.push({start:o.attributes.periodStart,timeline:o.attributes.periodStart}),a},{})),t=t.concat(i)}),t.map(i=>(i.discontinuityStarts=Df(i.segments||[],"discontinuity"),i))},Zo=(s,a)=>{var i=fa(s.sidx),a=i&&a[i]&&a[i].sidx;return a&&Ko(s,a,s.sidx.resolvedUri),s},Hf=(s,t={})=>{if(Object.keys(t).length)for(var i in s)s[i]=Zo(s[i],t);return s},qf=({attributes:s,segments:t,sidx:i,mediaSequence:a,discontinuitySequence:o,discontinuityStarts:l},h)=>(o={attributes:{NAME:s.id,BANDWIDTH:s.bandwidth,CODECS:s.codecs,"PROGRAM-ID":1},uri:"",endList:s.type==="static",timeline:s.periodStart,resolvedUri:s.baseUrl||"",targetDuration:s.duration,discontinuitySequence:o,discontinuityStarts:l,timelineStarts:s.timelineStarts,mediaSequence:a,segments:t},s.contentProtection&&(o.contentProtection=s.contentProtection),s.serviceLocation&&(o.attributes.serviceLocation=s.serviceLocation),i&&(o.sidx=i),h&&(o.attributes.AUDIO="audio",o.attributes.SUBTITLES="subs"),o),Vf=({attributes:s,segments:t,mediaSequence:i,discontinuityStarts:a,discontinuitySequence:o})=>{typeof t>"u"&&(t=[{uri:s.baseUrl,timeline:s.periodStart,resolvedUri:s.baseUrl||"",duration:s.sourceDuration,number:0}],s.duration=s.sourceDuration);var l={NAME:s.id,BANDWIDTH:s.bandwidth,"PROGRAM-ID":1},l=(s.codecs&&(l.CODECS=s.codecs),{attributes:l,uri:"",endList:s.type==="static",timeline:s.periodStart,resolvedUri:s.baseUrl||"",targetDuration:s.duration,timelineStarts:s.timelineStarts,discontinuityStarts:a,discontinuitySequence:o,mediaSequence:i,segments:t});return s.serviceLocation&&(l.attributes.serviceLocation=s.serviceLocation),l},Wf=(s,t={},i=!1)=>{let a;return s=s.reduce((o,l)=>{var h=l.attributes.role&&l.attributes.role.value||"",T=l.attributes.lang||"";let B=l.attributes.label||"main";return o[B=T&&!l.attributes.label?l.attributes.lang+(h?` (${h})`:""):B]||(o[B]={language:T,autoselect:!0,default:h==="main",playlists:[],uri:""}),T=Zo(qf(l,i),t),o[B].playlists.push(T),typeof a>"u"&&h==="main"&&((a=l).default=!0),o},{}),a||(s[Object.keys(s)[0]].default=!0),s},Xf=(s,t={})=>s.reduce((i,a)=>{var o=a.attributes.label||a.attributes.lang||"text",l=a.attributes.lang||"und";return i[o]||(i[o]={language:l,default:!1,autoselect:!1,playlists:[],uri:""}),i[o].playlists.push(Zo(Vf(a),t)),i},{}),Gf=s=>s.reduce((t,i)=>(i&&i.forEach(a=>{var{channel:o,language:l}=a;t[l]={autoselect:!1,default:!1,instreamId:o,language:l},a.hasOwnProperty("aspectRatio")&&(t[l].aspectRatio=a.aspectRatio),a.hasOwnProperty("easyReader")&&(t[l].easyReader=a.easyReader),a.hasOwnProperty("3D")&&(t[l]["3D"]=a["3D"])}),t),{}),$f=({attributes:s,segments:t,sidx:i,discontinuityStarts:a})=>(a={attributes:{NAME:s.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:s.width,height:s.height},CODECS:s.codecs,BANDWIDTH:s.bandwidth,"PROGRAM-ID":1},uri:"",endList:s.type==="static",timeline:s.periodStart,resolvedUri:s.baseUrl||"",targetDuration:s.duration,discontinuityStarts:a,timelineStarts:s.timelineStarts,segments:t},s.frameRate&&(a.attributes["FRAME-RATE"]=s.frameRate),s.contentProtection&&(a.contentProtection=s.contentProtection),s.serviceLocation&&(a.attributes.serviceLocation=s.serviceLocation),i&&(a.sidx=i),a),Kf=({attributes:s})=>s.mimeType==="video/mp4"||s.mimeType==="video/webm"||s.contentType==="video",Yf=({attributes:s})=>s.mimeType==="audio/mp4"||s.mimeType==="audio/webm"||s.contentType==="audio",Zf=({attributes:s})=>s.mimeType==="text/vtt"||s.contentType==="text",Qf=(s,t)=>{s.forEach(i=>{i.mediaSequence=0,i.discontinuitySequence=t.findIndex(function({timeline:a}){return a===i.timeline}),i.segments&&i.segments.forEach((a,o)=>{a.number=o})})},Kd=s=>s?Object.keys(s).reduce((t,i)=>(i=s[i],t.concat(i.playlists)),[]):[],Jf=({dashPlaylists:s,locations:t,contentSteering:i,sidxMapping:a={},previousManifest:o,eventStream:l})=>{var h,T,B,G,H,se,pe;return s.length?({sourceDuration:G,type:se,suggestedPresentationDelay:pe,minimumUpdatePeriod:H}=s[0].attributes,h=Yo(s.filter(Kf)).map($f),T=Yo(s.filter(Yf)),B=Yo(s.filter(Zf)),s=s.map(ae=>ae.attributes.captionServices).filter(Boolean),G={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:"",duration:G,playlists:Hf(h,a)},0<=H&&(G.minimumUpdatePeriod=1e3*H),t&&(G.locations=t),i&&(G.contentSteering=i),se==="dynamic"&&(G.suggestedPresentationDelay=pe),l&&0<l.length&&(G.eventStream=l),H=G.playlists.length===0,t=T.length?Wf(T,a,H):null,i=B.length?Xf(B,a):null,pe=(se=h.concat(Kd(t),Kd(i))).map(({timelineStarts:ae})=>ae),G.timelineStarts=Xd(pe),Qf(se,G.timelineStarts),t&&(G.mediaGroups.AUDIO.audio=t),i&&(G.mediaGroups.SUBTITLES.subs=i),s.length&&(G.mediaGroups["CLOSED-CAPTIONS"].cc=Gf(s)),o?jf({oldManifest:o,newManifest:G}):G):{}},em=(a,t,i)=>{var{NOW:a,clientOffset:o,availabilityStartTime:l,timescale:h=1,periodStart:T=0,minimumUpdatePeriod:B=0}=a;return Math.ceil((((a+o)/1e3+B-(l+T))*h-t)/i)},Yd=(s,t)=>{var{type:i,minimumUpdatePeriod:a=0,media:o="",sourceDuration:l,timescale:h=1,startNumber:T=1,periodStart:B}=s,G=[];let H=-1;for(let Ce=0;Ce<t.length;Ce++){var ae=t[Ce],se=ae.d,pe=ae.r||0,ae=ae.t||0;H<0&&(H=ae),ae&&ae>H&&(H=ae);let Le;Le=pe<0?(ae=Ce+1)===t.length?i==="dynamic"&&0<a&&0<o.indexOf("$Number$")?em(s,H,se):(l*h-H)/se:(t[ae].t-H)/se:pe+1;var _e=T+G.length+Le;let xe=T+G.length;for(;xe<_e;)G.push({number:xe,duration:se/h,time:H,timeline:B}),H+=se,xe++}return G},tm=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,im=s=>(t,i,a,o)=>t==="$$"?"$":typeof s[i]>"u"?t:(t=""+s[i],i==="RepresentationID"||(o=a?parseInt(o,10):1)<=t.length?t:new Array(o-t.length+1).join("0")+t),Zd=(s,t)=>s.replace(tm,im(t)),nm=(s,t)=>s.duration||t?s.duration?$o(s):Yd(s,t):[{number:s.startNumber||1,duration:s.sourceDuration,time:0,timeline:s.periodStart}],rm=(s,t)=>{let i={RepresentationID:s.id,Bandwidth:s.bandwidth||0};var{initialization:a={sourceURL:"",range:""}}=s;let o=Ss({baseUrl:s.baseUrl,source:Zd(a.sourceURL,i),range:a.range});return nm(s,t).map(l=>{i.Number=l.number,i.Time=l.time;var h=Zd(s.media||"",i),T=s.timescale||1,T=s.periodStart+(l.time-(s.presentationTimeOffset||0))/T;return{uri:h,timeline:l.timeline,duration:l.duration,resolvedUri:ra(s.baseUrl||"",h),map:o,number:l.number,presentationTime:T}})},sm=(a,t)=>{var{baseUrl:a,initialization:i={}}=a,i=Ss({baseUrl:a,source:i.sourceURL,range:i.range}),a=Ss({baseUrl:a,source:t.media,range:t.mediaRange});return a.map=i,a},am=(s,t)=>{let{duration:i,segmentUrls:a=[],periodStart:o}=s;if(!i&&!t||i&&t)throw new Error(Dr.SEGMENT_TIME_UNSPECIFIED);let l=a.map(T=>sm(s,T)),h;return i&&(h=$o(s)),(h=t?Yd(s,t):h).map((T,B)=>{var G,H;if(l[B])return B=l[B],G=s.timescale||1,H=s.presentationTimeOffset||0,B.timeline=T.timeline,B.duration=T.duration,B.number=T.number,B.presentationTime=o+(T.time-H)/G,B}).filter(T=>T)},om=({attributes:T,segmentInfo:t})=>{let i,a;t.template?(a=rm,i=Li(T,t.template)):t.base?(a=Wd,i=Li(T,t.base)):t.list&&(a=am,i=Li(T,t.list));var o,l,h,T={attributes:T};return a&&(o=a(i,t.segmentTimeline),i.duration?({duration:l,timescale:h=1}=i,i.duration=l/h):o.length?i.duration=o.reduce((B,G)=>Math.max(B,Math.ceil(G.duration)),0):i.duration=0,T.attributes=i,T.segments=o,t.base)&&i.indexRange&&(T.sidx=o[0],T.segments=[]),T},lm=s=>s.map(om),pi=(s,t)=>qd(s.childNodes).filter(({tagName:i})=>i===t),ws=s=>s.textContent.trim(),Pr=h=>{var t,i,a,o,l,h=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(h);return h?([h,t,i,a,o,l]=h.slice(1),31536e3*parseFloat(h||0)+2592e3*parseFloat(t||0)+86400*parseFloat(i||0)+3600*parseFloat(a||0)+60*parseFloat(o||0)+parseFloat(l||0)):0},Qd={mediaPresentationDuration(s){return Pr(s)},availabilityStartTime(s){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(s=s)&&(s+="Z"),Date.parse(s)/1e3},minimumUpdatePeriod(s){return Pr(s)},suggestedPresentationDelay(s){return Pr(s)},type(s){return s},timeShiftBufferDepth(s){return Pr(s)},start(s){return Pr(s)},width(s){return parseInt(s,10)},height(s){return parseInt(s,10)},bandwidth(s){return parseInt(s,10)},frameRate(s){return parseFloat(s.split("/").reduce((t,i)=>t/i))},startNumber(s){return parseInt(s,10)},timescale(s){return parseInt(s,10)},presentationTimeOffset(s){return parseInt(s,10)},duration(s){var t=parseInt(s,10);return isNaN(t)?Pr(s):t},d(s){return parseInt(s,10)},t(s){return parseInt(s,10)},r(s){return parseInt(s,10)},presentationTime(s){return parseInt(s,10)},DEFAULT(s){return s}},Ni=s=>s&&s.attributes?qd(s.attributes).reduce((t,i)=>{var a=Qd[i.name]||Qd.DEFAULT;return t[i.name]=a(i.value),t},{}):{},um={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime","urn:mpeg:dash:mp4protection:2011":"mp4protection"},ma=(s,t)=>t.length?Or(s.map(function(i){return t.map(function(h){var o=ws(h),l=ra(i.baseUrl,o),h=Li(Ni(h),{baseUrl:l});return l!==o&&!h.serviceLocation&&i.serviceLocation&&(h.serviceLocation=i.serviceLocation),h})})):s,Qo=a=>{var h=pi(a,"SegmentTemplate")[0],t=pi(a,"SegmentList")[0],i=t&&pi(t,"SegmentURL").map(B=>Li({tag:"SegmentURL"},Ni(B))),a=pi(a,"SegmentBase")[0],o=t||h,o=o&&pi(o,"SegmentTimeline")[0],l=t||a||h,l=l&&pi(l,"Initialization")[0],h=h&&Ni(h);h&&l?h.initialization=l&&Ni(l):h&&h.initialization&&(h.initialization={sourceURL:h.initialization});let T={template:h,segmentTimeline:o&&pi(o,"S").map(B=>Ni(B)),list:t&&Li(Ni(t),{segmentUrls:i,initialization:Ni(l)}),base:a&&Li(Ni(a),{initialization:Ni(l)})};return Object.keys(T).forEach(B=>{T[B]||delete T[B]}),T},dm=(s,t,i)=>a=>{var o=pi(a,"BaseURL"),o=ma(t,o);let l=Li(s,Ni(a)),h=Qo(a);return o.map(T=>({segmentInfo:Li(i,h),attributes:Li(l,T)}))},cm=s=>s.reduce((t,i)=>{var a=Ni(i),o=(a.schemeIdUri&&(a.schemeIdUri=a.schemeIdUri.toLowerCase()),um[a.schemeIdUri]);return o&&(t[o]={attributes:a},a=pi(i,"cenc:pssh")[0])&&(i=ws(a),t[o].pssh=i&&id(i)),t},{}),hm=s=>s.schemeIdUri==="urn:scte:dash:cc:cea-608:2015"?(typeof s.value!="string"?[]:s.value.split(";")).map(t=>{let i,a;return a=t,/^CC\d=/.test(t)?[i,a]=t.split("="):/^CC\d$/.test(t)&&(i=t),{channel:i,language:a}}):s.schemeIdUri==="urn:scte:dash:cc:cea-708:2015"?(typeof s.value!="string"?[]:s.value.split(";")).map(t=>{let i={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};var a,o;return/=/.test(t)?([a,o=""]=t.split("="),i.channel=a,i.language=t,o.split(",").forEach(h=>{var[h,T]=h.split(":");h==="lang"?i.language=T:h==="er"?i.easyReader=Number(T):h==="war"?i.aspectRatio=Number(T):h==="3D"&&(i["3D"]=Number(T))})):i.language=t,i.channel&&(i.channel="SERVICE"+i.channel),i}):void 0,pm=s=>Or(pi(s.node,"EventStream").map(t=>{let i=Ni(t),a=i.schemeIdUri;return pi(t,"Event").map(o=>{var l=Ni(o),B=l.presentationTime||0,h=i.timescale||1,T=l.duration||0,B=B/h+s.attributes.start;return{schemeIdUri:a,value:i.value,id:l.id,start:B,end:B+T/h,messageData:ws(o)||l.messageData,contentEncoding:i.contentEncoding,presentationTimeOffset:i.presentationTimeOffset||0}})})),fm=(s,t,i)=>a=>{var o=Ni(a),l=ma(t,pi(a,"BaseURL")),h=pi(a,"Role")[0],h={role:Ni(h)};let T=Li(s,o,h);return o=pi(a,"Accessibility")[0],h=hm(Ni(o)),h&&(T=Li(T,{captionServices:h})),o=pi(a,"Label")[0],o&&o.childNodes.length&&(h=o.childNodes[0].nodeValue.trim(),T=Li(T,{label:h})),o=cm(pi(a,"ContentProtection")),Object.keys(o).length&&(T=Li(T,{contentProtection:o})),h=Qo(a),o=pi(a,"Representation"),a=Li(i,h),Or(o.map(dm(T,l,a)))},mm=(s,t)=>(T,a)=>{var o=ma(t,pi(T.node,"BaseURL")),l=Li(s,{periodStart:T.attributes.start}),h=(typeof T.attributes.duration=="number"&&(l.periodDuration=T.attributes.duration),pi(T.node,"AdaptationSet")),T=Qo(T.node);return Or(h.map(fm(l,o,T)))},gm=(s,t)=>(1<s.length&&t({type:"warn",message:"The MPD manifest should contain no more than one ContentSteering tag"}),s.length?((t=Li({serverURL:ws(s[0])},Ni(s[0]))).queryBeforeStart=t.queryBeforeStart==="true",t):null),ym=({attributes:s,priorPeriodAttributes:t,mpdType:i})=>typeof s.start=="number"?s.start:t&&typeof t.start=="number"&&typeof t.duration=="number"?t.start+t.duration:t||i!=="static"?null:0,vm=(s,i={})=>{var{manifestUri:i="",NOW:a=Date.now(),clientOffset:o=0,eventHandler:l=function(){}}=i,h=pi(s,"Period");if(!h.length)throw new Error(Dr.INVALID_NUMBER_OF_PERIOD);var T=pi(s,"Location");let B=Ni(s);i=ma([{baseUrl:i}],pi(s,"BaseURL")),s=pi(s,"ContentSteering"),B.type=B.type||"static",B.sourceDuration=B.mediaPresentationDuration||0,B.NOW=a,B.clientOffset=o,T.length&&(B.locations=T.map(ws));let G=[];return h.forEach((H,ae)=>{var pe=Ni(H),ae=G[ae-1];pe.start=ym({attributes:pe,priorPeriodAttributes:ae?ae.attributes:null,mpdType:B.type}),G.push({node:H,attributes:pe})}),{locations:B.locations,contentSteeringInfo:gm(s,l),representationInfo:Or(G.map(mm(B,i))),eventStream:Or(G.map(pm))}},Jd=s=>{if(s==="")throw new Error(Dr.DASH_EMPTY_MANIFEST);var t,i=new If;let a;try{t=i.parseFromString(s,"application/xml"),a=t&&t.documentElement.tagName==="MPD"?t.documentElement:null}catch{}if(!a||a&&0<a.getElementsByTagName("parsererror").length)throw new Error(Dr.DASH_INVALID_XML);return a},bm=s=>(t=>{if(t=pi(t,"UTCTiming")[0],!t)return null;var i=Ni(t);switch(i.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":i.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":i.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":i.method="DIRECT",i.value=Date.parse(i.value);break;default:throw new Error(Dr.UNSUPPORTED_UTC_TIMING_SCHEME)}return i})(Jd(s));function Rr(s,t){var i,a,o;return t===void 0&&(t=0),(s=wt(s)).length-t<10||!hi(s,Sm,{offset:t})?t:(t+=((a=t)===void 0&&(a=0),o=(i=wt(i=s))[a+5],i=i[a+6]<<21|i[a+7]<<14|i[a+8]<<7|i[a+9],(16&o)>>4?20+i:10+i),Rr(s,t))}function ec(s,t,i){var a;return i>=t.length?t.length:(a=ya(t,i,!1),hi(s.bytes,a.bytes)?i:ec(s,t,i+(s=ya(t,i+a.length)).length+s.value+a.length))}function Jo(s,t){i=t,t=Array.isArray(i)?i.map(function(G){return rc(G)}):[rc(i)],s=wt(s);var i,a=[];if(t.length)for(var o=0;o<s.length;){var l=ya(s,o,!1),h=ya(s,o+l.length),B=o+l.length+h.length,T=(h.value===127&&(h.value=ec(l,s,B),h.value!==s.length)&&(h.value-=B),B+h.value>s.length?s.length:B+h.value),B=s.subarray(B,T);hi(t[0],l.bytes)&&(t.length===1?a.push(B):a=a.concat(Jo(B,t.slice(1)))),o+=l.length+h.length+B.length}return a}function tc(s,t,i,a){a===void 0&&(a=1/0),s=wt(s),i=[].concat(i);for(var o,l=0,h=0;l<s.length&&(h<a||o);){var T=void 0;if(hi(s.subarray(l),xm)?T=4:hi(s.subarray(l),km)&&(T=3),T){if(h++,o)return Am(s.subarray(o,l));var B=void 0;t==="h264"?B=31&s[l+T]:t==="h265"&&(B=s[l+T]>>1&63),i.indexOf(B)!==-1&&(o=l+T),l+=T+(t==="h264"?1:2)}else l++}return s.subarray(0,0)}var _m=Math.pow(2,32),ic=function(i){var t,i=new DataView(i.buffer,i.byteOffset,i.byteLength);return i.getBigUint64?(t=i.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(t):t:i.getUint32(0)*_m+i.getUint32(4)},Tm=function(s){var t=new DataView(s.buffer,s.byteOffset,s.byteLength),i={version:s[0],flags:new Uint8Array(s.subarray(1,4)),references:[],referenceId:t.getUint32(4),timescale:t.getUint32(8)},a=12,o=(i.version===0?(i.earliestPresentationTime=t.getUint32(a),i.firstOffset=t.getUint32(a+4),a+=8):(i.earliestPresentationTime=ic(s.subarray(a)),i.firstOffset=ic(s.subarray(a+8)),a+=16),t.getUint16(a+=2));for(a+=2;0<o;a+=12,o--)i.references.push({referenceType:(128&s[a])>>>7,referencedSize:2147483647&t.getUint32(a),subsegmentDuration:t.getUint32(a+4),startsWithSap:!!(128&s[a+8]),sapType:(112&s[a+8])>>>4,sapDeltaTime:268435455&t.getUint32(a+8)});return i},Sm=wt([73,68,51]),nc=function(s){return typeof s=="string"?dd(s):s},wm=function(s){return Array.isArray(s)?s.map(function(t){return nc(t)}):[nc(s)]},Em=function s(t,i,a){a===void 0&&(a=!1),i=wm(i),t=wt(t);var o=[];if(i.length)for(var l=0;l<t.length;){var h=(t[l]<<24|t[l+1]<<16|t[l+2]<<8|t[l+3])>>>0,T=t.subarray(l+4,l+8);if(h==0)break;if(h=l+h,h>t.length){if(a)break;h=t.length}var B=t.subarray(l+8,h);hi(T,i[0])&&(i.length===1?o.push(B):o.push.apply(o,s(B,i.slice(1),a))),l=h}return o},ga={EBML:wt([26,69,223,163]),DocType:wt([66,130]),Segment:wt([24,83,128,103]),SegmentInfo:wt([21,73,169,102]),Tracks:wt([22,84,174,107]),Track:wt([174]),TrackNumber:wt([215]),DefaultDuration:wt([35,227,131]),TrackEntry:wt([174]),TrackType:wt([131]),FlagDefault:wt([136]),CodecID:wt([134]),CodecPrivate:wt([99,162]),VideoTrack:wt([224]),AudioTrack:wt([225]),Cluster:wt([31,67,182,117]),Timestamp:wt([231]),TimestampScale:wt([42,215,177]),BlockGroup:wt([160]),BlockDuration:wt([155]),Block:wt([161]),SimpleBlock:wt([163])},el=[128,64,32,16,8,4,2,1],Cm=function(s){for(var t=1,i=0;i<el.length&&!(s&el[i]);i++)t++;return t},ya=function(s,t,i,a){i===void 0&&(i=!0),a===void 0&&(a=!1);var o=Cm(s[t]),l=s.subarray(t,t+o);return i&&((l=Array.prototype.slice.call(s,t,t+o))[0]^=el[o-1]),{length:o,value:bf(l,{signed:a}),bytes:l}},rc=function s(t){return typeof t=="string"?t.match(/.{1,2}/g).map(s):typeof t=="number"?_f(t):t},xm=wt([0,0,0,1]),km=wt([0,0,1]),Nm=wt([0,0,3]),Am=function(s){for(var t=[],i=1;i<s.length-2;)hi(s.subarray(i,i+3),Nm)&&(t.push(i+2),i++),i++;if(t.length===0)return s;for(var a=s.length-t.length,o=new Uint8Array(a),l=0,i=0;i<a;l++,i++)l===t[0]&&(l++,t.shift()),o[i]=s[l];return o},$i={webm:wt([119,101,98,109]),matroska:wt([109,97,116,114,111,115,107,97]),flac:wt([102,76,97,67]),ogg:wt([79,103,103,83]),ac3:wt([11,119]),riff:wt([82,73,70,70]),avi:wt([65,86,73]),wav:wt([87,65,86,69]),"3gp":wt([102,116,121,112,51,103]),mp4:wt([102,116,121,112]),fmp4:wt([115,116,121,112]),mov:wt([102,116,121,112,113,116]),moov:wt([109,111,111,118]),moof:wt([109,111,111,102])},Lr={aac:function(s){var t=Rr(s);return hi(s,[255,16],{offset:t,mask:[255,22]})},mp3:function(s){var t=Rr(s);return hi(s,[255,2],{offset:t,mask:[255,6]})},webm:function(s){return s=Jo(s,[ga.EBML,ga.DocType])[0],hi(s,$i.webm)},mkv:function(s){return s=Jo(s,[ga.EBML,ga.DocType])[0],hi(s,$i.matroska)},mp4:function(s){return!Lr["3gp"](s)&&!Lr.mov(s)&&(!!(hi(s,$i.mp4,{offset:4})||hi(s,$i.fmp4,{offset:4})||hi(s,$i.moof,{offset:4})||hi(s,$i.moov,{offset:4}))||void 0)},mov:function(s){return hi(s,$i.mov,{offset:4})},"3gp":function(s){return hi(s,$i["3gp"],{offset:4})},ac3:function(s){var t=Rr(s);return hi(s,$i.ac3,{offset:t})},ts:function(s){if(s.length<189&&1<=s.length)return s[0]===71;for(var t=0;t+188<s.length&&t<188;){if(s[t]===71&&s[t+188]===71)return!0;t+=1}return!1},flac:function(s){var t=Rr(s);return hi(s,$i.flac,{offset:t})},ogg:function(s){return hi(s,$i.ogg)},avi:function(s){return hi(s,$i.riff)&&hi(s,$i.avi,{offset:8})},wav:function(s){return hi(s,$i.riff)&&hi(s,$i.wav,{offset:8})},h264:function(s){return tc(s,"h264",7,3).length},h265:function(s){return tc(s,"h265",[32,33],3).length}},tl=Object.keys(Lr).filter(function(s){return s!=="ts"&&s!=="h264"&&s!=="h265"}).concat(["ts","h264","h265"]),Im=(tl.forEach(function(s){var t=Lr[s];Lr[s]=function(i){return t(wt(i))}}),Lr),il=function(s){s=wt(s);for(var t=0;t<tl.length;t++){var i=tl[t];if(Im[i](s))return i}return""},Om=function(s){return 0<Em(s,["moof"]).length},sr=9e4;/*! @name @videojs/http-streaming @version 3.16.2 @license Apache-2.0 */let en=ra,va=(s,t)=>t&&t.responseURL&&s!==t.responseURL?t.responseURL:s,un=s=>He.log.debug?He.log.debug.bind(He,"VHS:",s+" >"):function(){};function Qt(...s){var t=He.obj||He;return(t.merge||t.mergeOptions).apply(t,s)}function zi(...s){var t=He.time||He;return(t.createTimeRanges||t.createTimeRanges).apply(t,s)}function Mr(s,t){return ac(s,function(i,a){return i-Cn<=t&&a+Cn>=t})}function ba(s,t){return ac(s,function(i){return i-En>=t})}function nl(s){if(s&&s.length&&s.end)return s.end(s.length-1)}function rl(s,t){let i=0;if(s&&s.length)for(let l=0;l<s.length;l++){var a=s.start(l),o=s.end(l);o<t||(i+=a<t&&t<=o?o-t:o-a)}return i}function Es({defaultDuration:s,durationList:t,startIndex:i,endIndex:a}){let o=0;if(a<i&&([i,a]=[a,i]),i<0){for(let l=i;l<Math.min(0,a);l++)o+=s;i=0}for(let l=i;l<a;l++)o+=t[l].duration;return o}function sc(s,t,i,a){if(!s||!s.segments)return null;if(s.endList)return hc(s);if(t===null)return null;t=t||0;let o=cc(s,s.mediaSequence+s.segments.length,t);return i&&(a=typeof a=="number"?a:dc(null,s),o-=a),Math.max(0,o)}let En=1/30,Cn=3*En,ac=function(s,t){var i=[];let a;if(s&&s.length)for(a=0;a<s.length;a++)t(s.start(a),s.end(a))&&i.push([s.start(a),s.end(a)]);return zi(i)},oc=s=>{var t=[];if(!s||!s.length)return"";for(let i=0;i<s.length;i++)t.push(s.start(i)+" => "+s.end(i));return t.join(", ")},ar=s=>{var t=[];for(let i=0;i<s.length;i++)t.push({start:s.start(i),end:s.end(i)});return t},sl=(s,t)=>{if(!t.preload)return t.duration;let i=0;return(t.parts||[]).forEach(function(a){i+=a.duration}),(t.preloadHints||[]).forEach(function(a){a.type==="PART"&&(i+=s.partTargetDuration)}),i},al=s=>(s.segments||[]).reduce((t,i,a)=>(i.parts?i.parts.forEach(function(o,l){t.push({duration:o.duration,segmentIndex:a,partIndex:l,part:o,segment:i})}):t.push({duration:i.duration,segmentIndex:a,partIndex:null,segment:i,part:null}),t),[]),lc=s=>(s=s.segments&&s.segments.length&&s.segments[s.segments.length-1],s&&s.parts||[]),uc=({preloadSegment:s})=>{var t;if(s)return{parts:s,preloadHints:t}=s,(t||[]).reduce((i,a)=>i+(a.type==="PART"?1:0),0)+(s&&s.length?s.length:0)},dc=(s,t)=>t.endList?0:s&&s.suggestedPresentationDelay?s.suggestedPresentationDelay:(s=0<lc(t).length)&&t.serverControl&&t.serverControl.partHoldBack?t.serverControl.partHoldBack:s&&t.partTargetDuration?3*t.partTargetDuration:t.serverControl&&t.serverControl.holdBack?t.serverControl.holdBack:t.targetDuration?3*t.targetDuration:0,Dm=function(s,t){let i=0,a=t-s.mediaSequence,o=s.segments[a];if(o){if(typeof o.start<"u")return{result:o.start,precise:!0};if(typeof o.end<"u")return{result:o.end-o.duration,precise:!0}}for(;a--;){if(typeof(o=s.segments[a]).end<"u")return{result:i+o.end,precise:!0};if(i+=sl(s,o),typeof o.start<"u")return{result:i+o.start,precise:!0}}return{result:i,precise:!1}},Pm=function(s,t){let i=0;var a;let o=t-s.mediaSequence;for(;o<s.segments.length;o++){if(typeof(a=s.segments[o]).start<"u")return{result:a.start-i,precise:!0};if(i+=sl(s,a),typeof a.end<"u")return{result:a.end-i,precise:!0}}return{result:-1,precise:!1}},cc=function(s,t,i){var a;return(t=typeof t>"u"?s.mediaSequence+s.segments.length:t)<s.mediaSequence?0:(a=Dm(s,t)).precise?a.result:(s=Pm(s,t)).precise?s.result:a.result+i},hc=function(s,t,i){if(!s)return 0;if(typeof i!="number"&&(i=0),typeof t>"u"){if(s.totalDuration)return s.totalDuration;if(!s.endList)return window.Infinity}return cc(s,t,i)};function pc(s){return s.excludeUntil&&s.excludeUntil>Date.now()}function ol(s){return s.excludeUntil&&s.excludeUntil===1/0}function _a(s){var t=pc(s);return!s.disabled&&!t}function fc(s,t){return t.attributes&&t.attributes[s]}function mc(s,t){var i,a=s&&s.mediaGroups&&s.mediaGroups.AUDIO||{};let o=!1;for(i in a){for(var l in a[i])if(o=t(a[i][l]))break;if(o)break}return!!o}let ll=(s,t)=>{if(s.playlists.length===1)return!0;let i=t.attributes.BANDWIDTH||Number.MAX_VALUE;return s.playlists.filter(a=>!!_a(a)&&(a.attributes.BANDWIDTH||0)<i).length===0},ul=(s,t)=>!(!s&&!t||!s&&t||s&&!t||s!==t&&(!s.id||!t.id||s.id!==t.id)&&(!s.resolvedUri||!t.resolvedUri||s.resolvedUri!==t.resolvedUri)&&(!s.uri||!t.uri||s.uri!==t.uri)),Cs=s=>{if(!s||!s.playlists||!s.playlists.length)return mc(s,i=>i.playlists&&i.playlists.length||i.uri);for(let i=0;i<s.playlists.length;i++){let a=s.playlists[i];var t=a.attributes&&a.attributes.CODECS;if((!t||!t.split(",").every(o=>rd(o)))&&(t=mc(s,o=>ul(a,o)),!t))return!1}return!0};var tn={liveEdgeDelay:dc,duration:hc,seekable:function(s,t,i){var a=t||0;let o=sc(s,t,!0,i);return o===null?zi():zi(a,o=o<a?a:o)},getMediaInfoForTime:function({playlist:s,currentTime:t,startingSegmentIndex:i,startingPartIndex:a,startTime:o,exactManifestTimings:l}){let h=t-o;var T=al(s);let B=0;for(let _e=0;_e<T.length;_e++){var G=T[_e];if(i===G.segmentIndex&&(typeof a!="number"||typeof G.partIndex!="number"||a===G.partIndex)){B=_e;break}}if(h<0){if(0<B)for(let _e=B-1;0<=_e;_e--){var H=T[_e];if(h+=H.duration,l){if(h<0)continue}else if(h+En<=0)continue;return{partIndex:H.partIndex,segmentIndex:H.segmentIndex,startTime:o-Es({defaultDuration:s.targetDuration,durationList:T,startIndex:B,endIndex:_e})}}return{partIndex:T[0]&&T[0].partIndex||null,segmentIndex:T[0]&&T[0].segmentIndex||0,startTime:t}}if(B<0){for(let _e=B;_e<0;_e++)if((h-=s.targetDuration)<0)return{partIndex:T[0]&&T[0].partIndex||null,segmentIndex:T[0]&&T[0].segmentIndex||0,startTime:t};B=0}for(let _e=B;_e<T.length;_e++){var se=T[_e],ae=(h-=se.duration,se.duration>En),pe=h===0,ae=ae&&0<=h+En;if(!pe&&!ae||_e===T.length-1){if(l){if(0<h)continue}else if(0<=h-En)continue;return{partIndex:se.partIndex,segmentIndex:se.segmentIndex,startTime:o+Es({defaultDuration:s.targetDuration,durationList:T,startIndex:B,endIndex:_e})}}}return{segmentIndex:T[T.length-1].segmentIndex,partIndex:T[T.length-1].partIndex,startTime:t}},isEnabled:_a,isDisabled:function(s){return s.disabled},isExcluded:pc,isIncompatible:ol,playlistEnd:sc,isAes:function(s){for(let t=0;t<s.segments.length;t++)if(s.segments[t].key)return!0;return!1},hasAttribute:fc,estimateSegmentRequestTime:function(s,t,i,a=0){return fc("BANDWIDTH",i)?(s*i.attributes.BANDWIDTH-8*a)/t:NaN},isLowestEnabledRendition:ll,isAudioOnly:Cs,playlistMatch:ul,segmentDurationWithParts:sl};let gc=He.log,Ur=(s,t)=>s+"-"+t,yc=(s,t,i)=>`placeholder-uri-${s}-${t}-`+i,Fr=(s,t)=>{s.mediaGroups&&["AUDIO","SUBTITLES"].forEach(i=>{if(s.mediaGroups[i])for(var a in s.mediaGroups[i])for(var o in s.mediaGroups[i][a]){var l=s.mediaGroups[i][a][o];t(l,i,a,o)}})},vc=({playlist:s,uri:t,id:i})=>{s.id=i,s.playlistErrors_=0,t&&(s.uri=t),s.attributes=s.attributes||{}},bc=(s,t,i=yc)=>{s.uri=t;for(let h=0;h<s.playlists.length;h++){var a;s.playlists[h].uri||(a="placeholder-uri-"+h,s.playlists[h].uri=a)}let o=Cs(s);var l;Fr(s,(h,T,B,G)=>{if(!h.playlists||!h.playlists.length){if(o&&T==="AUDIO"&&!h.uri)for(let se=0;se<s.playlists.length;se++){var H=s.playlists[se];if(H.attributes&&H.attributes.AUDIO&&H.attributes.AUDIO===B)return}h.playlists=[Ii({},h)]}h.playlists.forEach(function(se,pe){var ae=i(T,B,G,se),_e=Ur(pe,ae);se.uri?se.resolvedUri=se.resolvedUri||en(s.uri,se.uri):(se.uri=pe===0?ae:_e,se.resolvedUri=se.uri),se.id=se.id||_e,se.attributes=se.attributes||{},s.playlists[se.id]=se,s.playlists[se.uri]=se})}),(h=>{let T=h.playlists.length;for(;T--;){var B=h.playlists[T];vc({playlist:B,id:Ur(T,B.uri)}),B.resolvedUri=en(h.uri,B.uri),h.playlists[B.id]=B,(h.playlists[B.uri]=B).attributes.BANDWIDTH||gc.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}})(s),l=s,Fr(l,h=>{h.uri&&(h.resolvedUri=en(l.uri,h.uri))})};class _c{constructor(){this.offset_=null,this.pendingDateRanges_=new Map,this.processedDateRanges_=new Map}setOffset(t=[]){this.offset_===null&&t.length&&([t]=t,t.programDateTime!==void 0)&&(this.offset_=t.programDateTime/1e3)}setPendingDateRanges(t=[]){var i;t.length&&([i]=t,i=i.startDate.getTime(),this.trimProcessedDateRanges_(i),this.pendingDateRanges_=t.reduce((a,o)=>(a.set(o.id,o),a),new Map))}processDateRange(t){this.pendingDateRanges_.delete(t.id),this.processedDateRanges_.set(t.id,t)}getDateRangesToProcess(){if(this.offset_===null)return[];let t={},i=[];this.pendingDateRanges_.forEach((l,h)=>{this.processedDateRanges_.has(h)||(l.startTime=l.startDate.getTime()/1e3-this.offset_,l.processDateRange=()=>this.processDateRange(l),i.push(l),l.class&&(t[l.class]?(h=t[l.class].push(l),l.classListIndex=h-1):(t[l.class]=[l],l.classListIndex=0)))});for(var a of i){var o=t[a.class]||[];a.endDate?a.endTime=a.endDate.getTime()/1e3-this.offset_:a.endOnNext&&o[a.classListIndex+1]?a.endTime=o[a.classListIndex+1].startTime:a.duration?a.endTime=a.startTime+a.duration:a.plannedDuration?a.endTime=a.startTime+a.plannedDuration:a.endTime=a.startTime}return i}trimProcessedDateRanges_(t){new Map(this.processedDateRanges_).forEach((i,a)=>{i.startDate.getTime()<t&&this.processedDateRanges_.delete(a)})}}let or=({requestType:l,request:t,error:i,parseFailure:a})=>{var h=t.status<200||299<t.status,o=400<=t.status&&t.status<=499,l={uri:t.uri,requestType:l},h=h&&!o||a;return i&&o?(l.error=Ii({},i),l.errorType=He.Error.NetworkRequestFailed):t.aborted?l.errorType=He.Error.NetworkRequestAborted:t.timedout?l.erroType=He.Error.NetworkRequestTimeout:h&&(o=a?He.Error.NetworkBodyParserFailed:He.Error.NetworkBadStatus,l.errorType=o,l.status=t.status,l.headers=t.headers),l};_n=He.EventTarget;function Tc(s){var t=s.segments||[],i=s.preloadSegment;if(i&&i.parts&&i.parts.length){if(i.preloadHints){for(let a=0;a<i.preloadHints.length;a++)if(i.preloadHints[a].type==="MAP")return t}i.duration=s.targetDuration,i.preload=!0,t.push(i)}return t}let Rm=(s,t)=>{if(!s)return t;var i=Qt(s,t);if(s.preloadHints&&!t.preloadHints&&delete i.preloadHints,s.parts&&!t.parts)delete i.parts;else if(s.parts&&t.parts)for(let a=0;a<t.parts.length;a++)s.parts&&s.parts[a]&&(i.parts[a]=Qt(s.parts[a],t.parts[a]));return!s.skipped&&t.skipped&&(i.skipped=!1),s.preload&&!t.preload&&(i.preload=!1),i},Sc=(s,t)=>{!s.resolvedUri&&s.uri&&(s.resolvedUri=en(t,s.uri)),s.key&&!s.key.resolvedUri&&(s.key.resolvedUri=en(t,s.key.uri)),s.map&&!s.map.resolvedUri&&(s.map.resolvedUri=en(t,s.map.uri)),s.map&&s.map.key&&!s.map.key.resolvedUri&&(s.map.key.resolvedUri=en(t,s.map.key.uri)),s.parts&&s.parts.length&&s.parts.forEach(i=>{i.resolvedUri||(i.resolvedUri=en(t,i.uri))}),s.preloadHints&&s.preloadHints.length&&s.preloadHints.forEach(i=>{i.resolvedUri||(i.resolvedUri=en(t,i.uri))})},wc=(s,t)=>s===t||s.segments&&t.segments&&s.segments.length===t.segments.length&&s.endList===t.endList&&s.mediaSequence===t.mediaSequence&&s.preloadSegment===t.preloadSegment,dl=(s,t,i=wc)=>{var a=Qt(s,{}),o=a.playlists[t.id];if(!o||i(o,t))return null;t.segments=Tc(t);let l=Qt(o,t);if(l.preloadSegment&&!t.preloadSegment&&delete l.preloadSegment,o.segments){if(t.skip){t.segments=t.segments||[];for(let h=0;h<t.skip.skippedSegments;h++)t.segments.unshift({skipped:!0})}l.segments=((h,T,B)=>{var G=h.slice(),H=T.slice(),se=(B=B||0,[]);let pe;for(let Ce=0;Ce<H.length;Ce++){var ae=G[Ce+B],_e=H[Ce];ae?(pe=ae.map||pe,se.push(Rm(ae,_e))):(pe&&!_e.map&&(_e.map=pe),se.push(_e))}return se})(o.segments,t.segments,t.mediaSequence-o.mediaSequence)}l.segments.forEach(h=>{Sc(h,l.resolvedUri)});for(let h=0;h<a.playlists.length;h++)a.playlists[h].id===t.id&&(a.playlists[h]=l);return a.playlists[t.id]=l,a.playlists[t.uri]=l,Fr(s,(h,T,B,G)=>{if(h.playlists)for(let H=0;H<h.playlists.length;H++)t.id===h.playlists[H].id&&(h.playlists[H]=l)}),a},cl=(s,t)=>{var i=s.segments||[],i=i[i.length-1],a=i&&i.parts&&i.parts[i.parts.length-1],a=a&&a.duration||i&&i.duration;return t&&a?1e3*a:500*(s.partTargetDuration||s.targetDuration||10)},Ec=(s,t,i)=>{if(s){let a=[];return s.forEach(o=>{var l,h,T;o.attributes&&({BANDWIDTH:l,RESOLUTION:h,CODECS:T}=o.attributes,a.push({id:o.id,bandwidth:l,resolution:h,codecs:T}))}),{type:t,isLive:i,renditions:a}}};class Br extends _n{constructor(l,i,a={}){if(super(),!l)throw new Error("A non-empty playlist URL or object is required");this.logger_=un("PlaylistLoader");var{withCredentials:o=!1}=a,l=(this.src=l,this.vhs_=i,this.withCredentials=o,this.addDateRangesToTextTrack_=a.addDateRangesToTextTrack,i.options_);this.customTagParsers=l&&l.customTagParsers||[],this.customTagMappers=l&&l.customTagMappers||[],this.llhls=l&&l.llhls,this.dateRangesStorage_=new _c,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_),this.on("loadedplaylist",this.handleLoadedPlaylist_.bind(this))}handleLoadedPlaylist_(){var t=this.media();t&&(this.dateRangesStorage_.setOffset(t.segments),this.dateRangesStorage_.setPendingDateRanges(t.dateRanges),(t=this.dateRangesStorage_.getDateRangesToProcess()).length)&&this.addDateRangesToTextTrack_&&this.addDateRangesToTextTrack_(t)}handleMediaupdatetimeout_(){if(this.state==="HAVE_METADATA"){var t=this.media();let i=en(this.main.uri,t.uri);this.llhls&&(i=((a,o)=>{if(!o.endList&&o.serverControl){let T={};if(o.serverControl.canBlockReload){var l,h=o.preloadSegment;let B=o.mediaSequence+o.segments.length;h&&(h=h.parts||[],-1<(l=uc(o)-1)&&l!=h.length-1&&(T._HLS_part=l),-1<l||h.length)&&B--,T._HLS_msn=B}if(o.serverControl&&o.serverControl.canSkipUntil&&(T._HLS_skip=o.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(T).length){let B=new window.URL(a);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(G){T.hasOwnProperty(G)&&B.searchParams.set(G,T[G])}),a=B.toString()}}return a})(i,t)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:i,withCredentials:this.withCredentials,requestType:"hls-playlist"},(a,o)=>{if(this.request)return a?this.playlistRequestError(this.request,this.media(),"HAVE_METADATA"):void this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})})}}playlistRequestError(t,o,a){var{uri:o,id:l}=o;this.request=null,a&&(this.state=a),this.error={playlist:this.main.playlists[l],status:t.status,message:`HLS playlist request error at URL: ${o}.`,responseText:t.responseText,code:500<=t.status?4:2,metadata:or({requestType:t.requestType,request:t,error:t.error})},this.trigger("error")}parseManifest_({url:t,manifestString:i}){try{return(({onwarn:a,oninfo:o,manifestString:l,customTagParsers:h=[],customTagMappers:T=[],llhls:B})=>{let G=new cf,H=(a&&G.on("warn",a),o&&G.on("info",o),h.forEach(se=>G.addParser(se)),T.forEach(se=>G.addTagMapper(se)),G.push(l),G.end(),G.manifest);if(B||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(se){H.hasOwnProperty(se)&&delete H[se]}),H.segments&&H.segments.forEach(function(se){["parts","preloadHints"].forEach(function(pe){se.hasOwnProperty(pe)&&delete se[pe]})})),!H.targetDuration){let se=10;H.segments&&H.segments.length&&(se=H.segments.reduce((pe,ae)=>Math.max(pe,ae.duration),0)),a&&a({message:"manifest has no targetDuration defaulting to "+se}),H.targetDuration=se}return o=lc(H),o.length&&!H.partTargetDuration&&(h=o.reduce((se,pe)=>Math.max(se,pe.duration),0),a&&(a({message:"manifest has no partTargetDuration defaulting to "+h}),gc.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),H.partTargetDuration=h),H})({onwarn:({message:a})=>this.logger_(`m3u8-parser warn for ${t}: `+a),oninfo:({message:a})=>this.logger_(`m3u8-parser info for ${t}: `+a),manifestString:i,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls})}catch(a){this.error=a,this.error.metadata={errorType:He.Error.StreamingHlsPlaylistParserError,error:a}}}haveMetadata({playlistString:T,playlistObject:h,url:a,id:o}){this.request=null,this.state="HAVE_METADATA";var l={playlistInfo:{type:"media",uri:a}},h=(this.trigger({type:"playlistparsestart",metadata:l}),h||this.parseManifest_({url:a,manifestString:T})),T=(h.lastRequest=Date.now(),vc({playlist:h,uri:a,id:o}),dl(this.main,h));this.targetDuration=h.partTargetDuration||h.targetDuration,this.pendingMedia_=null,T?(this.main=T,this.media_=this.main.playlists[o]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(cl(this.media(),!!T)),l.parsedPlaylist=Ec(this.main.playlists,l.playlistInfo.type,!this.media_.endList),this.trigger({type:"playlistparsecomplete",metadata:l}),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),window.clearTimeout(this.mediaUpdateTimeout),window.clearTimeout(this.finalRenditionTimeout),this.dateRangesStorage_=new _c,this.off()}stopRequest(){var t;this.request&&(t=this.request,this.request=null,t.onreadystatechange=null,t.abort())}media(t,i){if(!t)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof t=="string"){if(!this.main.playlists[t])throw new Error("Unknown playlist URI: "+t);t=this.main.playlists[t]}if(window.clearTimeout(this.finalRenditionTimeout),i)i=(t.partTargetDuration||t.targetDuration)/2*1e3||5e3,this.finalRenditionTimeout=window.setTimeout(this.media.bind(this,t,!1),i);else{let o=this.state;var i=!this.media_||t.id!==this.media_.id,a=this.main.playlists[t.id];if(a&&a.endList||t.endList&&t.segments.length)this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=t,i&&(this.trigger("mediachanging"),o==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange"));else if(this.updateMediaUpdateTimeout_(cl(t,!0)),i){if(this.state="SWITCHING_MEDIA",this.request){if(t.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging");let h={playlistInfo:{type:"media",uri:(this.pendingMedia_=t).uri}};this.trigger({type:"playlistrequeststart",metadata:h}),this.request=this.vhs_.xhr({uri:t.resolvedUri,withCredentials:this.withCredentials,requestType:"hls-playlist"},(T,B)=>{if(this.request){if(t.lastRequest=Date.now(),t.resolvedUri=va(t.resolvedUri,B),T)return this.playlistRequestError(this.request,t,o);this.trigger({type:"playlistrequestcomplete",metadata:h}),this.haveMetadata({playlistString:B.responseText,url:t.uri,id:t.id}),o==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}}}pause(){this.mediaUpdateTimeout&&(window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}load(t){this.mediaUpdateTimeout&&(window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);var i=this.media();t?(t=i?(i.partTargetDuration||i.targetDuration)/2*1e3:5e3,this.mediaUpdateTimeout=window.setTimeout(()=>{this.mediaUpdateTimeout=null,this.load()},t)):this.started?i&&!i.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}updateMediaUpdateTimeout_(t){this.mediaUpdateTimeout&&(window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.media()&&!this.media().endList&&(this.mediaUpdateTimeout=window.setTimeout(()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(t)},t))}start(){if(this.started=!0,typeof this.src=="object")this.src.uri||(this.src.uri=window.location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0);else{let t={playlistInfo:{type:"multivariant",uri:this.src}};this.trigger({type:"playlistrequeststart",metadata:t}),this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials,requestType:"hls-playlist"},(i,a)=>{if(this.request){if(this.request=null,i)return this.error={status:a.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:a.responseText,code:2,metadata:or({requestType:a.requestType,request:a,error:i})},this.state==="HAVE_NOTHING"&&(this.started=!1),this.trigger("error");this.trigger({type:"playlistrequestcomplete",metadata:t}),this.src=va(this.src,a),this.trigger({type:"playlistparsestart",metadata:t}),i=this.parseManifest_({manifestString:a.responseText,url:this.src}),t.parsedPlaylist=Ec(i.playlists,t.playlistInfo.type,!1),this.trigger({type:"playlistparsecomplete",metadata:t}),this.setupInitialPlaylist(i)}})}}srcUri(){return typeof this.src=="string"?this.src:this.src.uri}setupInitialPlaylist(t){var i,a,o,l;this.state="HAVE_MAIN_MANIFEST",t.playlists?(this.main=t,bc(this.main,this.srcUri()),t.playlists.forEach(h=>{h.segments=Tc(h),h.segments.forEach(T=>{Sc(T,h.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0])):(i=this.srcUri()||window.location.href,this.main=(a=i,o=Ur(0,a),(l={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:window.location.href,resolvedUri:window.location.href,playlists:[{uri:a,id:o,resolvedUri:a,attributes:{}}]}).playlists[o]=l.playlists[0],l.playlists[a]=l.playlists[0],l),this.haveMetadata({playlistObject:t,url:i,id:this.main.playlists[0].id}),this.trigger("loadedmetadata"))}updateOrDeleteClone(t,i){var a=this.main,o=t.ID;let l=a.playlists.length;for(;l--;){var h,T,B,G,H,se=a.playlists[l];se.attributes["PATHWAY-ID"]===o&&(h=se.resolvedUri,T=se.id,i?(B=this.createCloneURI_(se.resolvedUri,t),G=Ur(o,B),H=this.createCloneAttributes_(o,se.attributes),se=this.createClonePlaylist_(se,G,t,H),a.playlists[l]=se,a.playlists[G]=se,a.playlists[B]=se):a.playlists.splice(l,1),delete a.playlists[T],delete a.playlists[h])}this.updateOrDeleteCloneMedia(t,i)}updateOrDeleteCloneMedia(t,i){let a=this.main,o=t.ID;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(l=>{if(a.mediaGroups[l]&&a.mediaGroups[l][o]){for(var h in a.mediaGroups[l])if(h===o){for(var T in a.mediaGroups[l][h])a.mediaGroups[l][h][T].playlists.forEach((se,G)=>{var se=a.playlists[se.id],H=se.id,se=se.resolvedUri;delete a.playlists[H],delete a.playlists[se]});delete a.mediaGroups[l][h]}}}),i&&this.createClonedMediaGroups_(t)}addClonePathway(t,B={}){var a=this.main,o=a.playlists.length,l=this.createCloneURI_(B.resolvedUri,t),h=Ur(t.ID,l),T=this.createCloneAttributes_(t.ID,B.attributes),B=this.createClonePlaylist_(B,h,t,T);a.playlists[o]=B,a.playlists[h]=B,a.playlists[l]=B,this.createClonedMediaGroups_(t)}createClonedMediaGroups_(t){let i=t.ID,a=t["BASE-ID"],o=this.main;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(l=>{if(o.mediaGroups[l]&&!o.mediaGroups[l][i]){for(var h in o.mediaGroups[l])if(h===a){o.mediaGroups[l][i]={};for(let G in o.mediaGroups[l][h]){var T=o.mediaGroups[l][h][G];o.mediaGroups[l][i][G]=Ii({},T);let H=o.mediaGroups[l][i][G];var B=this.createCloneURI_(T.resolvedUri,t);H.resolvedUri=B,H.uri=B,H.playlists=[],T.playlists.forEach((se,pe)=>{var ae,_e=o.playlists[se.id],Ce=yc(l,i,G),Ce=Ur(i,Ce);_e&&!o.playlists[Ce]&&(ae=(_e=this.createClonePlaylist_(_e,Ce,t)).resolvedUri,o.playlists[Ce]=_e,o.playlists[ae]=_e),H.playlists[pe]=this.createClonePlaylist_(se,Ce,t)})}}}})}createClonePlaylist_(t,i,a,o){return a=this.createCloneURI_(t.resolvedUri,a),a={resolvedUri:a,uri:a,id:i},t.segments&&(a.segments=[]),o&&(a.attributes=o),Qt(t,a)}createCloneURI_(t,i){var a,o=new URL(t),l=(o.hostname=i["URI-REPLACEMENT"].HOST,i["URI-REPLACEMENT"].PARAMS);for(a of Object.keys(l))o.searchParams.set(a,l[a]);return o.href}createCloneAttributes_(t,i){let a={"PATHWAY-ID":t};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(o=>{i[o]&&(a[o]=t)}),a}getKeyIdSet(t){if(t.contentProtection){var i,a=new Set;for(i in t.contentProtection){var o=t.contentProtection[i].attributes.keyId;o&&a.add(o.toLowerCase())}return a}}}function hl(s,t,i,a){var o=s.responseType==="arraybuffer"?s.response:s.responseText;!t&&o&&(s.responseTime=Date.now(),s.roundTripTime=s.responseTime-s.requestTime,s.bytesReceived=o.byteLength||o.length,s.bandwidth||(s.bandwidth=Math.floor(s.bytesReceived/s.roundTripTime*8*1e3))),i.headers&&(s.responseHeaders=i.headers),t&&t.code==="ETIMEDOUT"&&(s.timedout=!0),a(t=t||s.aborted||i.statusCode===200||i.statusCode===206||i.statusCode===0?t:new Error("XHR Failed with a response of: "+(s&&(o||s.responseText))),s)}function Cc(){function s(t,i){t=Qt({timeout:45e3},t);var a=s.beforeRequest||He.Vhs.xhr.beforeRequest,o=s._requestCallbackSet||He.Vhs.xhr._requestCallbackSet||new Set;let l=s._responseCallbackSet||He.Vhs.xhr._responseCallbackSet;a&&typeof a=="function"&&(He.log.warn("beforeRequest is deprecated, use onRequest instead."),o.add(a));var h=(He.Vhs.xhr.original===!0?He:He.Vhs).xhr,T=((H,se)=>{if(H&&H.size){let pe=se;return H.forEach(ae=>{pe=ae(pe)}),pe}})(o,t);o.delete(a);let B=h(T||t,function(H,se){var pe,ae,_e,Ce;return pe=l,ae=B,_e=H,Ce=se,pe&&pe.size&&pe.forEach(Le=>{Le(ae,_e,Ce)}),hl(B,H,se,i)}),G=B.abort;return B.abort=function(){return B.aborted=!0,G.apply(B,arguments)},B.uri=t.uri,B.requestType=t.requestType,B.requestTime=Date.now(),B}return s.original=!0,s}function pl(s){var t={};return s.byterange&&(t.Range=function(i){let a;return"bytes="+i.offset+"-"+(a=typeof i.offset=="bigint"||typeof i.length=="bigint"?window.BigInt(i.offset)+window.BigInt(i.length)-window.BigInt(1):i.offset+i.length-1)}(s.byterange)),t}function Lm(s,t){return s=s.toString(16),"00".substring(0,2-s.length)+s+(t%2?" ":"")}function Mm(s){return 32<=s&&s<126?String.fromCharCode(s):"."}function Ta(s){var t=s.byterange||{length:1/0,offset:0};return[t.length,t.offset,s.resolvedUri].join(",")}function xc(s){return s.resolvedUri}let kc=function(s){let t={};return Object.keys(s).forEach(i=>{var a=s[i];ud(a)?t[i]={bytes:a.buffer,byteOffset:a.byteOffset,byteLength:a.byteLength}:t[i]=a}),t},Nc=s=>{var t,i,a=Array.prototype.slice.call(s);let o="";for(let l=0;l<a.length/16;l++)t=a.slice(16*l,16*l+16).map(Lm).join(""),i=a.slice(16*l,16*l+16).map(Mm).join(""),o+=t+" "+i+`
`;return o};nr=Object.freeze({__proto__:null,createTransferableMessage:kc,initSegmentId:Ta,segmentKeyId:xc,hexDump:Nc,tagDump:({bytes:s})=>Nc(s),textRanges:s=>{let t="",i;for(i=0;i<s.length;i++)t+=(a=s,o=i,a.start(o)+"-"+a.end(o)+" ");var a,o;return t}});let Ac=.25,Um=s=>s.transmuxedPresentationEnd-s.transmuxedPresentationStart-s.transmuxerPrependedSeconds,Fm=({playlist:s,time:t=void 0,callback:i})=>{var a,o;if(i)return s&&t!==void 0?(s=((l,h)=>{if(!h||!h.segments||h.segments.length===0)return null;let T=0,B;for(let H=0;H<h.segments.length&&(B=h.segments[H],!(l<=(T=B.videoTimingInfo?B.videoTimingInfo.transmuxedPresentationEnd:T+B.duration)));H++);var G=h.segments[h.segments.length-1];if(G.videoTimingInfo&&G.videoTimingInfo.transmuxedPresentationEnd<l)return null;if(l>T){if(l>T+G.duration*Ac)return null;B=G}return{segment:B,estimatedStart:B.videoTimingInfo?B.videoTimingInfo.transmuxedPresentationStart:T-B.duration,type:B.videoTimingInfo?"accurate":"estimate"}})(t,s))?s.type==="estimate"?i({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:s.estimatedStart}):(a={mediaSeconds:t},t=t,(o=(s=s.segment).dateTimeObject?(o=s.videoTimingInfo.transmuxerPrependedSeconds,t=t-(s.videoTimingInfo.transmuxedPresentationStart+o),new Date(s.dateTimeObject.getTime()+1e3*t)):null)&&(a.programDateTime=o.toISOString()),i(null,a)):i({message:"valid programTime was not found"}):i({message:"getProgramTime: playlist and time must be provided"});throw new Error("getProgramTime: callback must be provided")},Ic=({programTime:s,playlist:t,retryCount:i=2,seekTo:a,pauseAfterSeek:o=!0,tech:l,callback:h})=>{var T,B,G;if(h)return typeof s<"u"&&t&&a?t.endList||l.hasStarted_?(H=>{if(!H.segments||H.segments.length===0)return!1;for(let se=0;se<H.segments.length;se++)if(!H.segments[se].dateTimeObject)return!1;return!0})(t)?(G=((Ce,se)=>{let pe;try{pe=new Date(Ce)}catch{return null}if(!se||!se.segments||se.segments.length===0)return null;let ae=se.segments[0];if(pe<new Date(ae.dateTimeObject))return null;for(let Pe=0;Pe<se.segments.length-1;Pe++){ae=se.segments[Pe];var _e=new Date(se.segments[Pe+1].dateTimeObject);if(pe<_e)break}var Ce=se.segments[se.segments.length-1],Le=Ce.dateTimeObject,xe=Ce.videoTimingInfo?Um(Ce.videoTimingInfo):Ce.duration+Ce.duration*Ac,xe=new Date(Le.getTime()+1e3*xe);return pe>xe?null:{segment:ae=pe>new Date(Le)?Ce:ae,estimatedStart:ae.videoTimingInfo?ae.videoTimingInfo.transmuxedPresentationStart:tn.duration(se,se.mediaSequence+se.segments.indexOf(ae)),type:ae.videoTimingInfo?"accurate":"estimate"}})(s,t))?(B=((H,se)=>{let pe,ae;try{pe=new Date(H),ae=new Date(se)}catch{}return H=pe.getTime(),(ae.getTime()-H)/1e3})((T=G.segment).dateTimeObject,s),G.type==="estimate"?i===0?h({message:s+" is not buffered yet. Try again"}):(a(G.estimatedStart+B),void l.one("seeked",()=>{Ic({programTime:s,playlist:t,retryCount:i-1,seekTo:a,pauseAfterSeek:o,tech:l,callback:h})})):(G=T.start+B,l.one("seeked",()=>h(null,l.currentTime())),o&&l.pause(),void a(G))):h({message:s+" was not found in the stream"}):h({message:"programDateTime tags must be provided in the manifest "+t.resolvedUri}):h({message:"player must be playing a live stream to start buffering"}):h({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});throw new Error("seekToProgramTime: callback must be provided")},Bm=(s,t)=>{if(s.readyState===4)return t()},zm=(s,t,i,a)=>{function o(H,se,pe,ae){return se.abort(),B=!0,i(H,se,pe,ae)}function l(H,se){var pe;if(!B)return H?(H.metadata=or({requestType:a,request:se,error:H}),o(H,se,"",h)):(pe=se.responseText.substring(h&&h.byteLength||0,se.responseText.length),h=function(){for(var ae,_e,Ce,Le=arguments.length,xe=new Array(Le),Pe=0;Pe<Le;Pe++)xe[Pe]=arguments[Pe];return(xe=xe.filter(function(Ae){return Ae&&(Ae.byteLength||Ae.length)&&typeof Ae!="string"})).length<=1?wt(xe[0]):(ae=xe.reduce(function(Ae,st,Ue){return Ae+(st.byteLength||st.length)},0),_e=new Uint8Array(ae),Ce=0,xe.forEach(function(Ae){Ae=wt(Ae),_e.set(Ae,Ce),Ce+=Ae.byteLength}),_e)}(h,dd(pe,!0)),T=T||Rr(h),h.length<10||T&&h.length<T+2||(pe=il(h))==="ts"&&h.length<188||!pe&&h.length<376?Bm(se,()=>o(H,se,"",h)):o(null,se,pe,h))}let h=[],T,B=!1,G=t({uri:s,beforeSend(H){H.overrideMimeType("text/plain; charset=x-user-defined"),H.addEventListener("progress",function({}){return hl(H,null,{statusCode:H.status},l)})}},function(H,se){return hl(G,H,se,l)});return G};vi=He.EventTarget;function Oc(s,t){if(!wc(s,t)||s.sidx&&t.sidx&&(s.sidx.offset!==t.sidx.offset||s.sidx.length!==t.sidx.length)||!s.sidx&&t.sidx||s.sidx&&!t.sidx||s.segments&&!t.segments||!s.segments&&t.segments)return!1;if(s.segments||t.segments)for(let o=0;o<s.segments.length;o++){var i=s.segments[o],a=t.segments[o];if(i.uri!==a.uri||(i.byterange||a.byterange)&&(i=i.byterange,a=a.byterange,i&&!a||!i&&a||i.offset!==a.offset||i.length!==a.length))return!1}return!0}let jm=(s,t,i,a)=>`placeholder-uri-${s}-${t}-`+(a.attributes.NAME||i),Hm=({mainXml:s,srcUrl:t,clientOffset:i,sidxMapping:a,previousManifest:o})=>(s=s,i={manifestUri:t,clientOffset:i,sidxMapping:a,previousManifest:o},s=vm(Jd(s),i),a=lm(s.representationInfo),o=Jf({dashPlaylists:a,locations:s.locations,contentSteering:s.contentSteeringInfo,sidxMapping:i.sidxMapping,previousManifest:i.previousManifest,eventStream:s.eventStream}),bc(o,t,jm),o),qm=(s,t,i)=>{let a=!0,o=Qt(s,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod,timelineStarts:t.timelineStarts});for(let G=0;G<t.playlists.length;G++){var l=t.playlists[G],h=(l.sidx&&(h=fa(l.sidx),i)&&i[h]&&i[h].sidx&&Ko(l,i[h].sidx,l.sidx.resolvedUri),dl(o,l,Oc));h&&(o=h,a=!1)}var T,B;return Fr(t,(G,H,se,pe)=>{var ae,_e;G.playlists&&G.playlists.length&&(ae=G.playlists[0].id,_e=dl(o,G.playlists[0],Oc))&&(pe in(o=_e).mediaGroups[H][se]||(o.mediaGroups[H][se][pe]=G),o.mediaGroups[H][se][pe].playlists[0]=o.playlists[ae],a=!1)}),T=o,B=t,Fr(T,(G,H,se,pe)=>{B.mediaGroups[H][se]&&pe in B.mediaGroups[H][se]||delete T.mediaGroups[H][se][pe]}),(a=t.minimumUpdatePeriod===s.minimumUpdatePeriod&&a)?null:o},Vm=(s,t)=>(!s.map&&!t.map||!!(s.map&&t.map&&s.map.byterange.offset===t.map.byterange.offset&&s.map.byterange.length===t.map.byterange.length))&&s.uri===t.uri&&s.byterange.offset===t.byterange.offset&&s.byterange.length===t.byterange.length,Dc=(s,t)=>{var i,a={};for(i in s){var o=s[i].sidx;if(o){var l=fa(o);if(!t[l])break;var h=t[l].sidxInfo;Vm(h,o)&&(a[l]=t[l])}}return a};class fl extends vi{constructor(t,i,a={},l){super(),this.isPaused_=!0,this.mainPlaylistLoader_=l||this,l||(this.isMain_=!0);var{withCredentials:l=!1}=a;if(this.vhs_=i,this.withCredentials=l,this.addMetadataToTextTrack=a.addMetadataToTextTrack,!t)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",()=>{this.refreshXml_()}),this.on("mediaupdatetimeout",()=>{this.refreshMedia_(this.media().id)}),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=un("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=t,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=t}get isPaused(){return this.isPaused_}requestErrored_(t,i,a){return!this.request||(this.request=null,t?(this.error=typeof t!="object"||t instanceof Error?{status:i.status,message:"DASH request error at URL: "+i.uri,response:i.response,code:2,metadata:t.metadata}:t,a&&(this.state=a),this.trigger("error"),!0):void 0)}addSidxSegments_(t,i,a){let o=t.sidx&&fa(t.sidx);if(t.sidx&&o&&!this.mainPlaylistLoader_.sidxMapping_[o]){let l=va(t.sidx.resolvedUri),h=(T,B)=>{if(!this.requestErrored_(T,B,i)){var T=this.mainPlaylistLoader_.sidxMapping_,G=B.requestType;let se;try{se=Tm(wt(B.response).subarray(8))}catch(pe){return pe.metadata=or({requestType:G,request:B,parseFailure:!0}),void this.requestErrored_(pe,B,i)}return T[o]={sidxInfo:t.sidx,sidx:se},Ko(t,se,t.sidx.resolvedUri),a(!0)}};this.request=zm(l,this.vhs_.xhr,(T,B,G,H)=>{var se,pe;return T?h(T,B):G&&G==="mp4"?({offset:se,length:pe}=t.sidx.byterange,H.length>=pe+se?h(T,{response:H.subarray(se,se+pe),status:B.status,uri:B.uri}):void(this.request=this.vhs_.xhr({uri:l,responseType:"arraybuffer",requestType:"dash-sidx",headers:pl({byterange:t.sidx.byterange})},h))):(T=G||"unknown",h({status:B.status,message:`Unsupported ${T} container type for sidx segment at URL: `+l,response:"",playlist:t,internal:!0,playlistExclusionDuration:1/0,code:2},B))},"dash-sidx")}else window.clearTimeout(this.mediaRequest_),this.mediaRequest_=window.setTimeout(()=>a(!1),0)}dispose(){this.isPaused_=!0,this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},window.clearTimeout(this.minimumUpdatePeriodTimeout_),window.clearTimeout(this.mediaRequest_),window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){var t;this.request&&(t=this.request,this.request=null,t.onreadystatechange=null,t.abort())}media(t){if(!t)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);let i=this.state;if(typeof t=="string"){if(!this.mainPlaylistLoader_.main.playlists[t])throw new Error("Unknown playlist URI: "+t);t=this.mainPlaylistLoader_.main.playlists[t]}var a=!this.media_||t.id!==this.media_.id;a&&this.loadedPlaylists_[t.id]&&this.loadedPlaylists_[t.id].endList?(this.state="HAVE_METADATA",this.media_=t,a&&(this.trigger("mediachanging"),this.trigger("mediachange"))):a&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(t,i,o=>{this.haveMetadata({startingState:i,playlist:t})}))}haveMetadata({startingState:t,playlist:i}){this.state="HAVE_METADATA",this.loadedPlaylists_[i.id]=i,window.clearTimeout(this.mediaRequest_),this.mediaRequest_=null,this.refreshMedia_(i.id),t==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.isPaused_=!0,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(window.clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)}load(t){this.isPaused_=!1,window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;var i=this.media();t?(t=i?i.targetDuration/2*1e3:5e3,this.mediaUpdateTimeout=window.setTimeout(()=>this.load(),t)):this.started?i&&!i.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist"):this.start()}start(){this.started=!0,this.isMain_?this.requestMain_((t,i)=>{this.haveMain_(),this.hasPendingRequest()||this.media_||this.media(this.mainPlaylistLoader_.main.playlists[0])}):(window.clearTimeout(this.mediaRequest_),this.mediaRequest_=window.setTimeout(()=>this.haveMain_(),0))}requestMain_(t){let i={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};this.trigger({type:"manifestrequeststart",metadata:i}),this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials,requestType:"dash-manifest"},(a,o)=>{var l;if(a&&(l=o.requestType,a.metadata=or({requestType:l,request:o,error:a})),this.requestErrored_(a,o))this.state==="HAVE_NOTHING"&&(this.started=!1);else{this.trigger({type:"manifestrequestcomplete",metadata:i});let h=o.responseText!==this.mainPlaylistLoader_.mainXml_;if(this.mainPlaylistLoader_.mainXml_=o.responseText,o.responseHeaders&&o.responseHeaders.date?this.mainLoaded_=Date.parse(o.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=va(this.mainPlaylistLoader_.srcUrl,o),!h)return t(o,h);this.handleMain_(),this.syncClientServerClock_(()=>t(o,h))}})}syncClientServerClock_(t){let i=bm(this.mainPlaylistLoader_.mainXml_);return i===null?(this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),t()):i.method==="DIRECT"?(this.mainPlaylistLoader_.clientOffset_=i.value-Date.now(),t()):void(this.request=this.vhs_.xhr({uri:en(this.mainPlaylistLoader_.srcUrl,i.value),method:i.method,withCredentials:this.withCredentials,requestType:"dash-clock-sync"},(a,o)=>{if(this.request){var l;if(a)return l=o.requestType,this.error.metadata=or({requestType:l,request:o,error:a}),this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),t();let h;h=i.method==="HEAD"?o.responseHeaders&&o.responseHeaders.date?Date.parse(o.responseHeaders.date):this.mainLoaded_:Date.parse(o.responseText),this.mainPlaylistLoader_.clientOffset_=h-Date.now(),t()}}))}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){window.clearTimeout(this.mediaRequest_),this.mediaRequest_=null;var t=this.mainPlaylistLoader_.main,i={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};this.trigger({type:"manifestparsestart",metadata:i});let a;try{a=Hm({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:t})}catch(l){this.error=l,this.error.metadata={errorType:He.Error.StreamingDashManifestParserError,error:l},this.trigger("error")}t&&(a=qm(t,a,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=a||t;var o=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];if(o&&o!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=o),(!t||a&&a.minimumUpdatePeriod!==t.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),this.addEventStreamToMetadataTrack_(a),a){var{duration:o,endList:t}=a;let T=[];a.playlists.forEach(B=>{T.push({id:B.id,bandwidth:B.attributes.BANDWIDTH,resolution:B.attributes.RESOLUTION,codecs:B.attributes.CODECS})}),o={duration:o,isLive:!t,renditions:T},i.parsedManifest=o,this.trigger({type:"manifestparsecomplete",metadata:i})}return!!a}updateMinimumUpdatePeriodTimeout_(){var t=this.mainPlaylistLoader_;t.createMupOnMedia_&&(t.off("loadedmetadata",t.createMupOnMedia_),t.createMupOnMedia_=null),t.minimumUpdatePeriodTimeout_&&(window.clearTimeout(t.minimumUpdatePeriodTimeout_),t.minimumUpdatePeriodTimeout_=null);let i=t.main&&t.main.minimumUpdatePeriod;i===0&&(t.media()?i=1e3*t.media().targetDuration:(t.createMupOnMedia_=t.updateMinimumUpdatePeriodTimeout_,t.one("loadedmetadata",t.createMupOnMedia_))),typeof i!="number"||i<=0?i<0&&this.logger_(`found invalid minimumUpdatePeriod of ${i}, not setting a timeout`):this.createMUPTimeout_(i)}createMUPTimeout_(t){let i=this.mainPlaylistLoader_;i.minimumUpdatePeriodTimeout_=window.setTimeout(()=>{i.minimumUpdatePeriodTimeout_=null,i.trigger("minimumUpdatePeriod"),i.createMUPTimeout_(t)},t)}refreshXml_(){this.requestMain_((t,i)=>{i&&(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=((a,o)=>{let l=Dc(a.playlists,o);return Fr(a,(h,T,B,G)=>{h.playlists&&h.playlists.length&&(h=h.playlists,l=Qt(l,Dc(h,o)))}),l})(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,a=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(t){if(!t)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();var i=this.mainPlaylistLoader_.main.playlists;let a=!this.media_||this.media_!==i[t];if(a?this.media_=i[t]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){let o=()=>{this.media().endList||(this.mediaUpdateTimeout=window.setTimeout(()=>{this.trigger("mediaupdatetimeout"),o()},cl(this.media(),!!a)))};o()}this.trigger("loadedplaylist")}addEventStreamToMetadataTrack_(t){t&&this.mainPlaylistLoader_.main.eventStream&&(t=this.mainPlaylistLoader_.main.eventStream.map(i=>({cueTime:i.start,frames:[{data:i.messageData}]})),this.addMetadataToTextTrack("EventStream",t,this.mainPlaylistLoader_.main.duration))}getKeyIdSet(t){if(t.contentProtection){var i,a=new Set;for(i in t.contentProtection){var o=t.contentProtection[i].attributes["cenc:default_KID"];o&&a.add(o.replace(/-/g,"").toLowerCase())}return a}}}var Mi={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};function Pc(s){return s.on=s.addEventListener,s.off=s.removeEventListener,s}let Wm=s=>{var t=new Uint8Array(new ArrayBuffer(s.length));for(let i=0;i<s.length;i++)t[i]=s.charCodeAt(i);return t.buffer};function Rc(s){return function(){let t=function(o){try{return URL.createObjectURL(new Blob([o],{type:"application/javascript"}))}catch{var l=new BlobBuilder;return l.append(o),URL.createObjectURL(l.getBlob())}}(s);var i=Pc(new Worker(t));i.objURL=t;let a=i.terminate;return i.on=i.addEventListener,i.off=i.removeEventListener,i.terminate=function(){return URL.revokeObjectURL(t),a.call(this)},i}}function Lc(s){return`var browserWorkerPolyFill = ${Pc.toString()};
browserWorkerPolyFill(self);
`+s}function Mc(s){return s.toString().replace(/^function.+?{/,"").slice(0,-1)}var Xm=Rc(Lc(Mc(function(){function s(){this.init=function(){var c={};this.on=function(C,D){c[C]||(c[C]=[]),c[C]=c[C].concat(D)},this.off=function(C,D){return!!c[C]&&(D=c[C].indexOf(D),c[C]=c[C].slice(),c[C].splice(D,1),-1<D)},this.trigger=function(C){var D,L,X,oe=c[C];if(oe)if(arguments.length===2)for(L=oe.length,D=0;D<L;++D)oe[D].call(this,arguments[1]);else{for(X=[],D=arguments.length,D=1;D<arguments.length;++D)X.push(arguments[D]);for(L=oe.length,D=0;D<L;++D)oe[D].apply(this,X)}},this.dispose=function(){c={}}}}var t,i,a,o,l,h,T,B,G,H,se,pe,ae,_e,Ce,Le,xe,Pe,Ae,st,Ue,ft,Et,dt,Ot,Ct,Lt,jt,xt,Zt,Ti,mn,si,lt,ht,Ft,Xt,Ci=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},cn=(s.prototype.pipe=function(c){return this.on("data",function(C){c.push(C)}),this.on("done",function(C){c.flush(C)}),this.on("partialdone",function(C){c.partialFlush(C)}),this.on("endedtimeline",function(C){c.endTimeline(C)}),this.on("reset",function(C){c.reset(C)}),c},s.prototype.push=function(c){this.trigger("data",c)},s.prototype.flush=function(c){this.trigger("done",c)},s.prototype.partialFlush=function(c){this.trigger("partialdone",c)},s.prototype.endTimeline=function(c){this.trigger("endedtimeline",c)},s.prototype.reset=function(c){this.trigger("reset",c)},s),Jt=Math.pow(2,32),ji={getUint64:function(D){var C,D=new DataView(D.buffer,D.byteOffset,D.byteLength);return D.getBigUint64?(C=D.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(C):C:D.getUint32(0)*Jt+D.getUint32(4)},MAX_UINT32:Jt},fi=ji.MAX_UINT32;if(Ue={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},typeof Uint8Array<"u"){for(var Wt in Ue)Ue.hasOwnProperty(Wt)&&(Ue[Wt]=[Wt.charCodeAt(0),Wt.charCodeAt(1),Wt.charCodeAt(2),Wt.charCodeAt(3)]);ft=new Uint8Array([105,115,111,109]),dt=new Uint8Array([97,118,99,49]),Et=new Uint8Array([0,0,0,1]),wl=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),El=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),Ot={video:wl,audio:El},jt=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Lt=new Uint8Array([0,0,0,0,0,0,0,0]),xt=new Uint8Array([0,0,0,0,0,0,0,0]),Zt=xt,Ti=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),mn=xt,Ct=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}t=function(c){for(var C,D=[],L=0,X=1;X<arguments.length;X++)D.push(arguments[X]);for(X=D.length;X--;)L+=D[X].byteLength;for(C=new Uint8Array(L+8),new DataView(C.buffer,C.byteOffset,C.byteLength).setUint32(0,C.byteLength),C.set(c,4),X=0,L=8;X<D.length;X++)C.set(D[X],L),L+=D[X].byteLength;return C},i=function(){return t(Ue.dinf,t(Ue.dref,jt))},a=function(c){return t(Ue.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,c.audioobjecttype<<3|c.samplingfrequencyindex>>>1,c.samplingfrequencyindex<<7|c.channelcount<<3,6,1,2]))},_e=function(c){return t(Ue.hdlr,Ot[c])},ae=function(c){var C=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,c.duration>>>24&255,c.duration>>>16&255,c.duration>>>8&255,255&c.duration,85,196,0,0]);return c.samplerate&&(C[12]=c.samplerate>>>24&255,C[13]=c.samplerate>>>16&255,C[14]=c.samplerate>>>8&255,C[15]=255&c.samplerate),t(Ue.mdhd,C)},pe=function(c){return t(Ue.mdia,ae(c),_e(c.type),h(c))},l=function(c){return t(Ue.mfhd,new Uint8Array([0,0,0,0,(4278190080&c)>>24,(16711680&c)>>16,(65280&c)>>8,255&c]))},h=function(c){return t(Ue.minf,c.type==="video"?t(Ue.vmhd,Ct):t(Ue.smhd,Lt),i(),Le(c))},B=function(c){for(var C=c.length,D=[];C--;)D[C]=Ae(c[C]);return t.apply(null,[Ue.mvex].concat(D))},G=function(c){return c=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&c)>>24,(16711680&c)>>16,(65280&c)>>8,255&c,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]),t(Ue.mvhd,c)},Ce=function(c){for(var C,D=c.samples||[],L=new Uint8Array(4+D.length),X=0;X<D.length;X++)C=D[X].flags,L[X+4]=C.dependsOn<<4|C.isDependedOn<<2|C.hasRedundancy;return t(Ue.sdtp,L)},Le=function(c){return t(Ue.stbl,xe(c),t(Ue.stts,mn),t(Ue.stsc,Zt),t(Ue.stsz,Ti),t(Ue.stco,xt))},xe=function(c){return t(Ue.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),(c.type==="video"?si:lt)(c))},si=function(c){for(var C,D,L=c.sps||[],X=c.pps||[],oe=[],ce=[],ge=0;ge<L.length;ge++)oe.push((65280&L[ge].byteLength)>>>8),oe.push(255&L[ge].byteLength),oe=oe.concat(Array.prototype.slice.call(L[ge]));for(ge=0;ge<X.length;ge++)ce.push((65280&X[ge].byteLength)>>>8),ce.push(255&X[ge].byteLength),ce=ce.concat(Array.prototype.slice.call(X[ge]));return C=[Ue.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&c.width)>>8,255&c.width,(65280&c.height)>>8,255&c.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),t(Ue.avcC,new Uint8Array([1,c.profileIdc,c.profileCompatibility,c.levelIdc,255].concat([L.length],oe,[X.length],ce))),t(Ue.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],c.sarRatio&&(D=c.sarRatio[0],c=c.sarRatio[1],C.push(t(Ue.pasp,new Uint8Array([(4278190080&D)>>24,(16711680&D)>>16,(65280&D)>>8,255&D,(4278190080&c)>>24,(16711680&c)>>16,(65280&c)>>8,255&c])))),t.apply(null,C)},lt=function(c){return t(Ue.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&c.channelcount)>>8,255&c.channelcount,(65280&c.samplesize)>>8,255&c.samplesize,0,0,0,0,(65280&c.samplerate)>>8,255&c.samplerate,0,0]),a(c))},se=function(c){return c=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&c.id)>>24,(16711680&c.id)>>16,(65280&c.id)>>8,255&c.id,0,0,0,0,(4278190080&c.duration)>>24,(16711680&c.duration)>>16,(65280&c.duration)>>8,255&c.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&c.width)>>8,255&c.width,0,0,(65280&c.height)>>8,255&c.height,0,0]),t(Ue.tkhd,c)},Pe=function(c){var C,D=t(Ue.tfhd,new Uint8Array([0,0,0,58,(4278190080&c.id)>>24,(16711680&c.id)>>16,(65280&c.id)>>8,255&c.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),X=Math.floor(c.baseMediaDecodeTime/fi),L=Math.floor(c.baseMediaDecodeTime%fi),X=t(Ue.tfdt,new Uint8Array([1,0,0,0,X>>>24&255,X>>>16&255,X>>>8&255,255&X,L>>>24&255,L>>>16&255,L>>>8&255,255&L]));return c.type==="audio"?(C=st(c,92),t(Ue.traf,D,X,C)):(L=Ce(c),C=st(c,L.length+92),t(Ue.traf,D,X,C,L))},H=function(c){return c.duration=c.duration||4294967295,t(Ue.trak,se(c),pe(c))},Ae=function(c){var C=new Uint8Array([0,0,0,0,(4278190080&c.id)>>24,(16711680&c.id)>>16,(65280&c.id)>>8,255&c.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return c.type!=="video"&&(C[C.length-1]=0),t(Ue.trex,C)},ht=function(c,C){var D=0,L=0,X=0,oe=0;return c.length&&(c[0].duration!==void 0&&(D=1),c[0].size!==void 0&&(L=2),c[0].flags!==void 0&&(X=4),c[0].compositionTimeOffset!==void 0)&&(oe=8),[0,0,D|L|X|oe,1,(4278190080&c.length)>>>24,(16711680&c.length)>>>16,(65280&c.length)>>>8,255&c.length,(4278190080&C)>>>24,(16711680&C)>>>16,(65280&C)>>>8,255&C]},Ft=function(c,C){var D,L,X,oe,ce=c.samples||[];for(C+=20+16*ce.length,c=ht(ce,C),(L=new Uint8Array(c.length+16*ce.length)).set(c),D=c.length,oe=0;oe<ce.length;oe++)X=ce[oe],L[D++]=(4278190080&X.duration)>>>24,L[D++]=(16711680&X.duration)>>>16,L[D++]=(65280&X.duration)>>>8,L[D++]=255&X.duration,L[D++]=(4278190080&X.size)>>>24,L[D++]=(16711680&X.size)>>>16,L[D++]=(65280&X.size)>>>8,L[D++]=255&X.size,L[D++]=X.flags.isLeading<<2|X.flags.dependsOn,L[D++]=X.flags.isDependedOn<<6|X.flags.hasRedundancy<<4|X.flags.paddingValue<<1|X.flags.isNonSyncSample,L[D++]=61440&X.flags.degradationPriority,L[D++]=15&X.flags.degradationPriority,L[D++]=(4278190080&X.compositionTimeOffset)>>>24,L[D++]=(16711680&X.compositionTimeOffset)>>>16,L[D++]=(65280&X.compositionTimeOffset)>>>8,L[D++]=255&X.compositionTimeOffset;return t(Ue.trun,L)},Xt=function(c,C){var D,L,X,oe,ce=c.samples||[];for(C+=20+8*ce.length,c=ht(ce,C),(D=new Uint8Array(c.length+8*ce.length)).set(c),L=c.length,oe=0;oe<ce.length;oe++)X=ce[oe],D[L++]=(4278190080&X.duration)>>>24,D[L++]=(16711680&X.duration)>>>16,D[L++]=(65280&X.duration)>>>8,D[L++]=255&X.duration,D[L++]=(4278190080&X.size)>>>24,D[L++]=(16711680&X.size)>>>16,D[L++]=(65280&X.size)>>>8,D[L++]=255&X.size;return t(Ue.trun,D)},st=function(c,C){return(c.type==="audio"?Xt:Ft)(c,C)};function Gt(c,C){var D=Ng();return D.dataOffset=C,D.compositionTimeOffset=c.pts-c.dts,D.duration=c.duration,D.size=4*c.length,D.size+=c.byteLength,c.keyFrame&&(D.flags.dependsOn=2,D.flags.isNonSyncSample=0),D}function Mt(c){for(var C=[];c--;)C.push(0);return C}function Ht(c){c=c||{},Ht.prototype.init.call(this),this.parse708captions_=typeof c.parse708captions!="boolean"||c.parse708captions,this.captionPackets_=[],this.ccStreams_=[new mi(0,0),new mi(0,1),new mi(1,0),new mi(1,1)],this.parse708captions_&&(this.cc708Stream_=new ai({captionServices:c.captionServices})),this.reset(),this.ccStreams_.forEach(function(C){C.on("data",this.trigger.bind(this,"data")),C.on("partialdone",this.trigger.bind(this,"partialdone")),C.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))}function sn(c){return 32<=c&&c<=127||160<=c&&c<=255}function an(c){this.windowNum=c,this.reset()}function Mn(c,C,D){this.serviceNum=c,this.text="",this.currentWindow=new an(-1),this.windows=[],this.stream=D,typeof C=="string"&&this.createTextDecoder(C)}function ur(c){return c===null?"":(c=Dg[c]||c,String.fromCharCode(c))}function li(){for(var c=[],C=Aa+1;C--;)c.push({text:"",indent:0,offset:0});return c}function Vr(c,C){var D=1;for(C<c&&(D=-1);Math.abs(C-c)>Lg;)c+=D*Rg;return c}function Ns(c){var C,D;Ns.prototype.init.call(this),this.type_=c||"shared",this.push=function(L){L.type==="metadata"?this.trigger("data",L):this.type_!=="shared"&&L.type!==this.type_||(D===void 0&&(D=L.dts),L.dts=Vr(L.dts,D),L.pts=Vr(L.pts,D),C=L.dts,this.trigger("data",L))},this.flush=function(){D=C,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){C=D=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}}var Wr,wl={ftyp:o=function(){return t(Ue.ftyp,ft,Et,ft,dt)},mdat:function(c){return t(Ue.mdat,c)},moof:function(c,C){for(var D=[],L=C.length;L--;)D[L]=Pe(C[L]);return t.apply(null,[Ue.moof,l(c)].concat(D))},moov:T=function(c){for(var C=c.length,D=[];C--;)D[C]=H(c[C]);return t.apply(null,[Ue.moov,G(4294967295)].concat(D).concat(B(c)))},initSegment:function(D){var C=o(),D=T(D),L=new Uint8Array(C.byteLength+D.byteLength);return L.set(C),L.set(D,C.byteLength),L}},Ng=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},El={groupNalsIntoFrames:function(c){var C,D,L=[],X=[];for(X.byteLength=0,X.nalCount=0,C=L.byteLength=X.duration=0;C<c.length;C++)(D=c[C]).nalUnitType==="access_unit_delimiter_rbsp"?(L.length&&(L.duration=D.dts-L.dts,X.byteLength+=L.byteLength,X.nalCount+=L.length,X.duration+=L.duration,X.push(L)),(L=[D]).byteLength=D.data.byteLength,L.pts=D.pts,L.dts=D.dts):(D.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(L.keyFrame=!0),L.duration=D.dts-L.dts,L.byteLength+=D.data.byteLength,L.push(D));return X.length&&(!L.duration||L.duration<=0)&&(L.duration=X[X.length-1].duration),X.byteLength+=L.byteLength,X.nalCount+=L.length,X.duration+=L.duration,X.push(L),X},groupFramesIntoGops:function(c){var C,D,L=[],X=[];for(L.byteLength=0,L.nalCount=0,L.duration=0,L.pts=c[0].pts,L.dts=c[0].dts,X.byteLength=0,X.nalCount=0,X.duration=0,X.pts=c[0].pts,X.dts=c[0].dts,C=0;C<c.length;C++)(D=c[C]).keyFrame?(L.length&&(X.push(L),X.byteLength+=L.byteLength,X.nalCount+=L.nalCount,X.duration+=L.duration),(L=[D]).nalCount=D.length,L.byteLength=D.byteLength,L.pts=D.pts,L.dts=D.dts,L.duration=D.duration):(L.duration+=D.duration,L.nalCount+=D.length,L.byteLength+=D.byteLength,L.push(D));return X.length&&L.duration<=0&&(L.duration=X[X.length-1].duration),X.byteLength+=L.byteLength,X.nalCount+=L.nalCount,X.duration+=L.duration,X.push(L),X},extendFirstKeyFrame:function(c){var C;return!c[0][0].keyFrame&&1<c.length&&(C=c.shift(),c.byteLength-=C.byteLength,c.nalCount-=C.nalCount,c[0][0].dts=C.dts,c[0][0].pts=C.pts,c[0][0].duration+=C.duration),c},generateSampleTable:function(c,C){for(var D,L,X,oe=C||0,ce=[],ge=0;ge<c.length;ge++)for(L=c[ge],D=0;D<L.length;D++)X=L[D],oe+=(X=Gt(X,oe)).size,ce.push(X);return ce},concatenateNalData:function(c){for(var C,D,L,X,oe,ce=0,ge=c.byteLength,Te=new Uint8Array(ge+4*c.nalCount),Ie=new DataView(Te.buffer),Ge=0;Ge<c.length;Ge++)for(L=c[Ge],C=0;C<L.length;C++)for(X=L[C],D=0;D<X.length;D++)oe=X[D],Ie.setUint32(ce,oe.data.byteLength),Te.set(oe.data,ce+=4),ce+=oe.data.byteLength;return Te},generateSampleTableForFrame:function(L,C){var D=[],L=Gt(L,C||0);return D.push(L),D},concatenateNalDataForFrame:function(c){for(var C,D=0,L=c.byteLength,X=new Uint8Array(L+4*c.length),oe=new DataView(X.buffer),ce=0;ce<c.length;ce++)oe.setUint32(D,(C=c[ce]).data.byteLength),X.set(C.data,D+=4),D+=C.data.byteLength;return X}},Vn=[33,16,5,32,164,27],Cl=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Us=function(c){return 9e4*c},$r=function(c,C){return c*C},kh=function(c){return c/9e4},ka=function(c,C){return c/C},di={ONE_SECOND_IN_TS:9e4,secondsToVideoTs:Us,secondsToAudioTs:$r,videoTsToSeconds:kh,audioTsToSeconds:ka,audioTsToVideoTs:function(c,C){return c/C*9e4},videoTsToAudioTs:function(c,C){return c/9e4*C},metadataTsToSeconds:function(c,C,D){return kh(D?c:c-C)}},Ag=function(){var c,C;return Wr||(c={96e3:[Vn,[227,64],Mt(154),[56]],88200:[Vn,[231],Mt(170),[56]],64e3:[Vn,[248,192],Mt(240),[56]],48e3:[Vn,[255,192],Mt(268),[55,148,128],Mt(54),[112]],44100:[Vn,[255,192],Mt(268),[55,163,128],Mt(84),[112]],32e3:[Vn,[255,192],Mt(268),[55,234],Mt(226),[112]],24e3:[Vn,[255,192],Mt(268),[55,255,128],Mt(268),[111,112],Mt(126),[224]],16e3:[Vn,[255,192],Mt(268),[55,255,128],Mt(268),[111,255],Mt(269),[223,108],Mt(195),[1,192]],12e3:[Cl,Mt(268),[3,127,248],Mt(268),[6,255,240],Mt(268),[13,255,224],Mt(268),[27,253,128],Mt(259),[56]],11025:[Cl,Mt(268),[3,127,248],Mt(268),[6,255,240],Mt(268),[13,255,224],Mt(268),[27,255,192],Mt(268),[55,175,128],Mt(108),[112]],8e3:[Cl,Mt(268),[3,121,16],Mt(47),[7]]},C=c,Wr=Object.keys(C).reduce(function(D,L){return D[L]=new Uint8Array(C[L].reduce(function(X,oe){return X.concat(oe)},[])),D},{})),Wr},xa=di,Us={prefixWithSilence:function(c,C,D,L){var X,oe,ce,ge,Te,Ie=0,Ge=0;if(C.length&&(oe=xa.audioTsToVideoTs(c.baseMediaDecodeTime,c.samplerate),X=Math.ceil(xa.ONE_SECOND_IN_TS/(c.samplerate/1024)),D&&L&&(oe=oe-Math.max(D,L),Ge=(Ie=Math.floor(oe/X))*X),!(Ie<1||Ge>xa.ONE_SECOND_IN_TS/2))){for(ce=(ce=Ag()[c.samplerate])||C[0].data,ge=0;ge<Ie;ge++)Te=C[0],C.splice(0,0,{data:ce,dts:Te.dts-X,pts:Te.pts-X});return c.baseMediaDecodeTime-=Math.floor(xa.videoTsToAudioTs(Ge,c.samplerate)),Ge}},trimAdtsFramesByEarliestDts:function(c,C,D){return C.minSegmentDts>=D?c:(C.minSegmentDts=1/0,c.filter(function(L){return L.dts>=D&&(C.minSegmentDts=Math.min(C.minSegmentDts,L.dts),C.minSegmentPts=C.minSegmentDts,!0)}))},generateSampleTable:function(c){for(var C=[],D=0;D<c.length;D++)C.push({size:c[D].data.byteLength,duration:1024});return C},concatenateFrameData:function(c){for(var C,D=0,L=new Uint8Array(function(oe){for(var ce=0,ge=0;ge<oe.length;ge++)ce+=oe[ge].data.byteLength;return ce}(c)),X=0;X<c.length;X++)L.set((C=c[X]).data,D),D+=C.data.byteLength;return L}},Ig=di.ONE_SECOND_IN_TS,$r={clearDtsInfo:function(c){delete c.minSegmentDts,delete c.maxSegmentDts,delete c.minSegmentPts,delete c.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function(c,C){var D=c.minSegmentDts;return C||(D-=c.timelineStartInfo.dts),C=c.timelineStartInfo.baseMediaDecodeTime,C+=D,C=Math.max(0,C),c.type==="audio"&&(C*=c.samplerate/Ig,C=Math.floor(C)),C},collectDtsInfo:function(c,C){typeof C.pts=="number"&&(c.timelineStartInfo.pts===void 0&&(c.timelineStartInfo.pts=C.pts),c.minSegmentPts=c.minSegmentPts===void 0?C.pts:Math.min(c.minSegmentPts,C.pts),c.maxSegmentPts=c.maxSegmentPts===void 0?C.pts:Math.max(c.maxSegmentPts,C.pts)),typeof C.dts=="number"&&(c.timelineStartInfo.dts===void 0&&(c.timelineStartInfo.dts=C.dts),c.minSegmentDts=c.minSegmentDts===void 0?C.dts:Math.min(c.minSegmentDts,C.dts),c.maxSegmentDts=c.maxSegmentDts===void 0?C.dts:Math.max(c.maxSegmentDts,C.dts))}},ka={parseSei:function(c){for(var C=0,D={payloadType:-1,payloadSize:0},L=0,X=0;C<c.byteLength&&c[C]!==128;){for(;c[C]===255;)L+=255,C++;for(L+=c[C++];c[C]===255;)X+=255,C++;if(X+=c[C++],!D.payload&&L===4){if(String.fromCharCode(c[C+3],c[C+4],c[C+5],c[C+6])==="GA94"){D.payloadType=L,D.payloadSize=X,D.payload=c.subarray(C,C+X);break}D.payload=void 0}C+=X,X=L=0}return D},parseUserData:function(c){return c.payload[0]!==181||(c.payload[1]<<8|c.payload[2])!=49||String.fromCharCode(c.payload[3],c.payload[4],c.payload[5],c.payload[6])!=="GA94"||c.payload[7]!==3?null:c.payload.subarray(8,c.payload.length-1)},parseCaptionPackets:function(c,C){var D,L,X,oe,ce=[];if(64&C[0])for(L=31&C[0],D=0;D<L;D++)oe={type:3&C[2+(X=3*D)],pts:c},4&C[2+X]&&(oe.ccData=C[3+X]<<8|C[4+X],ce.push(oe));return ce},discardEmulationPreventionBytes:function(c){for(var C=c.byteLength,D=[],L=1;L<C-2;)c[L]===0&&c[L+1]===0&&c[L+2]===3?(D.push(L+2),L+=2):L++;if(D.length===0)return c;for(var X=C-D.length,oe=new Uint8Array(X),ce=0,L=0;L<X;ce++,L++)ce===D[0]&&(ce++,D.shift()),oe[L]=c[ce];return oe},USER_DATA_REGISTERED_ITU_T_T35:4},Xr=cn,Na=ka,Og=((Ht.prototype=new Xr).push=function(c){var C;c.nalUnitType==="sei_rbsp"&&(C=Na.parseSei(c.escapedRBSP)).payload&&C.payloadType===Na.USER_DATA_REGISTERED_ITU_T_T35&&(C=Na.parseUserData(C))&&(c.dts<this.latestDts_?this.ignoreNextEqualDts_=!0:c.dts===this.latestDts_&&this.ignoreNextEqualDts_?(this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1)):(C=Na.parseCaptionPackets(c.pts,C),this.captionPackets_=this.captionPackets_.concat(C),this.latestDts_!==c.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=c.dts))},Ht.prototype.flushCCStreams=function(c){this.ccStreams_.forEach(function(C){return c==="flush"?C.flush():C.partialFlush()},this)},Ht.prototype.flushStream=function(c){this.captionPackets_.length&&(this.captionPackets_.forEach(function(C,D){C.presortIndex=D}),this.captionPackets_.sort(function(C,D){return C.pts===D.pts?C.presortIndex-D.presortIndex:C.pts-D.pts}),this.captionPackets_.forEach(function(C){C.type<2?this.dispatchCea608Packet(C):this.dispatchCea708Packet(C)},this),this.captionPackets_.length=0),this.flushCCStreams(c)},Ht.prototype.flush=function(){return this.flushStream("flush")},Ht.prototype.partialFlush=function(){return this.flushStream("partialFlush")},Ht.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(c){c.reset()})},Ht.prototype.dispatchCea608Packet=function(c){this.setsTextOrXDSActive(c)?this.activeCea608Channel_[c.type]=null:this.setsChannel1Active(c)?this.activeCea608Channel_[c.type]=0:this.setsChannel2Active(c)&&(this.activeCea608Channel_[c.type]=1),this.activeCea608Channel_[c.type]!==null&&this.ccStreams_[(c.type<<1)+this.activeCea608Channel_[c.type]].push(c)},Ht.prototype.setsChannel1Active=function(c){return(30720&c.ccData)==4096},Ht.prototype.setsChannel2Active=function(c){return(30720&c.ccData)==6144},Ht.prototype.setsTextOrXDSActive=function(c){return(28928&c.ccData)==256||(30974&c.ccData)==4138||(30974&c.ccData)==6186},Ht.prototype.dispatchCea708Packet=function(c){this.parse708captions_&&this.cc708Stream_.push(c)},{127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600}),ai=(an.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},an.prototype.getText=function(){return this.rows.join(`
`)},an.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},an.prototype.newLine=function(c){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(c),0<this.rows.length&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},an.prototype.isEmpty=function(){return this.rows.length===0||this.rows.length===1&&this.rows[0]===""},an.prototype.addText=function(c){this.rows[this.rowIdx]+=c},an.prototype.backspace=function(){var c;this.isEmpty()||(c=this.rows[this.rowIdx],this.rows[this.rowIdx]=c.substr(0,c.length-1))},Mn.prototype.init=function(c,C){this.startPts=c;for(var D=0;D<8;D++)this.windows[D]=new an(D),typeof C=="function"&&(this.windows[D].beforeRowOverflow=C)},Mn.prototype.setCurrentWindow=function(c){this.currentWindow=this.windows[c]},Mn.prototype.createTextDecoder=function(c){if(typeof TextDecoder>"u")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(c)}catch(C){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+c+" encoding. "+C})}},function(c){c=c||{},ai.prototype.init.call(this);var C,D=this,L=c.captionServices||{},X={};Object.keys(L).forEach(oe=>{C=L[oe],/^SERVICE/.test(oe)&&(X[oe]=C.encoding)}),this.serviceEncodings=X,this.current708Packet=null,this.services={},this.push=function(oe){(oe.type===3||D.current708Packet===null)&&D.new708Packet(),D.add708Bytes(oe)}}),Dg=(ai.prototype=new Xr,ai.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},ai.prototype.add708Bytes=function(c){var D=c.ccData,C=D>>>8,D=255&D;this.current708Packet.ptsVals.push(c.pts),this.current708Packet.data.push(C),this.current708Packet.data.push(D)},ai.prototype.push708Packet=function(){var c,C=this.current708Packet,D=C.data,L=null,X=0,oe=D[X++];for(C.seq=oe>>6,C.sizeCode=63&oe;X<D.length;X++)c=31&(oe=D[X++]),(L=oe>>5)===7&&0<c&&(L=D[X++]),this.pushServiceBlock(L,X,c),0<c&&(X+=c-1)},ai.prototype.pushServiceBlock=function(c,C,D){for(var L,X=C,oe=this.current708Packet.data,ce=(ce=this.services[c])||this.initService(c,X);X<C+D&&X<oe.length;X++)L=oe[X],sn(L)?X=this.handleText(X,ce):L===24?X=this.multiByteCharacter(X,ce):L===16?X=this.extendedCommands(X,ce):128<=L&&L<=135?X=this.setCurrentWindow(X,ce):152<=L&&L<=159?X=this.defineWindow(X,ce):L===136?X=this.clearWindows(X,ce):L===140?X=this.deleteWindows(X,ce):L===137?X=this.displayWindows(X,ce):L===138?X=this.hideWindows(X,ce):L===139?X=this.toggleWindows(X,ce):L===151?X=this.setWindowAttributes(X,ce):L===144?X=this.setPenAttributes(X,ce):L===145?X=this.setPenColor(X,ce):L===146?X=this.setPenLocation(X,ce):L===143?ce=this.reset(X,ce):L===8?ce.currentWindow.backspace():L===12?ce.currentWindow.clearText():L===13?ce.currentWindow.pendingNewLine=!0:L===14?ce.currentWindow.clearText():L===141&&X++},ai.prototype.extendedCommands=function(c,C){var D=this.current708Packet.data[++c];return c=sn(D)?this.handleText(c,C,{isExtended:!0}):c},ai.prototype.getPts=function(c){return this.current708Packet.ptsVals[Math.floor(c/2)]},ai.prototype.initService=function(c,C){var D,L="SERVICE"+c,X=this;return L in this.serviceEncodings&&(D=this.serviceEncodings[L]),this.services[c]=new Mn(c,D,X),this.services[c].init(this.getPts(C),function(oe){X.flushDisplayed(oe,X.services[c])}),this.services[c]},ai.prototype.handleText=function(c,C,oe){var L,X=oe&&oe.isExtended,oe=oe&&oe.isMultiByte,ce=this.current708Packet.data,ge=X?4096:0,Te=ce[c],Ie=C.currentWindow;return oe?(L=[Te,ce[c+1]],c++):L=[Te],oe=C.textDecoder_&&!X?C.textDecoder_.decode(new Uint8Array(L)):oe?(ce=L.map(Ge=>("0"+(255&Ge).toString(16)).slice(-2)).join(""),String.fromCharCode(parseInt(ce,16))):(C=Og[X=ge|Te]||X,4096&X&&X===C?"":String.fromCharCode(C)),Ie.pendingNewLine&&!Ie.isEmpty()&&Ie.newLine(this.getPts(c)),Ie.pendingNewLine=!1,Ie.addText(oe),c},ai.prototype.multiByteCharacter=function(c,C){var D=this.current708Packet.data,L=D[c+1];return c=sn(L)&&sn(D[c+2])?this.handleText(++c,C,{isMultiByte:!0}):c},ai.prototype.setCurrentWindow=function(c,C){var D=this.current708Packet.data[c];return C.setCurrentWindow(7&D),c},ai.prototype.defineWindow=function(c,L){var D=this.current708Packet.data,X=D[c],L=(L.setCurrentWindow(7&X),L.currentWindow),X=D[++c];return L.visible=(32&X)>>5,L.rowLock=(16&X)>>4,L.columnLock=(8&X)>>3,L.priority=7&X,X=D[++c],L.relativePositioning=(128&X)>>7,L.anchorVertical=127&X,X=D[++c],L.anchorHorizontal=X,X=D[++c],L.anchorPoint=(240&X)>>4,L.rowCount=15&X,X=D[++c],L.columnCount=63&X,X=D[++c],L.windowStyle=(56&X)>>3,L.penStyle=7&X,L.virtualRowCount=L.rowCount+1,c},ai.prototype.setWindowAttributes=function(c,L){var D=this.current708Packet.data,L=(D[c],L.currentWindow.winAttr),X=D[++c];return L.fillOpacity=(192&X)>>6,L.fillRed=(48&X)>>4,L.fillGreen=(12&X)>>2,L.fillBlue=3&X,X=D[++c],L.borderType=(192&X)>>6,L.borderRed=(48&X)>>4,L.borderGreen=(12&X)>>2,L.borderBlue=3&X,X=D[++c],L.borderType+=(128&X)>>5,L.wordWrap=(64&X)>>6,L.printDirection=(48&X)>>4,L.scrollDirection=(12&X)>>2,L.justify=3&X,X=D[++c],L.effectSpeed=(240&X)>>4,L.effectDirection=(12&X)>>2,L.displayEffect=3&X,c},ai.prototype.flushDisplayed=function(c,C){for(var D=[],L=0;L<8;L++)C.windows[L].visible&&!C.windows[L].isEmpty()&&D.push(C.windows[L].getText());C.endPts=c,C.text=D.join(`

`),this.pushCaption(C),C.startPts=c},ai.prototype.pushCaption=function(c){c.text!==""&&(this.trigger("data",{startPts:c.startPts,endPts:c.endPts,text:c.text,stream:"cc708_"+c.serviceNum}),c.text="",c.startPts=c.endPts)},ai.prototype.displayWindows=function(c,C){var D=this.current708Packet.data[++c],L=this.getPts(c);this.flushDisplayed(L,C);for(var X=0;X<8;X++)D&1<<X&&(C.windows[X].visible=1);return c},ai.prototype.hideWindows=function(c,C){var D=this.current708Packet.data[++c],L=this.getPts(c);this.flushDisplayed(L,C);for(var X=0;X<8;X++)D&1<<X&&(C.windows[X].visible=0);return c},ai.prototype.toggleWindows=function(c,C){var D=this.current708Packet.data[++c],L=this.getPts(c);this.flushDisplayed(L,C);for(var X=0;X<8;X++)D&1<<X&&(C.windows[X].visible^=1);return c},ai.prototype.clearWindows=function(c,C){var D=this.current708Packet.data[++c],L=this.getPts(c);this.flushDisplayed(L,C);for(var X=0;X<8;X++)D&1<<X&&C.windows[X].clearText();return c},ai.prototype.deleteWindows=function(c,C){var D=this.current708Packet.data[++c],L=this.getPts(c);this.flushDisplayed(L,C);for(var X=0;X<8;X++)D&1<<X&&C.windows[X].reset();return c},ai.prototype.setPenAttributes=function(c,L){var D=this.current708Packet.data,L=(D[c],L.currentWindow.penAttr),X=D[++c];return L.textTag=(240&X)>>4,L.offset=(12&X)>>2,L.penSize=3&X,X=D[++c],L.italics=(128&X)>>7,L.underline=(64&X)>>6,L.edgeType=(56&X)>>3,L.fontStyle=7&X,c},ai.prototype.setPenColor=function(c,L){var D=this.current708Packet.data,L=(D[c],L.currentWindow.penColor),X=D[++c];return L.fgOpacity=(192&X)>>6,L.fgRed=(48&X)>>4,L.fgGreen=(12&X)>>2,L.fgBlue=3&X,X=D[++c],L.bgOpacity=(192&X)>>6,L.bgRed=(48&X)>>4,L.bgGreen=(12&X)>>2,L.bgBlue=3&X,X=D[++c],L.edgeRed=(48&X)>>4,L.edgeGreen=(12&X)>>2,L.edgeBlue=3&X,c},ai.prototype.setPenLocation=function(c,C){var D=this.current708Packet.data,L=(D[c],C.currentWindow.penLoc);return C.currentWindow.pendingNewLine=!0,C=D[++c],L.row=15&C,C=D[++c],L.column=63&C,c},ai.prototype.reset=function(c,C){var D=this.getPts(c);return this.flushDisplayed(D,C),this.initService(C.serviceNum,c)},{42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496}),Aa=14,Pg=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],mi=function(c,C){mi.prototype.init.call(this),this.field_=c||0,this.dataChannel_=C||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(D){var L,X,oe,ce,ge=32639&D.ccData;ge===this.lastControlCode_?this.lastControlCode_=null:((61440&ge)==4096?this.lastControlCode_=ge:ge!==this.PADDING_&&(this.lastControlCode_=null),L=ge>>>8,X=255&ge,ge!==this.PADDING_&&(ge===this.RESUME_CAPTION_LOADING_?this.mode_="popOn":ge===this.END_OF_CAPTION_?(this.mode_="popOn",this.clearFormatting(D.pts),this.flushDisplayed(D.pts),ce=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=ce,this.startPts_=D.pts):ge===this.ROLL_UP_2_ROWS_?(this.rollUpRows_=2,this.setRollUp(D.pts)):ge===this.ROLL_UP_3_ROWS_?(this.rollUpRows_=3,this.setRollUp(D.pts)):ge===this.ROLL_UP_4_ROWS_?(this.rollUpRows_=4,this.setRollUp(D.pts)):ge===this.CARRIAGE_RETURN_?(this.clearFormatting(D.pts),this.flushDisplayed(D.pts),this.shiftRowsUp_(),this.startPts_=D.pts):ge===this.BACKSPACE_?this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1):ge===this.ERASE_DISPLAYED_MEMORY_?(this.flushDisplayed(D.pts),this.displayed_=li()):ge===this.ERASE_NON_DISPLAYED_MEMORY_?this.nonDisplayed_=li():ge===this.RESUME_DIRECT_CAPTIONING_?(this.mode_!=="paintOn"&&(this.flushDisplayed(D.pts),this.displayed_=li()),this.mode_="paintOn",this.startPts_=D.pts):this.isSpecialCharacter(L,X)?(oe=ur((L=(3&L)<<8)|X),this[this.mode_](D.pts,oe),this.column_++):this.isExtCharacter(L,X)?(this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1),oe=ur((L=(3&L)<<8)|X),this[this.mode_](D.pts,oe),this.column_++):this.isMidRowCode(L,X)?(this.clearFormatting(D.pts),this[this.mode_](D.pts," "),this.column_++,(14&X)==14&&this.addFormatting(D.pts,["i"]),(1&X)==1&&this.addFormatting(D.pts,["u"])):this.isOffsetControlCode(L,X)?(this.nonDisplayed_[this.row_].offset=ce=3&X,this.column_+=ce):this.isPAC(L,X)?(ce=Pg.indexOf(7968&ge),this.mode_==="rollUp"&&(ce-this.rollUpRows_+1<0&&(ce=this.rollUpRows_-1),this.setRollUp(D.pts,ce)),ce!==this.row_&&0<=ce&&ce<=14&&(this.clearFormatting(D.pts),this.row_=ce),1&X&&this.formatting_.indexOf("u")===-1&&this.addFormatting(D.pts,["u"]),(16&ge)==16&&(this.column_=4*(ce=(14&ge)>>1),this.nonDisplayed_[this.row_].indent+=ce),this.isColorPAC(X)&&(14&X)==14&&this.addFormatting(D.pts,["i"])):this.isNormalChar(L)&&(X===0&&(X=null),oe=ur(L),oe+=ur(X),this[this.mode_](D.pts,oe),this.column_+=oe.length)))}},Xr=(mi.prototype=new Xr,mi.prototype.flushDisplayed=function(c){let C=L=>{this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+L+"."})},D=[];this.displayed_.forEach((L,X)=>{if(L&&L.text&&L.text.length){try{L.text=L.text.trim()}catch{C(X)}L.text.length&&D.push({text:L.text,line:X+1,position:10+Math.min(70,10*L.indent)+2.5*L.offset})}else L==null&&C(X)}),D.length&&this.trigger("data",{startPts:this.startPts_,endPts:c,content:D,stream:this.name_})},mi.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=li(),this.nonDisplayed_=li(),this.lastControlCode_=null,this.column_=0,this.row_=Aa,this.rollUpRows_=2,this.formatting_=[]},mi.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},mi.prototype.isSpecialCharacter=function(c,C){return c===this.EXT_&&48<=C&&C<=63},mi.prototype.isExtCharacter=function(c,C){return(c===this.EXT_+1||c===this.EXT_+2)&&32<=C&&C<=63},mi.prototype.isMidRowCode=function(c,C){return c===this.EXT_&&32<=C&&C<=47},mi.prototype.isOffsetControlCode=function(c,C){return c===this.OFFSET_&&33<=C&&C<=35},mi.prototype.isPAC=function(c,C){return c>=this.BASE_&&c<this.BASE_+8&&64<=C&&C<=127},mi.prototype.isColorPAC=function(c){return 64<=c&&c<=79||96<=c&&c<=127},mi.prototype.isNormalChar=function(c){return 32<=c&&c<=127},mi.prototype.setRollUp=function(c,C){if(this.mode_!=="rollUp"&&(this.row_=Aa,this.mode_="rollUp",this.flushDisplayed(c),this.nonDisplayed_=li(),this.displayed_=li()),C!==void 0&&C!==this.row_)for(var D=0;D<this.rollUpRows_;D++)this.displayed_[C-D]=this.displayed_[this.row_-D],this.displayed_[this.row_-D]={text:"",indent:0,offset:0};C===void 0&&(C=this.row_),this.topRow_=C-this.rollUpRows_+1},mi.prototype.addFormatting=function(c,C){this.formatting_=this.formatting_.concat(C),C=C.reduce(function(D,L){return D+"<"+L+">"},""),this[this.mode_](c,C)},mi.prototype.clearFormatting=function(c){var C;this.formatting_.length&&(C=this.formatting_.reverse().reduce(function(D,L){return D+"</"+L+">"},""),this.formatting_=[],this[this.mode_](c,C))},mi.prototype.popOn=function(c,C){var D=this.nonDisplayed_[this.row_].text;this.nonDisplayed_[this.row_].text=D+=C},mi.prototype.rollUp=function(c,C){var D=this.displayed_[this.row_].text;this.displayed_[this.row_].text=D+=C},mi.prototype.shiftRowsUp_=function(){for(var c=0;c<this.topRow_;c++)this.displayed_[c]={text:"",indent:0,offset:0};for(c=this.row_+1;c<Aa+1;c++)this.displayed_[c]={text:"",indent:0,offset:0};for(c=this.topRow_;c<this.row_;c++)this.displayed_[c]=this.displayed_[c+1];this.displayed_[this.row_]={text:"",indent:0,offset:0}},mi.prototype.paintOn=function(c,C){var D=this.displayed_[this.row_].text;this.displayed_[this.row_].text=D+=C},{CaptionStream:Ht,Cea608Stream:mi,Cea708Stream:ai}),Ia={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},An=cn,Rg=8589934592,Lg=4294967296;Ns.prototype=new An;function Nh(c,C,D){for(var L="",X=C;X<D;X++)L+="%"+("00"+c[X].toString(16)).slice(-2);return L}function As(c,C,D){return decodeURIComponent(Nh(c,C,D))}function Is(c,C,D){return unescape(Nh(c,C,D))}function Os(c){return c[0]<<21|c[1]<<14|c[2]<<7|c[3]}var Oa,xl,Da,An=Ns,Mg=Vr,Pa=(c,C,D)=>{if(c){for(var L=D;L<c.length;L++)if(c[L]===C)return L}return-1},Ra=3,Ds={APIC:function(c){var C,D=1;c.data[0]!==Ra||(C=Pa(c.data,0,1))<0||(c.mimeType=Is(c.data,1,C),c.pictureType=c.data[D=C+1],(C=Pa(c.data,0,++D))<0)||(c.description=As(c.data,D,C),D=C+1,c.mimeType==="-->"?c.url=Is(c.data,D,c.data.length):c.pictureData=c.data.subarray(D,c.data.length))},"T*":function(c){c.data[0]===Ra&&(c.value=As(c.data,1,c.data.length).replace(/\0*$/,""),c.values=c.value.split("\0"))},TXXX:function(c){var C;c.data[0]===Ra&&(C=Pa(c.data,0,1))!==-1&&(c.description=As(c.data,1,C),c.value=As(c.data,C+1,c.data.length).replace(/\0*$/,""),c.data=c.value)},"W*":function(c){c.url=Is(c.data,0,c.data.length).replace(/\0.*$/,"")},WXXX:function(c){var C;c.data[0]===Ra&&(C=Pa(c.data,0,1))!==-1&&(c.description=As(c.data,1,C),c.url=Is(c.data,C+1,c.data.length).replace(/\0.*$/,""))},PRIV:function(c){for(var C=0;C<c.data.length;C++)if(c.data[C]===0){c.owner=Is(c.data,0,C);break}c.privateData=c.data.subarray(C+1),c.data=c.privateData}},Ah={parseId3Frames:function(c){var C,D=10,L=0,X=[];if(!(c.length<10||c[0]!==73||c[1]!==68||c[2]!==51)){L=Os(c.subarray(6,10)),L+=10,64&c[5]&&(D=(D+=4)+Os(c.subarray(10,14)),L-=Os(c.subarray(16,20)));do{if((C=Os(c.subarray(D+4,D+8)))<1)break;var oe={id:String.fromCharCode(c[D],c[D+1],c[D+2],c[D+3]),data:c.subarray(D+10,D+C+10)}}while(oe.key=oe.id,Ds[oe.id]?Ds[oe.id](oe):oe.id[0]==="T"?Ds["T*"](oe):oe.id[0]==="W"&&Ds["W*"](oe),X.push(oe),(D=D+10+C)<L);return X}},parseSyncSafeInteger:Os,frameParsers:Ds},Nn=cn,Ug=Ia,Wn=Ah,kl=function(c){var C,D={descriptor:c&&c.descriptor},L=0,X=[],oe=0;if(kl.prototype.init.call(this),this.dispatchType=Ug.METADATA_STREAM_TYPE.toString(16),D.descriptor)for(C=0;C<D.descriptor.length;C++)this.dispatchType+=("00"+D.descriptor[C].toString(16)).slice(-2);this.push=function(ce){var ge,Te,Ie,Ge,it,Tt,Nt;if(ce.type==="timed-metadata"){if(ce.dataAlignmentIndicator&&(oe=0,X.length=0),X.length===0&&(ce.data.length<10||ce.data[0]!==73||ce.data[1]!==68||ce.data[2]!==51))this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});else if(X.push(ce),oe+=ce.data.byteLength,X.length===1&&(L=Wn.parseSyncSafeInteger(ce.data.subarray(6,10)),L+=10),!(oe<L)){for(ge={data:new Uint8Array(L),frames:[],pts:X[0].pts,dts:X[0].dts},Ge=0;Ge<L;)ge.data.set(X[0].data.subarray(0,L-Ge),Ge),Ge+=X[0].data.byteLength,oe-=X[0].data.byteLength,X.shift();Te=10,64&ge.data[5]&&(Te=(Te+=4)+Wn.parseSyncSafeInteger(ge.data.subarray(10,14)),L-=Wn.parseSyncSafeInteger(ge.data.subarray(16,20)));do if((Ie=Wn.parseSyncSafeInteger(ge.data.subarray(Te+4,Te+8)))<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}while((Nt={id:String.fromCharCode(ge.data[Te],ge.data[Te+1],ge.data[Te+2],ge.data[Te+3]),data:ge.data.subarray(Te+10,Te+Ie+10)}).key=Nt.id,Wn.frameParsers[Nt.id]?Wn.frameParsers[Nt.id](Nt):Nt.id[0]==="T"?Wn.frameParsers["T*"](Nt):Nt.id[0]==="W"&&Wn.frameParsers["W*"](Nt),Nt.owner==="com.apple.streaming.transportStreamTimestamp"&&(Tt=(1&(it=Nt.data)[3])<<30|it[4]<<22|it[5]<<14|it[6]<<6|it[7]>>>2,Nt.timeStamp=Tt=(Tt*=4)+(3&it[7]),ge.pts===void 0&&ge.dts===void 0&&(ge.pts=Nt.timeStamp,ge.dts=Nt.timeStamp),this.trigger("timestamp",Nt)),ge.frames.push(Nt),(Te=Te+10+Ie)<L);this.trigger("data",ge)}}}},Nn=(kl.prototype=new Nn,kl),dr=cn,Gn=Xr,gn=Ia,Nl=function(){var c=new Uint8Array(188),C=0;Nl.prototype.init.call(this),this.push=function(D){var L,X=0,oe=188;for(C?((L=new Uint8Array(D.byteLength+C)).set(c.subarray(0,C)),L.set(D,C),C=0):L=D;oe<L.byteLength;)L[X]===71&&L[oe]===71?(this.trigger("data",L.subarray(X,oe)),X+=188,oe+=188):(X++,oe++);X<L.byteLength&&(c.set(L.subarray(X),0),C=L.byteLength-X)},this.flush=function(){C===188&&c[0]===71&&(this.trigger("data",c),C=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){C=0,this.trigger("reset")}},Ih=(Nl.prototype=new dr,(Oa=function(){var c,C,D,L;Oa.prototype.init.call(this),(L=this).packetsWaitingForPmt=[],this.programMapTable=void 0,c=function(X,oe){var ce=0;oe.payloadUnitStartIndicator&&(ce+=X[ce]+1),(oe.type==="pat"?C:D)(X.subarray(ce),oe)},C=function(X,oe){oe.section_number=X[7],oe.last_section_number=X[8],L.pmtPid=(31&X[10])<<8|X[11],oe.pmtPid=L.pmtPid},D=function(X,oe){var ce,ge;if(1&X[5]){for(L.programMapTable={video:null,audio:null,"timed-metadata":{}},ce=3+((15&X[1])<<8|X[2])-4,ge=12+((15&X[10])<<8|X[11]);ge<ce;){var Te=X[ge],Ie=(31&X[ge+1])<<8|X[ge+2];Te===gn.H264_STREAM_TYPE&&L.programMapTable.video===null?L.programMapTable.video=Ie:Te===gn.ADTS_STREAM_TYPE&&L.programMapTable.audio===null?L.programMapTable.audio=Ie:Te===gn.METADATA_STREAM_TYPE&&(L.programMapTable["timed-metadata"][Ie]=Te),ge+=5+((15&X[ge+3])<<8|X[ge+4])}oe.programMapTable=L.programMapTable}},this.push=function(X){var oe={},ce=4;if(oe.payloadUnitStartIndicator=!!(64&X[1]),oe.pid=31&X[1],oe.pid<<=8,oe.pid|=X[2],1<(48&X[3])>>>4&&(ce+=X[ce]+1),oe.pid===0)oe.type="pat",c(X.subarray(ce),oe),this.trigger("data",oe);else if(oe.pid===this.pmtPid)for(oe.type="pmt",c(X.subarray(ce),oe),this.trigger("data",oe);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([X,ce,oe]):this.processPes_(X,ce,oe)},this.processPes_=function(X,oe,ce){ce.pid===this.programMapTable.video?ce.streamType=gn.H264_STREAM_TYPE:ce.pid===this.programMapTable.audio?ce.streamType=gn.ADTS_STREAM_TYPE:ce.streamType=this.programMapTable["timed-metadata"][ce.pid],ce.type="pes",ce.data=X.subarray(oe),this.trigger("data",ce)}}).prototype=new dr,Oa.STREAM_TYPES={h264:27,adts:15},(xl=function(){function c(Te,Ie,Ge){var it,Tt=new Uint8Array(Te.size),Nt={type:Ie},Dt=0,Di=0;if(Te.data.length&&!(Te.size<9)){for(Nt.trackId=Te.data[0].pid,Dt=0;Dt<Te.data.length;Dt++)it=Te.data[Dt],Tt.set(it.data,Di),Di+=it.data.byteLength;ge(Tt,Nt),Ie=Ie==="video"||Nt.packetLength<=Te.size,(Ge||Ie)&&(Te.size=0,Te.data.length=0),Ie&&D.trigger("data",Nt)}}var C,D=this,L=!1,X={data:[],size:0},oe={data:[],size:0},ce={data:[],size:0},ge=function(Te,Ie){var Ge=Te[0]<<16|Te[1]<<8|Te[2];Ie.data=new Uint8Array,Ge==1&&(Ie.packetLength=6+(Te[4]<<8|Te[5]),Ie.dataAlignmentIndicator=(4&Te[6])!=0,192&(Ge=Te[7])&&(Ie.pts=(14&Te[9])<<27|(255&Te[10])<<20|(254&Te[11])<<12|(255&Te[12])<<5|(254&Te[13])>>>3,Ie.pts*=4,Ie.pts+=(6&Te[13])>>>1,Ie.dts=Ie.pts,64&Ge)&&(Ie.dts=(14&Te[14])<<27|(255&Te[15])<<20|(254&Te[16])<<12|(255&Te[17])<<5|(254&Te[18])>>>3,Ie.dts*=4,Ie.dts+=(6&Te[18])>>>1),Ie.data=Te.subarray(9+Te[8]))};xl.prototype.init.call(this),this.push=function(Te){({pat:function(){},pes:function(){var Ie,Ge;switch(Te.streamType){case gn.H264_STREAM_TYPE:Ie=X,Ge="video";break;case gn.ADTS_STREAM_TYPE:Ie=oe,Ge="audio";break;case gn.METADATA_STREAM_TYPE:Ie=ce,Ge="timed-metadata";break;default:return}Te.payloadUnitStartIndicator&&c(Ie,Ge,!0),Ie.data.push(Te),Ie.size+=Te.data.byteLength},pmt:function(){var Ie={type:"metadata",tracks:[]};(C=Te.programMapTable).video!==null&&Ie.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+C.video,codec:"avc",type:"video"}),C.audio!==null&&Ie.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+C.audio,codec:"adts",type:"audio"}),L=!0,D.trigger("data",Ie)}})[Te.type]()},this.reset=function(){X.size=0,X.data.length=0,oe.size=0,oe.data.length=0,this.trigger("reset")},this.flushStreams_=function(){c(X,"video"),c(oe,"audio"),c(ce,"timed-metadata")},this.flush=function(){var Te;!L&&C&&(Te={type:"metadata",tracks:[]},C.video!==null&&Te.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+C.video,codec:"avc",type:"video"}),C.audio!==null&&Te.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+C.audio,codec:"adts",type:"audio"}),D.trigger("data",Te)),L=!1,this.flushStreams_(),this.trigger("done")}}).prototype=new dr,{PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:Nl,TransportParseStream:Oa,ElementaryStream:xl,TimestampRolloverStream:An,CaptionStream:Gn.CaptionStream,Cea608Stream:Gn.Cea608Stream,Cea708Stream:Gn.Cea708Stream,MetadataStream:Nn});for(Da in gn)gn.hasOwnProperty(Da)&&(Ih[Da]=gn[Da]);var Al,Oh,dr=Ih,An=cn,Fg=di.ONE_SECOND_IN_TS,Dh=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Il=function(c){var C,D=0;Il.prototype.init.call(this),this.skipWarn_=function(L,X){this.trigger("log",{level:"warn",message:`adts skiping bytes ${L} to ${X} in frame ${D} outside syncword`})},this.push=function(L){var X,oe,ce,ge,Te,Ie,Ge=0;if(c||(D=0),L.type==="audio"){for(C&&C.length?(ce=C,(C=new Uint8Array(ce.byteLength+L.data.byteLength)).set(ce),C.set(L.data,ce.byteLength)):C=L.data;Ge+7<C.length;)if(C[Ge]!==255||(246&C[Ge+1])!=240)typeof Ie!="number"&&(Ie=Ge),Ge++;else{if(typeof Ie=="number"&&(this.skipWarn_(Ie,Ge),Ie=null),oe=2*(1&~C[Ge+1]),X=(3&C[Ge+3])<<11|C[Ge+4]<<3|(224&C[Ge+5])>>5,Te=(ge=1024*(1+(3&C[Ge+6])))*Fg/Dh[(60&C[Ge+2])>>>2],C.byteLength-Ge<X)break;this.trigger("data",{pts:L.pts+D*Te,dts:L.dts+D*Te,sampleCount:ge,audioobjecttype:1+(C[Ge+2]>>>6&3),channelcount:(1&C[Ge+2])<<2|(192&C[Ge+3])>>>6,samplerate:Dh[(60&C[Ge+2])>>>2],samplingfrequencyindex:(60&C[Ge+2])>>>2,samplesize:16,data:C.subarray(Ge+7+oe,Ge+X)}),D++,Ge+=X}typeof Ie=="number"&&(this.skipWarn_(Ie,Ge),Ie=null),C=C.subarray(Ge)}},this.flush=function(){D=0,this.trigger("done")},this.reset=function(){C=void 0,this.trigger("reset")},this.endTimeline=function(){C=void 0,this.trigger("endedtimeline")}},Gn=(Il.prototype=new An,Il),Nn=cn,Bg=function(c){var C=c.byteLength,D=0,L=0;this.length=function(){return 8*C},this.bitsAvailable=function(){return 8*C+L},this.loadWord=function(){var X=c.byteLength-C,oe=new Uint8Array(4),ce=Math.min(4,C);if(ce===0)throw new Error("no bytes available");oe.set(c.subarray(X,X+ce)),D=new DataView(oe.buffer).getUint32(0),L=8*ce,C-=ce},this.skipBits=function(X){var oe;X<L||(X=(X-=L)-8*(oe=Math.floor(X/8)),C-=oe,this.loadWord()),D<<=X,L-=X},this.readBits=function(X){var oe=Math.min(L,X),ce=D>>>32-oe;return 0<(L-=oe)?D<<=oe:0<C&&this.loadWord(),0<(oe=X-oe)?ce<<oe|this.readBits(oe):ce},this.skipLeadingZeros=function(){for(var X=0;X<L;++X)if(D&2147483648>>>X)return D<<=X,L-=X,X;return this.loadWord(),X+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var X=this.skipLeadingZeros();return this.readBits(X+1)-1},this.readExpGolomb=function(){var X=this.readUnsignedExpGolomb();return 1&X?1+X>>>1:-1*(X>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()},Ol=function(){var c,C,D=0;Ol.prototype.init.call(this),this.push=function(L){for(var X,oe=(C=C?((X=new Uint8Array(C.byteLength+L.data.byteLength)).set(C),X.set(L.data,C.byteLength),X):L.data).byteLength;D<oe-3;D++)if(C[D+2]===1){c=D+5;break}for(;c<oe;)switch(C[c]){case 0:if(C[c-1]!==0)c+=2;else if(C[c-2]!==0)c++;else{for(D+3!==c-2&&this.trigger("data",C.subarray(D+3,c-2));C[++c]!==1&&c<oe;);D=c-2,c+=3}break;case 1:C[c-1]!==0||C[c-2]!==0||(this.trigger("data",C.subarray(D+3,c-2)),D=c-2),c+=3;break;default:c+=3}C=C.subarray(D),c-=D,D=0},this.reset=function(){C=null,D=0,this.trigger("reset")},this.flush=function(){C&&3<C.byteLength&&this.trigger("data",C.subarray(D+3)),C=null,D=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}};Ol.prototype=new Nn,Oh={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(Al=function(){var c,C,D,L,X,oe,ce,ge=new Ol;Al.prototype.init.call(this),(c=this).push=function(Te){Te.type==="video"&&(C=Te.trackId,D=Te.pts,L=Te.dts,ge.push(Te))},ge.on("data",function(Te){var Ie={trackId:C,pts:D,dts:L,data:Te,nalUnitTypeCode:31&Te[0]};switch(Ie.nalUnitTypeCode){case 5:Ie.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:Ie.nalUnitType="sei_rbsp",Ie.escapedRBSP=X(Te.subarray(1));break;case 7:Ie.nalUnitType="seq_parameter_set_rbsp",Ie.escapedRBSP=X(Te.subarray(1)),Ie.config=oe(Ie.escapedRBSP);break;case 8:Ie.nalUnitType="pic_parameter_set_rbsp";break;case 9:Ie.nalUnitType="access_unit_delimiter_rbsp"}c.trigger("data",Ie)}),ge.on("done",function(){c.trigger("done")}),ge.on("partialdone",function(){c.trigger("partialdone")}),ge.on("reset",function(){c.trigger("reset")}),ge.on("endedtimeline",function(){c.trigger("endedtimeline")}),this.flush=function(){ge.flush()},this.partialFlush=function(){ge.partialFlush()},this.reset=function(){ge.reset()},this.endTimeline=function(){ge.endTimeline()},ce=function(Te,Ie){for(var Ge=8,it=8,Tt=0;Tt<Te;Tt++)Ge=(it=it!==0?(Ge+Ie.readExpGolomb()+256)%256:it)===0?Ge:it},X=function(Te){for(var Ie=Te.byteLength,Ge=[],it=1;it<Ie-2;)Te[it]===0&&Te[it+1]===0&&Te[it+2]===3?(Ge.push(it+2),it+=2):it++;if(Ge.length===0)return Te;for(var Tt=Ie-Ge.length,Nt=new Uint8Array(Tt),Dt=0,it=0;it<Tt;Dt++,it++)Dt===Ge[0]&&(Dt++,Ge.shift()),Nt[it]=Te[Dt];return Nt},oe=function(Ha){var Ie,Ge,it,Tt,Nt,Dt,Di=0,Fn=0,Kn=0,Zr=0,gi=[1,1],Bt=new Bg(Ha),Ha=Bt.readUnsignedByte(),wy=Bt.readUnsignedByte(),Ey=Bt.readUnsignedByte();if(Bt.skipUnsignedExpGolomb(),Oh[Ha]&&((Ge=Bt.readUnsignedExpGolomb())===3&&Bt.skipBits(1),Bt.skipUnsignedExpGolomb(),Bt.skipUnsignedExpGolomb(),Bt.skipBits(1),Bt.readBoolean()))for(Nt=Ge!==3?8:12,Dt=0;Dt<Nt;Dt++)Bt.readBoolean()&&ce(Dt<6?16:64,Bt);if(Bt.skipUnsignedExpGolomb(),(Ge=Bt.readUnsignedExpGolomb())===0)Bt.readUnsignedExpGolomb();else if(Ge===1)for(Bt.skipBits(1),Bt.skipExpGolomb(),Bt.skipExpGolomb(),Ie=Bt.readUnsignedExpGolomb(),Dt=0;Dt<Ie;Dt++)Bt.skipExpGolomb();if(Bt.skipUnsignedExpGolomb(),Bt.skipBits(1),Ge=Bt.readUnsignedExpGolomb(),it=Bt.readUnsignedExpGolomb(),(Tt=Bt.readBits(1))===0&&Bt.skipBits(1),Bt.skipBits(1),Bt.readBoolean()&&(Di=Bt.readUnsignedExpGolomb(),Fn=Bt.readUnsignedExpGolomb(),Kn=Bt.readUnsignedExpGolomb(),Zr=Bt.readUnsignedExpGolomb()),Bt.readBoolean()&&Bt.readBoolean()){switch(Bt.readUnsignedByte()){case 1:gi=[1,1];break;case 2:gi=[12,11];break;case 3:gi=[10,11];break;case 4:gi=[16,11];break;case 5:gi=[40,33];break;case 6:gi=[24,11];break;case 7:gi=[20,11];break;case 8:gi=[32,11];break;case 9:gi=[80,33];break;case 10:gi=[18,11];break;case 11:gi=[15,11];break;case 12:gi=[64,33];break;case 13:gi=[160,99];break;case 14:gi=[4,3];break;case 15:gi=[3,2];break;case 16:gi=[2,1];break;case 255:gi=[Bt.readUnsignedByte()<<8|Bt.readUnsignedByte(),Bt.readUnsignedByte()<<8|Bt.readUnsignedByte()]}gi&&(gi[0],gi[1])}return{profileIdc:Ha,levelIdc:Ey,profileCompatibility:wy,width:16*(Ge+1)-2*Di-2*Fn,height:(2-Tt)*(it+1)*16-2*Kn-2*Zr,sarRatio:gi}}}).prototype=new Nn;function Ph(c){return c[0]<<21|c[1]<<14|c[2]<<7|c[3]}var An=Al,zg=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Rh=function(c,C){var D=0<=(D=c[C+6]<<21|c[C+7]<<14|c[C+8]<<7|c[C+9])?D:0;return(16&c[C+5])>>4?20+D:10+D},Lh=function(c,C){return c.length-C<10||c[C]!==73||c[C+1]!==68||c[C+2]!==51?C:(C+=Rh(c,C),Lh(c,C))},jg=function(c,C,D){for(var L="",X=C;X<D;X++)L+="%"+("00"+c[X].toString(16)).slice(-2);return L},Nn={isLikelyAacData:function(c){var C=Lh(c,0);return c.length>=C+2&&(255&c[C])==255&&(240&c[C+1])==240&&(22&c[C+1])==16},parseId3TagSize:Rh,parseAdtsSize:function(c,C){var D=(224&c[C+5])>>5;return 6144&c[C+3]|c[C+4]<<3|D},parseType:function(c,C){return c[C]===73&&c[C+1]===68&&c[C+2]===51?"timed-metadata":!0&c[C]&&(240&c[C+1])==240?"audio":null},parseSampleRate:function(c){for(var C=0;C+5<c.length;){if(c[C]===255&&(246&c[C+1])==240)return zg[(60&c[C+2])>>>2];C++}return null},parseAacTimestamp:function(c){var C,D=10;64&c[5]&&(D=(D+=4)+Ph(c.subarray(10,14)));do{if((C=Ph(c.subarray(D+4,D+8)))<1)return null;if(String.fromCharCode(c[D],c[D+1],c[D+2],c[D+3])==="PRIV"){for(var L,X,oe=c.subarray(D+10,D+C+10),ce=0;ce<oe.byteLength;ce++)if(oe[ce]===0){if(unescape(jg(oe,0,ce))==="com.apple.streaming.transportStreamTimestamp")return X=(1&(L=oe.subarray(ce+1))[3])<<30|L[4]<<22|L[5]<<14|L[6]<<6|L[7]>>>2,(X*=4)+(3&L[7]);break}}}while((D=D+10+C)<c.byteLength);return null}},Gr=cn,Mh=Nn,Dl=function(){var c=new Uint8Array,C=0;Dl.prototype.init.call(this),this.setTimestamp=function(D){C=D},this.push=function(D){var L,X,oe=0,ce=0;for(c.length?(X=c.length,(c=new Uint8Array(D.byteLength+X)).set(c.subarray(0,X)),c.set(D,X)):c=D;3<=c.length-ce;)if(c[ce]===73&&c[ce+1]===68&&c[ce+2]===51){if(c.length-ce<10||ce+(oe=Mh.parseId3TagSize(c,ce))>c.length)break;L={type:"timed-metadata",data:c.subarray(ce,ce+oe)},this.trigger("data",L),ce+=oe}else if((255&c[ce])==255&&(240&c[ce+1])==240){if(c.length-ce<7||ce+(oe=Mh.parseAdtsSize(c,ce))>c.length)break;L={type:"audio",data:c.subarray(ce,ce+oe),pts:C,dts:C},this.trigger("data",L),ce+=oe}else ce++;c=0<c.length-ce?c.subarray(ce):new Uint8Array},this.reset=function(){c=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){c=new Uint8Array,this.trigger("endedtimeline")}};Dl.prototype=new Gr;function Uh(c,C){for(var D=Object.keys(C),L=0;L<D.length;L++){var X=D[L];X!=="headOfPipeline"&&C[X].on&&C[X].on("log",Xg.bind(c,X))}}function Fh(c,C){var D;if(c.length===C.length){for(D=0;D<c.length;D++)if(c[D]!==C[D])return;return 1}}function Bh(c,C,D,L,X,oe){return{start:{dts:c,pts:c+(D-C)},end:{dts:c+(L-C),pts:c+(X-D)},prependedContentDuration:oe,baseMediaDecodeTime:c}}var Pl,Rl,Ps,Gr=cn,Rs=wl,Ls=El,La=Us,yn=$r,Un=dr,Ma=di,zh=Gn,Hg=An,qg=Dl,Vg=Nn.isLikelyAacData,Wg=di.ONE_SECOND_IN_TS,jh=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Hh=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],Xg=function(c,C){C.stream=c,this.trigger("log",C)},Ua=function(c,C){var D=[],L=0,X=0,oe=1/0,ce=(C=C||{}).firstSequenceNumber||0;Ua.prototype.init.call(this),this.push=function(ge){yn.collectDtsInfo(c,ge),c&&jh.forEach(function(Te){c[Te]=ge[Te]}),D.push(ge)},this.setEarliestDts=function(ge){L=ge},this.setVideoBaseMediaDecodeTime=function(ge){oe=ge},this.setAudioAppendStart=function(ge){X=ge},this.flush=function(){var ge,Te,Ie,Ge,it;D.length!==0&&(ge=La.trimAdtsFramesByEarliestDts(D,c,L),c.baseMediaDecodeTime=yn.calculateTrackBaseMediaDecodeTime(c,C.keepOriginalTimestamps),it=La.prefixWithSilence(c,ge,X,oe),c.samples=La.generateSampleTable(ge),Ie=Rs.mdat(La.concatenateFrameData(ge)),D=[],Ge=Rs.moof(ce,[c]),Te=new Uint8Array(Ge.byteLength+Ie.byteLength),ce++,Te.set(Ge),Te.set(Ie,Ge.byteLength),yn.clearDtsInfo(c),Ie=Math.ceil(1024*Wg/c.samplerate),ge.length&&(Ge=ge.length*Ie,this.trigger("segmentTimingInfo",Bh(Ma.audioTsToVideoTs(c.baseMediaDecodeTime,c.samplerate),ge[0].dts,ge[0].pts,ge[0].dts+Ge,ge[0].pts+Ge,it||0)),this.trigger("timingInfo",{start:ge[0].pts,end:ge[0].pts+Ge})),this.trigger("data",{track:c,boxes:Te})),this.trigger("done","AudioSegmentStream")},this.reset=function(){yn.clearDtsInfo(c),D=[],this.trigger("reset")}};Ua.prototype=new Gr,(Pl=function(c,C){var D,L,X=[],oe=[],ce=(C=C||{}).firstSequenceNumber||0;Pl.prototype.init.call(this),delete c.minPTS,this.gopCache_=[],this.push=function(ge){yn.collectDtsInfo(c,ge),ge.nalUnitType!=="seq_parameter_set_rbsp"||D||(D=ge.config,c.sps=[ge.data],Hh.forEach(function(Te){c[Te]=D[Te]},this)),ge.nalUnitType!=="pic_parameter_set_rbsp"||L||(L=ge.data,c.pps=[ge.data]),X.push(ge)},this.flush=function(){for(var ge,Te,Ie,Ge=0;X.length&&X[0].nalUnitType!=="access_unit_delimiter_rbsp";)X.shift();if(X.length!==0){if(ge=Ls.groupNalsIntoFrames(X),(ge=Ls.groupFramesIntoGops(ge))[0][0].keyFrame||((it=this.getGopForFusion_(X[0],c))?(Ge=it.duration,ge.unshift(it),ge.byteLength+=it.byteLength,ge.nalCount+=it.nalCount,ge.pts=it.pts,ge.dts=it.dts,ge.duration+=it.duration):ge=Ls.extendFirstKeyFrame(ge)),oe.length){var it=C.alignGopsAtEnd?this.alignGopsAtEnd_(ge):this.alignGopsAtStart_(ge);if(!it)return this.gopCache_.unshift({gop:ge.pop(),pps:c.pps,sps:c.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),X=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");yn.clearDtsInfo(c),ge=it}yn.collectDtsInfo(c,ge),c.samples=Ls.generateSampleTable(ge),it=Rs.mdat(Ls.concatenateNalData(ge)),c.baseMediaDecodeTime=yn.calculateTrackBaseMediaDecodeTime(c,C.keepOriginalTimestamps),this.trigger("processedGopsInfo",ge.map(function(Tt){return{pts:Tt.pts,dts:Tt.dts,byteLength:Tt.byteLength}})),Te=ge[0],Ie=ge[ge.length-1],this.trigger("segmentTimingInfo",Bh(c.baseMediaDecodeTime,Te.dts,Te.pts,Ie.dts+Ie.duration,Ie.pts+Ie.duration,Ge)),this.trigger("timingInfo",{start:ge[0].pts,end:ge[ge.length-1].pts+ge[ge.length-1].duration}),this.gopCache_.unshift({gop:ge.pop(),pps:c.pps,sps:c.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),X=[],this.trigger("baseMediaDecodeTime",c.baseMediaDecodeTime),this.trigger("timelineStartInfo",c.timelineStartInfo),Te=Rs.moof(ce,[c]),Ie=new Uint8Array(Te.byteLength+it.byteLength),ce++,Ie.set(Te),Ie.set(it,Te.byteLength),this.trigger("data",{track:c,boxes:Ie})}this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),X=[],this.gopCache_.length=0,oe.length=0,this.trigger("reset")},this.resetStream_=function(){yn.clearDtsInfo(c),L=D=void 0},this.getGopForFusion_=function(ge){for(var Te,Ie,Ge,it=1/0,Tt=0;Tt<this.gopCache_.length;Tt++)Ie=(Ge=this.gopCache_[Tt]).gop,c.pps&&Fh(c.pps[0],Ge.pps[0])&&c.sps&&Fh(c.sps[0],Ge.sps[0])&&(Ie.dts<c.timelineStartInfo.dts||-1e4<=(Ie=ge.dts-Ie.dts-Ie.duration)&&Ie<=45e3&&(!Te||Ie<it)&&(Te=Ge,it=Ie));return Te?Te.gop:null},this.alignGopsAtStart_=function(ge){for(var Te,Ie,Ge,it,Tt=ge.byteLength,Nt=ge.nalCount,Dt=ge.duration,Di=Te=0;Di<oe.length&&Te<ge.length&&(Ie=oe[Di],Ge=ge[Te],Ie.pts!==Ge.pts);)Ie.pts<Ge.pts?Di++:(Te++,Tt-=Ge.byteLength,Nt-=Ge.nalCount,Dt-=Ge.duration);return Te===0?ge:Te===ge.length?null:((it=ge.slice(Te)).byteLength=Tt,it.duration=Dt,it.nalCount=Nt,it.pts=it[0].pts,it.dts=it[0].dts,it)},this.alignGopsAtEnd_=function(ge){for(var Te,Ie,Ge,it,Tt=oe.length-1,Nt=ge.length-1,Dt=null,Di=!1;0<=Tt&&0<=Nt;){if(Te=oe[Tt],Ie=ge[Nt],Te.pts===Ie.pts){Di=!0;break}Ie.pts<Te.pts?Tt--:(Tt===oe.length-1&&(Dt=Nt),Nt--)}return Di||Dt!==null?(Ge=Di?Nt:Dt)===0?ge:(it=(Ge=ge.slice(Ge)).reduce(function(Fn,Kn){return Fn.byteLength+=Kn.byteLength,Fn.duration+=Kn.duration,Fn.nalCount+=Kn.nalCount,Fn},{byteLength:0,duration:0,nalCount:0}),Ge.byteLength=it.byteLength,Ge.duration=it.duration,Ge.nalCount=it.nalCount,Ge.pts=Ge[0].pts,Ge.dts=Ge[0].dts,Ge):null},this.alignGopsWith=function(ge){oe=ge}}).prototype=new Gr,((Ps=function(c,C){this.numberOfTracks=0,this.metadataStream=C,typeof(c=c||{}).remux<"u"?this.remuxTracks=!!c.remux:this.remuxTracks=!0,this.keepOriginalTimestamps=typeof c.keepOriginalTimestamps=="boolean"&&c.keepOriginalTimestamps,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Ps.prototype.init.call(this),this.push=function(D){return D.content||D.text?this.pendingCaptions.push(D):D.frames?this.pendingMetadata.push(D):(this.pendingTracks.push(D.track),this.pendingBytes+=D.boxes.byteLength,D.track.type==="video"&&(this.videoTrack=D.track,this.pendingBoxes.push(D.boxes)),void(D.track.type==="audio"&&(this.audioTrack=D.track,this.pendingBoxes.unshift(D.boxes))))}}).prototype=new Gr).flush=function(c){var C,D,L,X=0,oe={captions:[],captionStreams:{},metadata:[],info:{}},ce=0;if(this.pendingTracks.length<this.numberOfTracks){if(c!=="VideoSegmentStream"&&c!=="AudioSegmentStream"||this.remuxTracks)return;if(this.pendingTracks.length===0)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(ce=this.videoTrack.timelineStartInfo.pts,Hh.forEach(function(ge){oe.info[ge]=this.videoTrack[ge]},this)):this.audioTrack&&(ce=this.audioTrack.timelineStartInfo.pts,jh.forEach(function(ge){oe.info[ge]=this.audioTrack[ge]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?oe.type=this.pendingTracks[0].type:oe.type="combined",this.emittedTracks+=this.pendingTracks.length,c=Rs.initSegment(this.pendingTracks),oe.initSegment=new Uint8Array(c.byteLength),oe.initSegment.set(c),oe.data=new Uint8Array(this.pendingBytes),L=0;L<this.pendingBoxes.length;L++)oe.data.set(this.pendingBoxes[L],X),X+=this.pendingBoxes[L].byteLength;for(L=0;L<this.pendingCaptions.length;L++)(C=this.pendingCaptions[L]).startTime=Ma.metadataTsToSeconds(C.startPts,ce,this.keepOriginalTimestamps),C.endTime=Ma.metadataTsToSeconds(C.endPts,ce,this.keepOriginalTimestamps),oe.captionStreams[C.stream]=!0,oe.captions.push(C);for(L=0;L<this.pendingMetadata.length;L++)(D=this.pendingMetadata[L]).cueTime=Ma.metadataTsToSeconds(D.pts,ce,this.keepOriginalTimestamps),oe.metadata.push(D);for(oe.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",oe),L=0;L<oe.captions.length;L++)C=oe.captions[L],this.trigger("caption",C);for(L=0;L<oe.metadata.length;L++)D=oe.metadata[L],this.trigger("id3Frame",D)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},Ps.prototype.setRemux=function(c){this.remuxTracks=c},(Rl=function(c){var C,D,L=this,X=!0;Rl.prototype.init.call(this),c=c||{},this.baseMediaDecodeTime=c.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var oe={};(this.transmuxPipeline_=oe).type="aac",oe.metadataStream=new Un.MetadataStream,oe.aacStream=new qg,oe.audioTimestampRolloverStream=new Un.TimestampRolloverStream("audio"),oe.timedMetadataTimestampRolloverStream=new Un.TimestampRolloverStream("timed-metadata"),oe.adtsStream=new zh,oe.coalesceStream=new Ps(c,oe.metadataStream),oe.headOfPipeline=oe.aacStream,oe.aacStream.pipe(oe.audioTimestampRolloverStream).pipe(oe.adtsStream),oe.aacStream.pipe(oe.timedMetadataTimestampRolloverStream).pipe(oe.metadataStream).pipe(oe.coalesceStream),oe.metadataStream.on("timestamp",function(ce){oe.aacStream.setTimestamp(ce.timeStamp)}),oe.aacStream.on("data",function(ce){ce.type!=="timed-metadata"&&ce.type!=="audio"||oe.audioSegmentStream||(D=D||{timelineStartInfo:{baseMediaDecodeTime:L.baseMediaDecodeTime},codec:"adts",type:"audio"},oe.coalesceStream.numberOfTracks++,oe.audioSegmentStream=new Ua(D,c),oe.audioSegmentStream.on("log",L.getLogTrigger_("audioSegmentStream")),oe.audioSegmentStream.on("timingInfo",L.trigger.bind(L,"audioTimingInfo")),oe.adtsStream.pipe(oe.audioSegmentStream).pipe(oe.coalesceStream),L.trigger("trackinfo",{hasAudio:!!D,hasVideo:!!C}))}),oe.coalesceStream.on("data",this.trigger.bind(this,"data")),oe.coalesceStream.on("done",this.trigger.bind(this,"done")),Uh(this,oe)},this.setupTsPipeline=function(){var oe={};(this.transmuxPipeline_=oe).type="ts",oe.metadataStream=new Un.MetadataStream,oe.packetStream=new Un.TransportPacketStream,oe.parseStream=new Un.TransportParseStream,oe.elementaryStream=new Un.ElementaryStream,oe.timestampRolloverStream=new Un.TimestampRolloverStream,oe.adtsStream=new zh,oe.h264Stream=new Hg,oe.captionStream=new Un.CaptionStream(c),oe.coalesceStream=new Ps(c,oe.metadataStream),oe.headOfPipeline=oe.packetStream,oe.packetStream.pipe(oe.parseStream).pipe(oe.elementaryStream).pipe(oe.timestampRolloverStream),oe.timestampRolloverStream.pipe(oe.h264Stream),oe.timestampRolloverStream.pipe(oe.adtsStream),oe.timestampRolloverStream.pipe(oe.metadataStream).pipe(oe.coalesceStream),oe.h264Stream.pipe(oe.captionStream).pipe(oe.coalesceStream),oe.elementaryStream.on("data",function(ce){var ge;if(ce.type==="metadata"){for(ge=ce.tracks.length;ge--;)C||ce.tracks[ge].type!=="video"?D||ce.tracks[ge].type!=="audio"||((D=ce.tracks[ge]).timelineStartInfo.baseMediaDecodeTime=L.baseMediaDecodeTime):(C=ce.tracks[ge]).timelineStartInfo.baseMediaDecodeTime=L.baseMediaDecodeTime;C&&!oe.videoSegmentStream&&(oe.coalesceStream.numberOfTracks++,oe.videoSegmentStream=new Pl(C,c),oe.videoSegmentStream.on("log",L.getLogTrigger_("videoSegmentStream")),oe.videoSegmentStream.on("timelineStartInfo",function(Te){D&&!c.keepOriginalTimestamps&&(D.timelineStartInfo=Te,oe.audioSegmentStream.setEarliestDts(Te.dts-L.baseMediaDecodeTime))}),oe.videoSegmentStream.on("processedGopsInfo",L.trigger.bind(L,"gopInfo")),oe.videoSegmentStream.on("segmentTimingInfo",L.trigger.bind(L,"videoSegmentTimingInfo")),oe.videoSegmentStream.on("baseMediaDecodeTime",function(Te){D&&oe.audioSegmentStream.setVideoBaseMediaDecodeTime(Te)}),oe.videoSegmentStream.on("timingInfo",L.trigger.bind(L,"videoTimingInfo")),oe.h264Stream.pipe(oe.videoSegmentStream).pipe(oe.coalesceStream)),D&&!oe.audioSegmentStream&&(oe.coalesceStream.numberOfTracks++,oe.audioSegmentStream=new Ua(D,c),oe.audioSegmentStream.on("log",L.getLogTrigger_("audioSegmentStream")),oe.audioSegmentStream.on("timingInfo",L.trigger.bind(L,"audioTimingInfo")),oe.audioSegmentStream.on("segmentTimingInfo",L.trigger.bind(L,"audioSegmentTimingInfo")),oe.adtsStream.pipe(oe.audioSegmentStream).pipe(oe.coalesceStream)),L.trigger("trackinfo",{hasAudio:!!D,hasVideo:!!C})}}),oe.coalesceStream.on("data",this.trigger.bind(this,"data")),oe.coalesceStream.on("id3Frame",function(ce){ce.dispatchType=oe.metadataStream.dispatchType,L.trigger("id3Frame",ce)}),oe.coalesceStream.on("caption",this.trigger.bind(this,"caption")),oe.coalesceStream.on("done",this.trigger.bind(this,"done")),Uh(this,oe)},this.setBaseMediaDecodeTime=function(oe){var ce=this.transmuxPipeline_;c.keepOriginalTimestamps||(this.baseMediaDecodeTime=oe),D&&(D.timelineStartInfo.dts=void 0,D.timelineStartInfo.pts=void 0,yn.clearDtsInfo(D),ce.audioTimestampRolloverStream)&&ce.audioTimestampRolloverStream.discontinuity(),C&&(ce.videoSegmentStream&&(ce.videoSegmentStream.gopCache_=[]),C.timelineStartInfo.dts=void 0,C.timelineStartInfo.pts=void 0,yn.clearDtsInfo(C),ce.captionStream.reset()),ce.timestampRolloverStream&&ce.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(oe){D&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(oe)},this.setRemux=function(oe){var ce=this.transmuxPipeline_;c.remux=oe,ce&&ce.coalesceStream&&ce.coalesceStream.setRemux(oe)},this.alignGopsWith=function(oe){C&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(oe)},this.getLogTrigger_=function(oe){var ce=this;return function(ge){ge.stream=oe,ce.trigger("log",ge)}},this.push=function(oe){var ce;X&&((ce=Vg(oe))&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():ce||this.transmuxPipeline_.type==="ts"||this.setupTsPipeline(),X=!1),this.transmuxPipeline_.headOfPipeline.push(oe)},this.flush=function(){X=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new Gr;function Ll(c){var C="";return(C+=String.fromCharCode(c[0]))+String.fromCharCode(c[1])+String.fromCharCode(c[2])+String.fromCharCode(c[3])}function Ms(c,C){var D,L,X,oe=[];if(!C.length)return null;for(D=0;D<c.byteLength;)L=$g(c[D]<<24|c[D+1]<<16|c[D+2]<<8|c[D+3]),X=Kg(c.subarray(D+4,D+8)),L=1<L?D+L:c.byteLength,X===C[0]&&(C.length===1?oe.push(c.subarray(D+8,L)):(X=Ms(c.subarray(D+8,L),C.slice(1))).length&&(oe=oe.concat(X))),D=L;return oe}function Ml(c){var C={version:c[0],flags:new Uint8Array(c.subarray(1,4))};return C.baseMediaDecodeTime=C.version===1?Zg(c.subarray(4)):Yg(c[4]<<24|c[5]<<16|c[6]<<8|c[7]),C}function Ul(c){var C=new DataView(c.buffer,c.byteOffset,c.byteLength),D=1&(c={version:c[0],flags:new Uint8Array(c.subarray(1,4)),trackId:C.getUint32(4)}).flags[2],L=2&c.flags[2],X=8&c.flags[2],oe=16&c.flags[2],ce=32&c.flags[2],ge=65536&c.flags[0],Te=131072&c.flags[0],Ie=8;return D&&(Ie+=4,c.baseDataOffset=C.getUint32(12),Ie+=4),L&&(c.sampleDescriptionIndex=C.getUint32(Ie),Ie+=4),X&&(c.defaultSampleDuration=C.getUint32(Ie),Ie+=4),oe&&(c.defaultSampleSize=C.getUint32(Ie),Ie+=4),ce&&(c.defaultSampleFlags=C.getUint32(Ie)),ge&&(c.durationIsEmpty=!0),!D&&Te&&(c.baseDataOffsetIsMoof=!0),c}function qh(c){var C,D={version:c[0],flags:new Uint8Array(c.subarray(1,4)),samples:[]},L=new DataView(c.buffer,c.byteOffset,c.byteLength),X=1&D.flags[2],oe=4&D.flags[2],ce=1&D.flags[1],ge=2&D.flags[1],Te=4&D.flags[1],Ie=8&D.flags[1],Ge=L.getUint32(4),it=8;for(X&&(D.dataOffset=L.getInt32(it),it+=4),oe&&Ge&&(C={flags:Wh(c.subarray(it,it+4))},it+=4,ce&&(C.duration=L.getUint32(it),it+=4),ge&&(C.size=L.getUint32(it),it+=4),Ie&&(C.compositionTimeOffset=D.version===1?L.getInt32(it):L.getUint32(it),it+=4),D.samples.push(C),Ge--);Ge--;)C={},ce&&(C.duration=L.getUint32(it),it+=4),ge&&(C.size=L.getUint32(it),it+=4),Te&&(C.flags=Wh(c.subarray(it,it+4)),it+=4),Ie&&(C.compositionTimeOffset=D.version===1?L.getInt32(it):L.getUint32(it),it+=4),D.samples.push(C);return D}function dn(c){return new Date(1e3*c-20828448e5)}var Gg=Rl,cn=function(c){return c>>>0},Us=function(c){return("00"+c.toString(16)).slice(-2)},$g=cn,Kg=Ll,Yg=cn,Zg=ji.getUint64,Vh=ji.getUint64,Wh=function(c){return{isLeading:(12&c[0])>>>2,dependsOn:3&c[0],isDependedOn:(192&c[1])>>>6,hasRedundancy:(48&c[1])>>>4,paddingValue:(14&c[1])>>>1,isNonSyncSample:1&c[1],degradationPriority:c[2]<<8|c[3]}},Xh=ji.getUint64,Fs=Ll,Xn={avc1:function(c){var C=new DataView(c.buffer,c.byteOffset,c.byteLength);return{dataReferenceIndex:C.getUint16(6),width:C.getUint16(24),height:C.getUint16(26),horizresolution:C.getUint16(28)+C.getUint16(30)/16,vertresolution:C.getUint16(32)+C.getUint16(34)/16,frameCount:C.getUint16(40),depth:C.getUint16(74),config:Ki(c.subarray(78,c.byteLength))}},avcC:function(c){for(var C,D,L=new DataView(c.buffer,c.byteOffset,c.byteLength),X={configurationVersion:c[0],avcProfileIndication:c[1],profileCompatibility:c[2],avcLevelIndication:c[3],lengthSizeMinusOne:3&c[4],sps:[],pps:[]},oe=31&c[5],ce=6,ge=0;ge<oe;ge++)D=L.getUint16(ce),ce+=2,X.sps.push(new Uint8Array(c.subarray(ce,ce+D))),ce+=D;for(C=c[ce],ce++,ge=0;ge<C;ge++)D=L.getUint16(ce),ce+=2,X.pps.push(new Uint8Array(c.subarray(ce,ce+D))),ce+=D;return X},btrt:function(c){return c=new DataView(c.buffer,c.byteOffset,c.byteLength),{bufferSizeDB:c.getUint32(0),maxBitrate:c.getUint32(4),avgBitrate:c.getUint32(8)}},edts:function(c){return{boxes:Ki(c)}},elst:function(c){for(var C=new DataView(c.buffer,c.byteOffset,c.byteLength),D={version:C.getUint8(0),flags:new Uint8Array(c.subarray(1,4)),edits:[]},L=C.getUint32(4),X=8;L;L--)D.version===0?(D.edits.push({segmentDuration:C.getUint32(X),mediaTime:C.getInt32(X+4),mediaRate:C.getUint16(X+8)+C.getUint16(X+10)/65536}),X+=12):(D.edits.push({segmentDuration:Xh(c.subarray(X)),mediaTime:Xh(c.subarray(X+8)),mediaRate:C.getUint16(X+16)+C.getUint16(X+18)/65536}),X+=20);return D},esds:function(c){return{version:c[0],flags:new Uint8Array(c.subarray(1,4)),esId:c[6]<<8|c[7],streamPriority:31&c[8],decoderConfig:{objectProfileIndication:c[11],streamType:c[12]>>>2&63,bufferSize:c[13]<<16|c[14]<<8|c[15],maxBitrate:c[16]<<24|c[17]<<16|c[18]<<8|c[19],avgBitrate:c[20]<<24|c[21]<<16|c[22]<<8|c[23],decoderConfigDescriptor:{tag:c[24],length:c[25],audioObjectType:c[26]>>>3&31,samplingFrequencyIndex:(7&c[26])<<1|c[27]>>>7&1,channelConfiguration:c[27]>>>3&15}}}},ftyp:function(c){for(var C=new DataView(c.buffer,c.byteOffset,c.byteLength),D={majorBrand:Fs(c.subarray(0,4)),minorVersion:C.getUint32(4),compatibleBrands:[]},L=8;L<c.byteLength;)D.compatibleBrands.push(Fs(c.subarray(L,L+4))),L+=4;return D},dinf:function(c){return{boxes:Ki(c)}},dref:function(c){return{version:c[0],flags:new Uint8Array(c.subarray(1,4)),dataReferences:Ki(c.subarray(8))}},hdlr:function(c){for(var C={version:new DataView(c.buffer,c.byteOffset,c.byteLength).getUint8(0),flags:new Uint8Array(c.subarray(1,4)),handlerType:Fs(c.subarray(8,12)),name:""},D=8,D=24;D<c.byteLength;D++){if(c[D]===0){D++;break}C.name+=String.fromCharCode(c[D])}return C.name=decodeURIComponent(escape(C.name)),C},mdat:function(c){return{byteLength:c.byteLength,nals:function(C){for(var D,L=new DataView(C.buffer,C.byteOffset,C.byteLength),X=[],oe=0;oe+4<C.length;oe+=D)if(D=L.getUint32(oe),oe+=4,D<=0)X.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&C[oe]){case 1:X.push("slice_layer_without_partitioning_rbsp");break;case 5:X.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:X.push("sei_rbsp");break;case 7:X.push("seq_parameter_set_rbsp");break;case 8:X.push("pic_parameter_set_rbsp");break;case 9:X.push("access_unit_delimiter_rbsp");break;default:X.push("UNKNOWN NAL - "+C[oe]&31)}return X}(c)}},mdhd:function(L){var C=new DataView(L.buffer,L.byteOffset,L.byteLength),D=4,L={version:C.getUint8(0),flags:new Uint8Array(L.subarray(1,4)),language:""};return L.version===1?(L.creationTime=dn(C.getUint32(D+=4)),L.modificationTime=dn(C.getUint32(D+=8)),L.timescale=C.getUint32(D+=4),L.duration=C.getUint32(D+=8)):(L.creationTime=dn(C.getUint32(D)),L.modificationTime=dn(C.getUint32(D+=4)),L.timescale=C.getUint32(D+=4),L.duration=C.getUint32(D+=4)),C=C.getUint16(D+=4),L.language+=String.fromCharCode(96+(C>>10)),L.language+=String.fromCharCode(96+((992&C)>>5)),L.language+=String.fromCharCode(96+(31&C)),L},mdia:function(c){return{boxes:Ki(c)}},mfhd:function(c){return{version:c[0],flags:new Uint8Array(c.subarray(1,4)),sequenceNumber:c[4]<<24|c[5]<<16|c[6]<<8|c[7]}},minf:function(c){return{boxes:Ki(c)}},mp4a:function(c){var C=new DataView(c.buffer,c.byteOffset,c.byteLength),C={dataReferenceIndex:C.getUint16(6),channelcount:C.getUint16(16),samplesize:C.getUint16(18),samplerate:C.getUint16(24)+C.getUint16(26)/65536};return 28<c.byteLength&&(C.streamDescriptor=Ki(c.subarray(28))[0]),C},moof:function(c){return{boxes:Ki(c)}},moov:function(c){return{boxes:Ki(c)}},mvex:function(c){return{boxes:Ki(c)}},mvhd:function(c){var C=new DataView(c.buffer,c.byteOffset,c.byteLength),D=4,L={version:C.getUint8(0),flags:new Uint8Array(c.subarray(1,4))};return L.version===1?(L.creationTime=dn(C.getUint32(D+=4)),L.modificationTime=dn(C.getUint32(D+=8)),L.timescale=C.getUint32(D+=4),L.duration=C.getUint32(D+=8)):(L.creationTime=dn(C.getUint32(D)),L.modificationTime=dn(C.getUint32(D+=4)),L.timescale=C.getUint32(D+=4),L.duration=C.getUint32(D+=4)),L.rate=C.getUint16(D+=4)+C.getUint16(D+2)/16,L.volume=C.getUint8(D+=4)+C.getUint8(D+1)/8,D=(D+=2)+2+8,L.matrix=new Uint32Array(c.subarray(D,D+36)),L.nextTrackId=C.getUint32(D=D+36+24),L},pdin:function(c){var C=new DataView(c.buffer,c.byteOffset,c.byteLength);return{version:C.getUint8(0),flags:new Uint8Array(c.subarray(1,4)),rate:C.getUint32(4),initialDelay:C.getUint32(8)}},sdtp:function(c){for(var C={version:c[0],flags:new Uint8Array(c.subarray(1,4)),samples:[]},D=4;D<c.byteLength;D++)C.samples.push({dependsOn:(48&c[D])>>4,isDependedOn:(12&c[D])>>2,hasRedundancy:3&c[D]});return C},sidx:function(c){var C=new DataView(c.buffer,c.byteOffset,c.byteLength),D={version:c[0],flags:new Uint8Array(c.subarray(1,4)),references:[],referenceId:C.getUint32(4),timescale:C.getUint32(8)},L=12,X=(D.version===0?(D.earliestPresentationTime=C.getUint32(L),D.firstOffset=C.getUint32(L+4),L+=8):(D.earliestPresentationTime=Vh(c.subarray(L)),D.firstOffset=Vh(c.subarray(L+8)),L+=16),C.getUint16(L+=2));for(L+=2;0<X;L+=12,X--)D.references.push({referenceType:(128&c[L])>>>7,referencedSize:2147483647&C.getUint32(L),subsegmentDuration:C.getUint32(L+4),startsWithSap:!!(128&c[L+8]),sapType:(112&c[L+8])>>>4,sapDeltaTime:268435455&C.getUint32(L+8)});return D},smhd:function(c){return{version:c[0],flags:new Uint8Array(c.subarray(1,4)),balance:c[4]+c[5]/256}},stbl:function(c){return{boxes:Ki(c)}},ctts:function(c){for(var C=new DataView(c.buffer,c.byteOffset,c.byteLength),D={version:C.getUint8(0),flags:new Uint8Array(c.subarray(1,4)),compositionOffsets:[]},L=C.getUint32(4),X=8;L;X+=8,L--)D.compositionOffsets.push({sampleCount:C.getUint32(X),sampleOffset:C[D.version===0?"getUint32":"getInt32"](X+4)});return D},stss:function(c){for(var C=new DataView(c.buffer,c.byteOffset,c.byteLength),D={version:C.getUint8(0),flags:new Uint8Array(c.subarray(1,4)),syncSamples:[]},L=C.getUint32(4),X=8;L;X+=4,L--)D.syncSamples.push(C.getUint32(X));return D},stco:function(c){for(var C=new DataView(c.buffer,c.byteOffset,c.byteLength),D={version:c[0],flags:new Uint8Array(c.subarray(1,4)),chunkOffsets:[]},L=C.getUint32(4),X=8;L;X+=4,L--)D.chunkOffsets.push(C.getUint32(X));return D},stsc:function(c){for(var C=new DataView(c.buffer,c.byteOffset,c.byteLength),D=C.getUint32(4),L={version:c[0],flags:new Uint8Array(c.subarray(1,4)),sampleToChunks:[]},X=8;D;X+=12,D--)L.sampleToChunks.push({firstChunk:C.getUint32(X),samplesPerChunk:C.getUint32(X+4),sampleDescriptionIndex:C.getUint32(X+8)});return L},stsd:function(c){return{version:c[0],flags:new Uint8Array(c.subarray(1,4)),sampleDescriptions:Ki(c.subarray(8))}},stsz:function(c){for(var C=new DataView(c.buffer,c.byteOffset,c.byteLength),D={version:c[0],flags:new Uint8Array(c.subarray(1,4)),sampleSize:C.getUint32(4),entries:[]},L=12;L<c.byteLength;L+=4)D.entries.push(C.getUint32(L));return D},stts:function(c){for(var C=new DataView(c.buffer,c.byteOffset,c.byteLength),D={version:c[0],flags:new Uint8Array(c.subarray(1,4)),timeToSamples:[]},L=C.getUint32(4),X=8;L;X+=8,L--)D.timeToSamples.push({sampleCount:C.getUint32(X),sampleDelta:C.getUint32(X+4)});return D},styp:function(c){return Xn.ftyp(c)},tfdt:Ml,tfhd:Ul,tkhd:function(c){var C=new DataView(c.buffer,c.byteOffset,c.byteLength),D=4,L={version:C.getUint8(0),flags:new Uint8Array(c.subarray(1,4))};return L.version===1?(L.creationTime=dn(C.getUint32(D+=4)),L.modificationTime=dn(C.getUint32(D+=8)),L.trackId=C.getUint32(D+=4),L.duration=C.getUint32(D=D+4+8)):(L.creationTime=dn(C.getUint32(D)),L.modificationTime=dn(C.getUint32(D+=4)),L.trackId=C.getUint32(D+=4),L.duration=C.getUint32(D=D+4+4)),L.layer=C.getUint16(D=D+4+8),L.alternateGroup=C.getUint16(D+=2),L.volume=C.getUint8(D+=2)+C.getUint8(D+1)/8,D=D+2+2,L.matrix=new Uint32Array(c.subarray(D,D+36)),L.width=C.getUint16(D+=36)+C.getUint16(D+2)/65536,L.height=C.getUint16(D+=4)+C.getUint16(D+2)/65536,L},traf:function(c){return{boxes:Ki(c)}},trak:function(c){return{boxes:Ki(c)}},trex:function(c){var C=new DataView(c.buffer,c.byteOffset,c.byteLength);return{version:c[0],flags:new Uint8Array(c.subarray(1,4)),trackId:C.getUint32(4),defaultSampleDescriptionIndex:C.getUint32(8),defaultSampleDuration:C.getUint32(12),defaultSampleSize:C.getUint32(16),sampleDependsOn:3&c[20],sampleIsDependedOn:(192&c[21])>>6,sampleHasRedundancy:(48&c[21])>>4,samplePaddingValue:(14&c[21])>>1,sampleIsDifferenceSample:!!(1&c[21]),sampleDegradationPriority:C.getUint16(22)}},trun:qh,"url ":function(c){return{version:c[0],flags:new Uint8Array(c.subarray(1,4))}},vmhd:function(c){var C=new DataView(c.buffer,c.byteOffset,c.byteLength);return{version:c[0],flags:new Uint8Array(c.subarray(1,4)),graphicsmode:C.getUint16(4),opcolor:new Uint16Array([C.getUint16(6),C.getUint16(8),C.getUint16(10)])}}},Ki=function(c){for(var C,D,L,X,oe,ce=0,ge=[],Te=new ArrayBuffer(c.length),Ie=new Uint8Array(Te),Ge=0;Ge<c.length;++Ge)Ie[Ge]=c[Ge];for(C=new DataView(Te);ce<c.byteLength;)D=C.getUint32(ce),L=Fs(c.subarray(ce+4,ce+8)),X=1<D?ce+D:c.byteLength,(oe=(Xn[L]||function(it){return{data:it}})(c.subarray(ce+8,X))).size=D,oe.type=L,ge.push(oe),ce=X;return ge},Gh=function(c,C){var D;return C=C||0,D=new Array(2*C+1).join(" "),c.map(function(L,X){return D+L.type+`
`+Object.keys(L).filter(function(oe){return oe!=="type"&&oe!=="boxes"}).map(function(Te){var ce,ge=D+"  "+Te+": ",Te=L[Te];return Te instanceof Uint8Array||Te instanceof Uint32Array?(ce=Array.prototype.slice.call(new Uint8Array(Te.buffer,Te.byteOffset,Te.byteLength)).map(function(Ie){return" "+("00"+Ie.toString(16)).slice(-2)}).join("").match(/.{1,24}/g))?ce.length===1?ge+"<"+ce.join("").slice(1)+">":ge+`<
`+ce.map(function(Ie){return D+"  "+Ie}).join(`
`)+`
`+D+"  >":ge+"<>":ge+JSON.stringify(Te,null,2).split(`
`).map(function(Ie,Ge){return Ge===0?Ie:D+"  "+Ie}).join(`
`)}).join(`
`)+(L.boxes?`
`+Gh(L.boxes,C+1):"")}).join(`
`)},$r={inspect:Ki,textify:Gh,parseType:Fs,findBox:Ms,parseTraf:Xn.traf,parseTfdt:Xn.tfdt,parseHdlr:Xn.hdlr,parseTfhd:Xn.tfhd,parseTrun:Xn.trun,parseSidx:Xn.sidx},Fa=function(c){for(var C=0,D=String.fromCharCode(c[C]),L="";D!=="\0";)L+=D,C++,D=String.fromCharCode(c[C]);return L+=D},Qg=ji.getUint64,$h=function(c){return c!==void 0||c!==null},dr=typeof window<"u"?window:typeof Ci<"u"?Ci:typeof self<"u"?self:{},Gn=dr,Ba=cn,Bs=Us,xi=Ms,Kr=Ll,Fl={parseEmsgBox:function(c){var C,D,L,X,oe,ce,ge,Te=4,Ie=c[0],Ge=(Ie===0?(Te=(Te+=(X=Fa(c.subarray(Te))).length)+(oe=Fa(c.subarray(Te))).length,L=(Ge=new DataView(c.buffer)).getUint32(Te),ge=Ge.getUint32(Te+=4),C=Ge.getUint32(Te+=4),D=Ge.getUint32(Te+=4),Te+=4):Ie===1&&(L=(Ge=new DataView(c.buffer)).getUint32(Te),ce=Qg(c.subarray(Te+=4)),C=Ge.getUint32(Te+=8),D=Ge.getUint32(Te+=4),Te=(Te=(Te+=4)+(X=Fa(c.subarray(Te))).length)+(oe=Fa(c.subarray(Te))).length),{scheme_id_uri:X,value:oe,timescale:L||1,presentation_time:ce,presentation_time_delta:ge,event_duration:C,id:D,message_data:new Uint8Array(c.subarray(Te,c.byteLength))});return oe=(X=Ge).scheme_id_uri!=="\0",ce=(L=Ie)===0&&$h(X.presentation_time_delta)&&oe,ge=L===1&&$h(X.presentation_time)&&oe,!(1<L)&&ce||ge?Ge:void 0},scaleTime:function(c,C,D,L){return c||c===0?c/C:L+D/C}},Jg=Ul,ey=qh,ty=Ml,iy=ji.getUint64,Bl=Gn,ny=Ah.parseId3Frames,Kh=function(c){var C=c[0]===0?12:20;return Ba(c[C]<<24|c[1+C]<<16|c[2+C]<<8|c[3+C])},zs={findBox:xi,parseType:Kr,timescale:function(c){return xi(c,["moov","trak"]).reduce(function(C,D){var L,X,oe=xi(D,["tkhd"])[0];return oe&&(L=oe[0],oe=Ba(oe[X=L===0?12:20]<<24|oe[1+X]<<16|oe[2+X]<<8|oe[3+X]),D=xi(D,["mdia","mdhd"])[0])?(L=D[0],C[oe]=Ba(D[X=L===0?12:20]<<24|D[1+X]<<16|D[2+X]<<8|D[3+X]),C):null},{})},startTime:function(c,C){return C=xi(C,["moof","traf"]).reduce(function(D,ce){var X=xi(ce,["tfhd"])[0],X=Ba(X[4]<<24|X[5]<<16|X[6]<<8|X[7]),X=c[X]||9e4,ce=xi(ce,["tfdt"])[0],oe=new DataView(ce.buffer,ce.byteOffset,ce.byteLength),ce=ce[0]===1?iy(ce.subarray(4,12)):oe.getUint32(4);let ge;return typeof ce=="bigint"?ge=ce/Bl.BigInt(X):typeof ce!="number"||isNaN(ce)||(ge=ce/X),D=(ge=ge<Number.MAX_SAFE_INTEGER?Number(ge):ge)<D?ge:D},1/0),typeof C=="bigint"||isFinite(C)?C:0},compositionStartTime:function(c,ce){var D,L,ce=xi(ce,["moof","traf"]),X=0,oe=0,ce=(ce&&ce.length&&(L=xi(ce[0],["tfhd"])[0],ge=xi(ce[0],["trun"])[0],ce=xi(ce[0],["tfdt"])[0],L&&(D=Jg(L).trackId),ce&&(X=ty(ce).baseMediaDecodeTime),ge)&&(L=ey(ge)).samples&&L.samples.length&&(oe=L.samples[0].compositionTimeOffset||0),c[D]||9e4),ge=(typeof X=="bigint"&&(oe=Bl.BigInt(oe),ce=Bl.BigInt(ce)),(X+oe)/ce);return ge=typeof ge=="bigint"&&ge<Number.MAX_SAFE_INTEGER?Number(ge):ge},videoTrackIds:function(C){var C=xi(C,["moov","trak"]),D=[];return C.forEach(function(L){var X=xi(L,["mdia","hdlr"]),oe=xi(L,["tkhd"]);X.forEach(function(Te,Ie){var Te=Kr(Te.subarray(8,12)),Ie=oe[Ie];Te==="vide"&&(Ie=(Te=new DataView(Ie.buffer,Ie.byteOffset,Ie.byteLength)).getUint8(0)===0?Te.getUint32(12):Te.getUint32(20),D.push(Ie))})}),D},tracks:function(C){var C=xi(C,["moov","trak"]),D=[];return C.forEach(function(L){var X,oe={},ge=xi(L,["tkhd"])[0],ce=(ge&&(ce=(ge=new DataView(ge.buffer,ge.byteOffset,ge.byteLength)).getUint8(0),oe.id=ce===0?ge.getUint32(12):ge.getUint32(20)),xi(L,["mdia","hdlr"])[0]),ce=(ce&&(ge=Kr(ce.subarray(8,12)),oe.type=ge==="vide"?"video":ge==="soun"?"audio":ge),xi(L,["mdia","minf","stbl","stsd"])[0]),ge=(ce&&(ge=ce.subarray(8),oe.codec=Kr(ge.subarray(4,8)),ce=xi(ge,[oe.codec])[0])&&(/^[asm]vc[1-9]$/i.test(oe.codec)?(X=ce.subarray(78),Kr(X.subarray(4,8))==="avcC"&&11<X.length?(oe.codec+=".",oe.codec+=Bs(X[9]),oe.codec+=Bs(X[10]),oe.codec+=Bs(X[11])):oe.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(oe.codec)?(X=ce.subarray(28),Kr(X.subarray(4,8))==="esds"&&20<X.length&&X[19]!==0?(oe.codec+="."+Bs(X[19]),oe.codec+="."+Bs(X[20]>>>2&63).replace(/^0/,"")):oe.codec="mp4a.40.2"):oe.codec=oe.codec.toLowerCase()),xi(L,["mdia","mdhd"])[0]);ge&&(oe.timescale=Kh(ge)),D.push(oe)}),D},getTimescaleFromMediaHeader:Kh,getEmsgID3:function(c,C=0){return xi(c,["emsg"]).map(L=>{var L=Fl.parseEmsgBox(new Uint8Array(L)),X=ny(L.message_data);return{cueTime:Fl.scaleTime(L.presentation_time,L.timescale,L.presentation_time_delta,C),duration:Fl.scaleTime(L.event_duration,L.timescale),frames:X}})}};let ry=$r.parseTrun,Yh=zs.findBox;var Zh=Gn,An={getMdatTrafPairs:function(D){var C=Yh(D,["moof","traf"]),D=Yh(D,["mdat"]),L=[];return D.forEach(function(X,oe){oe=C[oe],L.push({mdat:X,traf:oe})}),L},parseSamples:function(c,C,D){var L=C,X=D.defaultSampleDuration||0,oe=D.defaultSampleSize||0,ce=D.trackId,ge=[];return c.forEach(function(Te){Te=ry(Te).samples,Te.forEach(function(Ie){Ie.duration===void 0&&(Ie.duration=X),Ie.size===void 0&&(Ie.size=oe),Ie.trackId=ce,Ie.dts=L,Ie.compositionTimeOffset===void 0&&(Ie.compositionTimeOffset=0),typeof L=="bigint"?(Ie.pts=L+Zh.BigInt(Ie.compositionTimeOffset),L+=Zh.BigInt(Ie.duration)):(Ie.pts=L+Ie.compositionTimeOffset,L+=Ie.duration)}),ge=ge.concat(Te)}),ge}},sy=ka.discardEmulationPreventionBytes,ay=Xr.CaptionStream,zl=Ms,oy=Ml,ly=Ul,{getMdatTrafPairs:uy,parseSamples:dy}=An,cy=function(c,C){for(var D=c,L=0;L<C.length;L++){var X=C[L];if(D<X.size)return X;D-=X.size}return null},hy=function(c,C,D){for(var L,X,oe=new DataView(c.buffer,c.byteOffset,c.byteLength),ce={logs:[],seiNals:[]},ge=0;ge+4<c.length;ge+=L)if(L=oe.getUint32(ge),ge+=4,!(L<=0))switch(31&c[ge]){case 6:var Ie=c.subarray(ge+1,ge+1+L),Te=cy(ge,C),Ie={nalUnitType:"sei_rbsp",size:L,data:Ie,escapedRBSP:sy(Ie),trackId:D};if(Te)Ie.pts=Te.pts,Ie.dts=Te.dts,X=Te;else{if(!X){ce.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+ge+" for trackId "+D+". See mux.js#223."});break}Ie.pts=X.pts,Ie.dts=X.dts}ce.seiNals.push(Ie)}return ce},py=function(c,C){var D={};return uy(c).forEach(function(Te){var X=Te.mdat,Te=Te.traf,oe=zl(Te,["tfhd"]),oe=ly(oe[0]),ce=oe.trackId,ge=zl(Te,["tfdt"]),ge=0<ge.length?oy(ge[0]).baseMediaDecodeTime:0,Te=zl(Te,["trun"]);C===ce&&0<Te.length&&(Te=dy(Te,ge,oe),ge=hy(X,Te,ce),D[ce]||(D[ce]={seiNals:[],logs:[]}),D[ce].seiNals=D[ce].seiNals.concat(ge.seiNals),D[ce].logs=D[ce].logs.concat(ge.logs))}),D},fy=function(){var c,C,D,L,X,oe,ce=!1;this.isInitialized=function(){return ce},this.init=function(ge){c=new ay,ce=!0,oe=!!ge&&ge.isPartial,c.on("data",function(Te){Te.startTime=Te.startPts/L,Te.endTime=Te.endPts/L,X.captions.push(Te),X.captionStreams[Te.stream]=!0}),c.on("log",function(Te){X.logs.push(Te)})},this.isNewInit=function(ge,Te){return!(ge&&ge.length===0||Te&&typeof Te=="object"&&Object.keys(Te).length===0||D===ge[0]&&L===Te[D])},this.parse=function(ge,Te,Ie){var Ge,it;if(!this.isInitialized()||!Te||!Ie)return null;if(this.isNewInit(Te,Ie))D=Te[0],L=Ie[D];else if(D===null||!L)return C.push(ge),null;for(;0<C.length;){var Tt=C.shift();this.parse(Tt,Te,Ie)}return ge=ge,it=L,(Ge=(Ge=D)===null?null:{seiNals:(ge=py(ge,Ge)[Ge]||{}).seiNals,logs:ge.logs,timescale:it})&&Ge.logs&&(X.logs=X.logs.concat(Ge.logs)),Ge!==null&&Ge.seiNals?(this.pushNals(Ge.seiNals),this.flushStream(),X):X.logs.length?{logs:X.logs,captions:[],captionStreams:[]}:null},this.pushNals=function(ge){if(!this.isInitialized()||!ge||ge.length===0)return null;ge.forEach(function(Te){c.push(Te)})},this.flushStream=function(){if(!this.isInitialized())return null;oe?c.partialFlush():c.flush()},this.clearParsedCaptions=function(){X.captions=[],X.captionStreams={},X.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;c.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){C=[],L=D=null,X?this.clearParsedCaptions():X={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()};let my=$r.parseTfdt,$n=Ms,gy=zs.getTimescaleFromMediaHeader,{parseSamples:yy,getMdatTrafPairs:vy}=An;function Qh(c){var C=31&c[1];return C<<8|c[2]}function za(c){return!!(64&c[1])}function ja(c){var C=0;return 1<(48&c[3])>>>4&&(C+=c[4]+1),C}function jl(c){switch(c){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}}var Jh=function(){let c=9e4;this.init=function(C){C=$n(C,["moov","trak","mdia","mdhd"])[0],C&&(c=gy(C))},this.parseSegment=function(C){let D=[];C=vy(C);let L=0;return C.forEach(function(Te){let oe=Te.mdat;var Te=Te.traf,ce=$n(Te,["tfdt"])[0],ge=$n(Te,["tfhd"])[0],Te=$n(Te,["trun"]);if(ce&&(ce=my(ce),L=ce.baseMediaDecodeTime),Te.length&&ge){ce=yy(Te,L,ge);let Ie=0;ce.forEach(function(Ge){let it=new TextDecoder("utf-8");var Tt=oe.slice(Ie,Ie+Ge.size);$n(Tt,["vtte"])[0]||$n(Tt,["vttc"]).forEach(function(Di){var Dt=$n(Di,["payl"])[0],Di=$n(Di,["sttg"])[0],Fn=Ge.pts/c,Kn=(Ge.pts+Ge.duration)/c;let Zr,gi;if(Dt)try{Zr=it.decode(Dt)}catch{}if(Di)try{gi=it.decode(Di)}catch{}Ge.duration&&Zr&&D.push({cueText:Zr,start:Fn,end:Kn,settings:gi})}),Ie+=Ge.size})}}),D}},Hl=Ia,ep=Ia,Yr=Mg,ni={},cr=(ni.ts={parseType:function(c,C){return c=Qh(c),c===0?"pat":c===C?"pmt":C?"pes":null},parsePat:function(c){var C=za(c),D=4+ja(c);return C&&(D+=c[D]+1),(31&c[D+10])<<8|c[D+11]},parsePmt:function(c){var C={},D=za(c),L=4+ja(c);if(D&&(L+=c[L]+1),1&c[L+5]){for(var X=3+((15&c[L+1])<<8|c[L+2])-4,oe=12+((15&c[L+10])<<8|c[L+11]);oe<X;){var ce=L+oe;C[(31&c[ce+1])<<8|c[ce+2]]=c[ce],oe+=5+((15&c[ce+3])<<8|c[ce+4])}return C}},parsePayloadUnitStartIndicator:za,parsePesType:function(c,C){switch(C[Qh(c)]){case Hl.H264_STREAM_TYPE:return"video";case Hl.ADTS_STREAM_TYPE:return"audio";case Hl.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(c){var C,D,L;return!za(c)||(C=4+ja(c))>=c.byteLength?null:(D=null,192&(L=c[C+7])&&((D={}).pts=(14&c[C+9])<<27|(255&c[C+10])<<20|(254&c[C+11])<<12|(255&c[C+12])<<5|(254&c[C+13])>>>3,D.pts*=4,D.pts+=(6&c[C+13])>>>1,D.dts=D.pts,64&L)&&(D.dts=(14&c[C+14])<<27|(255&c[C+15])<<20|(254&c[C+16])<<12|(255&c[C+17])<<5|(254&c[C+18])>>>3,D.dts*=4,D.dts+=(6&c[C+18])>>>1),D)},videoPacketContainsKeyFrame:function(c){for(var C=4+ja(c),D=c.subarray(C),L=0,X=0,oe=!1;X<D.byteLength-3;X++)if(D[X+2]===1){L=X+5;break}for(;L<D.byteLength;)switch(D[L]){case 0:if(D[L-1]!==0)L+=2;else if(D[L-2]!==0)L++;else{for(X+3!==L-2&&jl(31&D[X+3])==="slice_layer_without_partitioning_rbsp_idr"&&(oe=!0);D[++L]!==1&&L<D.length;);X=L-2,L+=3}break;case 1:D[L-1]!==0||D[L-2]!==0||(jl(31&D[X+3])==="slice_layer_without_partitioning_rbsp_idr"&&(oe=!0),X=L-2),L+=3;break;default:L+=3}return D=D.subarray(X),L-=X,X=0,oe=D&&3<D.byteLength&&jl(31&D[X+3])==="slice_layer_without_partitioning_rbsp_idr"?!0:oe}},ni.aac=Nn,di.ONE_SECOND_IN_TS),Yi=188,In=71,by=function(c,C){for(var D,L=0,X=Yi;X<c.byteLength;)if(c[L]===In&&c[X]===In){switch(D=c.subarray(L,X),ni.ts.parseType(D,C.pid)){case"pat":C.pid=ni.ts.parsePat(D);break;case"pmt":var oe=ni.ts.parsePmt(D);C.table=C.table||{},Object.keys(oe).forEach(function(ce){C.table[ce]=oe[ce]})}L+=Yi,X+=Yi}else L++,X++},_y=function(c,C,D){for(var L,X,oe,ce,ge=0,Te=Yi,Ie=!1;Te<=c.byteLength;)if(c[ge]!==In||c[Te]!==In&&Te!==c.byteLength)ge++,Te++;else{if(L=c.subarray(ge,Te),ni.ts.parseType(L,C.pid)==="pes"&&(X=ni.ts.parsePesType(L,C.table),oe=ni.ts.parsePayloadUnitStartIndicator(L),X==="audio")&&oe&&(ce=ni.ts.parsePesTime(L))&&(ce.type="audio",D.audio.push(ce),Ie=!0),Ie)break;ge+=Yi,Te+=Yi}for(ge=(Te=c.byteLength)-Yi,Ie=!1;0<=ge;)if(c[ge]!==In||c[Te]!==In&&Te!==c.byteLength)ge--,Te--;else{if(L=c.subarray(ge,Te),ni.ts.parseType(L,C.pid)==="pes"&&(X=ni.ts.parsePesType(L,C.table),oe=ni.ts.parsePayloadUnitStartIndicator(L),X==="audio")&&oe&&(ce=ni.ts.parsePesTime(L))&&(ce.type="audio",D.audio.push(ce),Ie=!0),Ie)break;ge-=Yi,Te-=Yi}},Ty=function(c,C,D){for(var L,X,oe,ce,ge,Te,Ie,Ge,it=0,Tt=Yi,Nt=!1,Dt={data:[],size:0};Tt<c.byteLength;)if(c[it]===In&&c[Tt]===In){if(L=c.subarray(it,Tt),ni.ts.parseType(L,C.pid)==="pes"&&(X=ni.ts.parsePesType(L,C.table),oe=ni.ts.parsePayloadUnitStartIndicator(L),X==="video"&&(oe&&!Nt&&(ce=ni.ts.parsePesTime(L))&&(ce.type="video",D.video.push(ce),Nt=!0),!D.firstKeyFrame))){if(oe&&Dt.size!==0){for(ge=new Uint8Array(Dt.size),Te=0;Dt.data.length;)Ie=Dt.data.shift(),ge.set(Ie,Te),Te+=Ie.byteLength;ni.ts.videoPacketContainsKeyFrame(ge)&&(Ge=ni.ts.parsePesTime(ge))&&(D.firstKeyFrame=Ge,D.firstKeyFrame.type="video"),Dt.size=0}Dt.data.push(L),Dt.size+=L.byteLength}if(Nt&&D.firstKeyFrame)break;it+=Yi,Tt+=Yi}else it++,Tt++;for(it=(Tt=c.byteLength)-Yi,Nt=!1;0<=it;)if(c[it]===In&&c[Tt]===In){if(L=c.subarray(it,Tt),ni.ts.parseType(L,C.pid)==="pes"&&(X=ni.ts.parsePesType(L,C.table),oe=ni.ts.parsePayloadUnitStartIndicator(L),X==="video")&&oe&&(ce=ni.ts.parsePesTime(L))&&(ce.type="video",D.video.push(ce),Nt=!0),Nt)break;it-=Yi,Tt-=Yi}else it--,Tt--},Sy=function(oe,C){var D,L,X,oe=(ni.aac.isLikelyAacData(oe)?function(ce){for(var ge,Te,Ie=!1,Ge=0,it=null,Tt=null,Nt=0,Dt=0;3<=ce.length-Dt;){switch(ni.aac.parseType(ce,Dt)){case"timed-metadata":ce.length-Dt<10||(Nt=ni.aac.parseId3TagSize(ce,Dt))>ce.length?Ie=!0:(Tt===null&&(ge=ce.subarray(Dt,Dt+Nt),Tt=ni.aac.parseAacTimestamp(ge)),Dt+=Nt);break;case"audio":ce.length-Dt<7||(Nt=ni.aac.parseAdtsSize(ce,Dt))>ce.length?Ie=!0:(it===null&&(ge=ce.subarray(Dt,Dt+Nt),it=ni.aac.parseSampleRate(ge)),Ge++,Dt+=Nt);break;default:Dt++}if(Ie)return null}return it===null||Tt===null?null:{audio:[{type:"audio",dts:Tt,pts:Tt},{type:"audio",dts:Tt+1024*Ge*(Te=cr/it),pts:Tt+1024*Ge*Te}]}}:function(ce){var ge,Te={pid:null,table:null},Ie={};for(ge in by(ce,Te),Te.table)if(Te.table.hasOwnProperty(ge))switch(Te.table[ge]){case ep.H264_STREAM_TYPE:Ie.video=[],Ty(ce,Te,Ie),Ie.video.length===0&&delete Ie.video;break;case ep.ADTS_STREAM_TYPE:Ie.audio=[],_y(ce,Te,Ie),Ie.audio.length===0&&delete Ie.audio}return Ie})(oe);return oe&&(oe.audio||oe.video)?(C=C,(D=oe).audio&&D.audio.length&&(typeof(L=C)<"u"&&!isNaN(L)||(L=D.audio[0].dts),D.audio.forEach(function(ce){ce.dts=Yr(ce.dts,L),ce.pts=Yr(ce.pts,L),ce.dtsTime=ce.dts/cr,ce.ptsTime=ce.pts/cr})),D.video&&D.video.length&&(typeof(X=C)<"u"&&!isNaN(X)||(X=D.video[0].dts),D.video.forEach(function(ce){ce.dts=Yr(ce.dts,X),ce.pts=Yr(ce.pts,X),ce.dtsTime=ce.dts/cr,ce.ptsTime=ce.pts/cr}),D.firstKeyFrame)&&((C=D.firstKeyFrame).dts=Yr(C.dts,X),C.pts=Yr(C.pts,X),C.dtsTime=C.dts/cr,C.ptsTime=C.pts/cr),oe):null};class tp{constructor(C,D){this.options=D||{},this.self=C,this.init()}init(){var C,D;this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new Gg(this.options),C=this.self,(D=this.transmuxer).on("data",function(L){var X=L.initSegment,X=(L.initSegment={data:X.buffer,byteOffset:X.byteOffset,byteLength:X.byteLength},L.data);L.data=X.buffer,C.postMessage({action:"data",segment:L,byteOffset:X.byteOffset,byteLength:X.byteLength},[L.data])}),D.on("done",function(L){C.postMessage({action:"done"})}),D.on("gopInfo",function(L){C.postMessage({action:"gopInfo",gopInfo:L})}),D.on("videoSegmentTimingInfo",function(L){var X={start:{decode:di.videoTsToSeconds(L.start.dts),presentation:di.videoTsToSeconds(L.start.pts)},end:{decode:di.videoTsToSeconds(L.end.dts),presentation:di.videoTsToSeconds(L.end.pts)},baseMediaDecodeTime:di.videoTsToSeconds(L.baseMediaDecodeTime)};L.prependedContentDuration&&(X.prependedContentDuration=di.videoTsToSeconds(L.prependedContentDuration)),C.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:X})}),D.on("audioSegmentTimingInfo",function(L){var X={start:{decode:di.videoTsToSeconds(L.start.dts),presentation:di.videoTsToSeconds(L.start.pts)},end:{decode:di.videoTsToSeconds(L.end.dts),presentation:di.videoTsToSeconds(L.end.pts)},baseMediaDecodeTime:di.videoTsToSeconds(L.baseMediaDecodeTime)};L.prependedContentDuration&&(X.prependedContentDuration=di.videoTsToSeconds(L.prependedContentDuration)),C.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:X})}),D.on("id3Frame",function(L){C.postMessage({action:"id3Frame",id3Frame:L})}),D.on("caption",function(L){C.postMessage({action:"caption",caption:L})}),D.on("trackinfo",function(L){C.postMessage({action:"trackinfo",trackInfo:L})}),D.on("audioTimingInfo",function(L){C.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:di.videoTsToSeconds(L.start),end:di.videoTsToSeconds(L.end)}})}),D.on("videoTimingInfo",function(L){C.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:di.videoTsToSeconds(L.start),end:di.videoTsToSeconds(L.end)}})}),D.on("log",function(L){C.postMessage({action:"log",log:L})})}pushMp4Captions(L){this.captionParser||(this.captionParser=new fy,this.captionParser.init());var D=new Uint8Array(L.data,L.byteOffset,L.byteLength),L=this.captionParser.parse(D,L.trackIds,L.timescales);this.self.postMessage({action:"mp4Captions",captions:L&&L.captions||[],logs:L&&L.logs||[],data:D.buffer},[D.buffer])}initMp4WebVttParser(C){this.webVttParser||(this.webVttParser=new Jh),C=new Uint8Array(C.data,C.byteOffset,C.byteLength),this.webVttParser.init(C)}getMp4WebVttText(D){this.webVttParser||(this.webVttParser=new Jh);var D=new Uint8Array(D.data,D.byteOffset,D.byteLength),L=this.webVttParser.parseSegment(D);this.self.postMessage({action:"getMp4WebVttText",mp4VttCues:L||[],data:D.buffer},[D.buffer])}probeMp4StartTime({timescales:C,data:D}){C=zs.startTime(C,D),this.self.postMessage({action:"probeMp4StartTime",startTime:C,data:D},[D.buffer])}probeMp4Tracks({data:C}){var D=zs.tracks(C);this.self.postMessage({action:"probeMp4Tracks",tracks:D,data:C},[C.buffer])}probeEmsgID3({data:C,offset:D}){D=zs.getEmsgID3(C,D),this.self.postMessage({action:"probeEmsgID3",id3Frames:D,emsgData:C},[C.buffer])}probeTs({data:C,baseStartTime:D}){D=typeof D!="number"||isNaN(D)?void 0:D*di.ONE_SECOND_IN_TS,D=Sy(C,D);let L=null;D&&((L={hasVideo:D.video&&D.video.length===2||!1,hasAudio:D.audio&&D.audio.length===2||!1}).hasVideo&&(L.videoStart=D.video[0].ptsTime),L.hasAudio)&&(L.audioStart=D.audio[0].ptsTime),this.self.postMessage({action:"probeTs",result:L,data:C},[C.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(C){C=new Uint8Array(C.data,C.byteOffset,C.byteLength),this.transmuxer.push(C)}reset(){this.transmuxer.reset()}setTimestampOffset(C){C=C.timestampOffset||0,this.transmuxer.setBaseMediaDecodeTime(Math.round(di.secondsToVideoTs(C)))}setAudioAppendStart(C){this.transmuxer.setAudioAppendStart(Math.ceil(di.secondsToVideoTs(C.appendStart)))}setRemux(C){this.transmuxer.setRemux(C.remux)}flush(C){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(C){this.transmuxer.alignGopsWith(C.gopsToAlignWith.slice())}}self.onmessage=function(c){c.data.action==="init"&&c.data.options?this.messageHandlers=new tp(self,c.data.options):(this.messageHandlers||(this.messageHandlers=new tp(self)),c.data&&c.data.action&&c.data.action!=="init"&&this.messageHandlers[c.data.action]&&this.messageHandlers[c.data.action](c.data))}})));let Gm=(s,G,i)=>{var{type:a,initSegment:o,captions:H,captionStreams:l,metadata:h,videoFrameDtsTime:T,videoFramePtsTime:B}=s.data.segment,G=(G.buffer.push({captions:H,captionStreams:l,metadata:h}),s.data.segment.boxes||{data:s.data.segment.data}),H={type:a,data:new Uint8Array(G.data,G.data.byteOffset,G.data.byteLength),initSegment:new Uint8Array(o.data,o.byteOffset,o.byteLength)};typeof T<"u"&&(H.videoFrameDtsTime=T),typeof B<"u"&&(H.videoFramePtsTime=B),i(H)},$m=({transmuxedData:s,callback:t})=>{s.buffer=[],t(s)},Km=(s,t)=>{t.gopInfo=s.data.gopInfo},Uc=s=>{let{transmuxer:t,bytes:i,audioAppendStart:a,gopsToAlignWith:o,remux:l,onData:h,onTrackInfo:T,onAudioTimingInfo:B,onVideoTimingInfo:G,onVideoSegmentTimingInfo:H,onAudioSegmentTimingInfo:se,onId3:pe,onCaptions:ae,onDone:_e,onEndedTimeline:Ce,onTransmuxerLog:Le,isEndOfTimeline:xe,segment:Pe,triggerSegmentEventFn:Ae}=s,st={buffer:[]},Ue=xe;var ft,Et;t.onmessage=dt=>{t.currentTransmux!==s||(dt.data.action==="data"&&Gm(dt,st,h),dt.data.action==="trackinfo"&&T(dt.data.trackInfo),dt.data.action==="gopInfo"&&Km(dt,st),dt.data.action==="audioTimingInfo"&&B(dt.data.audioTimingInfo),dt.data.action==="videoTimingInfo"&&G(dt.data.videoTimingInfo),dt.data.action==="videoSegmentTimingInfo"&&H(dt.data.videoSegmentTimingInfo),dt.data.action==="audioSegmentTimingInfo"&&se(dt.data.audioSegmentTimingInfo),dt.data.action==="id3Frame"&&pe([dt.data.id3Frame],dt.data.id3Frame.dispatchType),dt.data.action==="caption"&&ae(dt.data.caption),dt.data.action==="endedtimeline"&&(Ue=!1,Ce()),dt.data.action==="log"&&Le(dt.data.log),dt.data.type!=="transmuxed")||Ue||(t.onmessage=null,$m({transmuxedData:st,callback:_e}),Fc(t))},t.onerror=()=>{var dt={message:"Received an error message from the transmuxer worker",metadata:{errorType:He.Error.StreamingFailedToTransmuxSegment,segmentInfo:lr({segment:Pe})}};_e(null,dt)},a&&t.postMessage({action:"setAudioAppendStart",appendStart:a}),Array.isArray(o)&&t.postMessage({action:"alignGopsWith",gopsToAlignWith:o}),typeof l<"u"&&t.postMessage({action:"setRemux",remux:l}),i.byteLength&&(ft=i instanceof ArrayBuffer?i:i.buffer,Et=i instanceof ArrayBuffer?0:i.byteOffset,Ae({type:"segmenttransmuxingstart",segment:Pe}),t.postMessage({action:"push",data:ft,byteOffset:Et,byteLength:i.byteLength},[ft])),xe&&t.postMessage({action:"endTimeline"}),t.postMessage({action:"flush"})},Fc=s=>{s.currentTransmux=null,s.transmuxQueue.length&&(s.currentTransmux=s.transmuxQueue.shift(),typeof s.currentTransmux=="function"?s.currentTransmux():Uc(s.currentTransmux))},Bc=(s,t)=>{s.postMessage({action:t}),Fc(s)},Ym=(s,t)=>{t.currentTransmux?t.transmuxQueue.push(Bc.bind(null,t,s)):(t.currentTransmux=s,Bc(t,s))},zc=s=>{s.transmuxer.currentTransmux?s.transmuxer.transmuxQueue.push(s):(s.transmuxer.currentTransmux=s,Uc(s))};var jc=s=>{Ym("reset",s)},Zm=s=>{let t=new Xm,i=(t.currentTransmux=null,t.transmuxQueue=[],t.terminate);return t.terminate=()=>(t.currentTransmux=null,t.transmuxQueue.length=0,i.call(t)),t.postMessage({action:"init",options:s}),t};function Hc(s){let t=0;return s.audio&&t++,s.video&&t++,t}function xs(s,t){var i=t.attributes||{},a=wa(function(o){if(o=o.attributes||{},o.CODECS)return Tn(o.CODECS)}(t)||[]);return!$c(s,t)||a.audio||((o,T)=>{if(!$c(o,T))return!0;var h,T=T.attributes||{},B=o.mediaGroups.AUDIO[T.AUDIO];for(h in B)if(!B[h].uri&&!B[h].playlists)return!0;return!1})(s,t)||(t=wa(function(o,l){if(o.mediaGroups.AUDIO&&l){var h=o.mediaGroups.AUDIO[l];if(h){for(var T in h)if(T=h[T],T.default&&T.playlists)return Tn(T.playlists[0].attributes.CODECS)}}return null}(s,i.AUDIO)||[])).audio&&(a.audio=t.audio),a}function Sa(s,t){return(s=s&&window.getComputedStyle(s))?s[t]:""}function ml(s,t){let i,a;return i=(i=s.attributes.BANDWIDTH?s.attributes.BANDWIDTH:i)||window.Number.MAX_VALUE,a=(a=t.attributes.BANDWIDTH?t.attributes.BANDWIDTH:a)||window.Number.MAX_VALUE,i-a}let zr=function(s){let t=s.transmuxer,i=s.endAction||s.action,a=s.callback;var o,l=Ii({},s,{endAction:null,transmuxer:null,callback:null});let h=T=>{T.data.action===i&&(t.removeEventListener("message",h),T.data.data&&(T.data.data=new Uint8Array(T.data.data,s.byteOffset||0,s.byteLength||T.data.data.byteLength),s.data)&&(s.data=T.data.data),a(T.data))};t.addEventListener("message",h),s.data?(o=s.data instanceof ArrayBuffer,l.byteOffset=o?0:s.data.byteOffset,l.byteLength=s.data.byteLength,o=[o?s.data:s.data.buffer],t.postMessage(l,o)):t.postMessage(l)},xn={FAILURE:2,TIMEOUT:-101,ABORTED:-102},qc="wvtt",gl=s=>{s.forEach(t=>{t.abort()})},Qm=s=>({bandwidth:s.bandwidth,bytesReceived:s.bytesReceived||0,roundTripTime:s.roundTripTime||0}),Jm=s=>{var t=s.target,t={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-t.requestTime||0};return t.bytesReceived=s.loaded,t.bandwidth=Math.floor(t.bytesReceived/t.roundTripTime*8*1e3),t},yl=(s,t)=>{var i=t.requestType,i=or({requestType:i,request:t,error:s});return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:xn.TIMEOUT,xhr:t,metadata:i}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:xn.ABORTED,xhr:t,metadata:i}:s?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:xn.FAILURE,xhr:t,metadata:i}:t.responseType==="arraybuffer"&&t.response.byteLength===0?{status:t.status,message:"Empty HLS response at URL: "+t.uri,code:xn.FAILURE,xhr:t,metadata:i}:null},Vc=(s,t,i,a)=>(T,l)=>{var h=l.response,T=yl(T,l);if(T)return i(T,s);if(h.byteLength!==16)return i({status:l.status,message:"Invalid HLS key at URL: "+l.uri,code:xn.FAILURE,xhr:l},s);var T=new DataView(h),B=new Uint32Array([T.getUint32(0),T.getUint32(4),T.getUint32(8),T.getUint32(12)]);for(let G=0;G<t.length;G++)t[G].bytes=B;return h={uri:l.uri},a({type:"segmentkeyloadcomplete",segment:s,keyInfo:h}),i(null,s)},eg=(s,t)=>{t===qc&&s.transmuxer.postMessage({action:"initMp4WebVttParser",data:s.map.bytes})},tg=(s,t,i)=>{t===qc&&zr({action:"getMp4WebVttText",data:s.bytes,transmuxer:s.transmuxer,callback:({data:a,mp4VttCues:o})=>{s.bytes=a,i(null,s,{mp4VttCues:o})}})},Wc=(s,t)=>{var i,a=il(s.map.bytes);if(a!=="mp4")return i=s.map.resolvedUri||s.map.uri,t({internal:!0,message:`Found unsupported ${a=a||"unknown"} container for initialization segment at URL: `+i,code:xn.FAILURE,metadata:{mediaType:a}});zr({action:"probeMp4Tracks",data:s.map.bytes,transmuxer:s.transmuxer,callback:({tracks:o,data:l})=>(s.map.bytes=l,o.forEach(function(h){s.map.tracks=s.map.tracks||{},s.map.tracks[h.type]||(typeof(s.map.tracks[h.type]=h).id=="number"&&h.timescale&&(s.map.timescales=s.map.timescales||{},s.map.timescales[h.id]=h.timescale),h.type==="text"&&eg(s,h.codec))}),t(null))})},ig=({segment:s,bytes:t,trackInfoFn:i,timingInfoFn:a,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:l,id3Fn:h,captionsFn:T,isEndOfTimeline:B,endedTimelineFn:G,dataFn:H,doneFn:se,onTransmuxerLog:pe,triggerSegmentEventFn:ae})=>{var _e=s.map&&s.map.tracks||{};let Ce=!!(_e.audio&&_e.video),Le=a.bind(null,s,"audio","start"),xe=a.bind(null,s,"audio","end"),Pe=a.bind(null,s,"video","start"),Ae=a.bind(null,s,"video","end");zr({action:"probeTs",transmuxer:s.transmuxer,data:t,baseStartTime:s.baseStartTime,callback:st=>{s.bytes=t=st.data,st=st.result,st&&(i(s,{hasAudio:st.hasAudio,hasVideo:st.hasVideo,isMuxed:Ce}),i=null),zc({bytes:t,transmuxer:s.transmuxer,audioAppendStart:s.audioAppendStart,gopsToAlignWith:s.gopsToAlignWith,remux:Ce,onData:Ue=>{Ue.type=Ue.type==="combined"?"video":Ue.type,H(s,Ue)},onTrackInfo:Ue=>{i&&(Ce&&(Ue.isMuxed=!0),i(s,Ue))},onAudioTimingInfo:Ue=>{Le&&typeof Ue.start<"u"&&(Le(Ue.start),Le=null),xe&&typeof Ue.end<"u"&&xe(Ue.end)},onVideoTimingInfo:Ue=>{Pe&&typeof Ue.start<"u"&&(Pe(Ue.start),Pe=null),Ae&&typeof Ue.end<"u"&&Ae(Ue.end)},onVideoSegmentTimingInfo:Ue=>{var ft={pts:{start:Ue.start.presentation,end:Ue.end.presentation},dts:{start:Ue.start.decode,end:Ue.end.decode}};ae({type:"segmenttransmuxingtiminginfoavailable",segment:s,timingInfo:ft}),o(Ue)},onAudioSegmentTimingInfo:Ue=>{var ft={pts:{start:Ue.start.pts,end:Ue.end.pts},dts:{start:Ue.start.dts,end:Ue.end.dts}};ae({type:"segmenttransmuxingtiminginfoavailable",segment:s,timingInfo:ft}),l(Ue)},onId3:(Ue,ft)=>{h(s,Ue,ft)},onCaptions:Ue=>{T(s,[Ue])},isEndOfTimeline:B,onEndedTimeline:()=>{G()},onTransmuxerLog:pe,onDone:(Ue,ft)=>{se&&(Ue.type=Ue.type==="combined"?"video":Ue.type,ae({type:"segmenttransmuxingcomplete",segment:s}),se(ft,s,Ue))},segment:s,triggerSegmentEventFn:ae})}})},Xc=({segment:s,bytes:t,trackInfoFn:i,timingInfoFn:a,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:l,id3Fn:h,captionsFn:T,isEndOfTimeline:B,endedTimelineFn:G,dataFn:H,doneFn:se,onTransmuxerLog:pe,triggerSegmentEventFn:ae})=>{let _e=new Uint8Array(t);if(Om(_e)){s.isFmp4=!0;let Ce=s.map.tracks;if(Ce.text&&(!Ce.audio||!Ce.video))return H(s,{data:_e,type:"text"}),void tg(s,Ce.text.codec,se);let Le={isFmp4:!0,hasVideo:!!Ce.video,hasAudio:!!Ce.audio},xe=(Ce.audio&&Ce.audio.codec&&Ce.audio.codec!=="enca"&&(Le.audioCodec=Ce.audio.codec),Ce.video&&Ce.video.codec&&Ce.video.codec!=="encv"&&(Le.videoCodec=Ce.video.codec),Ce.video&&Ce.audio&&(Le.isMuxed=!0),i(s,Le),(Pe,Ae)=>{H(s,{data:_e,type:Le.hasAudio&&!Le.isMuxed?"audio":"video"}),Ae&&Ae.length&&h(s,Ae),Pe&&Pe.length&&T(s,Pe),se(null,s,{})});zr({action:"probeMp4StartTime",timescales:s.map.timescales,data:_e,transmuxer:s.transmuxer,callback:({data:Pe,startTime:Ae})=>{t=Pe.buffer,s.bytes=_e=Pe,Le.hasAudio&&!Le.isMuxed&&a(s,"audio","start",Ae),Le.hasVideo&&a(s,"video","start",Ae),zr({action:"probeEmsgID3",data:_e,transmuxer:s.transmuxer,offset:Ae,callback:({emsgData:st,id3Frames:Ue})=>{t=st.buffer,s.bytes=_e=st,Ce.video&&st.byteLength&&s.transmuxer?zr({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:s.transmuxer,data:_e,timescales:s.map.timescales,trackIds:[Ce.video.id],callback:ft=>{t=ft.data.buffer,s.bytes=_e=ft.data,ft.logs.forEach(function(Et){pe(Qt(Et,{stream:"mp4CaptionParser"}))}),xe(ft.captions,Ue)}}):xe(void 0,Ue)}})}})}else s.transmuxer?(typeof s.container>"u"&&(s.container=il(_e)),s.container!=="ts"&&s.container!=="aac"?(i(s,{hasAudio:!1,hasVideo:!1}),se(null,s,{})):ig({segment:s,bytes:t,trackInfoFn:i,timingInfoFn:a,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:l,id3Fn:h,captionsFn:T,isEndOfTimeline:B,endedTimelineFn:G,dataFn:H,doneFn:se,onTransmuxerLog:pe,triggerSegmentEventFn:ae})):se(null,s,{})},Gc=function({id:s,key:t,encryptedBytes:i,decryptionWorker:a,segment:o,doneFn:l},h){let T=G=>{G.data.source===s&&(a.removeEventListener("message",T),G=G.data.decrypted,h(new Uint8Array(G.bytes,G.byteOffset,G.byteLength)))};a.onerror=()=>{var H="An error occurred in the decryption worker",G=lr({segment:o}),H={message:H,metadata:{error:new Error(H),errorType:He.Error.StreamingFailedToDecryptSegment,segmentInfo:G,keyInfo:{uri:o.key.resolvedUri||o.map.key.resolvedUri}}};l(H,o)},a.addEventListener("message",T);let B;B=t.bytes.slice?t.bytes.slice():new Uint32Array(Array.prototype.slice.call(t.bytes)),a.postMessage(kc({source:s,encrypted:i,key:B,iv:t.iv}),[i.buffer,B.buffer])},ng=({decryptionWorker:s,segment:t,trackInfoFn:i,timingInfoFn:a,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:l,id3Fn:h,captionsFn:T,isEndOfTimeline:B,endedTimelineFn:G,dataFn:H,doneFn:se,onTransmuxerLog:pe,triggerSegmentEventFn:ae})=>{ae({type:"segmentdecryptionstart"}),Gc({id:t.requestId,key:t.key,encryptedBytes:t.encryptedBytes,decryptionWorker:s,segment:t,doneFn:se},_e=>{t.bytes=_e,ae({type:"segmentdecryptioncomplete",segment:t}),Xc({segment:t,bytes:t.bytes,trackInfoFn:i,timingInfoFn:a,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:l,id3Fn:h,captionsFn:T,isEndOfTimeline:B,endedTimelineFn:G,dataFn:H,doneFn:se,onTransmuxerLog:pe,triggerSegmentEventFn:ae})})},rg=({xhr:s,xhrOptions:t,decryptionWorker:jt,segment:a,abortFn:o,progressFn:l,trackInfoFn:Zt,timingInfoFn:Ti,videoSegmentTimingInfoFn:B,audioSegmentTimingInfoFn:G,id3Fn:H,captionsFn:se,isEndOfTimeline:pe,endedTimelineFn:ae,dataFn:_e,doneFn:Ce,onTransmuxerLog:xt,triggerSegmentEventFn:xe})=>{let Pe=[];var Ae,st,Ue,ft,Et,dt,Ot,Ct,Lt,jt=(({activeXhrs:si,decryptionWorker:lt,trackInfoFn:ht,timingInfoFn:Ft,videoSegmentTimingInfoFn:Xt,audioSegmentTimingInfoFn:Ci,id3Fn:Jt,captionsFn:ji,isEndOfTimeline:fi,endedTimelineFn:Wt,dataFn:Gt,doneFn:Mt,onTransmuxerLog:Ht,triggerSegmentEventFn:sn})=>{let an=0,Mn=!1;return(ur,li)=>{if(!Mn){if(ur)return Mn=!0,gl(si),Mt(ur,li);if((an+=1)===si.length){let Vr=function(){if(li.encryptedBytes)return ng({decryptionWorker:lt,segment:li,trackInfoFn:ht,timingInfoFn:Ft,videoSegmentTimingInfoFn:Xt,audioSegmentTimingInfoFn:Ci,id3Fn:Jt,captionsFn:ji,isEndOfTimeline:fi,endedTimelineFn:Wt,dataFn:Gt,doneFn:Mt,onTransmuxerLog:Ht,triggerSegmentEventFn:sn});Xc({segment:li,bytes:li.bytes,trackInfoFn:ht,timingInfoFn:Ft,videoSegmentTimingInfoFn:Xt,audioSegmentTimingInfoFn:Ci,id3Fn:Jt,captionsFn:ji,isEndOfTimeline:fi,endedTimelineFn:Wt,dataFn:Gt,doneFn:Mt,onTransmuxerLog:Ht,triggerSegmentEventFn:sn})};if(li.endOfAllRequests=Date.now(),li.map&&li.map.encryptedBytes&&!li.map.bytes)return sn({type:"segmentdecryptionstart",segment:li}),Gc({decryptionWorker:lt,id:li.requestId+"-init",encryptedBytes:li.map.encryptedBytes,key:li.map.key,segment:li,doneFn:Mt},Ns=>{li.map.bytes=Ns,sn({type:"segmentdecryptioncomplete",segment:li}),Wc(li,Wr=>{if(Wr)return gl(si),Mt(Wr,li);Vr()})});Vr()}}}})({activeXhrs:Pe,decryptionWorker:jt,trackInfoFn:Zt,timingInfoFn:Ti,videoSegmentTimingInfoFn:B,audioSegmentTimingInfoFn:G,id3Fn:H,captionsFn:se,isEndOfTimeline:pe,endedTimelineFn:ae,dataFn:_e,doneFn:Ce,onTransmuxerLog:xt,triggerSegmentEventFn:xe}),xt=(a.key&&!a.key.bytes&&(Zt=[a.key],a.map&&!a.map.bytes&&a.map.key&&a.map.key.resolvedUri===a.key.resolvedUri&&Zt.push(a.map.key),Ti=Qt(t,{uri:a.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),B=Vc(a,Zt,jt,xe),xe({type:"segmentkeyloadstart",segment:a,keyInfo:{uri:a.key.resolvedUri}}),G=s(Ti,B),Pe.push(G)),a.map&&!a.map.bytes&&(!a.map.key||a.key&&a.key.resolvedUri===a.map.key.resolvedUri||(H=Qt(t,{uri:a.map.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),se=Vc(a,[a.map.key],jt,xe),xe({type:"segmentkeyloadstart",segment:a,keyInfo:{uri:a.map.key.resolvedUri}}),pe=s(H,se),Pe.push(pe)),ae=Qt(t,{uri:a.map.resolvedUri,responseType:"arraybuffer",headers:pl(a.map),requestType:"segment-media-initialization"}),{segment:Ae,finishProcessingFn:st,triggerSegmentEventFn:Ue}=[{segment:a,finishProcessingFn:jt,triggerSegmentEventFn:xe}][0],_e=(ht,lt)=>{var ht=yl(ht,lt);return ht?st(ht,Ae):(ht=new Uint8Array(lt.response),Ue({type:"segmentloaded",segment:Ae}),Ae.map.key?(Ae.map.encryptedBytes=ht,st(null,Ae)):(Ae.map.bytes=ht,void Wc(Ae,function(Ft){if(Ft)return Ft.xhr=lt,Ft.status=lt.status,st(Ft,Ae);st(null,Ae)})))},xe({type:"segmentloadstart",segment:a}),Ce=s(ae,_e),Pe.push(Ce)),Qt(t,{uri:a.part&&a.part.resolvedUri||a.resolvedUri,responseType:"arraybuffer",headers:pl(a),requestType:"segment"})),Zt=({segment:ft,finishProcessingFn:Et,responseType:dt,triggerSegmentEventFn:Ot}=[{segment:a,finishProcessingFn:jt,responseType:xt.responseType,triggerSegmentEventFn:xe}][0],(si,lt)=>(si=yl(si,lt),si?Et(si,ft):(Ot({type:"segmentloaded",segment:ft}),si=dt!=="arraybuffer"&&lt.responseText?Wm(lt.responseText.substring(ft.lastReachedChar||0)):lt.response,ft.stats=Qm(lt),ft.key?ft.encryptedBytes=new Uint8Array(si):ft.bytes=new Uint8Array(si),Et(null,ft)))),Ti=(xe({type:"segmentloadstart",segment:a}),s(xt,Zt));Ti.addEventListener("progress",({segment:Ct,progressFn:Lt}=[{segment:a,progressFn:l}][0],si=>{var lt=si.target;if(!lt.aborted)return Ct.stats=Qt(Ct.stats,Jm(si)),!Ct.stats.firstBytesReceivedAt&&Ct.stats.bytesReceived&&(Ct.stats.firstBytesReceivedAt=Date.now()),Lt(si,Ct)})),Pe.push(Ti);let mn={};return Pe.forEach(si=>{var lt,ht;si.addEventListener("loadend",({loadendState:lt,abortFn:ht}=[{loadendState:mn,abortFn:o}][0],Ft=>{Ft.target.aborted&&ht&&!lt.calledAbortFn&&(ht(),lt.calledAbortFn=!0)}))}),()=>gl(Pe)},sg=un("CodecUtils"),$c=(s,t)=>(t=t.attributes||{},s&&s.mediaGroups&&s.mediaGroups.AUDIO&&t.AUDIO&&s.mediaGroups.AUDIO[t.AUDIO]),wa=function(s){let t={};return s.forEach(({mediaType:i,type:a,details:o})=>{t[i]=t[i]||[],t[i].push(od(""+a+o))}),Object.keys(t).forEach(function(i){1<t[i].length?(sg(`multiple ${i} codecs found as attributes: ${t[i].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),t[i]=null):t[i]=t[i][0]}),t},vl=un("PlaylistSelector"),Kc=function(s){var t;if(s&&s.playlist)return t=s.playlist,JSON.stringify({id:t.id,bandwidth:s.bandwidth,width:s.width,height:s.height,codecs:t.attributes&&t.attributes.CODECS||""})},jr=function(s,t){let i=s.slice();s.sort(function(a,o){var l=t(a,o);return l===0?i.indexOf(a)-i.indexOf(o):l})};function Yc(s,t,i,a,o,l){if(s){var h={bandwidth:t,width:i,height:a,limitRenditionByPlayerDimensions:o};let G=s.playlists,H=(tn.isAudioOnly(s)&&(G=l.getAudioTrackPlaylists_(),h.audioOnly=!0),G.map(ae=>{var _e=ae.attributes&&ae.attributes.RESOLUTION&&ae.attributes.RESOLUTION.width,Ce=ae.attributes&&ae.attributes.RESOLUTION&&ae.attributes.RESOLUTION.height,Le=ae.attributes&&ae.attributes.BANDWIDTH;return{bandwidth:Le||window.Number.MAX_VALUE,width:_e,height:Ce,playlist:ae}})),se=(jr(H,(ae,_e)=>ae.bandwidth-_e.bandwidth),(H=H.filter(ae=>!tn.isIncompatible(ae.playlist))).filter(ae=>tn.isEnabled(ae.playlist)));s=(se=se.length?se:H.filter(ae=>!tn.isDisabled(ae.playlist))).filter(ae=>ae.bandwidth*Mi.BANDWIDTH_VARIANCE<t);let pe=s[s.length-1];var T=s.filter(ae=>ae.bandwidth===pe.bandwidth)[0];if(o===!1){let ae=T||se[0]||H[0];if(ae&&ae.playlist){let _e=T?"bandwidthBestRep":"sortedPlaylistReps";return se[0]&&(_e="enabledPlaylistReps"),vl(`choosing ${Kc(ae)} using ${_e} with options`,h),ae.playlist}}else{var B,o=s.filter(Ae=>Ae.width&&Ae.height),s=(jr(o,(Ae,st)=>Ae.width-st.width),o.filter(Ae=>Ae.width===i&&Ae.height===a)),s=(pe=s[s.length-1],s.filter(Ae=>Ae.bandwidth===pe.bandwidth)[0]);let Ce,Le;s||(B=(Ce=o.filter(Ae=>Ae.width>i||a<Ae.height)).filter(Ae=>Ae.width===Ce[0].width&&Ae.height===Ce[0].height),pe=B[B.length-1],Le=B.filter(Ae=>Ae.bandwidth===pe.bandwidth)[0]);let xe,Pe=(l.leastPixelDiffSelector&&(B=o.map(Ae=>(Ae.pixelDiff=Math.abs(Ae.width-i)+Math.abs(Ae.height-a),Ae)),jr(B,(Ae,st)=>Ae.pixelDiff===st.pixelDiff?st.bandwidth-Ae.bandwidth:Ae.pixelDiff-st.pixelDiff),xe=B[0]),xe||Le||s||T||se[0]||H[0]);if(Pe&&Pe.playlist){let Ae="sortedPlaylistReps";return xe?Ae="leastPixelDiffRep":Le?Ae="resolutionPlusOneRep":s?Ae="resolutionBestRep":T?Ae="bandwidthBestRep":se[0]&&(Ae="enabledPlaylistReps"),vl(`choosing ${Kc(Pe)} using ${Ae} with options`,h),Pe.playlist}}return vl("could not choose a playlist with options",h),null}}function Zc(){let s=this.useDevicePixelRatio&&window.devicePixelRatio||1;return isNaN(this.customPixelRatio)||(s=this.customPixelRatio),Yc(this.playlists.main,this.systemBandwidth,parseInt(Sa(this.tech_.el(),"width"),10)*s,parseInt(Sa(this.tech_.el(),"height"),10)*s,this.limitRenditionByPlayerDimensions,this.playlistController_)}function Qc(s){try{return new URL(s).pathname.split("/").slice(-2).join("/")}catch{return""}}function ks(s,t,i){let a;var o;if(i&&i.cues)for(a=i.cues.length;a--;)(o=i.cues[a]).startTime>=s&&o.endTime<=t&&i.removeCue(o)}let ag=({inbandTextTracks:s,metadataArray:t,timestampOffset:i,videoDuration:a})=>{if(t){let h=window.WebKitDataCue||window.VTTCue,T=s.metadataTrack_;if(T&&(t.forEach(B=>{let G=B.cueTime+i;!(typeof G!="number"||window.isNaN(G)||G<0)&&G<1/0&&B.frames&&B.frames.length&&B.frames.forEach(H=>{var se,pe=new h(G,G,H.value||H.url||H.data||"");pe.frame=H,pe.value=H,se=pe,Object.defineProperties(se.frame,{id:{get(){return He.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),se.value.key}},value:{get(){return He.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),se.value.data}},privateData:{get(){return He.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),se.value.data}}}),T.addCue(pe)})}),T.cues)&&T.cues.length){var o=T.cues,l=[];for(let H=0;H<o.length;H++)o[H]&&l.push(o[H]);let B=l.reduce((H,se)=>{var pe=H[se.startTime]||[];return pe.push(se),H[se.startTime]=pe,H},{}),G=Object.keys(B).sort((H,se)=>Number(H)-Number(se));G.forEach((ae,se)=>{var pe=B[ae],ae=isFinite(a)?a:ae;let _e=Number(G[se+1])||ae;pe.forEach(Ce=>{Ce.endTime=_e})})}}},og={id:"ID",class:"CLASS",startDate:"START-DATE",duration:"DURATION",endDate:"END-DATE",endOnNext:"END-ON-NEXT",plannedDuration:"PLANNED-DURATION",scte35Out:"SCTE35-OUT",scte35In:"SCTE35-IN"},lg=new Set(["id","class","startDate","duration","endDate","endOnNext","startTime","endTime","processDateRange"]),Jc=(s,t,i)=>{s.metadataTrack_||(s.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,He.browser.IS_ANY_SAFARI)||(s.metadataTrack_.inBandMetadataTrackDispatchType=t)},eh=s=>typeof s=="number"&&isFinite(s),Hr=ae=>{var{startOfSegment:t,duration:i,segment:a,part:o,playlist:{mediaSequence:l,id:h,segments:H=[]},mediaIndex:T,partIndex:B,timeline:G}=ae,H=H.length-1;let se="mediaIndex/partIndex increment";ae.getMediaInfoForTime?se=`getMediaInfoForTime (${ae.getMediaInfoForTime})`:ae.isSyncRequest&&(se="getSyncSegmentCandidate (isSyncRequest)"),ae.independent&&(se+=" with independent "+ae.independent);var pe=typeof B=="number",ae=ae.segment.uri?"segment":"pre-segment",_e=pe?uc({preloadSegment:a})-1:0;return ae+` [${l+T}/${l+H}]`+(pe?` part [${B}/${_e}]`:"")+` segment start/end [${a.start} => ${a.end}]`+(pe?` part start/end [${o.start} => ${o.end}]`:"")+` startOfSegment [${t}] duration [${i}] timeline [${G}] selected by [${se}] playlist [${h}]`},th=s=>s+"TimingInfo",bl=({timelineChangeController:s,currentTimeline:t,segmentTimeline:i,loaderType:a,audioDisabled:o})=>!(t===i||(a==="audio"?(t=s.lastTimelineChange({type:"main"}))&&t.to===i:a!=="main"||!o||(t=s.pendingTimelineChange({type:"audio"}))&&t.to===i)),Hn=s=>{var t,i,a,o=s.pendingSegment_;o&&bl({timelineChangeController:s.timelineChangeController_,currentTimeline:s.currentTimeline_,segmentTimeline:o.timeline,loaderType:s.loaderType_,audioDisabled:s.audioDisabled_})&&((o=s.timelineChangeController_)&&(t=o.pendingTimelineChange({type:"audio"}),o=o.pendingTimelineChange({type:"main"}),a=(i=t&&o)&&t.to!==o.to,i)&&t.from!==-1&&o.from!==-1&&a)&&(t=(i=s).timelineChangeController_.pendingTimelineChange({type:"audio"}),i=i.timelineChangeController_.pendingTimelineChange({type:"main"}),t&&i&&t.to<i.to?s.timelineChangeController_.trigger("audioTimelineBehind"):s.timelineChangeController_.trigger("fixBadTimelineChange"))},ih=({segmentDuration:s,maxDuration:t})=>!!s&&Math.round(s)>t+En,ug=(s,t)=>{var i,a,o;return t==="hls"&&(t=(l=>{let h=0;return["video","audio"].forEach(function(T){if(T=l[T+"TimingInfo"],T){var{start:T,end:B}=T;let H;typeof T=="bigint"||typeof B=="bigint"?H=window.BigInt(B)-window.BigInt(T):typeof T=="number"&&typeof B=="number"&&(H=B-T),typeof H<"u"&&H>h&&(h=H)}}),h=typeof h=="bigint"&&h<Number.MAX_SAFE_INTEGER?Number(h):h})({audioTimingInfo:s.audioTimingInfo,videoTimingInfo:s.videoTimingInfo}))&&(i=s.playlist.targetDuration,a=ih({segmentDuration:t,maxDuration:2*i}),o=ih({segmentDuration:t,maxDuration:i}),t=`Segment with index ${s.mediaIndex} from playlist ${s.playlist.id} has a duration of ${t} when the reported duration is ${s.duration} and the target duration is ${i}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`,a||o)?{severity:a?"warn":"info",message:t}:null},lr=({type:s,segment:t})=>{var i,a,o;if(t)return i=!!(t.key||t.map&&t.map.ke),a=!!(t.map&&!t.map.bytes),o=t.startOfSegment===void 0?t.start:t.startOfSegment,{type:s||t.type,uri:t.resolvedUri||t.uri,start:o,duration:t.duration,isEncrypted:i,isMediaInitialization:a}};class _l extends He.EventTarget{constructor(t,i=0){if(super(),!t)throw new TypeError("Initialization settings are required");if(typeof t.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!t.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=t.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=t.hasPlayed,this.currentTime_=t.currentTime,this.seekable_=t.seekable,this.seeking_=t.seeking,this.duration_=t.duration,this.mediaSource_=t.mediaSource,this.vhs_=t.vhs,this.loaderType_=t.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=t.segmentMetadataTrack,this.goalBufferLength_=t.goalBufferLength,this.sourceType_=t.sourceType,this.sourceUpdater_=t.sourceUpdater,this.inbandTextTracks_=t.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=t.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=t.parse708captions,this.useDtsForTimestampOffset_=t.useDtsForTimestampOffset,this.captionServices_=t.captionServices,this.exactManifestTimings=t.exactManifestTimings,this.addMetadataToTextTrack=t.addMetadataToTextTrack,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.shouldForceTimestampOffsetAfterResync_=!1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=!1,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=t.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=t.decrypter,this.syncController_=t.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)}),this.fetchAtBuffer_=!1,this.logger_=un(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(a){a!==this.state_&&(this.logger_(this.state_+" -> "+a),this.state_=a,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()?this.processCallQueue_():Hn(this)}),this.sourceUpdater_.on("codecschange",a=>{this.trigger(Ii({type:"codecschange"},a))}),this.loaderType_==="main"&&this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()?this.processCallQueue_():Hn(this)}),this.loaderType_==="audio"&&this.timelineChangeController_.on("timelinechange",a=>{this.trigger(Ii({type:"timelinechange"},a)),this.hasEnoughInfoToLoad_()?this.processLoadQueue_():Hn(this),this.hasEnoughInfoToAppend_()?this.processCallQueue_():Hn(this)})}get mediaSequenceSync_(){return this.syncController_.getMediaSequenceSync(this.loaderType_)}createTransmuxer_(){return Zm({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&window.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(t){this.audioDisabled_=!t,t?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){this.state!=="WAITING"?(this.pendingSegment_&&(this.pendingSegment_=null),this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_)):(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_())}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,window.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(t){return this.state!=="APPENDING"||this.pendingSegment_?!this.pendingSegment_||this.pendingSegment_.requestId!==t:(this.state="READY",!0)}error(t){return typeof t<"u"&&(this.logger_("error occurred:",t),this.error_=t),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&jc(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){var t=this.getMediaInfo_();if(!this.sourceUpdater_||!t)return zi();if(this.loaderType_==="main"){var{hasAudio:t,hasVideo:i,isMuxed:a}=t;if(i&&t&&!this.audioDisabled_&&!a)return this.sourceUpdater_.buffered();if(i)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(t,i=!1){if(!t)return null;var a=Ta(t);let o=this.initSegments_[a];return i&&!o&&t.bytes&&(this.initSegments_[a]=o={resolvedUri:t.resolvedUri,byterange:t.byterange,bytes:t.bytes,tracks:t.tracks,timescales:t.timescales}),o||t}segmentKey(t,i=!1){if(!t)return null;var a=xc(t);let o=this.keyCache_[a];return this.cacheEncryptionKeys_&&i&&!o&&t.bytes&&(this.keyCache_[a]=o={resolvedUri:t.resolvedUri,bytes:t.bytes}),i={resolvedUri:(o||t).resolvedUri},o&&(i.bytes=o.bytes),i}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),this.playlist_)return this.state==="INIT"&&this.couldBeginLoading_()?this.init_():void(!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY"))}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(t,i={}){if(t&&!(this.playlist_&&this.playlist_.endList&&t.endList&&this.playlist_.uri===t.uri)){var a,o=this.playlist_,l=this.pendingSegment_;this.playlist_=t,this.xhrOptions_=i,this.state==="INIT"&&(t.syncInfo={mediaSequence:t.mediaSequence,time:0},this.loaderType_==="main")&&this.syncController_.setDateTimeMappingForStart(t);let h=null;if(o&&(o.id?h=o.id:o.uri&&(h=o.uri)),this.logger_(`playlist update [${h} => ${t.id||t.uri}]`),this.mediaSequenceSync_&&(this.mediaSequenceSync_.update(t,this.currentTime_()),this.logger_(`Playlist update:
currentTime: ${this.currentTime_()}
bufferedEnd: ${nl(this.buffered_())}
`,this.mediaSequenceSync_.diagnostics)),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();o&&o.uri===t.uri?(i=t.mediaSequence-o.mediaSequence,this.logger_(`live window shift [${i}]`),this.mediaIndex!==null&&(this.mediaIndex-=i,this.mediaIndex<0?(this.mediaIndex=null,this.partIndex=null):(a=this.playlist_.segments[this.mediaIndex],!this.partIndex||a.parts&&a.parts.length&&a.parts[this.partIndex]||(a=this.mediaIndex,this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=a))),l&&(l.mediaIndex-=i,l.mediaIndex<0?(l.mediaIndex=null,l.partIndex=null):(0<=l.mediaIndex&&(l.segment=t.segments[l.mediaIndex]),0<=l.partIndex&&l.segment.parts&&(l.part=l.segment.parts[l.partIndex]))),this.syncController_.saveExpiredSegmentInfo(o,t)):(this.mediaIndex!==null&&(!t.endList&&typeof t.partTargetDuration=="number"?this.resetLoader():this.resyncLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate"))}}pause(){this.checkBufferTimeout_&&(window.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return this.checkBufferTimeout_===null}resetEverything(t){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,t),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.mediaSequenceSync_&&this.mediaSequenceSync_.resetAppendedStatus(),this.resyncLoader()}resyncLoader(){this.transmuxer_&&jc(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1;var t=this.currentMediaInfo_&&this.currentMediaInfo_.isFmp4;this.sourceType_!=="hls"||t||(this.shouldForceTimestampOffsetAfterResync_=!0),this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(t,i,a=()=>{},o=!1){if((i=i===1/0?this.duration_():i)<=t)this.logger_("skipping remove because end ${end} is <= start ${start}");else if(this.sourceUpdater_&&this.getMediaInfo_()){let T=1;var l,h=()=>{--T===0&&a()};for(l in!o&&this.audioDisabled_||(T++,this.sourceUpdater_.removeAudio(t,i,h)),!o&&this.loaderType_!=="main"||(this.gopBuffer_=((B,_e,H,se)=>{var pe=Math.ceil((_e-se)*sr),ae=Math.ceil((H-se)*sr),_e=B.slice();let Ce=B.length;for(;Ce--&&!(B[Ce].pts<=ae););if(Ce!==-1){let Le=Ce+1;for(;Le--&&!(B[Le].pts<=pe););Le=Math.max(Le,0),_e.splice(Le,Ce-Le+1)}return _e})(this.gopBuffer_,t,i,this.timeMapping_),T++,this.sourceUpdater_.removeVideo(t,i,h)),this.inbandTextTracks_)ks(t,i,this.inbandTextTracks_[l]);ks(t,i,this.segmentMetadataTrack_),h()}else this.logger_("skipping remove because no source updater or starting media info")}monitorBuffer_(){this.checkBufferTimeout_&&window.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=window.setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&window.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=window.setTimeout(this.monitorBufferTick_.bind(this),500)}fillBuffer_(){var t,i;this.sourceUpdater_.updating()||(t=this.chooseNextRequest_())&&(i={segmentInfo:lr({type:this.loaderType_,segment:t})},this.trigger({type:"segmentselected",metadata:i}),typeof t.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:t.timeline})),this.loadSegment_(t))}isEndOfStream_(t=this.mediaIndex,i=this.playlist_,a=this.partIndex){var o;return!(!i||!this.mediaSource_)&&(o=typeof t=="number"&&i.segments[t],t=t+1===i.segments.length,a=!o||!o.parts||a+1===o.parts.length,i.endList)&&this.mediaSource_.readyState==="open"&&t&&a}chooseNextRequest_(){var i=this.buffered_(),t=nl(i)||0,i=rl(i,this.currentTime_()),a=!this.hasPlayed_()&&1<=i,o=i>=this.goalBufferLength_(),l=this.playlist_.segments;if(!l.length||a||o)return null;if(this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_(),this.loaderType_),a={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:!this.syncPoint_},a.isSyncRequest)a.mediaIndex=function(B,G,H){G=G||[];var se=[];let pe=0;for(let _e=0;_e<G.length;_e++){var ae=G[_e];if(B===ae.timeline&&(se.push(_e),(pe+=ae.duration)>H))return _e}return se.length===0?0:se[se.length-1]}(this.currentTimeline_,l,t),this.logger_("choose next request. Can not find sync point. Fallback to media Index: "+a.mediaIndex);else if(this.mediaIndex!==null){var o=l[this.mediaIndex],h=typeof this.partIndex=="number"?this.partIndex:-1;a.startOfSegment=o.end||t,o.parts&&o.parts[h+1]?(a.mediaIndex=this.mediaIndex,a.partIndex=h+1):a.mediaIndex=this.mediaIndex+1}else{let B,G,H;if(o=this.fetchAtBuffer_?t:this.currentTime_(),this.mediaSequenceSync_&&this.logger_(`chooseNextRequest_ request after Quality Switch:
For TargetTime: ${o}.
CurrentTime: ${this.currentTime_()}
BufferedEnd: ${t}
Fetch At Buffer: ${this.fetchAtBuffer_}
`,this.mediaSequenceSync_.diagnostics),this.mediaSequenceSync_&&this.mediaSequenceSync_.isReliable){if(h=this.getSyncInfoFromMediaSequenceSync_(o),!h)return this.error({message:t="No sync info found while using media sequence sync",metadata:{errorType:He.Error.StreamingFailedToSelectNextSegment,error:new Error(t)}}),this.logger_("chooseNextRequest_ - no sync info found using media sequence sync"),null;this.logger_(`chooseNextRequest_ mediaSequence syncInfo (${h.start} --> ${h.end})`),B=h.segmentIndex,G=h.partIndex,H=h.start}else this.logger_("chooseNextRequest_ - fallback to a regular segment selection algorithm, based on a syncPoint."),t=tn.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:o,startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time}),B=t.segmentIndex,G=t.partIndex,H=t.startTime;a.getMediaInfoForTime=this.fetchAtBuffer_?"bufferedEnd "+o:"currentTime "+o,a.mediaIndex=B,a.startOfSegment=H,a.partIndex=G,this.logger_(`choose next request. Playlist switched and we have a sync point. Media Index: ${a.mediaIndex} `)}h=l[a.mediaIndex];let T=h&&typeof a.partIndex=="number"&&h.parts&&h.parts[a.partIndex];return!h||typeof a.partIndex=="number"&&!T?null:(typeof a.partIndex!="number"&&h.parts&&(a.partIndex=0,T=h.parts[0]),t=this.vhs_.playlists&&this.vhs_.playlists.main&&this.vhs_.playlists.main.independentSegments||this.playlist_.independentSegments,i||!T||t||T.independent||(a.partIndex===0?(i=(o=l[a.mediaIndex-1]).parts&&o.parts.length&&o.parts[o.parts.length-1])&&i.independent&&(--a.mediaIndex,a.partIndex=o.parts.length-1,a.independent="previous segment"):h.parts[a.partIndex-1].independent&&(--a.partIndex,a.independent="previous part")),t=this.mediaSource_&&this.mediaSource_.readyState==="ended",a.mediaIndex>=l.length-1&&t&&!this.seeking_()?null:(this.shouldForceTimestampOffsetAfterResync_&&(this.shouldForceTimestampOffsetAfterResync_=!1,a.forceTimestampOffset=!0,this.logger_("choose next request. Force timestamp offset after loader resync")),this.generateSegmentInfo_(a)))}getSyncInfoFromMediaSequenceSync_(t){var i;return this.mediaSequenceSync_&&(t!==(i=Math.max(t,this.mediaSequenceSync_.start))&&this.logger_(`getSyncInfoFromMediaSequenceSync_. Pulled target time from ${t} to `+i),t=this.mediaSequenceSync_.getSyncInfoForTime(i))?t.isAppended?(i=this.mediaSequenceSync_.getSyncInfoForTime(t.end))?(i.isAppended&&this.logger_("getSyncInfoFromMediaSequenceSync_: We encounter unexpected scenario where next media sequence sync info is also appended!"),i):null:t:null}generateSegmentInfo_(i){var{independent:i,playlist:a,mediaIndex:G,startOfSegment:o,isSyncRequest:se,partIndex:H,forceTimestampOffset:l,getMediaInfoForTime:h}=i,T=a.segments[G],B=typeof H=="number"&&T.parts[H],G={requestId:"segment-loader-"+Math.random(),uri:B&&B.resolvedUri||T.resolvedUri,mediaIndex:G,partIndex:B?H:null,isSyncRequest:se,startOfSegment:o,playlist:a,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:T.timeline,duration:B&&B.duration||T.duration,segment:T,part:B,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:h,independent:i},H=typeof l<"u"?l:this.isPendingTimestampOffset_,se=(G.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:T.timeline,currentTimeline:this.currentTimeline_,startOfSegment:o,buffered:this.buffered_(),overrideCheck:H}),nl(this.sourceUpdater_.audioBuffered()));return typeof se=="number"&&(G.audioAppendStart=se-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(G.gopsToAlignWith=((pe,ae,_e)=>{if(typeof ae>"u"||ae===null||!pe.length)return[];var Ce=Math.ceil((ae-_e+3)*sr);let Le;for(Le=0;Le<pe.length&&!(pe[Le].pts>Ce);Le++);return pe.slice(Le)})(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),G}timestampOffsetForSegment_(t){return{segmentTimeline:t,currentTimeline:i,startOfSegment:a,buffered:o,overrideCheck:l}=[t][0],l||t!==i?!(t<i)&&o.length?o.end(o.length-1):a:null;var i,a,o,l}earlyAbortWhenNeeded_(t){if(!this.vhs_.tech_.paused()&&this.xhrOptions_.timeout&&this.playlist_.attributes.BANDWIDTH&&!(Date.now()-(t.firstBytesReceivedAt||Date.now())<1e3)){var i=this.currentTime_(),a=t.bandwidth,o=this.pendingSegment_.duration,t=tn.estimateSegmentRequestTime(o,a,this.playlist_,t.bytesReceived),l=([l,h,T=1]=[this.buffered_(),i,this.vhs_.tech_.playbackRate()],((l.length?l.end(l.length-1):0)-h)/T-1);if(!(t<=l)){var h=function(Ae){let{main:H,currentTime:se,bandwidth:pe,duration:ae,segmentDuration:_e,timeUntilRebuffer:Ce,currentTimeline:Le,syncController:xe}=Ae;Ae=H.playlists.filter(Ue=>!tn.isIncompatible(Ue));let Pe=Ae.filter(tn.isEnabled);var Ae=(Pe=Pe.length?Pe:Ae.filter(Ue=>!tn.isDisabled(Ue))).filter(tn.hasAttribute.bind(null,"BANDWIDTH")).map(Ue=>{var ft=xe.getSyncPoint(Ue,ae,Le,se)?1:2;return{playlist:Ue,rebufferingImpact:tn.estimateSegmentRequestTime(_e,pe,Ue)*ft-Ce}}),st=Ae.filter(Ue=>Ue.rebufferingImpact<=0);return jr(st,(Ue,ft)=>ml(ft.playlist,Ue.playlist)),st.length?st[0]:(jr(Ae,(Ue,ft)=>Ue.rebufferingImpact-ft.rebufferingImpact),Ae[0]||null)}({main:this.vhs_.playlists.main,currentTime:i,bandwidth:a,duration:this.duration_(),segmentDuration:o,timeUntilRebuffer:l,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(h){var T=t-l-h.rebufferingImpact;let G=.5;l<=En&&(G=1),!h.playlist||h.playlist.uri===this.playlist_.uri||T<G||(this.bandwidth=h.playlist.attributes.BANDWIDTH*Mi.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}}}}handleAbort_(t){this.logger_("Aborting "+Hr(t)),this.mediaRequestsAborted+=1}handleProgress_(t,i){this.earlyAbortWhenNeeded_(i.stats),this.checkForAbort_(i.requestId)||this.trigger("progress")}handleTrackInfo_(t,i){var{hasAudio:o,hasVideo:a}=i,o={segmentInfo:lr({type:this.loaderType_,segment:t}),trackInfo:{hasAudio:o,hasVideo:a}};this.trigger({type:"segmenttransmuxingtrackinfoavailable",metadata:o}),this.earlyAbortWhenNeeded_(t.stats),this.checkForAbort_(t.requestId)||this.checkForIllegalMediaSwitch(i)||(function(l,h){if(!l&&!h||!l&&h||l&&!h)return!1;if(l!==h){var T=Object.keys(l).sort(),B=Object.keys(h).sort();if(T.length!==B.length)return!1;for(let H=0;H<T.length;H++){var G=T[H];if(G!==B[H]||l[G]!==h[G])return!1}}return!0}(this.currentMediaInfo_,i=i||{})||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=i,this.currentMediaInfo_=i,this.logger_("trackinfo update",i),this.trigger("trackinfo")),this.checkForAbort_(t.requestId))||(this.pendingSegment_.trackInfo=i,this.hasEnoughInfoToAppend_()?this.processCallQueue_():Hn(this))}handleTimingInfo_(t,i,a,o){var l;this.earlyAbortWhenNeeded_(t.stats),this.checkForAbort_(t.requestId)||((t=this.pendingSegment_)[l=th(i)]=t[l]||{},t[l][a]=o,this.logger_(`timinginfo: ${i} - ${a} - `+o),this.hasEnoughInfoToAppend_()?this.processCallQueue_():Hn(this))}handleCaptions_(t,i){if(this.earlyAbortWhenNeeded_(t.stats),!this.checkForAbort_(t.requestId))if(i.length===0)this.logger_("SegmentLoader received no captions from a caption event");else if(this.pendingSegment_.hasAppendedData_){let a=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),o={};i.forEach(l=>{o[l.stream]=o[l.stream]||{startTime:1/0,captions:[],endTime:0};var h=o[l.stream];h.startTime=Math.min(h.startTime,l.startTime+a),h.endTime=Math.max(h.endTime,l.endTime+a),h.captions.push(l)}),Object.keys(o).forEach(l=>{var{startTime:h,endTime:T,captions:B}=o[l],G=this.inbandTextTracks_;this.logger_(`adding cues from ${h} -> ${T} for `+l),function(H,se,pe){if(!H[pe]){se.trigger({type:"usage",name:"vhs-608"});let _e=pe;/^cc708_/.test(pe)&&(_e="SERVICE"+pe.split("_")[1]);var ae=se.textTracks().getTrackById(_e);if(ae)H[pe]=ae;else{let Ce=pe,Le=pe,xe=!1;ae=(se.options_.vhs&&se.options_.vhs.captionServices||{})[_e],ae&&(Ce=ae.label,Le=ae.language,xe=ae.default),H[pe]=se.addRemoteTextTrack({kind:"captions",id:_e,default:xe,label:Ce,language:Le},!1).track}}}(G,this.vhs_.tech_,l),ks(h,T,G[l]),function({inbandTextTracks:H,captionArray:se,timestampOffset:pe}){if(se){let ae=window.WebKitDataCue||window.VTTCue;se.forEach(_e=>{let Ce=_e.stream;_e.content?_e.content.forEach(Le=>{var xe=new ae(_e.startTime+pe,_e.endTime+pe,Le.text);xe.line=Le.line,xe.align="left",xe.position=Le.position,xe.positionAlign="line-left",H[Ce].addCue(xe)}):H[Ce].addCue(new ae(_e.startTime+pe,_e.endTime+pe,_e.text))})}}({captionArray:B,inbandTextTracks:G,timestampOffset:a})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}else this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,t,i))}handleId3_(t,i,a){this.earlyAbortWhenNeeded_(t.stats),this.checkForAbort_(t.requestId)||(this.pendingSegment_.hasAppendedData_?this.addMetadataToTextTrack(a,i,this.duration_()):this.metadataQueue_.id3.push(this.handleId3_.bind(this,t,i,a)))}processMetadataQueue_(){this.metadataQueue_.id3.forEach(t=>t()),this.metadataQueue_.caption.forEach(t=>t()),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){var t=this.callQueue_;this.callQueue_=[],t.forEach(i=>i())}processLoadQueue_(){var t=this.loadQueue_;this.loadQueue_=[],t.forEach(i=>i())}hasEnoughInfoToLoad_(){var t;return this.loaderType_!=="audio"||!(!(t=this.pendingSegment_)||this.getCurrentMediaInfo_()&&bl({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:t.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}getCurrentMediaInfo_(t=this.pendingSegment_){return t&&t.trackInfo||this.currentMediaInfo_}getMediaInfo_(t=this.pendingSegment_){return this.getCurrentMediaInfo_(t)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){var t,i,a,o;return!!this.sourceUpdater_.ready()&&!(this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_||(t=this.pendingSegment_,i=this.getCurrentMediaInfo_(),!t)||!i||({hasAudio:i,hasVideo:a,isMuxed:o}=i,a&&!t.videoTimingInfo)||i&&!this.audioDisabled_&&!o&&!t.audioTimingInfo||bl({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:t.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(t,i){if(this.earlyAbortWhenNeeded_(t.stats),!this.checkForAbort_(t.requestId))if(this.callQueue_.length||!this.hasEnoughInfoToAppend_())Hn(this),this.callQueue_.push(this.handleData_.bind(this,t,i));else{var a=this.pendingSegment_;if(this.setTimeMapping_(a.timeline),this.updateMediaSecondsLoaded_(a.part||a.segment),this.mediaSource_.readyState!=="closed"){if(t.map&&(t.map=this.initSegmentForMap(t.map,!0),a.segment.map=t.map),t.key&&this.segmentKey(t.key,!0),a.isFmp4=t.isFmp4,a.timingInfo=a.timingInfo||{},a.isFmp4)this.trigger("fmp4"),a.timingInfo.start=a[th(i.type)].start;else{t=this.getCurrentMediaInfo_(),t=this.loaderType_==="main"&&t&&t.hasVideo;let o;t&&(o=a.videoTimingInfo.start),a.timingInfo.start=this.trueSegmentStart_({currentStart:a.timingInfo.start,playlist:a.playlist,mediaIndex:a.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:t,firstVideoFrameTimeForData:o,videoTimingInfo:a.videoTimingInfo,audioTimingInfo:a.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(a,i.type),this.updateSourceBufferTimestampOffset_(a),a.isSyncRequest){if(this.updateTimingInfoEnd_(a),this.syncController_.saveSegmentTimingInfo({segmentInfo:a,shouldSaveTimelineMapping:this.loaderType_==="main"}),t=this.chooseNextRequest_(),t.mediaIndex!==a.mediaIndex||t.partIndex!==a.partIndex)return void this.logger_("sync segment was incorrect, not appending");this.logger_("sync segment was correct, appending")}a.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(a,i)}}}updateAppendInitSegmentStatus(t,i){this.loaderType_!=="main"||typeof t.timestampOffset!="number"||t.changedTimestampOffset||(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[i]!==t.playlist&&(this.appendInitSegment_[i]=!0)}getInitSegmentAndUpdateState_({type:t,initSegment:i,map:a,playlist:o}){if(a){var l=Ta(a);if(this.activeInitSegmentId_===l)return null;i=this.initSegmentForMap(a,!0).bytes,this.activeInitSegmentId_=l}return i&&this.appendInitSegment_[t]?(this.playlistOfLastInitSegment_[t]=o,this.appendInitSegment_[t]=!1,this.activeInitSegmentId_=null,i):null}handleQuotaExceededError_({segmentInfo:t,type:i,bytes:a},o){var l=this.sourceUpdater_.audioBuffered(),h=this.sourceUpdater_.videoBuffered(),T=(1<l.length&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+ar(l).join(", ")),1<h.length&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+ar(h).join(", ")),l.length?l.start(0):0),B=l.length?l.end(l.length-1):0,G=h.length?h.start(0):0,H=h.length?h.end(h.length-1):0;B-T<=1&&H-G<=1?(this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${a.byteLength}, audio buffer: ${ar(l).join(", ")}, video buffer: ${ar(h).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),this.trigger("error")):(this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:t,type:i,bytes:a})),B=this.currentTime_()-1,this.logger_("On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to "+B),this.remove(0,B,()=>{this.logger_("On QUOTA_EXCEEDED_ERR, retrying append in 1s"),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=window.setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()},1e3)},!0))}handleAppendError_({segmentInfo:t,type:i,bytes:a},o){o&&(o.code===22?this.handleQuotaExceededError_({segmentInfo:t,type:i,bytes:a}):(this.logger_("Received non QUOTA_EXCEEDED_ERR on append",o),this.error({message:`${i} append of ${a.length}b failed for segment #${t.mediaIndex} in playlist `+t.playlist.id,metadata:{errorType:He.Error.StreamingFailedToAppendSegment}}),this.trigger("appenderror")))}appendToSourceBuffer_({segmentInfo:t,type:i,initSegment:a,data:o,bytes:l}){if(!l){var h=[o];let T=o.byteLength;a&&(h.unshift(a),T+=a.byteLength),l=(B=>{let G=0,H;return B.bytes&&(H=new Uint8Array(B.bytes),B.segments.forEach(se=>{H.set(se,G),G+=se.byteLength})),H})({bytes:T,segments:h})}o={segmentInfo:lr({type:this.loaderType_,segment:t})},this.trigger({type:"segmentappendstart",metadata:o}),this.sourceUpdater_.appendBuffer({segmentInfo:t,type:i,bytes:l},this.handleAppendError_.bind(this,{segmentInfo:t,type:i,bytes:l}))}handleSegmentTimingInfo_(t,i,a){this.pendingSegment_&&i===this.pendingSegment_.requestId&&((i=this.pendingSegment_.segment)[t=t+"TimingInfo"]||(i[t]={}),i[t].transmuxerPrependedSeconds=a.prependedContentDuration||0,i[t].transmuxedPresentationStart=a.start.presentation,i[t].transmuxedDecodeStart=a.start.decode,i[t].transmuxedPresentationEnd=a.end.presentation,i[t].transmuxedDecodeEnd=a.end.decode,i[t].baseMediaDecodeTime=a.baseMediaDecodeTime)}appendData_(t,i){var{type:a,data:o}=i;o&&o.byteLength&&(a==="audio"&&this.audioDisabled_||(i=this.getInitSegmentAndUpdateState_({type:a,initSegment:i.initSegment,playlist:t.playlist,map:t.isFmp4?t.segment.map:null}),this.appendToSourceBuffer_({segmentInfo:t,type:a,initSegment:i,data:o})))}loadSegment_(t){this.state="WAITING",this.pendingSegment_=t,this.trimBackBuffer_(t),typeof t.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.hasEnoughInfoToLoad_()?this.updateTransmuxerAndRequestSegment_(t):(Hn(this),this.loadQueue_.push(()=>{var i=Ii({},t,{forceTimestampOffset:!0});Ii(t,this.generateSegmentInfo_(i)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(t)}))}updateTransmuxerAndRequestSegment_(t){this.shouldUpdateTransmuxerTimestampOffset_(t.timestampOffset)&&(this.gopBuffer_.length=0,t.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:t.timestampOffset}));var i=this.createSimplifiedSegmentObj_(t),l=this.isEndOfStream_(t.mediaIndex,t.playlist,t.partIndex),a=this.mediaIndex!==null,o=t.timeline!==this.currentTimeline_&&0<t.timeline,l=l||a&&o;this.logger_(`Requesting
${Qc(t.uri)}
`+Hr(t)),i.map&&!i.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),t.abortRequests=rg({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:i,abortFn:this.handleAbort_.bind(this,t),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",t.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",t.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:l,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:h,level:T,stream:B})=>{this.logger_(Hr(t)+` logged from transmuxer stream ${B} as a ${T}: `+h)},triggerSegmentEventFn:({type:h,segment:T,keyInfo:B,trackInfo:G,timingInfo:H})=>{T={segmentInfo:lr({segment:T})},B&&(T.keyInfo=B),G&&(T.trackInfo=G),H&&(T.timingInfo=H),this.trigger({type:h,metadata:T})}})}trimBackBuffer_(t){var i=((a,o,l)=>{let h=o-Mi.BACK_BUFFER_LENGTH;return a.length&&(h=Math.max(h,a.start(0))),Math.min(o-l,h)})(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);0<i&&this.remove(0,i)}createSimplifiedSegmentObj_(t){var i=t.segment,o=t.part,l=t.segment.key||t.segment.map&&t.segment.map.key,a=t.segment.map&&!t.segment.map.bytes,o={resolvedUri:(o||i).resolvedUri,byterange:(o||i).byterange,requestId:t.requestId,transmuxer:t.transmuxer,audioAppendStart:t.audioAppendStart,gopsToAlignWith:t.gopsToAlignWith,part:t.part,type:this.loaderType_,start:t.startOfSegment,duration:t.duration,isEncrypted:l,isMediaInitialization:a},l=t.playlist.segments[t.mediaIndex-1];return l&&l.timeline===i.timeline&&(l.videoTimingInfo?o.baseStartTime=l.videoTimingInfo.transmuxedDecodeEnd:l.audioTimingInfo&&(o.baseStartTime=l.audioTimingInfo.transmuxedDecodeEnd)),i.key&&(a=i.key.iv||new Uint32Array([0,0,0,t.mediaIndex+t.playlist.mediaSequence]),o.key=this.segmentKey(i.key),o.key.iv=a),i.map&&(o.map=this.initSegmentForMap(i.map)),o}saveTransferStats_(t){this.mediaRequests+=1,t&&(this.mediaBytesTransferred+=t.bytesReceived,this.mediaTransferDuration+=t.roundTripTime)}saveBandwidthRelatedStats_(t,i){this.pendingSegment_.byteLength=i.bytesReceived,t<1/60?this.logger_("Ignoring segment's bandwidth because its duration of "+t+" is less than the min to record "+1/60):(t={bandwidthInfo:{from:this.bandwidth,to:i.bandwidth}},this.trigger({type:"bandwidthupdated",metadata:t}),this.bandwidth=i.bandwidth,this.roundTrip=i.roundTripTime)}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(t,i,a){if(this.callQueue_.length)this.callQueue_.push(this.segmentRequestFinished_.bind(this,t,i,a));else if(this.saveTransferStats_(i.stats),this.pendingSegment_&&i.requestId===this.pendingSegment_.requestId){if(t)return this.pendingSegment_=null,this.state="READY",t.code===xn.ABORTED?void 0:(this.pause(),t.code===xn.TIMEOUT?void this.handleTimeout_():(this.mediaRequestsErrored+=1,this.error(t),void this.trigger("error")));t=this.pendingSegment_,this.saveBandwidthRelatedStats_(t.duration,i.stats),t.endOfAllRequests=i.endOfAllRequests,a.gopInfo&&(this.gopBuffer_=((o,l,h)=>{if(!l.length)return o;if(h)return l.slice();var T=l[0].pts;let B=0;for(B;B<o.length&&!(o[B].pts>=T);B++);return o.slice(0,B).concat(l)})(this.gopBuffer_,a.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(t)}}setTimeMapping_(t){t=this.syncController_.mappingForTimeline(t),t!==null&&(this.timeMapping_=t)}updateMediaSecondsLoaded_(t){typeof t.start=="number"&&typeof t.end=="number"?this.mediaSecondsLoaded+=t.end-t.start:this.mediaSecondsLoaded+=t.duration}shouldUpdateTransmuxerTimestampOffset_(t){return t!==null&&(this.loaderType_==="main"&&t!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&t!==this.sourceUpdater_.audioTimestampOffset())}trueSegmentStart_({currentStart:t,playlist:i,mediaIndex:a,firstVideoFrameTimeForData:o,currentVideoTimestampOffset:l,useVideoTimingInfo:h,videoTimingInfo:T,audioTimingInfo:B}){return typeof t<"u"?t:h?(t=i.segments[a-1],a!==0&&t&&typeof t.start<"u"&&t.end===o+l?T.start:o):B.start}waitForAppendsToComplete_(t){var i,a,o=this.getCurrentMediaInfo_(t);o?({hasAudio:o,hasVideo:a,isMuxed:i}=o,a=this.loaderType_==="main"&&a,o=!this.audioDisabled_&&o&&!i,t.waitingOnAppends=0,t.hasAppendedData_?(a&&t.waitingOnAppends++,o&&t.waitingOnAppends++,a&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,t)),o&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,t))):(t.timingInfo||typeof t.timestampOffset!="number"||(this.isPendingTimestampOffset_=!0),t.timingInfo={start:0},t.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(t),this.processMetadataQueue_()),this.checkAppendsDone_(t))):(this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:1/0}),this.trigger("error"))}checkAppendsDone_(t){this.checkForAbort_(t.requestId)||(t.waitingOnAppends--,t.waitingOnAppends===0&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(t){a=this.loaderType_,i=this.getCurrentMediaInfo_(),t=t;var i,a=a==="main"&&i&&t?t.hasAudio||t.hasVideo?i.hasVideo&&!t.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!i.hasVideo&&t.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null;return!!a&&(this.error({message:a,playlistExclusionDuration:1/0}),this.trigger("error"),!0)}updateSourceBufferTimestampOffset_(t){if(t.timestampOffset!==null&&typeof t.timingInfo.start=="number"&&!t.changedTimestampOffset&&this.loaderType_==="main"){let i=!1;t.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:t.segment.videoTimingInfo,audioTimingInfo:t.segment.audioTimingInfo,timingInfo:t.timingInfo}),t.changedTimestampOffset=!0,t.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(t.timestampOffset),i=!0),t.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(t.timestampOffset),i=!0),i&&this.trigger("timestampoffset")}}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:t,audioTimingInfo:i,timingInfo:a}){return this.useDtsForTimestampOffset_?t&&typeof t.transmuxedDecodeStart=="number"?t.transmuxedDecodeStart:i&&typeof i.transmuxedDecodeStart=="number"?i.transmuxedDecodeStart:a.start:a.start}updateTimingInfoEnd_(t){t.timingInfo=t.timingInfo||{};var i=this.getMediaInfo_(),i=this.loaderType_==="main"&&i&&i.hasVideo&&t.videoTimingInfo?t.videoTimingInfo:t.audioTimingInfo;i&&(t.timingInfo.end=typeof i.end=="number"?i.end:i.start+t.duration)}handleAppendsDone_(){var t,i,a;this.pendingSegment_&&(t={segmentInfo:lr({type:this.loaderType_,segment:this.pendingSegment_})},this.trigger({type:"appendsdone",metadata:t})),this.pendingSegment_?((t=this.pendingSegment_).part&&t.part.syncInfo?t.part.syncInfo.markAppended():t.segment.syncInfo&&t.segment.syncInfo.markAppended(),this.updateTimingInfoEnd_(t),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:t,shouldSaveTimelineMapping:this.loaderType_==="main"}),(i=ug(t,this.sourceType_))&&(i.severity==="warn"?He.log.warn(i.message):this.logger_(i.message)),this.recordThroughput_(t),this.pendingSegment_=null,this.state="READY",t.isSyncRequest&&(this.trigger("syncinfoupdate"),!t.hasAppendedData_)?this.logger_("Throwing away un-appended sync request "+Hr(t)):(this.logger_("Appended "+Hr(t)),this.addSegmentMetadataCue_(t),this.fetchAtBuffer_=!0,this.currentTimeline_!==t.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:t.timeline}),this.loaderType_!=="main"||this.audioDisabled_||this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:t.timeline})),this.currentTimeline_=t.timeline,this.trigger("syncinfoupdate"),i=t.segment,a=t.part,i=i.end&&this.currentTime_()-i.end>3*t.playlist.targetDuration,a=a&&a.end&&this.currentTime_()-a.end>3*t.playlist.partTargetDuration,i||a?(this.logger_(`bad ${i?"segment":"part"} `+Hr(t)),this.resetEverything()):(this.mediaIndex!==null&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=t.mediaIndex,this.partIndex=t.partIndex,this.isEndOfStream_(t.mediaIndex,t.playlist,t.partIndex)&&this.endOfStream(),this.trigger("appended"),t.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()))):(this.state="READY",this.paused()||this.monitorBuffer_())}recordThroughput_(t){var i,a;t.duration<1/60?this.logger_("Ignoring segment's throughput because its duration of "+t.duration+" is less than the min to record "+1/60):(i=this.throughput.rate,a=Date.now()-t.endOfAllRequests+1,t=Math.floor(t.byteLength/a*8*1e3),this.throughput.rate+=(t-i)/++this.throughput.count)}addSegmentMetadataCue_(t){var i,a,o,l;this.segmentMetadataTrack_&&(i=(l=t.segment).start,a=l.end,eh(i))&&eh(a)&&(ks(i,a,this.segmentMetadataTrack_),o=window.WebKitDataCue||window.VTTCue,l={custom:l.custom,dateTimeObject:l.dateTimeObject,dateTimeString:l.dateTimeString,programDateTime:l.programDateTime,bandwidth:t.playlist.attributes.BANDWIDTH,resolution:t.playlist.attributes.RESOLUTION,codecs:t.playlist.attributes.CODECS,byteLength:t.byteLength,uri:t.uri,timeline:t.timeline,playlist:t.playlist.id,start:i,end:a},(t=new o(i,a,JSON.stringify(l))).value=l,this.segmentMetadataTrack_.addCue(t))}}function Ln(){}function nh(s){return typeof s!="string"?s:s.replace(/./,t=>t.toUpperCase())}let dg=["video","audio"],Tl=(s,t)=>{var i=t[s+"Buffer"];return i&&i.updating||t.queuePending[s]},qr=(s,t)=>{if(t.queue.length!==0){let i=0,a=t.queue[i];if(a.type==="mediaSource")t.updating()||t.mediaSource.readyState==="closed"||(t.queue.shift(),a.action(t),a.doneFn&&a.doneFn(),qr("audio",t),qr("video",t));else if(s!=="mediaSource"&&t.ready()&&t.mediaSource.readyState!=="closed"&&!Tl(s,t)){if(a.type!==s){if((i=((o,l)=>{for(let T=0;T<l.length;T++){var h=l[T];if(h.type==="mediaSource")return null;if(h.type===o)return T}return null})(s,t.queue))===null)return;a=t.queue[i]}t.queue.splice(i,1),(t.queuePending[s]=a).action(s,t),a.doneFn||(t.queuePending[s]=null,qr(s,t))}}},rh=(s,t)=>{var i=t[s+"Buffer"],a=nh(s);i&&(i.removeEventListener("updateend",t[`on${a}UpdateEnd_`]),i.removeEventListener("error",t[`on${a}Error_`]),t.codecs[s]=null,t[s+"Buffer"]=null)},kn=(s,t)=>s&&t&&Array.prototype.indexOf.call(s.sourceBuffers,t)!==-1,nn={appendBuffer:(s,t,i)=>(a,o)=>{var l=o[a+"Buffer"];if(kn(o.mediaSource,l)){o.logger_(`Appending segment ${t.mediaIndex}'s ${s.length} bytes to ${a}Buffer`);try{l.appendBuffer(s)}catch(h){o.logger_(`Error with code ${h.code} `+(h.code===22?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${t.mediaIndex} to ${a}Buffer`),o.queuePending[a]=null,i(h)}}},remove:(s,t)=>(i,a)=>{var o=a[i+"Buffer"];if(kn(a.mediaSource,o)){a.logger_(`Removing ${s} to ${t} from ${i}Buffer`);try{o.remove(s,t)}catch{a.logger_(`Remove ${s} to ${t} from ${i}Buffer failed`)}}},timestampOffset:s=>(t,i)=>{var a=i[t+"Buffer"];kn(i.mediaSource,a)&&(i.logger_(`Setting ${t}timestampOffset to `+s),a.timestampOffset=s)},callback:s=>(t,i)=>{s()},endOfStream:s=>t=>{if(t.mediaSource.readyState==="open"){t.logger_(`Calling mediaSource endOfStream(${s||""})`);try{t.mediaSource.endOfStream(s)}catch(i){He.log.warn("Failed to call media source endOfStream",i)}}},duration:s=>t=>{t.logger_("Setting mediaSource duration to "+s);try{t.mediaSource.duration=s}catch(i){He.log.warn("Failed to set media source duration",i)}},abort:()=>(s,t)=>{if(t.mediaSource.readyState==="open"){var i=t[s+"Buffer"];if(kn(t.mediaSource,i)){t.logger_(`calling abort on ${s}Buffer`);try{i.abort()}catch(a){He.log.warn(`Failed to abort on ${s}Buffer`,a)}}}},addSourceBuffer:(s,t)=>i=>{var a=nh(s),o=Tr(t),o=(i.logger_(`Adding ${s}Buffer with codec ${t} to mediaSource`),i.mediaSource.addSourceBuffer(o));o.addEventListener("updateend",i[`on${a}UpdateEnd_`]),o.addEventListener("error",i[`on${a}Error_`]),i.codecs[s]=t,i[s+"Buffer"]=o},removeSourceBuffer:s=>t=>{var i=t[s+"Buffer"];if(rh(s,t),kn(t.mediaSource,i)){t.logger_(`Removing ${s}Buffer with codec ${t.codecs[s]} from mediaSource`);try{t.mediaSource.removeSourceBuffer(i)}catch(a){He.log.warn(`Failed to removeSourceBuffer ${s}Buffer`,a)}}},changeType:s=>(t,i)=>{var a=i[t+"Buffer"],o=Tr(s);if(kn(i.mediaSource,a)){var l=s.substring(0,s.indexOf(".")),h=i.codecs[t],T=h.substring(0,h.indexOf("."));if(T!==l){T={codecsChangeInfo:{from:h,to:s}},i.trigger({type:"codecschange",metadata:T}),i.logger_(`changing ${t}Buffer codec from ${h} to `+s);try{a.changeType(o),i.codecs[t]=s}catch(B){T.errorType=He.Error.StreamingCodecsChangeError,(T.error=B).metadata=T,i.error_=B,i.trigger("error"),He.log.warn(`Failed to changeType on ${t}Buffer`,B)}}}}},rn=({type:s,sourceUpdater:t,action:i,doneFn:a,name:o})=>{t.queue.push({type:s,action:i,doneFn:a,name:o}),qr(s,t)},sh=(s,t)=>i=>{var a=function(o){if(o.length===0)return"Buffered Ranges are empty";let l=`Buffered Ranges: 
`;for(let B=0;B<o.length;B++){var h=o.start(B),T=o.end(B);l+=h+` --> ${T}. Duration (${T-h})
`}return l}(t[s+"Buffered"]());t.logger_(`received "updateend" event for ${s} Source Buffer: `,a),t.queuePending[s]&&(a=t.queuePending[s].doneFn,t.queuePending[s]=null,a)&&a(t[s+"Error_"]),qr(s,t)};class ah extends He.EventTarget{constructor(t){super(),this.mediaSource=t,this.sourceopenListener_=()=>qr("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=un("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=sh("video",this),this.onAudioUpdateEnd_=sh("audio",this),this.onVideoError_=i=>{this.videoError_=i},this.onAudioError_=i=>{this.audioError_=i},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(t){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(t),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(t,i){rn({type:"mediaSource",sourceUpdater:this,action:nn.addSourceBuffer(t,i),name:"addSourceBuffer"})}abort(t){rn({type:t,sourceUpdater:this,action:nn.abort(t),name:"abort"})}removeSourceBuffer(t){this.canRemoveSourceBuffer()?rn({type:"mediaSource",sourceUpdater:this,action:nn.removeSourceBuffer(t),name:"removeSourceBuffer"}):He.log.error("removeSourceBuffer is not supported!")}canRemoveSourceBuffer(){return!He.browser.IS_FIREFOX&&window.MediaSource&&window.MediaSource.prototype&&typeof window.MediaSource.prototype.removeSourceBuffer=="function"}static canChangeType(){return window.SourceBuffer&&window.SourceBuffer.prototype&&typeof window.SourceBuffer.prototype.changeType=="function"}canChangeType(){return this.constructor.canChangeType()}changeType(t,i){this.canChangeType()?rn({type:t,sourceUpdater:this,action:nn.changeType(i),name:"changeType"}):He.log.error("changeType is not supported!")}addOrChangeSourceBuffers(t){if(!t||typeof t!="object"||Object.keys(t).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(t).forEach(i=>{var a=t[i];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(i,a);this.canChangeType()&&this.changeType(i,a)})}appendBuffer(t,i){var{segmentInfo:a,type:o,bytes:l}=t;this.processedAppend_=!0,o==="audio"&&this.videoBuffer&&!this.videoAppendQueued_?(this.delayedAudioAppendQueue_.push([t,i]),this.logger_(`delayed audio append of ${l.length} until video append`)):(t=i,rn({type:o,sourceUpdater:this,action:nn.appendBuffer(l,a||{mediaIndex:-1},t),doneFn:i,name:"appendBuffer"}),o==="video"&&(this.videoAppendQueued_=!0,this.delayedAudioAppendQueue_.length)&&(l=this.delayedAudioAppendQueue_.slice(),this.logger_(`queuing delayed audio ${l.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,l.forEach(h=>{this.appendBuffer.apply(this,h)})))}audioBuffered(){return kn(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered||zi()}videoBuffered(){return kn(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered||zi()}buffered(){var t=kn(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,i=kn(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return i&&!t?this.audioBuffered():t&&!i?this.videoBuffered():function(a,o){let l=null,h=null,T=0;var B=[],G=[];if(!(a&&a.length&&o&&o.length))return zi();let H=a.length;for(;H--;)B.push({time:a.start(H),type:"start"}),B.push({time:a.end(H),type:"end"});for(H=o.length;H--;)B.push({time:o.start(H),type:"start"}),B.push({time:o.end(H),type:"end"});for(B.sort(function(se,pe){return se.time-pe.time}),H=0;H<B.length;H++)B[H].type==="start"?++T===2&&(l=B[H].time):B[H].type==="end"&&--T===1&&(h=B[H].time),l!==null&&h!==null&&(G.push([l,h]),l=null,h=null);return zi(G)}(this.audioBuffered(),this.videoBuffered())}setDuration(t,i=Ln){rn({type:"mediaSource",sourceUpdater:this,action:nn.duration(t),name:"duration",doneFn:i})}endOfStream(t=null,i=Ln){typeof t!="string"&&(t=void 0),rn({type:"mediaSource",sourceUpdater:this,action:nn.endOfStream(t),name:"endOfStream",doneFn:i})}removeAudio(t,i,a=Ln){this.audioBuffered().length&&this.audioBuffered().end(0)!==0?rn({type:"audio",sourceUpdater:this,action:nn.remove(t,i),doneFn:a,name:"remove"}):a()}removeVideo(t,i,a=Ln){this.videoBuffered().length&&this.videoBuffered().end(0)!==0?rn({type:"video",sourceUpdater:this,action:nn.remove(t,i),doneFn:a,name:"remove"}):a()}updating(){return!(!Tl("audio",this)&&!Tl("video",this))}audioTimestampOffset(t){return typeof t<"u"&&this.audioBuffer&&this.audioTimestampOffset_!==t&&(rn({type:"audio",sourceUpdater:this,action:nn.timestampOffset(t),name:"timestampOffset"}),this.audioTimestampOffset_=t),this.audioTimestampOffset_}videoTimestampOffset(t){return typeof t<"u"&&this.videoBuffer&&this.videoTimestampOffset_!==t&&(rn({type:"video",sourceUpdater:this,action:nn.timestampOffset(t),name:"timestampOffset"}),this.videoTimestampOffset_=t),this.videoTimestampOffset_}audioQueueCallback(t){this.audioBuffer&&rn({type:"audio",sourceUpdater:this,action:nn.callback(t),name:"callback"})}videoQueueCallback(t){this.videoBuffer&&rn({type:"video",sourceUpdater:this,action:nn.callback(t),name:"callback"})}dispose(){this.trigger("dispose"),dg.forEach(t=>{this.abort(t),this.canRemoveSourceBuffer()?this.removeSourceBuffer(t):this[t+"QueueCallback"](()=>rh(t,this))}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}let oh=s=>decodeURIComponent(escape(String.fromCharCode.apply(null,s))),lh=new Uint8Array(`

`.split("").map(s=>s.charCodeAt(0)));class cg extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}}class hg extends _l{constructor(t,i={}){super(t,i),this.mediaSource_=null,this.subtitlesTrack_=null,this.featuresNativeTextTracks_=t.featuresNativeTextTracks,this.loadVttJs=t.loadVttJs,this.shouldSaveSegmentTimingInfo_=!1}buffered_(){var t;return this.subtitlesTrack_&&this.subtitlesTrack_.cues&&this.subtitlesTrack_.cues.length?zi([[(t=this.subtitlesTrack_.cues)[0].startTime,t[t.length-1].startTime]]):zi()}initSegmentForMap(t,i=!1){if(!t)return null;var a=Ta(t);let o=this.initSegments_[a];return i&&!o&&t.bytes&&(i=lh.byteLength+t.bytes.byteLength,(i=new Uint8Array(i)).set(t.bytes),i.set(lh,t.bytes.byteLength),this.initSegments_[a]=o={resolvedUri:t.resolvedUri,byterange:t.byterange,bytes:i}),o||t}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(t){return typeof t<"u"&&(this.subtitlesTrack_=t,this.state==="INIT"&&this.couldBeginLoading_())&&this.init_(),this.subtitlesTrack_}remove(t,i){ks(t,i,this.subtitlesTrack_)}fillBuffer_(){var t=this.chooseNextRequest_();t&&(this.syncController_.timestampOffsetForTimeline(t.timeline)===null?(this.syncController_.one("timestampoffset",()=>{this.state="READY",this.paused()||this.monitorBuffer_()}),this.state="WAITING_ON_TIMELINE"):this.loadSegment_(t))}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(t){for(;t&&t.segment.empty;){if(t.mediaIndex+1>=t.playlist.segments.length){t=null;break}t=this.generateSegmentInfo_({playlist:t.playlist,mediaIndex:t.mediaIndex+1,startOfSegment:t.startOfSegment+t.duration,isSyncRequest:t.isSyncRequest})}return t}stopForError(t){this.error(t),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(t,i,a){if(this.subtitlesTrack_)if(this.saveTransferStats_(i.stats),this.pendingSegment_)if(t)t.code===xn.TIMEOUT&&this.handleTimeout_(),t.code===xn.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(t);else{var o=this.pendingSegment_,l=a.mp4VttCues&&a.mp4VttCues.length,h=(l&&(o.mp4VttCues=a.mp4VttCues),this.saveBandwidthRelatedStats_(o.duration,i.stats),i.key&&this.segmentKey(i.key,!0),this.state="APPENDING",this.trigger("appending"),o.segment);if(h.map&&(h.map.bytes=i.map.bytes),o.bytes=i.bytes,typeof window.WebVTT!="function"&&typeof this.loadVttJs=="function")this.state="WAITING_ON_VTTJS",this.loadVttJs().then(()=>this.segmentRequestFinished_(t,i,a),()=>this.stopForError({message:"Error loading vtt.js"}));else{h.requested=!0;try{this.parseVTTCues_(o)}catch(T){return void this.stopForError({message:T.message,metadata:{errorType:He.Error.StreamingVttParserError,error:T}})}l||this.updateTimeMapping_(o,this.syncController_.timelines[o.timeline],this.playlist_),o.cues.length?o.timingInfo={start:o.cues[0].startTime,end:o.cues[o.cues.length-1].endTime}:o.timingInfo={start:o.startOfSegment,end:o.startOfSegment+o.duration},o.isSyncRequest?(this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY"):(o.byteLength=o.bytes.byteLength,this.mediaSecondsLoaded+=h.duration,o.cues.forEach(T=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new window.VTTCue(T.startTime,T.endTime,T.text):T)}),function(T){var B=T.cues;if(B){var G={};for(let pe=B.length-1;0<=pe;pe--){var H=B[pe],se=H.startTime+`-${H.endTime}-`+H.text;G[se]?T.removeCue(H):G[se]=H}}}(this.subtitlesTrack_),this.handleAppendsDone_())}}else this.state="READY",this.mediaRequestsAborted+=1;else this.state="READY"}handleData_(t,i){var a=t&&t.type==="vtt",o=i&&i.type==="text";a&&o&&super.handleData_(t,i)}updateTimingInfoEnd_(){}parseMp4VttCues_(t){let i=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();t.mp4VttCues.forEach(a=>{var o=a.start+i,l=a.end+i;let h=new window.VTTCue(o,l,a.cueText);a.settings&&a.settings.split(" ").forEach(G=>{var G=G.split(":"),B=G[0],G=G[1];h[B]=isNaN(G)?G:Number(G)}),t.cues.push(h)})}parseVTTCues_(t){let i,a=!1;if(typeof window.WebVTT!="function")throw new cg;if(t.cues=[],t.timestampmap={MPEGTS:0,LOCAL:0},t.mp4VttCues)this.parseMp4VttCues_(t);else{typeof window.TextDecoder=="function"?i=new window.TextDecoder("utf8"):(i=window.WebVTT.StringDecoder(),a=!0);var o=new window.WebVTT.Parser(window,window.vttjs,i);if(o.oncue=t.cues.push.bind(t.cues),o.ontimestampmap=h=>{t.timestampmap=h},o.onparsingerror=h=>{He.log.warn("Error encountered when parsing cues: "+h.message)},t.segment.map){let h=t.segment.map.bytes;a&&(h=oh(h)),o.parse(h)}let l=t.bytes;a&&(l=oh(l)),o.parse(l),o.flush()}}updateTimeMapping_(t,i,a){var o=t.segment;if(i)if(t.cues.length){var{MPEGTS:l,LOCAL:h}=t.timestampmap;let T=l/sr-h+i.mapping;t.cues.forEach(B=>{var G=B.endTime-B.startTime,H=this.handleRollover_(B.startTime+T,i.time);B.startTime=Math.max(H,0),B.endTime=Math.max(H+G,0)}),a.syncInfo||(l=t.cues[0].startTime,h=t.cues[t.cues.length-1].startTime,a.syncInfo={mediaSequence:a.mediaSequence+t.mediaIndex,time:Math.min(l,h-o.duration)})}else o.empty=!0}handleRollover_(t,i){if(i===null)return t;let a=t*sr;var o=i*sr;let l;for(l=o<a?-8589934592:8589934592;4294967296<Math.abs(a-o);)a+=l;return a/sr}}class uh{constructor({start:t,end:i,segmentIndex:a,partIndex:o=null,appended:l=!1}){this.start_=t,this.end_=i,this.segmentIndex_=a,this.partIndex_=o,this.appended_=l}isInRange(t){return t>=this.start&&t<this.end}markAppended(){this.appended_=!0}resetAppendedStatus(){this.appended_=!1}get isAppended(){return this.appended_}get start(){return this.start_}get end(){return this.end_}get segmentIndex(){return this.segmentIndex_}get partIndex(){return this.partIndex_}}class pg{constructor(t,i=[]){this.segmentSyncInfo_=t,this.partsSyncInfo_=i}get segmentSyncInfo(){return this.segmentSyncInfo_}get partsSyncInfo(){return this.partsSyncInfo_}get hasPartsSyncInfo(){return 0<this.partsSyncInfo_.length}resetAppendStatus(){this.segmentSyncInfo_.resetAppendedStatus(),this.partsSyncInfo_.forEach(t=>t.resetAppendedStatus())}}class dh{constructor(){this.storage_=new Map,this.diagnostics_="",this.isReliable_=!1,this.start_=-1/0,this.end_=1/0}get start(){return this.start_}get end(){return this.end_}get diagnostics(){return this.diagnostics_}get isReliable(){return this.isReliable_}resetAppendedStatus(){this.storage_.forEach(t=>t.resetAppendStatus())}update(a,i){var{mediaSequence:a,segments:o}=a;if(this.isReliable_=this.isReliablePlaylist_(a,o),this.isReliable_)return this.updateStorage_(o,a,this.calculateBaseTime_(a,o,i))}getSyncInfoForTime(t){for(var{segmentSyncInfo:i,partsSyncInfo:a}of this.storage_.values())if(a.length){for(var o of a)if(o.isInRange(t))return o}else if(i.isInRange(t))return i;return null}getSyncInfoForMediaSequence(t){return this.storage_.get(t)}updateStorage_(t,i,a){let o=new Map,l=`
`,h=a,T=i;this.start_=h,t.forEach((B,G)=>{let H=this.storage_.get(T);var se=h,pe=se+B.duration,ae=!!(H&&H.segmentSyncInfo&&H.segmentSyncInfo.isAppended),_e=new uh({start:se,end:pe,appended:ae,segmentIndex:G});B.syncInfo=_e;let Ce=h;var Le=(B.parts||[]).map((xe,Pe)=>{var Ae=Ce,st=Ce+xe.duration,Ue=!!(H&&H.partsSyncInfo&&H.partsSyncInfo[Pe]&&H.partsSyncInfo[Pe].isAppended),ft=new uh({start:Ae,end:st,appended:Ue,segmentIndex:G,partIndex:Pe});return Ce=st,l+=`Media Sequence: ${T}.${Pe} | Range: ${Ae} --> ${st} | Appended: ${Ue}
`,xe.syncInfo=ft});o.set(T,new pg(_e,Le)),l+=`${Qc(B.resolvedUri)} | Media Sequence: ${T} | Range: ${se} --> ${pe} | Appended: ${ae}
`,T++,h=pe}),this.end_=h,this.storage_=o,this.diagnostics_=l}calculateBaseTime_(t,i,a){if(!this.storage_.size)return 0;if(this.storage_.has(t))return this.storage_.get(t).segmentSyncInfo.start;var o=Math.min(...this.storage_.keys());if(t<o){var l=o-t;let T=this.storage_.get(o).segmentSyncInfo.start;for(let B=0;B<l;B++){var h=i[B];T-=h.duration}return T}return a}isReliablePlaylist_(t,i){return t!=null&&Array.isArray(i)&&i.length}}class ch extends dh{constructor(t){super(),this.parent_=t}calculateBaseTime_(t,i,a){return this.storage_.size?super.calculateBaseTime_(t,i,a):(i=this.parent_.getSyncInfoForMediaSequence(t))?i.segmentSyncInfo.start:0}}let Sl=[{name:"VOD",run:(s,t,i,a,o)=>i!==1/0?{time:0,segmentIndex:0,partIndex:null}:null},{name:"MediaSequence",run:(s,t,i,a,o,l)=>(s=s.getMediaSequenceSync(l),s&&s.isReliable&&(l=s.getSyncInfoForTime(o))?{time:l.start,partIndex:l.partIndex,segmentIndex:l.segmentIndex}:null)},{name:"ProgramDateTime",run:(s,t,i,a,o)=>{if(!Object.keys(s.timelineToDatetimeMappings).length)return null;let l=null,h=null;var T=al(t);o=o||0;for(let se=0;se<T.length;se++){var B=T[t.endList||o===0?se:T.length-(se+1)],G=B.segment,H=s.timelineToDatetimeMappings[G.timeline];if(H&&G.dateTimeObject){let pe=G.dateTimeObject.getTime()/1e3+H;if(G.parts&&typeof B.partIndex=="number")for(let ae=0;ae<B.partIndex;ae++)pe+=G.parts[ae].duration;if(H=Math.abs(o-pe),h!==null&&(H===0||h<H))break;h=H,l={time:pe,segmentIndex:B.segmentIndex,partIndex:B.partIndex}}}return l}},{name:"Segment",run:(s,t,i,a,o)=>{let l=null,h=null;o=o||0;var T=al(t);for(let se=0;se<T.length;se++){var B=T[t.endList||o===0?se:T.length-(se+1)],G=B.segment,H=B.part&&B.part.start||G&&G.start;if(G.timeline===a&&typeof H<"u"){if(G=Math.abs(o-H),h!==null&&h<G)break;(!l||h===null||h>=G)&&(h=G,l={time:H,segmentIndex:B.segmentIndex,partIndex:B.partIndex})}}return l}},{name:"Discontinuity",run:(s,t,i,a,o)=>{let l=null;if(o=o||0,t.discontinuityStarts&&t.discontinuityStarts.length){let G=null;for(let H=0;H<t.discontinuityStarts.length;H++){var h=t.discontinuityStarts[H],T=t.discontinuitySequence+H+1,T=s.discontinuities[T];if(T){var B=Math.abs(o-T.time);if(G!==null&&G<B)break;(!l||G===null||G>=B)&&(G=B,l={time:T.time,segmentIndex:h,partIndex:null})}}}return l}},{name:"Playlist",run:(s,t,i,a,o)=>t.syncInfo?{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence,partIndex:null}:null}];class fg extends He.EventTarget{constructor(t=0){super(),this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={};var i=new dh,a=new ch(i),o=new ch(i);this.mediaSequenceStorage_={main:i,audio:a,vtt:o},this.logger_=un("SyncController")}getMediaSequenceSync(t){return this.mediaSequenceStorage_[t]||null}getSyncPoint(t,T,a,o,l){if(T!==1/0)return Sl.find(({name:ae})=>ae==="VOD").run(this,t,T);var h,T=this.runStrategies_(t,T,a,o,l);if(!T.length)return null;for(h of T){var{syncPoint:B,strategy:G}=h,{segmentIndex:H,time:se}=B;if(!(H<0)){var pe=se+t.segments[H].duration;if(this.logger_(`Strategy: ${G}. Current time: ${o}. selected segment: ${H}. Time: [${se} -> ${pe}]}`),se<=o&&o<pe)return this.logger_("Found sync point with exact match: ",B),B}}return this.selectSyncPoint_(T,{key:"time",value:o})}getExpiredTime(t,i){return t&&t.segments&&(i=this.runStrategies_(t,i,t.discontinuitySequence,0)).length?(0<(i=this.selectSyncPoint_(i,{key:"segmentIndex",value:0})).segmentIndex&&(i.time*=-1),Math.abs(i.time+Es({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:i.segmentIndex,endIndex:0}))):null}runStrategies_(t,i,a,o,l){var h=[];for(let G=0;G<Sl.length;G++){var T=Sl[G],B=T.run(this,t,i,a,o,l);B&&(B.strategy=T.name,h.push({strategy:T.name,syncPoint:B}))}return h}selectSyncPoint_(t,i){let a=t[0].syncPoint,o=Math.abs(t[0].syncPoint[i.key]-i.value),l=t[0].strategy;for(let T=1;T<t.length;T++){var h=Math.abs(t[T].syncPoint[i.key]-i.value);h<o&&(o=h,a=t[T].syncPoint,l=t[T].strategy)}return this.logger_(`syncPoint for [${i.key}: ${i.value}] chosen with strategy [${l}]: [time:${a.time}, segmentIndex:`+a.segmentIndex+(typeof a.partIndex=="number"?",partIndex:"+a.partIndex:"")+"]"),a}saveExpiredSegmentInfo(t,i){var a=i.mediaSequence-t.mediaSequence;if(86400<a)He.log.warn(`Not saving expired segment info. Media sequence gap ${a} is too large.`);else for(let l=a-1;0<=l;l--){var o=t.segments[l];if(o&&typeof o.start<"u"){i.syncInfo={mediaSequence:t.mediaSequence+l,time:o.start},this.logger_(`playlist refresh sync: [time:${i.syncInfo.time}, mediaSequence: ${i.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(t){var i;this.timelineToDatetimeMappings={},t.segments&&t.segments.length&&t.segments[0].dateTimeObject&&(i=(t=t.segments[0]).dateTimeObject.getTime()/1e3,this.timelineToDatetimeMappings[t.timeline]=-i)}saveSegmentTimingInfo({segmentInfo:t,shouldSaveTimelineMapping:i}){var o=this.calculateSegmentTimeMapping_(t,t.timingInfo,i),a=t.segment,o=(o&&(this.saveDiscontinuitySyncInfo_(t),t.playlist.syncInfo||(t.playlist.syncInfo={mediaSequence:t.playlist.mediaSequence+t.mediaIndex,time:a.start})),a.dateTimeObject);a.discontinuity&&i&&o&&(this.timelineToDatetimeMappings[a.timeline]=-o.getTime()/1e3)}timestampOffsetForTimeline(t){return typeof this.timelines[t]>"u"?null:this.timelines[t].time}mappingForTimeline(t){return typeof this.timelines[t]>"u"?null:this.timelines[t].mapping}calculateSegmentTimeMapping_(t,i,a){var o=t.segment,l=t.part;let h=this.timelines[t.timeline],T,B;if(typeof t.timestampOffset=="number")h={time:t.startOfSegment,mapping:t.startOfSegment-i.start},a&&(this.timelines[t.timeline]=h,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${t.timeline}: [time: ${h.time}] [mapping: ${h.mapping}]`)),T=t.startOfSegment;else{if(!h)return!1;T=i.start+h.mapping}return B=i.end+h.mapping,l&&(l.start=T,l.end=B),(!o.start||T<o.start)&&(o.start=T),o.end=B,!0}saveDiscontinuitySyncInfo_(t){var i=t.playlist,a=t.segment;if(a.discontinuity)this.discontinuities[a.timeline]={time:a.start,accuracy:0};else if(i.discontinuityStarts&&i.discontinuityStarts.length)for(let B=0;B<i.discontinuityStarts.length;B++){var o=i.discontinuityStarts[B],l=i.discontinuitySequence+B+1,h=o-t.mediaIndex,T=Math.abs(h);if(!this.discontinuities[l]||this.discontinuities[l].accuracy>T){let G;G=h<0?a.start-Es({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:t.mediaIndex,endIndex:o}):a.end+Es({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:t.mediaIndex+1,endIndex:o}),this.discontinuities[l]={time:G,accuracy:T}}}}dispose(){this.trigger("dispose"),this.off()}}class mg extends He.EventTarget{constructor(){super(),this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(t){this.pendingTimelineChanges_[t]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:t,from:i,to:a}){return typeof i=="number"&&typeof a=="number"&&(this.pendingTimelineChanges_[t]={type:t,from:i,to:a},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[t]}lastTimelineChange({type:t,from:i,to:a}){return typeof i=="number"&&typeof a=="number"&&(this.lastTimelineChanges_[t]={type:t,from:i,to:a},delete this.pendingTimelineChanges_[t],this.trigger({type:"timelinechange",metadata:{timelineChangeInfo:{from:i,to:a}}})),this.lastTimelineChanges_[t]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}var gg=Rc(Lc(Mc(function(){var s=function(){function B(){this.listeners={}}var G=B.prototype;return G.on=function(H,se){this.listeners[H]||(this.listeners[H]=[]),this.listeners[H].push(se)},G.off=function(H,se){return!!this.listeners[H]&&(se=this.listeners[H].indexOf(se),this.listeners[H]=this.listeners[H].slice(0),this.listeners[H].splice(se,1),-1<se)},G.trigger=function(H){var se=this.listeners[H];if(se)if(arguments.length===2)for(var pe=se.length,ae=0;ae<pe;++ae)se[ae].call(this,arguments[1]);else for(var _e=Array.prototype.slice.call(arguments,1),Ce=se.length,Le=0;Le<Ce;++Le)se[Le].apply(this,_e)},G.dispose=function(){this.listeners={}},G.pipe=function(H){this.on("data",function(se){H.push(se)})},B}();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 *//*! @name aes-decrypter @version 4.0.2 @license Apache-2.0 */let t=null;class i{constructor(G){t=t||function(){var Ae=[[[],[],[],[],[]],[[],[],[],[],[]]],st=Ae[0],Ue=Ae[1],ft=st[4],Et=Ue[4];let dt,Ot,Ct;var Lt,jt,xt,Zt,Ti=[],mn=[];let si,lt;for(dt=0;dt<256;dt++)mn[(Ti[dt]=dt<<1^283*(dt>>7))^dt]=dt;for(Ot=Ct=0;!ft[Ot];Ot^=Lt||1,Ct=mn[Ct]||1)for(Zt=(Zt=Ct^Ct<<1^Ct<<2^Ct<<3^Ct<<4)>>8^255&Zt^99,xt=Ti[jt=Ti[Lt=Ti[Et[ft[Ot]=Zt]=Ot]]],lt=16843009*xt^65537*jt^257*Lt^16843008*Ot,si=257*Ti[Zt]^16843008*Zt,dt=0;dt<4;dt++)st[dt][Ot]=si=si<<24^si>>>8,Ue[dt][Zt]=lt=lt<<24^lt>>>8;for(dt=0;dt<5;dt++)st[dt]=st[dt].slice(0),Ue[dt]=Ue[dt].slice(0);return Ae}(),this._tables=[[t[0][0].slice(),t[0][1].slice(),t[0][2].slice(),t[0][3].slice(),t[0][4].slice()],[t[1][0].slice(),t[1][1].slice(),t[1][2].slice(),t[1][3].slice(),t[1][4].slice()]];let H,se,pe;var ae=this._tables[0][4],_e=this._tables[1],Ce=G.length;let Le=1;if(Ce!==4&&Ce!==6&&Ce!==8)throw new Error("Invalid aes key size");var xe=G.slice(0),Pe=[];for(this._key=[xe,Pe],H=Ce;H<4*Ce+28;H++)pe=xe[H-1],(H%Ce==0||Ce===8&&H%Ce==4)&&(pe=ae[pe>>>24]<<24^ae[pe>>16&255]<<16^ae[pe>>8&255]<<8^ae[255&pe],H%Ce==0)&&(pe=pe<<8^pe>>>24^Le<<24,Le=Le<<1^283*(Le>>7)),xe[H]=xe[H-Ce]^pe;for(se=0;H;se++,H--)pe=xe[3&se?H:H-4],H<=4||se<4?Pe[se]=pe:Pe[se]=_e[0][ae[pe>>>24]]^_e[1][ae[pe>>16&255]]^_e[2][ae[pe>>8&255]]^_e[3][ae[255&pe]]}decrypt(Ct,H,se,pe,ae,_e){var Ce,Le,xe=this._key[1];let Pe=Ct^xe[0],Ae=pe^xe[1],st=se^xe[2],Ue=H^xe[3],ft;var Et=xe.length/4-2;let dt,Ot=4;var Ct=this._tables[1],Lt=Ct[0],jt=Ct[1],xt=Ct[2],Zt=Ct[3],Ti=Ct[4];for(dt=0;dt<Et;dt++)ft=Lt[Pe>>>24]^jt[Ae>>16&255]^xt[st>>8&255]^Zt[255&Ue]^xe[Ot],Ce=Lt[Ae>>>24]^jt[st>>16&255]^xt[Ue>>8&255]^Zt[255&Pe]^xe[Ot+1],Le=Lt[st>>>24]^jt[Ue>>16&255]^xt[Pe>>8&255]^Zt[255&Ae]^xe[Ot+2],Ue=Lt[Ue>>>24]^jt[Pe>>16&255]^xt[Ae>>8&255]^Zt[255&st]^xe[Ot+3],Ot+=4,Pe=ft,Ae=Ce,st=Le;for(dt=0;dt<4;dt++)ae[(3&-dt)+_e]=Ti[Pe>>>24]<<24^Ti[Ae>>16&255]<<16^Ti[st>>8&255]<<8^Ti[255&Ue]^xe[Ot++],ft=Pe,Pe=Ae,Ae=st,st=Ue,Ue=ft}}class a extends s{constructor(){super(s),this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(G){this.jobs.push(G),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}function o(B){return B<<24|(65280&B)<<8|(16711680&B)>>8|B>>>24}class l{constructor(G,H,se,pe){var ae=l.STEP,_e=new Int32Array(G.buffer);let Ce=new Uint8Array(G.byteLength),Le=0;for(this.asyncStream_=new a,this.asyncStream_.push(this.decryptChunk_(_e.subarray(Le,Le+ae),H,se,Ce)),Le=ae;Le<_e.length;Le+=ae)se=new Uint32Array([o(_e[Le-4]),o(_e[Le-3]),o(_e[Le-2]),o(_e[Le-1])]),this.asyncStream_.push(this.decryptChunk_(_e.subarray(Le,Le+ae),H,se,Ce));this.asyncStream_.push(function(){var xe;pe(null,(xe=Ce).subarray(0,xe.byteLength-xe[xe.byteLength-1]))})}static get STEP(){return 32e3}decryptChunk_(G,H,se,pe){return function(){var ae=function(_e,Et,Le){var xe,Pe,Ae,st,Ue=new Int32Array(_e.buffer,_e.byteOffset,_e.byteLength>>2),ft=new i(Array.prototype.slice.call(Et)),Et=new Uint8Array(_e.byteLength),dt=new Int32Array(Et.buffer);let Ot,Ct,Lt,jt,xt;for(Ot=Le[0],Ct=Le[1],Lt=Le[2],jt=Le[3],xt=0;xt<Ue.length;xt+=4)xe=o(Ue[xt]),Pe=o(Ue[xt+1]),Ae=o(Ue[xt+2]),st=o(Ue[xt+3]),ft.decrypt(xe,Pe,Ae,st,dt,xt),dt[xt]=o(dt[xt]^Ot),dt[xt+1]=o(dt[xt+1]^Ct),dt[xt+2]=o(dt[xt+2]^Lt),dt[xt+3]=o(dt[xt+3]^jt),Ot=xe,Ct=Pe,Lt=Ae,jt=st;return Et}(G,H,se);pe.set(ae,G.byteOffset)}}}var h=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},h=typeof window<"u"?window:typeof h<"u"?h:typeof self<"u"?self:{},h=h.BigInt||Number;h("0x1"),h("0x100"),h("0x10000"),h("0x1000000"),h("0x100000000"),h("0x10000000000"),h("0x1000000000000"),h("0x100000000000000"),h("0x10000000000000000"),h=new Uint16Array([65484]),(h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength))[0];function T(B){let G={};return Object.keys(B).forEach(H=>{var se,pe=B[H];se=pe,(ArrayBuffer.isView==="function"?ArrayBuffer.isView(se):se&&se.buffer instanceof ArrayBuffer)?G[H]={bytes:pe.buffer,byteOffset:pe.byteOffset,byteLength:pe.byteLength}:G[H]=pe}),G}self.onmessage=function(H){let G=H.data;var H=new Uint8Array(G.encrypted.bytes,G.encrypted.byteOffset,G.encrypted.byteLength),se=new Uint32Array(G.key.bytes,G.key.byteOffset,G.key.byteLength/4),pe=new Uint32Array(G.iv.bytes,G.iv.byteOffset,G.iv.byteLength/4);new l(H,se,pe,function(ae,_e){self.postMessage(T({source:G.source,decrypted:_e}),[_e.buffer])})}})));let hh=(s,t)=>{s.abort(),s.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)},ph=(s,t)=>{(t.activePlaylistLoader=s).load()},Ea={AUDIO:(s,t)=>()=>{var{mediaTypes:{[s]:i},excludePlaylist:a}=t,o=i.activeTrack(),l=i.activeGroup(),l=(l.filter(B=>B.default)[0]||l[0]).id,h=i.tracks[l];if(o===h)a({error:{message:"Problem encountered loading the default audio track."}});else{for(var T in He.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),i.tracks)i.tracks[T].enabled=i.tracks[T]===h;i.onTrackChanged()}},SUBTITLES:(s,t)=>()=>{var{[s]:i}=t.mediaTypes,a=(He.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),i.activeTrack());a&&(a.mode="disabled"),i.onTrackChanged()}},fh={AUDIO:(s,t,i)=>{if(!t)return;let{tech:a,requestOptions:o,segmentLoaders:{[s]:l}}=i;t.on("loadedmetadata",()=>{var h=t.media();l.playlist(h,o),(!a.paused()||h.endList&&a.preload()!=="none")&&l.load()}),t.on("loadedplaylist",()=>{l.playlist(t.media(),o),a.paused()||l.load()}),t.on("error",Ea[s](s,i))},SUBTITLES:(s,t,i)=>{let{tech:a,requestOptions:o,segmentLoaders:{[s]:l},mediaTypes:{[s]:h}}=i;t.on("loadedmetadata",()=>{var T=t.media();l.playlist(T,o),l.track(h.activeTrack()),(!a.paused()||T.endList&&a.preload()!=="none")&&l.load()}),t.on("loadedplaylist",()=>{l.playlist(t.media(),o),a.paused()||l.load()}),t.on("error",Ea[s](s,i))}},yg={AUDIO:(s,t)=>{var i,a,{vhs:o,sourceType:l,segmentLoaders:{[s]:h},requestOptions:T,main:{mediaGroups:B},mediaTypes:{[s]:{groups:G,tracks:H,logger_:se}},mainPlaylistLoader:pe}=t,ae=Cs(pe.main);for(i in B[s]&&Object.keys(B[s]).length!==0||(B[s]={main:{default:{default:!0}}},ae&&(B[s].main.default.playlists=pe.main.playlists)),B[s])for(var _e in G[i]||(G[i]=[]),B[s][i]){let Ce=B[s][i][_e],Le;Le=ae?(se(`AUDIO group '${i}' label '${_e}' is a main playlist`),Ce.isMainPlaylist=!0,null):l==="vhs-json"&&Ce.playlists?new Br(Ce.playlists[0],o,T):Ce.resolvedUri?new Br(Ce.resolvedUri,o,T):Ce.playlists&&l==="dash"?new fl(Ce.playlists[0],o,T,pe):null,Ce=Qt({id:_e,playlistLoader:Le},Ce),fh[s](s,Ce.playlistLoader,t),G[i].push(Ce),typeof H[_e]>"u"&&(a=new He.AudioTrack({id:_e,kind:(xe=>{let Pe=xe.default?"main":"alternative";return Pe=xe.characteristics&&0<=xe.characteristics.indexOf("public.accessibility.describes-video")?"main-desc":Pe})(Ce),enabled:!1,language:Ce.language,default:Ce.default,label:_e}),H[_e]=a)}h.on("error",Ea[s](s,t))},SUBTITLES:(s,t)=>{var i,a,{tech:o,vhs:l,sourceType:h,segmentLoaders:{[s]:T},requestOptions:B,main:{mediaGroups:G},mediaTypes:{[s]:{groups:H,tracks:se}},mainPlaylistLoader:pe}=t;for(i in G[s])for(var ae in H[i]||(H[i]=[]),G[s][i])if(l.options_.useForcedSubtitles||!G[s][i][ae].forced){let _e=G[s][i][ae],Ce;if(h==="hls")Ce=new Br(_e.resolvedUri,l,B);else if(h==="dash"){if(!_e.playlists.filter(Le=>Le.excludeUntil!==1/0).length)return;Ce=new fl(_e.playlists[0],l,B,pe)}else h==="vhs-json"&&(Ce=new Br(_e.playlists?_e.playlists[0]:_e.resolvedUri,l,B));_e=Qt({id:ae,playlistLoader:Ce},_e),fh[s](s,_e.playlistLoader,t),H[i].push(_e),typeof se[ae]>"u"&&(a=o.addRemoteTextTrack({id:ae,kind:"subtitles",default:_e.default&&_e.autoselect,language:_e.language,label:ae},!1).track,se[ae]=a)}T.on("error",Ea[s](s,t))},"CLOSED-CAPTIONS":(s,t)=>{var i,{tech:a,main:{mediaGroups:o},mediaTypes:{[s]:{groups:l,tracks:h}}}=t;for(i in o[s])for(var T in l[i]||(l[i]=[]),o[s][i]){var B=o[s][i][T];if(/^(?:CC|SERVICE)/.test(B.instreamId)){var G=a.options_.vhs&&a.options_.vhs.captionServices||{};let H={label:T,language:B.language,instreamId:B.instreamId,default:B.default&&B.autoselect};(H=G[H.instreamId]?Qt(H,G[H.instreamId]):H).default===void 0&&delete H.default,l[i].push(Qt({id:T},B)),typeof h[T]>"u"&&(G=a.addRemoteTextTrack({id:H.instreamId,kind:"captions",default:H.default,language:H.language,label:H.label},!1).track,h[T]=G)}}}},mh=(s,t)=>{for(let i=0;i<s.length;i++)if(ul(t,s[i])||s[i].playlists&&mh(s[i].playlists,t))return!0;return!1},vg={AUDIO:(s,t)=>()=>{var i,{[s]:{tracks:a}}=t.mediaTypes;for(i in a)if(a[i].enabled)return a[i];return null},SUBTITLES:(s,t)=>()=>{var i,{[s]:{tracks:a}}=t.mediaTypes;for(i in a)if(a[i].mode==="showing"||a[i].mode==="hidden")return a[i];return null}},bg=s=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(H=>{yg[H](H,s)});let{mediaTypes:t,mainPlaylistLoader:i,tech:a,vhs:o,segmentLoaders:{AUDIO:l,main:h}}=s;["AUDIO","SUBTITLES"].forEach(H=>{var se,pe,ae,_e,Ce,Le,xe,Pe,Ae,st;t[H].activeGroup=(se=H,pe=s,Ue=>{var{mainPlaylistLoader:ft,mediaTypes:{[se]:{groups:Et}}}=pe,dt=ft.media();if(!dt)return null;let Ot=null;dt.attributes[se]&&(Ot=Et[dt.attributes[se]]);var Ct=Object.keys(Et);if(!Ot)if(se==="AUDIO"&&1<Ct.length&&Cs(pe.main))for(let jt=0;jt<Ct.length;jt++){var Lt=Et[Ct[jt]];if(mh(Lt,dt)){Ot=Lt;break}}else Et.main?Ot=Et.main:Ct.length===1&&(Ot=Et[Ct[0]]);return typeof Ue>"u"?Ot:Ue!==null&&Ot&&Ot.filter(jt=>jt.id===Ue.id)[0]||null}),t[H].activeTrack=vg[H](H,s),t[H].onGroupChanged=(ae=H,_e=s,()=>{var{segmentLoaders:{[ae]:Ue,main:ft},mediaTypes:{[ae]:Et}}=_e,dt=Et.activeTrack(),Ot=Et.getActiveGroup(),Ct=Et.activePlaylistLoader,Lt=Et.lastGroup_;Ot&&Lt&&Ot.id===Lt.id||(Et.lastGroup_=Ot,Et.lastTrack_=dt,hh(Ue,Et),Ot&&!Ot.isMainPlaylist&&(Ot.playlistLoader?(Ue.resyncLoader(),ph(Ot.playlistLoader,Et)):Ct&&ft.resetEverything()))}),t[H].onGroupChanging=(Ce=H,Le=s,()=>{var{segmentLoaders:{[Ce]:Ue},mediaTypes:{[Ce]:ft}}=Le;ft.lastGroup_=null,Ue.abort(),Ue.pause()}),t[H].onTrackChanged=(xe=H,Pe=s,()=>{var Ue,ft,{mainPlaylistLoader:Et,segmentLoaders:{[xe]:dt,main:Ot},mediaTypes:{[xe]:Ct}}=Pe,Lt=Ct.activeTrack(),jt=Ct.getActiveGroup(),xt=Ct.activePlaylistLoader,Zt=Ct.lastTrack_;if((!Zt||!Lt||Zt.id!==Lt.id)&&(Ct.lastGroup_=jt,Ct.lastTrack_=Lt,hh(dt,Ct),jt)){if(jt.isMainPlaylist)return!Lt||!Zt||Lt.id===Zt.id||(ft=(Ue=Pe.vhs.playlistController_).selectPlaylist(),Ue.media()===ft)?void 0:(Ct.logger_(`track change. Switching main audio from ${Zt.id} to `+Lt.id),Et.pause(),Ot.resetEverything(),void Ue.fastQualityChange_(ft));if(xe==="AUDIO"){if(!jt.playlistLoader)return Ot.setAudio(!0),void Ot.resetEverything();dt.setAudio(!0),Ot.setAudio(!1)}xt===jt.playlistLoader||(dt.track&&dt.track(Lt),dt.resetEverything()),ph(jt.playlistLoader,Ct)}}),t[H].getActiveGroup=([Ae,st]=[H,s.mediaTypes],()=>{var Ue=st[Ae].activeTrack();return Ue?st[Ae].activeGroup(Ue):null})});var T,B=t.AUDIO.activeGroup();B&&(B=(B.filter(H=>H.default)[0]||B[0]).id,t.AUDIO.tracks[B].enabled=!0,t.AUDIO.onGroupChanged(),t.AUDIO.onTrackChanged(),(t.AUDIO.getActiveGroup().playlistLoader?(h.setAudio(!1),l):h).setAudio(!0)),i.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(H=>t[H].onGroupChanged())}),i.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(H=>t[H].onGroupChanging())});let G=()=>{t.AUDIO.onTrackChanged(),a.trigger({type:"usage",name:"vhs-audio-change"})};for(T in a.audioTracks().addEventListener("change",G),a.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged),o.on("dispose",()=>{a.audioTracks().removeEventListener("change",G),a.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)}),a.clearTracks("audio"),t.AUDIO.tracks)a.audioTracks().addTrack(t.AUDIO.tracks[T])};class gh{constructor(){this.priority_=[],this.pathwayClones_=new Map}set version(t){t===1&&(this.version_=t)}set ttl(t){this.ttl_=t||300}set reloadUri(t){t&&(this.reloadUri_=en(this.reloadUri_,t))}set priority(t){t&&t.length&&(this.priority_=t)}set pathwayClones(t){t&&t.length&&(this.pathwayClones_=new Map(t.map(i=>[i.ID,i])))}get version(){return this.version_}get ttl(){return this.ttl_}get reloadUri(){return this.reloadUri_}get priority(){return this.priority_}get pathwayClones(){return this.pathwayClones_}}class _g extends He.EventTarget{constructor(t,i){super(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=!1,this.availablePathways_=new Set,this.steeringManifest=new gh,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.currentPathwayClones=new Map,this.nextPathwayClones=new Map,this.excludedSteeringManifestURLs=new Set,this.logger_=un("Content Steering"),this.xhr_=t,this.getBandwidth_=i}assignTagProperties(t,i){this.manifestType_=i.serverUri?"HLS":"DASH";var a=i.serverUri||i.serverURL;a?a.startsWith("data:")?this.decodeDataUriManifest_(a.substring(a.indexOf(",")+1)):(this.steeringManifest.reloadUri=en(t,a),this.defaultPathway=i.pathwayId||i.defaultServiceLocation,this.queryBeforeStart=i.queryBeforeStart,this.proxyServerUrl_=i.proxyServerURL,this.defaultPathway&&!this.queryBeforeStart&&this.trigger("content-steering")):(this.logger_(`steering manifest URL is ${a}, cannot request steering manifest.`),this.trigger("error"))}requestSteeringManifest(t){var i=this.steeringManifest.reloadUri;if(i){let a=t?i:this.getRequestURI(i);if(a){let o={contentSteeringInfo:{uri:a}};this.trigger({type:"contentsteeringloadstart",metadata:o}),this.request_=this.xhr_({uri:a,requestType:"content-steering-manifest"},(l,h)=>{if(l)return h.status===410?(this.logger_(`manifest request 410 ${l}.`),this.logger_(`There will be no more content steering requests to ${a} this session.`),void this.excludedSteeringManifestURLs.add(a)):h.status===429?(h=h.responseHeaders["retry-after"],this.logger_(`manifest request 429 ${l}.`),this.logger_(`content steering will retry in ${h} seconds.`),void this.startTTLTimeout_(parseInt(h,10))):(this.logger_(`manifest failed to load ${l}.`),void this.startTTLTimeout_());this.trigger({type:"contentsteeringloadcomplete",metadata:o});let T;try{T=JSON.parse(this.request_.responseText)}catch(B){h={errorType:He.Error.StreamingContentSteeringParserError,error:B},this.trigger({type:"error",metadata:h})}this.assignSteeringProperties_(T),l={contentSteeringInfo:o.contentSteeringInfo,contentSteeringManifest:{version:this.steeringManifest.version,reloadUri:this.steeringManifest.reloadUri,priority:this.steeringManifest.priority}},this.trigger({type:"contentsteeringparsed",metadata:l}),this.startTTLTimeout_()})}else this.logger_("No valid content steering manifest URIs. Stopping content steering."),this.trigger("error"),this.dispose()}}setProxyServerUrl_(i){var i=new window.URL(i),a=new window.URL(this.proxyServerUrl_);return a.searchParams.set("url",encodeURI(i.toString())),this.setSteeringParams_(a.toString())}decodeDataUriManifest_(t){t=JSON.parse(window.atob(t)),this.assignSteeringProperties_(t)}setSteeringParams_(a){var i,a=new window.URL(a),o=this.getPathway(),l=this.getBandwidth_();return o&&(i=`_${this.manifestType_}_pathway`,a.searchParams.set(i,o)),l&&(i=`_${this.manifestType_}_throughput`,a.searchParams.set(i,l)),a.toString()}assignSteeringProperties_(t){var i;this.steeringManifest.version=t.VERSION,this.steeringManifest.version?(this.steeringManifest.ttl=t.TTL,this.steeringManifest.reloadUri=t["RELOAD-URI"],this.steeringManifest.priority=t["PATHWAY-PRIORITY"]||t["SERVICE-LOCATION-PRIORITY"],this.steeringManifest.pathwayClones=t["PATHWAY-CLONES"],this.nextPathwayClones=this.steeringManifest.pathwayClones,this.availablePathways_.size||(this.logger_("There are no available pathways for content steering. Ending content steering."),this.trigger("error"),this.dispose()),i=(a=>{for(var o of a)if(this.availablePathways_.has(o))return o;return[...this.availablePathways_][0]})(this.steeringManifest.priority),this.currentPathway!==i&&(this.currentPathway=i,this.trigger("content-steering"))):(this.logger_(`manifest version is ${t.VERSION}, which is not supported.`),this.trigger("error"))}getPathway(){return this.currentPathway||this.defaultPathway}getRequestURI(t){if(!t)return null;var i=o=>this.excludedSteeringManifestURLs.has(o);if(this.proxyServerUrl_){var a=this.setProxyServerUrl_(t);if(!i(a))return a}return a=this.setSteeringParams_(t),i(a)?null:a}startTTLTimeout_(t=this.steeringManifest.ttl){this.ttlTimeout_=window.setTimeout(()=>{this.requestSteeringManifest()},1e3*t)}clearTTLTimeout_(){window.clearTimeout(this.ttlTimeout_),this.ttlTimeout_=null}abort(){this.request_&&this.request_.abort(),this.request_=null}dispose(){this.off("content-steering"),this.off("error"),this.abort(),this.clearTTLTimeout_(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=null,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.excludedSteeringManifestURLs=new Set,this.availablePathways_=new Set,this.steeringManifest=new gh}addAvailablePathway(t){t&&this.availablePathways_.add(t)}clearAvailablePathways(){this.availablePathways_.clear()}excludePathway(t){return this.availablePathways_.delete(t)}didDASHTagChange(t,i){return!i&&this.steeringManifest.reloadUri||i&&(en(t,i.serverURL)!==this.steeringManifest.reloadUri||i.defaultServiceLocation!==this.defaultPathway||i.queryBeforeStart!==this.queryBeforeStart||i.proxyServerURL!==this.proxyServerUrl_)}getAvailablePathways(){return this.availablePathways_}}let qn,Tg=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"];class Sg extends He.EventTarget{constructor(t){super(),this.fastQualityChange_=((Pe,Ae)=>{let st=null;return(...Ue)=>{clearTimeout(st),st=setTimeout(()=>{Pe.apply(null,Ue)},Ae)}})(this.fastQualityChange_.bind(this),100);let{src:i,withCredentials:a,tech:o,bandwidth:l,externVhs:h,useCueTags:T,playlistExclusionDuration:B,enableLowInitialPlaylist:G,sourceType:H,cacheEncryptionKeys:se,bufferBasedABR:pe,leastPixelDiffSelector:ae,captionServices:_e,experimentalUseMMS:Ce}=t;if(!i)throw new Error("A non-empty playlist URL or JSON manifest string is required");let Le=t.maxPlaylistRetries;Le!==null&&typeof Le<"u"||(Le=1/0),qn=h,this.bufferBasedABR=!!pe,this.leastPixelDiffSelector=!!ae,this.withCredentials=a,this.tech_=o,this.vhs_=o.vhs,this.player_=t.player_,this.sourceType_=H,this.useCueTags_=T,this.playlistExclusionDuration=B,this.maxPlaylistRetries=Le,this.enableLowInitialPlaylist=G,this.usingManagedMediaSource_=!1,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:a,maxPlaylistRetries:Le,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=(()=>{let Pe={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(Ae=>{Pe[Ae]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Ln,activeTrack:Ln,getActiveGroup:Ln,onGroupChanged:Ln,onTrackChanged:Ln,lastTrack_:null,logger_:un(`MediaGroups[${Ae}]`)}}),Pe})(),Ce&&window.ManagedMediaSource?(this.tech_.el_.disableRemotePlayback=!0,this.mediaSource=new window.ManagedMediaSource,this.usingManagedMediaSource_=!0,He.log("Using ManagedMediaSource")):window.MediaSource&&(this.mediaSource=new window.MediaSource),this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.load=this.load.bind(this),this.pause=this.pause.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.mediaSource.addEventListener("startstreaming",this.load),this.mediaSource.addEventListener("endstreaming",this.pause),this.seekable_=zi(),this.hasPlayed_=!1,this.syncController_=new fg(t),this.segmentMetadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.decrypter_=new gg,this.sourceUpdater_=new ah(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new mg,this.keyStatusMap_=new Map;var xe={vhs:this.vhs_,parse708captions:t.parse708captions,useDtsForTimestampOffset:t.useDtsForTimestampOffset,captionServices:_e,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:l,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:se,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:t.exactManifestTimings,addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)},xe=(this.mainPlaylistLoader_=this.sourceType_==="dash"?new fl(i,this.vhs_,Qt(this.requestOptions_,{addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)})):new Br(i,this.vhs_,Qt(this.requestOptions_,{addDateRangesToTextTrack:this.addDateRangesToTextTrack_.bind(this)})),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new _l(Qt(xe,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),t),this.audioSegmentLoader_=new _l(Qt(xe,{loaderType:"audio"}),t),this.subtitleSegmentLoader_=new hg(Qt(xe,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise((Pe,Ae)=>{function st(){o.off("vttjserror",Ue),Pe()}function Ue(){o.off("vttjsloaded",st),Ae()}o.one("vttjsloaded",st),o.one("vttjserror",Ue),o.addWebVttScript_()})}),t),this.contentSteeringController_=new _g(this.vhs_.xhr,()=>this.mainSegmentLoader_.bandwidth),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_())),Tg.forEach(Pe=>{this[Pe+"_"]=(function(Ae){return this.audioSegmentLoader_[Ae]+this.mainSegmentLoader_[Ae]}).bind(this,Pe)}),this.logger_=un("pc"),this.triggeredFmp4Usage=!1,this.tech_.preload()==="none"?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1,this.tech_.preload()==="none"?"play":"loadstart");this.tech_.one(xe,()=>{let Pe=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-Pe,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){var t=this.mainAppendsToLoadedData_(),i=this.audioAppendsToLoadedData_();return t===-1||i===-1?-1:t+i}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(t="abr"){var i=this.selectPlaylist();i&&this.shouldSwitchToMedia_(i)&&this.switchMedia_(i,t)}switchMedia_(t,i,a){var o=this.media(),o=o&&(o.id||o.uri),l=t&&(t.id||t.uri);o&&o!==l&&(this.logger_(`switch media ${o} -> ${l} from `+i),o={renditionInfo:{id:l,bandwidth:t.attributes.BANDWIDTH,resolution:t.attributes.RESOLUTION,codecs:t.attributes.CODECS},cause:i},this.trigger({type:"renditionselected",metadata:o}),this.tech_.trigger({type:"usage",name:"vhs-rendition-change-"+i})),this.mainPlaylistLoader_.media(t,a)}switchMediaForDASHContentSteering_(){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(t=>{var i=this.mediaTypes_[t],i=i?i.activeGroup():null;let a=this.contentSteeringController_.getPathway();i&&a&&(i=(i.length?i[0]:i).playlists.filter(o=>o.attributes.serviceLocation===a)).length&&this.mediaTypes_[t].activePlaylistLoader.media(i[0])})}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=window.setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(window.clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){var t=this.main(),i=t&&t.playlists||[];if(!t||!t.mediaGroups||!t.mediaGroups.AUDIO)return i;var a=t.mediaGroups.AUDIO,o=Object.keys(a);let l;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)l=this.mediaTypes_.AUDIO.activeTrack();else{var h,T=a.main||o.length&&a[o[0]];for(h in T)if(T[h].default){l={label:h};break}}if(!l)return i;var B,G=[];for(B in a)if(a[B][l.label]){var H=a[B][l.label];if(H.playlists&&H.playlists.length)G.push.apply(G,H.playlists);else if(H.uri)G.push(H);else if(t.playlists.length)for(let pe=0;pe<t.playlists.length;pe++){var se=t.playlists[pe];se.attributes&&se.attributes.AUDIO&&se.attributes.AUDIO===B&&G.push(se)}}return G.length?G:i}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{var t=this.mainPlaylistLoader_.media(),i=1.5*t.targetDuration*1e3;ll(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,t.endList&&this.tech_.preload()!=="none"&&(this.mainSegmentLoader_.playlist(t,this.requestOptions_),this.mainSegmentLoader_.load()),bg({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),t),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})}),this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let t=this.mainPlaylistLoader_.media();if(!t){this.attachContentSteeringListeners_(),this.initContentSteeringController_(),this.excludeUnsupportedVariants_();let i;if(!(i=(i=this.enableLowInitialPlaylist?this.selectInitialPlaylist():i)||this.selectPlaylist())||!this.shouldSwitchToMedia_(i)||(this.initialMedia_=i,this.switchMedia_(this.initialMedia_,"initial"),!(this.sourceType_==="vhs-json"&&this.initialMedia_.segments)))return;t=this.initialMedia_}this.handleUpdatedMediaPlaylist(t)}),this.mainPlaylistLoader_.on("error",()=>{var t=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:t.playlist,error:t})}),this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()}),this.mainPlaylistLoader_.on("mediachange",()=>{var t=this.mainPlaylistLoader_.media(),i=1.5*t.targetDuration*1e3;ll(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,this.sourceType_==="dash"&&this.mainPlaylistLoader_.isPaused&&this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(t,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_?this.runFastQualitySwitch_():this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainPlaylistLoader_.on("playlistunchanged",()=>{var t=this.mainPlaylistLoader_.media();t.lastExcludeReason_!=="playlist-unchanged"&&this.stuckAtPlaylistEnd_(t)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))}),this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})}),this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})}),["manifestrequeststart","manifestrequestcomplete","manifestparsestart","manifestparsecomplete","playlistrequeststart","playlistrequestcomplete","playlistparsestart","playlistparsecomplete","renditiondisabled","renditionenabled"].forEach(t=>{this.mainPlaylistLoader_.on(t,i=>{this.player_.trigger(Ii({},i))})})}handleUpdatedMediaPlaylist(t){this.useCueTags_&&this.updateAdCues_(t),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(t,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_&&this.runFastQualitySwitch_(),this.updateDuration(!t.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(h,i){var a=h.mediaGroups||{};let o=!0;var l,h=Object.keys(a.AUDIO);for(l in a.AUDIO)for(var T in a.AUDIO[l])a.AUDIO[l][T].uri||(o=!1);o&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(a.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),qn.Playlist.isAes(i)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),h.length&&1<Object.keys(a.AUDIO[h[0]]).length&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(t){var i=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,a=this.tech_.currentTime(),o=this.bufferLowWaterLine(),l=this.bufferHighWaterLine();return function({currentPlaylist:h,buffered:T,currentTime:B,nextPlaylist:G,bufferLowWaterLine:H,bufferHighWaterLine:se,duration:pe,bufferBasedABR:ae,log:_e}){if(G){var Ce=`allowing switch ${h&&h.id||"null"} -> `+G.id;if(!h)return _e(Ce+" as current playlist is not set"),!0;if(G.id!==h.id){var Le=!!Mr(T,B).length;if(!h.endList)return Le||typeof h.partTargetDuration!="number"?(_e(Ce+" as current playlist is live"),!0):(_e(`not ${Ce} as current playlist is live llhls, but currentTime isn't in buffered.`),!1);if(Le=rl(T,B),T=ae?Mi.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Mi.MAX_BUFFER_LOW_WATER_LINE,pe<T)return _e(Ce+` as duration < max low water line (${pe} < ${T})`),!0;if(B=G.attributes.BANDWIDTH,pe=h.attributes.BANDWIDTH,B<pe&&(!ae||Le<se)){let xe=Ce+` as next bandwidth < current bandwidth (${B} < ${pe})`;return ae&&(xe+=` and forwardBuffer < bufferHighWaterLine (${Le} < ${se})`),_e(xe),!0}if((!ae||pe<B)&&H<=Le){let xe=Ce+` as forwardBuffer >= bufferLowWaterLine (${Le} >= ${H})`;return ae&&(xe+=` and next bandwidth > current bandwidth (${B} > ${pe})`),_e(xe),!0}_e(`not ${Ce} as no switching criteria met`)}}else He.log.warn("We received no playlist to switch to. Please check your stream.");return!1}({buffered:this.tech_.buffered(),currentTime:a,currentPlaylist:i,nextPlaylist:t,bufferLowWaterLine:o,bufferHighWaterLine:l,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()}),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")}),this.mainSegmentLoader_.on("error",()=>{var i=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:i.playlist,error:i})}),this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended"),this.onEndOfStream()}),this.timelineChangeController_.on("audioTimelineBehind",()=>{var i=this.audioSegmentLoader_.pendingSegment_;i&&i.segment&&i.segment.syncInfo&&(i=i.segment.syncInfo.end+.01,this.tech_.setCurrentTime(i))}),this.timelineChangeController_.on("fixBadTimelineChange",()=>{this.logger_("Fix bad timeline change. Restarting al segment loaders..."),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}),this.mainSegmentLoader_.on("earlyabort",i=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:10}))});var t=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();var i=this.getCodecsOrExclude_();i&&this.sourceUpdater_.addOrChangeSourceBuffers(i)};this.mainSegmentLoader_.on("trackinfo",t),this.audioSegmentLoader_.on("trackinfo",t),this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()}),["segmentselected","segmentloadstart","segmentloaded","segmentkeyloadstart","segmentkeyloadcomplete","segmentdecryptionstart","segmentdecryptioncomplete","segmenttransmuxingstart","segmenttransmuxingcomplete","segmenttransmuxingtrackinfoavailable","segmenttransmuxingtiminginfoavailable","segmentappendstart","appendsdone","bandwidthupdated","timelinechange","codecschange"].forEach(i=>{this.mainSegmentLoader_.on(i,a=>{this.player_.trigger(Ii({},a))}),this.audioSegmentLoader_.on(i,a=>{this.player_.trigger(Ii({},a))}),this.subtitleSegmentLoader_.on(i,a=>{this.player_.trigger(Ii({},a))})})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}pause(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}fastQualityChange_(t=this.selectPlaylist()){t&&t===this.mainPlaylistLoader_.media()?this.logger_("skipping fastQualityChange because new media is same as old"):(this.switchMedia_(t,"fast-quality"),this.waitingForFastQualityPlaylistReceived_=!0)}runFastQualitySwitch_(){this.waitingForFastQualityPlaylistReceived_=!1,this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}play(){var t;if(!this.setupFirstPlay())return this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load(),t=this.tech_.seekable(),this.tech_.duration()===1/0&&this.tech_.currentTime()<t.start(0)?this.tech_.setCurrentTime(t.end(t.length-1)):void 0}setupFirstPlay(){var t=this.mainPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_)return!1;if(!t.endList||t.start){var i=this.seekable();if(!i.length)return!1;var a=i.end(0);let o=a;t.start&&(t=t.start.timeOffset,o=t<0?Math.max(a+t,i.start(0)):Math.min(a,t)),this.trigger("firstplay"),this.tech_.setCurrentTime(o)}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){var t;this.tryToCreateSourceBuffers_(),this.tech_.autoplay()&&typeof(t=this.tech_.play())<"u"&&typeof t.then=="function"&&t.then(null,i=>{}),this.trigger("sourceopen")}handleSourceEnded_(){var t,i;this.inbandTextTracks_.metadataTrack_&&(t=this.inbandTextTracks_.metadataTrack_.cues)&&t.length&&(i=this.duration(),t[t.length-1].endTime=isNaN(i)||Math.abs(i)===1/0?Number.MAX_VALUE:i)}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let t=this.mainSegmentLoader_.ended_;var i;this.mediaTypes_.AUDIO.activePlaylistLoader&&(i=this.mainSegmentLoader_.getCurrentMediaInfo_(),t=(i&&!i.hasVideo||t)&&this.audioSegmentLoader_.ended_),t&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(t){var i,a;return!!this.seekable().length&&(i=this.syncController_.getExpiredTime(t,this.duration()))!==null&&(t=qn.Playlist.playlistEnd(t,i),i=this.tech_.currentTime(),(a=this.tech_.buffered()).length?(a=a.end(a.length-1))-i<=Cn&&t-a<=Cn:t-i<=Cn)}excludePlaylist({playlistToExclude:t=this.mainPlaylistLoader_.media(),error:i={},playlistExclusionDuration:a}){if(t=t||this.mainPlaylistLoader_.media(),a=a||i.playlistExclusionDuration||this.playlistExclusionDuration,t){t.playlistErrors_++;var o=this.mainPlaylistLoader_.main.playlists,l=o.filter(_a),l=l.length===1&&l[0]===t;if(o.length===1&&a!==1/0)return He.log.warn(`Problem encountered with playlist ${t.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(l);if(l){if(this.main().contentSteering){let G=this.pathwayAttribute_(t);var h=1e3*this.contentSteeringController_.steeringManifest.ttl;return this.contentSteeringController_.excludePathway(G),this.excludeThenChangePathway_(),void setTimeout(()=>{this.contentSteeringController_.addAvailablePathway(G)},h)}let B=!1;o.forEach(G=>{var H;G!==t&&typeof(H=G.excludeUntil)<"u"&&H!==1/0&&(B=!0,delete G.excludeUntil)}),B&&(He.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let T;if(T=t.playlistErrors_>this.maxPlaylistRetries?1/0:Date.now()+1e3*a,t.excludeUntil=T,i.reason&&(t.lastExcludeReason_=i.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"}),h=this.selectPlaylist(),h)return(i.internal?this.logger_:He.log.warn)(`${i.internal?"Internal problem":"Problem"} encountered with playlist ${t.id}.`+(i.message?" "+i.message:"")+` Switching to playlist ${h.id}.`),h.attributes.AUDIO!==t.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),h.attributes.SUBTITLES!==t.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]),o=h.targetDuration/2*1e3||5e3,a=typeof h.lastRequest=="number"&&Date.now()-h.lastRequest<=o,this.switchMedia_(h,"exclude",l||a);this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error")}else this.error=i,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network")}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(t,i){let a=[];var o=t==="all",l=(!o&&t!=="main"||a.push(this.mainPlaylistLoader_),[]);!o&&t!=="audio"||l.push("AUDIO"),!o&&t!=="subtitle"||(l.push("CLOSED-CAPTIONS"),l.push("SUBTITLES")),l.forEach(h=>{h=this.mediaTypes_[h]&&this.mediaTypes_[h].activePlaylistLoader,h&&a.push(h)}),["main","audio","subtitle"].forEach(h=>{var T=this[h+"SegmentLoader_"];!T||t!==h&&t!=="all"||a.push(T)}),a.forEach(h=>i.forEach(T=>{typeof h[T]=="function"&&h[T]()}))}setCurrentTime(t){var i=Mr(this.tech_.buffered(),t);return this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media()&&this.mainPlaylistLoader_.media().segments?i&&i.length?t:(this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),void this.load()):0}duration(){var t;return this.mainPlaylistLoader_&&(t=this.mainPlaylistLoader_.media())?t.endList?this.mediaSource?this.mediaSource.duration:qn.Playlist.duration(t):1/0:0}seekable(){return this.seekable_}getSeekableRange_(l,i){var a,o,l=l.media();return l?(i=this.syncController_.getMediaSequenceSync(i))&&i.isReliable?(o=i.start,i=i.end,!isFinite(o)||!isFinite(i)||(a=qn.Playlist.liveEdgeDelay(this.mainPlaylistLoader_.main,l),(i=Math.max(0,i-a))<o)?null:zi([[o,i]])):(a=this.syncController_.getExpiredTime(l,this.duration()))!==null&&(o=qn.Playlist.seekable(l,a,qn.Playlist.liveEdgeDelay(this.mainPlaylistLoader_.main,l))).length?o:null:null}computeFinalSeekable_(t,i){var a,o,l;return!i||(a=t.start(0),o=t.end(0),l=i.start(0),i=i.end(0),o<l)||i<a?t:zi([[Math.max(a,l),Math.min(o,i)]])}onSyncInfoUpdate_(){if(this.mainPlaylistLoader_){var t,i=this.getSeekableRange_(this.mainPlaylistLoader_,"main");if(i){let a;this.mediaTypes_.AUDIO.activePlaylistLoader&&!(a=this.getSeekableRange_(this.mediaTypes_.AUDIO.activePlaylistLoader,"audio"))||(t=this.seekable_,this.seekable_=this.computeFinalSeekable_(i,a),!this.seekable_)||t&&t.length&&this.seekable_.length&&t.start(0)===this.seekable_.start(0)&&t.end(0)===this.seekable_.end(0)||(this.logger_(`seekable updated [${oc(this.seekable_)}]`),i={seekableRanges:this.seekable_},this.trigger({type:"seekablerangeschanged",metadata:i}),this.tech_.trigger("seekablechanged"))}}}updateDuration(t){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open")this.updateDuration_=this.updateDuration.bind(this,t),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);else{if(t)return(t=this.seekable()).length?void((isNaN(this.mediaSource.duration)||this.mediaSource.duration<t.end(t.length-1))&&this.sourceUpdater_.setDuration(t.end(t.length-1))):void 0;t=this.tech_.buffered();let i=qn.Playlist.duration(this.mainPlaylistLoader_.media());0<t.length&&(i=Math.max(i,t.end(t.length-1))),this.mediaSource.duration!==i&&this.sourceUpdater_.setDuration(i)}}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.contentSteeringController_.dispose(),this.keyStatusMap_.clear(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(t=>{var i,a=this.mediaTypes_[t].groups;for(i in a)a[i].forEach(o=>{o.playlistLoader&&o.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){var i=!!this.mediaTypes_.AUDIO.activePlaylistLoader,t=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),i=!i||!!this.audioSegmentLoader_.getCurrentMediaInfo_();return t&&i}getCodecsOrExclude_(){let t={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},i=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();t.video=t.main;var a=xs(this.main(),i);let o={};var l=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(t.main.hasVideo&&(o.video=a.video||t.main.videoCodec||"avc1.4d400d"),t.main.isMuxed&&(o.video+=","+(a.audio||t.main.audioCodec||ld)),(t.main.hasAudio&&!t.main.isMuxed||t.audio.hasAudio||l)&&(o.audio=a.audio||t.main.audioCodec||t.audio.audioCodec||ld,t.audio.isFmp4=(t.main.hasAudio&&!t.main.isMuxed?t.main:t.audio).isFmp4),o.audio||o.video){let h=(G,H)=>G?us(H,this.usingManagedMediaSource_):Lo(H),T={},B;if(["video","audio"].forEach(function(G){var H;o.hasOwnProperty(G)&&!h(t[G].isFmp4,o[G])&&(H=t[G].isFmp4?"browser":"muxer",T[H]=T[H]||[],T[H].push(o[G]),G==="audio")&&(B=H)}),l&&B&&i.attributes.AUDIO){let G=i.attributes.AUDIO;this.main().playlists.forEach(H=>{(H.attributes&&H.attributes.AUDIO)===G&&H!==i&&(H.excludeUntil=1/0)}),this.logger_(`excluding audio group ${G} as ${B} does not support codec(s): "${o.audio}"`)}if(!Object.keys(T).length){if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){let G=[];if(["video","audio"].forEach(H=>{var se=(Tn(this.sourceUpdater_.codecs[H]||"")[0]||{}).type,pe=(Tn(o[H]||"")[0]||{}).type;se&&pe&&se.toLowerCase()!==pe.toLowerCase()&&G.push(`"${this.sourceUpdater_.codecs[H]}" -> "${o[H]}"`)}),G.length)return void this.excludePlaylist({playlistToExclude:i,error:{message:`Codec switching not supported: ${G.join(", ")}.`,internal:!0},playlistExclusionDuration:1/0})}return o}a=Object.keys(T).reduce((G,H)=>(G&&(G+=", "),G+=`${H} does not support codec(s): "${T[H].join(",")}"`),"")+".",this.excludePlaylist({playlistToExclude:i,error:{internal:!0,message:a},playlistExclusionDuration:1/0})}else this.excludePlaylist({playlistToExclude:i,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:1/0})}tryToCreateSourceBuffers_(){var t;this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()||this.areMediaTypesKnown_()&&(t=this.getCodecsOrExclude_())&&(this.sourceUpdater_.createSourceBuffers(t),t=[t.video,t.audio].filter(Boolean).join(","),this.excludeIncompatibleVariants_(t))}excludeUnsupportedVariants_(){let t=this.main().playlists,i=[];Object.keys(t).forEach(h=>{var o,l,h=t[h];i.indexOf(h.id)===-1&&(i.push(h.id),l=[],!(o=xs(this.main,h)).audio||Lo(o.audio)||us(o.audio,this.usingManagedMediaSource_)||l.push("audio codec "+o.audio),!o.video||Lo(o.video)||us(o.video,this.usingManagedMediaSource_)||l.push("video codec "+o.video),o.text&&o.text==="stpp.ttml.im1t"&&l.push("text codec "+o.text),l.length)&&(h.excludeUntil=1/0,this.logger_(`excluding ${h.id} for unsupported: `+l.join(", ")))})}excludeIncompatibleVariants_(t){let i=[],a=this.main().playlists;t=wa(Tn(t));let o=Hc(t),l=t.video&&Tn(t.video)[0]||null,h=t.audio&&Tn(t.audio)[0]||null;Object.keys(a).forEach(se=>{var B,G,H,se=a[se];i.indexOf(se.id)===-1&&se.excludeUntil!==1/0&&(i.push(se.id),B=[],H=xs(this.mainPlaylistLoader_.main,se),G=Hc(H),H.audio||H.video)&&(G!==o&&B.push(`codec count "${G}" !== "${o}"`),this.sourceUpdater_.canChangeType()||(G=H.video&&Tn(H.video)[0]||null,H=H.audio&&Tn(H.audio)[0]||null,G&&l&&G.type.toLowerCase()!==l.type.toLowerCase()&&B.push(`video codec "${G.type}" !== "${l.type}"`),H&&h&&H.type.toLowerCase()!==h.type.toLowerCase()&&B.push(`audio codec "${H.type}" !== "${h.type}"`)),B.length)&&(se.excludeUntil=1/0,this.logger_(`excluding ${se.id}: `+B.join(" && ")))})}updateAdCues_(t){let i=0;var a=this.seekable();a.length&&(i=a.start(0)),function(o,l,h=0){if(o.segments){let H=h,se;for(let pe=0;pe<o.segments.length;pe++){var T,B,G=o.segments[pe];if(se=se||function(ae,_e){var Ce=ae.cues;for(let xe=0;xe<Ce.length;xe++){var Le=Ce[xe];if(_e>=Le.adStartTime&&_e<=Le.adEndTime)return Le}return null}(l,H+G.duration/2)){if("cueIn"in G){se.endTime=H,se.adEndTime=H,H+=G.duration,se=null;continue}if(H<se.endTime){H+=G.duration;continue}se.endTime+=G.duration}else"cueOut"in G&&((se=new window.VTTCue(H,H+G.duration,G.cueOut)).adStartTime=H,se.adEndTime=H+parseFloat(G.cueOut),l.addCue(se)),"cueOutCont"in G&&([T,B]=G.cueOutCont.split("/").map(parseFloat),(se=new window.VTTCue(H,H+G.duration,"")).adStartTime=H-T,se.adEndTime=se.adStartTime+B,l.addCue(se));H+=G.duration}}}(t,this.cueTagsTrack_,i)}goalBufferLength(){var t=this.tech_.currentTime(),i=Mi.GOAL_BUFFER_LENGTH,a=Mi.GOAL_BUFFER_LENGTH_RATE,o=Math.max(i,Mi.MAX_GOAL_BUFFER_LENGTH);return Math.min(i+t*a,o)}bufferLowWaterLine(){var t=this.tech_.currentTime(),i=Mi.BUFFER_LOW_WATER_LINE,a=Mi.BUFFER_LOW_WATER_LINE_RATE,o=Math.max(i,Mi.MAX_BUFFER_LOW_WATER_LINE),l=Math.max(i,Mi.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(i+t*a,this.bufferBasedABR?l:o)}bufferHighWaterLine(){return Mi.BUFFER_HIGH_WATER_LINE}addDateRangesToTextTrack_(t){Jc(this.inbandTextTracks_,"com.apple.streaming",this.tech_),(({inbandTextTracks:i,dateRanges:a})=>{let o=i.metadataTrack_;if(o){let l=window.WebKitDataCue||window.VTTCue;a.forEach(h=>{for(var T of Object.keys(h)){var B;lg.has(T)||((B=new l(h.startTime,h.endTime,"")).id=h.id,B.type="com.apple.quicktime.HLS",B.value={key:og[T],data:h[T]},T!=="scte35Out"&&T!=="scte35In"||(B.value.data=new Uint8Array(B.value.data.match(/[\da-f]{2}/gi)).buffer),o.addCue(B))}h.processDateRange()})}})({inbandTextTracks:this.inbandTextTracks_,dateRanges:t})}addMetadataToTextTrack(t,i,a){var o=this.sourceUpdater_.videoBuffer?this.sourceUpdater_.videoTimestampOffset():this.sourceUpdater_.audioTimestampOffset();Jc(this.inbandTextTracks_,t,this.tech_),ag({inbandTextTracks:this.inbandTextTracks_,metadataArray:i,timestampOffset:o,videoDuration:a})}pathwayAttribute_(t){return t.attributes["PATHWAY-ID"]||t.attributes.serviceLocation}initContentSteeringController_(){var t=this.main();if(t.contentSteering){for(var i of t.playlists)this.contentSteeringController_.addAvailablePathway(this.pathwayAttribute_(i));this.contentSteeringController_.assignTagProperties(t.uri,t.contentSteering),this.contentSteeringController_.queryBeforeStart?this.contentSteeringController_.requestSteeringManifest(!0):this.tech_.one("canplay",()=>{this.contentSteeringController_.requestSteeringManifest()})}}resetContentSteeringController_(){this.contentSteeringController_.clearAvailablePathways(),this.contentSteeringController_.dispose(),this.initContentSteeringController_()}attachContentSteeringListeners_(){this.contentSteeringController_.on("content-steering",this.excludeThenChangePathway_.bind(this)),["contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"].forEach(t=>{this.contentSteeringController_.on(t,i=>{this.trigger(Ii({},i))})}),this.sourceType_==="dash"&&this.mainPlaylistLoader_.on("loadedplaylist",()=>{let t=this.main();(this.contentSteeringController_.didDASHTagChange(t.uri,t.contentSteering)||(()=>{var i,a=this.contentSteeringController_.getAvailablePathways(),o=[];for(i of t.playlists){var l=i.attributes.serviceLocation;if(l&&(o.push(l),!a.has(l)))return!0}return!(o.length||!a.size)})())&&this.resetContentSteeringController_()})}excludeThenChangePathway_(){let t=this.contentSteeringController_.getPathway();if(t){this.handlePathwayClones_();let i=this.main().playlists,a=new Set,o=!1;Object.keys(i).forEach(h=>{var h=i[h],T=this.pathwayAttribute_(h),T=T&&t!==T,B=(h.excludeUntil===1/0&&h.lastExcludeReason_==="content-steering"&&!T&&(delete h.excludeUntil,delete h.lastExcludeReason_,o=!0),!h.excludeUntil&&h.excludeUntil!==1/0);!a.has(h.id)&&T&&B&&(a.add(h.id),h.excludeUntil=1/0,h.lastExcludeReason_="content-steering",this.logger_(`excluding ${h.id} for `+h.lastExcludeReason_))}),this.contentSteeringController_.manifestType_==="DASH"&&Object.keys(this.mediaTypes_).forEach(h=>{var h=this.mediaTypes_[h];h.activePlaylistLoader&&(h=h.activePlaylistLoader.media_)&&h.attributes.serviceLocation!==t&&(o=!0)}),o&&this.changeSegmentPathway_()}}handlePathwayClones_(){var t=this.main().playlists,i=this.contentSteeringController_.currentPathwayClones,a=this.contentSteeringController_.nextPathwayClones;if(i&&i.size||a&&a.size){for(var[o,l]of i.entries())a.get(o)||(this.mainPlaylistLoader_.updateOrDeleteClone(l),this.contentSteeringController_.excludePathway(o));for(let[T,B]of a.entries()){var h=i.get(T);h?this.equalPathwayClones_(h,B)||(this.mainPlaylistLoader_.updateOrDeleteClone(B,!0),this.contentSteeringController_.addAvailablePathway(T)):(t.filter(G=>G.attributes["PATHWAY-ID"]===B["BASE-ID"]).forEach(G=>{this.mainPlaylistLoader_.addClonePathway(B,G)}),this.contentSteeringController_.addAvailablePathway(T))}this.contentSteeringController_.currentPathwayClones=new Map(JSON.parse(JSON.stringify([...a])))}}equalPathwayClones_(t,i){if(t["BASE-ID"]!==i["BASE-ID"]||t.ID!==i.ID||t["URI-REPLACEMENT"].HOST!==i["URI-REPLACEMENT"].HOST)return!1;var a,o,l=t["URI-REPLACEMENT"].PARAMS,h=i["URI-REPLACEMENT"].PARAMS;for(a in l)if(l[a]!==h[a])return!1;for(o in h)if(l[o]!==h[o])return!1;return!0}changeSegmentPathway_(){var t=this.selectPlaylist();this.pauseLoading(),this.contentSteeringController_.manifestType_==="DASH"&&this.switchMediaForDASHContentSteering_(),this.switchMedia_(t,"content-steering")}excludeNonUsablePlaylistsByKeyId_(){if(this.mainPlaylistLoader_&&this.mainPlaylistLoader_.main){let t=0,i="non-usable";this.mainPlaylistLoader_.main.playlists.forEach(a=>{var o=this.mainPlaylistLoader_.getKeyIdSet(a);o&&o.size&&o.forEach(l=>{var h="usable",h=this.keyStatusMap_.has(l)&&this.keyStatusMap_.get(l)===h,T=a.lastExcludeReason_===i&&a.excludeUntil===1/0;h?T&&(delete a.excludeUntil,delete a.lastExcludeReason_,this.logger_(`enabling playlist ${a.id} because key ID ${l} is usable`)):(a.excludeUntil!==1/0&&a.lastExcludeReason_!==i&&(a.excludeUntil=1/0,a.lastExcludeReason_=i,this.logger_(`excluding playlist ${a.id} because the key ID ${l} doesn't exist in the keyStatusMap or is not usable`)),t++)})}),t>=this.mainPlaylistLoader_.main.playlists.length&&this.mainPlaylistLoader_.main.playlists.forEach(a=>{var o=a&&a.attributes&&a.attributes.RESOLUTION&&a.attributes.RESOLUTION.height<720,l=a.excludeUntil===1/0&&a.lastExcludeReason_===i;o&&l&&(delete a.excludeUntil,He.log.warn(`enabling non-HD playlist ${a.id} because all playlists were excluded due to ${i} key IDs`))})}}addKeyStatus_(t,i){t=(typeof t=="string"?t:(a=>(a=new Uint8Array(a),Array.from(a).map(o=>o.toString(16).padStart(2,"0")).join("")))(t)).slice(0,32).toLowerCase(),this.logger_(`KeyStatus '${i}' with key ID ${t} added to the keyStatusMap`),this.keyStatusMap_.set(t,i)}updatePlaylistByKeyStatus(t,i){this.addKeyStatus_(t,i),this.waitingForFastQualityPlaylistReceived_||this.excludeNonUsableThenChangePlaylist_(),this.mainPlaylistLoader_.off("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this)),this.mainPlaylistLoader_.on("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this))}excludeNonUsableThenChangePlaylist_(){this.excludeNonUsablePlaylistsByKeyId_(),this.fastQualityChange_()}}class wg{constructor(t,i,a){var o,l,h,T,B=t.playlistController_,G=B.fastQualityChange_.bind(B);i.attributes&&(o=i.attributes.RESOLUTION,this.width=o&&o.width,this.height=o&&o.height,this.bandwidth=i.attributes.BANDWIDTH,this.frameRate=i.attributes["FRAME-RATE"]),this.codecs=xs(B.main(),i),this.playlist=i,this.id=a,this.enabled=(l=t.playlists,h=i.id,T=G,H=>{var se=l.main.playlists[h],pe=ol(se),ae=_a(se);if(typeof H>"u")return ae;H?delete se.disabled:se.disabled=!0;var _e={renditionInfo:{id:h,bandwidth:se.attributes.BANDWIDTH,resolution:se.attributes.RESOLUTION,codecs:se.attributes.CODECS},cause:"fast-quality"};return H===ae||pe||(H?(T(se),l.trigger({type:"renditionenabled",metadata:_e})):l.trigger({type:"renditiondisabled",metadata:_e})),H})}}let yh=["seeking","seeked","pause","playing","error"];class Eg extends He.EventTarget{constructor(t){super(),this.playlistController_=t.playlistController,this.tech_=t.tech,this.seekable=t.seekable,this.allowSeeksWithinUnsafeLiveWindow=t.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=t.liveRangeSafeTimeDelta,this.media=t.media,this.playedRanges_=[],this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=un("PlaybackWatcher"),this.logger_("initialize");let i=()=>this.monitorCurrentTime_(),a=()=>this.monitorCurrentTime_(),o=()=>this.techWaiting_(),l=()=>this.resetTimeUpdate_(),h=this.playlistController_,T=["main","subtitle","audio"],B={},G=(T.forEach(H=>{B[H]={reset:()=>this.resetSegmentDownloads_(H),updateend:()=>this.checkSegmentDownloads_(H)},h[H+"SegmentLoader_"].on("appendsdone",B[H].updateend),h[H+"SegmentLoader_"].on("playlistupdate",B[H].reset),this.tech_.on(["seeked","seeking"],B[H].reset)}),H=>{["main","audio"].forEach(se=>{h[se+"SegmentLoader_"][H]("appended",this.seekingAppendCheck_)})});this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),G("off"))},this.clearSeekingAppendCheck_=()=>G("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),G("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",o),this.tech_.on(yh,l),this.tech_.on("canplay",a),this.tech_.one("play",i),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",o),this.tech_.off(yh,l),this.tech_.off("canplay",a),this.tech_.off("play",i),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),T.forEach(H=>{h[H+"SegmentLoader_"].off("appendsdone",B[H].updateend),h[H+"SegmentLoader_"].off("playlistupdate",B[H].reset),this.tech_.off(["seeked","seeking"],B[H].reset)}),this.checkCurrentTimeTimeout_&&window.clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&window.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=window.setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(t){var i=this.playlistController_[t+"SegmentLoader_"];0<this[t+"StalledDownloads_"]&&this.logger_(`resetting possible stalled download count for ${t} loader`),this[t+"StalledDownloads_"]=0,this[t+"Buffered_"]=i.buffered_()}checkSegmentDownloads_(t){var i=this.playlistController_,a=i[t+"SegmentLoader_"],o=a.buffered_(),l=function(h,T){if(h!==T){if(!h&&T||!T&&h||h.length!==T.length)return!0;for(let B=0;B<h.length;B++)if(h.start(B)!==T.start(B)||h.end(B)!==T.end(B))return!0}return!1}(this[t+"Buffered_"],o);this[t+"Buffered_"]=o,l?(i.trigger({type:"bufferedrangeschanged",metadata:{bufferedRanges:o}}),this.resetSegmentDownloads_(t)):(this[t+"StalledDownloads_"]++,this.logger_(`found #${this[t+"StalledDownloads_"]} ${t} appends that did not increase buffer (possible stalled download)`,{playlistId:a.playlist_&&a.playlist_.id,buffered:ar(o)}),this[t+"StalledDownloads_"]<10||(this.logger_(t+" loader stalled download exclusion"),this.resetSegmentDownloads_(t),this.tech_.trigger({type:"usage",name:`vhs-${t}-download-exclusion`}),t!=="subtitle"&&i.excludePlaylist({error:{message:`Excessive ${t} segment downloading detected.`},playlistExclusionDuration:1/0})))}checkCurrentTime_(){var t,i;if(!this.tech_.paused()&&!this.tech_.seeking())return t=this.tech_.currentTime(),i=this.tech_.buffered(),this.lastRecordedTime===t&&(!i.length||t+Cn>=i.end(i.length-1))?this.techWaiting_():void(5<=this.consecutiveUpdates&&t===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):t===this.lastRecordedTime?this.consecutiveUpdates++:(this.playedRanges_.push(zi([this.lastRecordedTime,t])),i={playedRanges:this.playedRanges_},this.playlistController_.trigger({type:"playedrangeschanged",metadata:i}),this.consecutiveUpdates=0,this.lastRecordedTime=t))}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;var t=this.seekable(),i=this.tech_.currentTime();let a;if(this.afterSeekableWindow_(t,i,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(l=t.end(t.length-1),a=l),this.beforeSeekableWindow_(t,i)&&(l=t.start(0),a=l+(l===t.end(0)?0:Cn)),typeof a<"u")this.logger_(`Trying to seek outside of seekable at time ${i} with seekable range ${oc(t)}. Seeking to `+a+".");else{var l=this.playlistController_.sourceUpdater_,t=this.tech_.buffered(),o=l.audioBuffer?l.audioBuffered():null,l=l.videoBuffer?l.videoBuffered():null,h=this.media(),T=h.partTargetDuration||2*(h.targetDuration-En),B=[o,l];for(let H=0;H<B.length;H++)if(B[H]&&rl(B[H],i)<T)return!1;if((h=ba(t,i)).length===0)return!1;a=h.start(0)+Cn,this.logger_(`Buffered region starts (${h.start(0)})  just beyond seek point (${i}). Seeking to ${a}.`)}return this.tech_.setCurrentTime(a),!0}waiting_(){var t,i;this.techWaiting_()||(t=this.tech_.currentTime(),i=this.tech_.buffered(),(i=Mr(i,t)).length&&t+3<=i.end(0)&&(this.resetTimeUpdate_(),this.tech_.setCurrentTime(t),this.logger_(`Stopped at ${t} while inside a buffered region [${i.start(0)} -> ${i.end(0)}]. Attempting to resume playback by seeking to the current time.`),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"})))}techWaiting_(){var t,i=this.seekable(),a=this.tech_.currentTime();return!!this.tech_.seeking()||(this.beforeSeekableWindow_(i,a)?(i=i.end(i.length-1),this.logger_(`Fell out of live window at time ${a}. Seeking to live point (seekable end) `+i),this.resetTimeUpdate_(),this.tech_.setCurrentTime(i),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0):(i=this.tech_.vhs.playlistController_.sourceUpdater_,t=this.tech_.buffered(),this.videoUnderflow_({audioBuffered:i.audioBuffered(),videoBuffered:i.videoBuffered(),currentTime:a})?(this.resetTimeUpdate_(),this.tech_.setCurrentTime(a),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0):0<(i=ba(t,a)).length&&(this.logger_(`Stopped at ${a} and seeking to `+i.start(0)),this.resetTimeUpdate_(),this.skipTheGap_(a),!0)))}afterSeekableWindow_(t,i,a,o=!1){if(!t.length)return!1;let l=t.end(t.length-1)+Cn;var h=!a.endList;return i>(l=h&&(typeof a.partTargetDuration=="number"||o)?t.end(t.length-1)+3*a.targetDuration:l)}beforeSeekableWindow_(t,i){return!!(t.length&&0<t.start(0)&&i<t.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:t,audioBuffered:i,currentTime:a}){if(t){let h;var o,l;return t.length&&i.length?(o=Mr(t,a-3),l=Mr(t,a),(i=Mr(i,a)).length&&!l.length&&o.length&&(h={start:o.end(0),end:i.end(0)})):ba(t,a).length||(h=this.gapFromVideoUnderflow_(t,a)),!!h&&(this.logger_(`Encountered a gap in video from ${h.start} to ${h.end}. Seeking to current time `+a),!0)}}skipTheGap_(t){var a=this.tech_.buffered(),i=this.tech_.currentTime(),a=ba(a,i);this.resetTimeUpdate_(),a.length!==0&&i===t&&(this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",t,"nextRange start:",a.start(0)),this.tech_.setCurrentTime(a.start(0)+En),t={gapInfo:{from:i,to:a.start(0)}},this.playlistController_.trigger({type:"gapjumped",metadata:t}),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}))}gapFromVideoUnderflow_(t,i){var a=function(h){if(h.length<2)return zi();var T=[];for(let H=1;H<h.length;H++){var B=h.end(H-1),G=h.start(H);T.push([B,G])}return zi(T)}(t);for(let h=0;h<a.length;h++){var o=a.start(h),l=a.end(h);if(i-o<4&&2<i-o)return{start:o,end:l}}return null}}let Cg={errorInterval:30,getSource(s){return s(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource())}},vh=function(s,t){function i(G){G!=null&&(h=s.duration()!==1/0&&s.currentTime()||0,s.one("loadedmetadata",B),s.src(G),s.trigger({type:"usage",name:"vhs-error-reload"}),s.play())}function a(){if(Date.now()-l<1e3*T.errorInterval)s.trigger({type:"usage",name:"vhs-error-reload-canceled"});else{if(T.getSource&&typeof T.getSource=="function")return l=Date.now(),T.getSource.call(s,i);He.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}}function o(){s.off("loadedmetadata",B),s.off("error",a),s.off("dispose",o)}let l=0,h=0,T=Qt(Cg,t),B=(s.ready(()=>{s.trigger({type:"usage",name:"vhs-error-reload-initialized"})}),function(){h&&s.currentTime(h)});s.on("error",a),s.on("dispose",o),s.reloadSourceOnError=function(G){o(),vh(s,G)}};function bh(s,t){var i=t.media();let a=-1;for(let o=0;o<s.length;o++)if(s[o].id===i.id){a=o;break}s.selectedIndex_=a,s.trigger({selectedIndex:a,type:"change"})}let bi={PlaylistLoader:Br,Playlist:tn,utils:nr,STANDARD_PLAYLIST_SELECTOR:Zc,INITIAL_PLAYLIST_SELECTOR:function(){var s=this.playlists.main.playlists.filter(tn.isEnabled),s=(jr(s,(t,i)=>ml(t,i)),s.filter(t=>!!xs(this.playlists.main,t).video));return s[0]||null},lastBandwidthSelector:Zc,movingAverageBandwidthSelector:function(s){let t=-1,i=-1;if(s<0||1<s)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){let a=this.useDevicePixelRatio&&window.devicePixelRatio||1;return isNaN(this.customPixelRatio)||(a=this.customPixelRatio),t<0&&(t=this.systemBandwidth,i=this.systemBandwidth),0<this.systemBandwidth&&this.systemBandwidth!==i&&(t=s*this.systemBandwidth+(1-s)*t,i=this.systemBandwidth),Yc(this.playlists.main,t,parseInt(Sa(this.tech_.el(),"width"),10)*a,parseInt(Sa(this.tech_.el(),"height"),10)*a,this.limitRenditionByPlayerDimensions,this.playlistController_)}},comparePlaylistBandwidth:ml,comparePlaylistResolution:function(s,t){let i,a;return i=(i=s.attributes.RESOLUTION&&s.attributes.RESOLUTION.width?s.attributes.RESOLUTION.width:i)||window.Number.MAX_VALUE,a=(a=t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width?t.attributes.RESOLUTION.width:a)||window.Number.MAX_VALUE,i===a&&s.attributes.BANDWIDTH&&t.attributes.BANDWIDTH?s.attributes.BANDWIDTH-t.attributes.BANDWIDTH:i-a},xhr:Cc()},_h=(Object.keys(Mi).forEach(s=>{Object.defineProperty(bi,s,{get(){return He.log.warn(`using Vhs.${s} is UNSAFE be sure you know what you are doing`),Mi[s]},set(t){He.log.warn(`using Vhs.${s} is UNSAFE be sure you know what you are doing`),typeof t!="number"||t<0?He.log.warn(`value of Vhs.${s} must be greater than or equal to 0`):Mi[s]=t}})}),"videojs-vhs"),xg=(bi.canPlaySource=function(){return He.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")},({player:s,sourceKeySystems:t,audioMedia:l,mainPlaylists:a})=>{if(!s.eme.initializeMediaKeys)return Promise.resolve();var o,l=l?a.concat([l]):a,l=(a=l,o=Object.keys(t),a.reduce((B,G)=>{var H;return G.contentProtection&&(H=o.reduce((se,pe)=>{var ae=G.contentProtection[pe];return ae&&ae.pssh&&(se[pe]={pssh:ae.pssh}),se},{}),Object.keys(H).length)&&B.push(H),B},[]));let h=[],T=[];return l.forEach(B=>{T.push(new Promise((G,H)=>{s.tech_.one("keysessioncreated",G)})),h.push(new Promise((G,H)=>{s.eme.initializeMediaKeys({keySystems:B},se=>{se?H(se):G()})}))}),Promise.race([Promise.all(h),Promise.race(T)])}),kg=({player:s,sourceKeySystems:t,media:i,audioMedia:a})=>(t=((o,l,h)=>{if(!o)return o;let T={};l&&l.attributes&&l.attributes.CODECS&&(T=wa(Tn(l.attributes.CODECS))),h&&h.attributes&&h.attributes.CODECS&&(T.audio=h.attributes.CODECS);var B,G=Tr(T.video),H=Tr(T.audio),se={};for(B in o)se[B]={},H&&(se[B].audioContentType=H),G&&(se[B].videoContentType=G),l.contentProtection&&l.contentProtection[B]&&l.contentProtection[B].pssh&&(se[B].pssh=l.contentProtection[B].pssh),typeof o[B]=="string"&&(se[B].url=o[B]);return Qt(o,se)})(t,i,a),!(!t||(s.currentSource().keySystems=t)&&!s.eme&&(He.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),1))),Th=()=>{if(!window.localStorage)return null;var s=window.localStorage.getItem(_h);if(!s)return null;try{return JSON.parse(s)}catch{return null}},Sh=(s,t)=>{s._requestCallbackSet||(s._requestCallbackSet=new Set),s._requestCallbackSet.add(t)},wh=(s,t)=>{s._responseCallbackSet||(s._responseCallbackSet=new Set),s._responseCallbackSet.add(t)},Eh=(s,t)=>{s._requestCallbackSet&&(s._requestCallbackSet.delete(t),s._requestCallbackSet.size||delete s._requestCallbackSet)},Ch=(s,t)=>{s._responseCallbackSet&&(s._responseCallbackSet.delete(t),s._responseCallbackSet.size||delete s._responseCallbackSet)};bi.supportsNativeHls=function(){if(!document||!document.createElement)return!1;let s=document.createElement("video");return!!He.getTech("Html5").isSupported()&&["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(t){return/maybe|probably/i.test(s.canPlayType(t))})}(),bi.supportsNativeDash=!!(document&&document.createElement&&He.getTech("Html5").isSupported())&&/maybe|probably/i.test(document.createElement("video").canPlayType("application/dash+xml")),bi.supportsTypeNatively=s=>s==="hls"?bi.supportsNativeHls:s==="dash"&&bi.supportsNativeDash,bi.isSupported=function(){return He.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")},bi.xhr.onRequest=function(s){Sh(bi.xhr,s)},bi.xhr.onResponse=function(s){wh(bi.xhr,s)},bi.xhr.offRequest=function(s){Eh(bi.xhr,s)},bi.xhr.offResponse=function(s){Ch(bi.xhr,s)},Me=He.getComponent("Component");class xh extends Me{constructor(t,i,a){if(super(i,a.vhs),typeof a.initialBandwidth=="number"&&(this.options_.bandwidth=a.initialBandwidth),this.logger_=un("VhsHandler"),i.options_&&i.options_.playerId&&(a=He.getPlayer(i.options_.playerId),this.player_=a),this.tech_=i,this.source_=t,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&i.overrideNativeAudioTracks&&i.overrideNativeVideoTracks)i.overrideNativeAudioTracks(!0),i.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(i.featuresNativeVideoTracks||i.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(document,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],o=>{var l=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;l&&l.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()}),this.on(this.tech_,"seeking",function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}setOptions_(t={}){this.options_=Qt(this.options_,t),this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage<"u"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useForcedSubtitles=this.options_.useForcedSubtitles||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=this.options_.llhls!==!1,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,typeof this.options_.playlistExclusionDuration!="number"&&(this.options_.playlistExclusionDuration=60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage&&((t=Th())&&t.bandwidth&&(this.options_.bandwidth=t.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),t)&&t.throughput&&(this.options_.throughput=t.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"})),typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=Mi.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Mi.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","customPixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useForcedSubtitles","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach(i=>{typeof this.source_[i]<"u"&&(this.options_[i]=this.source_[i])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio,t=this.options_.customPixelRatio,typeof t=="number"&&0<=t&&(this.customPixelRatio=t)}setOptions(t={}){this.setOptions_(t)}src(t,i){t&&(this.setOptions_(),this.options_.src=(t=this.source_.src).toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(t.substring(t.indexOf(",")+1)):t,this.options_.tech=this.tech_,this.options_.externVhs=bi,this.options_.sourceType=sd(i),this.options_.seekTo=a=>{this.tech_.setCurrentTime(a)},this.options_.player_=this.player_,this.playlistController_=new Sg(this.options_),t=Qt({liveRangeSafeTimeDelta:Cn},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_}),this.playbackWatcher_=new Eg(t),this.attachStreamingEventListeners_(),this.playlistController_.on("error",()=>{var a=He.players[this.tech_.options_.playerId];let o=this.playlistController_.error;typeof o!="object"||o.code?typeof o=="string"&&(o={message:o,code:3}):o.code=3,a.error(o)}),i=this.options_.bufferBasedABR?bi.movingAverageBandwidthSelector(.55):bi.STANDARD_PLAYLIST_SELECTOR,this.playlistController_.selectPlaylist=(this.selectPlaylist||i).bind(this),this.playlistController_.selectInitialPlaylist=bi.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(a){this.playlistController_.selectPlaylist=a.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(a){this.playlistController_.mainSegmentLoader_.throughput.rate=a,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let a=this.playlistController_.mainSegmentLoader_.bandwidth;var o=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection;return this.options_.useNetworkInformationApi&&o&&(o=1e3*o.downlink*1e3,a=1e7<=o&&1e7<=a?Math.max(a,o):o),a},set(a){this.playlistController_.mainSegmentLoader_.bandwidth=a,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){var a=1/(this.bandwidth||1);let o;return o=0<this.throughput?1/this.throughput:0,Math.floor(1/(a+o))},set(){He.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>ar(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>ar(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",()=>{if(this.options_.useBandwidthFromLocalStorage){var a={bandwidth:this.bandwidth,throughput:Math.round(this.throughput)};if(window.localStorage){var o=(o=Th())?Qt(o,a):a;try{window.localStorage.setItem(_h,JSON.stringify(o))}catch{return}}}}),this.playlistController_.on("selectedinitialmedia",()=>{var a;(a=this).representations=()=>{var o=a.playlistController_.main(),o=Cs(o)?a.playlistController_.getAudioTrackPlaylists_():o.playlists;return o?o.filter(l=>!ol(l)).map((l,h)=>new wg(a,l,l.id)):[]}}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el())&&(this.mediaSourceUrl_=window.URL.createObjectURL(this.playlistController_.mediaSource),(He.browser.IS_ANY_SAFARI||He.browser.IS_IOS)&&this.options_.overrideNative&&this.options_.sourceType==="hls"&&typeof this.tech_.addSourceElement=="function"?(this.tech_.addSourceElement(this.mediaSourceUrl_),this.tech_.addSourceElement(this.source_.src)):this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){var t=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),xg({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:t&&t.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()}).catch(i=>{this.logger_("error while creating EME key session",i),this.player_.error({message:"Failed to initialize media keys for EME",code:3})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){var t=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,t=kg({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:t&&t.media()});this.player_.tech_.on("keystatuschange",i=>{this.playlistController_.updatePlaylistByKeyStatus(i.keyId,i.status)}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),t?this.createKeySessions_():this.playlistController_.sourceUpdater_.initializedEme()}setupQualityLevels_(){var t=He.players[this.tech_.options_.playerId];t&&t.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=t.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>{var i,a;i=this.qualityLevels_,(a=this).representations().forEach(o=>{i.addQualityLevel(o)}),bh(i,a.playlists)}),this.playlists.on("mediachange",()=>{bh(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":"3.16.2","mux.js":"7.1.0","mpd-parser":"1.3.1","m3u8-parser":"7.2.0","aes-decrypter":"4.0.2"}}version(){return this.constructor.version()}canChangeType(){return ah.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(t){this.playlistController_.setCurrentTime(t)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&window.URL.revokeObjectURL&&(window.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(t,i){return Fm({playlist:this.playlistController_.media(),time:t,callback:i})}seekToProgramTime(t,i,a=!0,o=2){return Ic({programTime:t,playlist:this.playlistController_.media(),retryCount:o,pauseAfterSeek:a,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:i})}setupXhrHooks_(){this.xhr.onRequest=t=>{Sh(this.xhr,t)},this.xhr.onResponse=t=>{wh(this.xhr,t)},this.xhr.offRequest=t=>{Eh(this.xhr,t)},this.xhr.offResponse=t=>{Ch(this.xhr,t)},this.player_.trigger("xhr-hooks-ready")}attachStreamingEventListeners_(){["seekablerangeschanged","bufferedrangeschanged","contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"].forEach(t=>{this.playlistController_.on(t,i=>{this.player_.trigger(Ii({},i))})}),["gapjumped","playedrangeschanged"].forEach(t=>{this.playbackWatcher_.on(t,i=>{this.player_.trigger(Ii({},i))})})}}let Ca={name:"videojs-http-streaming",VERSION:"3.16.2",canHandleSource(s,t={}){return t=Qt(He.options,t),!(!t.vhs.experimentalUseMMS&&!us("avc1.4d400d,mp4a.40.2",!1))&&Ca.canPlayType(s.type,t)},handleSource(s,t,i={}){return i=Qt(He.options,i),t.vhs=new xh(s,t,i),t.vhs.xhr=Cc(),t.vhs.setupXhrHooks_(),t.vhs.src(s.src,s.type),t.vhs},canPlayType(s,t){return s=sd(s),s&&(t=Ca.getOverrideNative(t),!bi.supportsTypeNatively(s)||t)?"maybe":""},getOverrideNative(i={}){var{vhs:i={}}=i,t=!(He.browser.IS_ANY_SAFARI||He.browser.IS_IOS),{overrideNative:i=t}=i;return i}};return us("avc1.4d400d,mp4a.40.2",!0)&&He.getTech("Html5").registerSourceHandler(Ca,0),He.VhsHandler=xh,He.VhsSourceHandler=Ca,He.Vhs=bi,He.use||He.registerComponent("Vhs",bi),He.options.vhs=He.options.vhs||{},He.getPlugin&&He.getPlugin("reloadSourceOnError")||He.registerPlugin("reloadSourceOnError",function(s){vh(this,s)}),He});var webodf_version="0.5.9";function Runtime(){}Runtime.prototype.getVariable=function(A){},Runtime.prototype.toJson=function(A){},Runtime.prototype.fromJson=function(A){},Runtime.prototype.byteArrayFromString=function(A,j){},Runtime.prototype.byteArrayToString=function(A,j){},Runtime.prototype.read=function(A,j,M,w){},Runtime.prototype.readFile=function(A,j,M){},Runtime.prototype.readFileSync=function(A,j){},Runtime.prototype.loadXML=function(A,j){},Runtime.prototype.writeFile=function(A,j,M){},Runtime.prototype.deleteFile=function(A,j){},Runtime.prototype.log=function(A,j){},Runtime.prototype.setTimeout=function(A,j){},Runtime.prototype.clearTimeout=function(A){},Runtime.prototype.libraryPaths=function(){},Runtime.prototype.currentDirectory=function(){},Runtime.prototype.setCurrentDirectory=function(A){},Runtime.prototype.type=function(){},Runtime.prototype.getDOMImplementation=function(){},Runtime.prototype.parseXML=function(A){},Runtime.prototype.exit=function(A){},Runtime.prototype.getWindow=function(){},Runtime.prototype.requestAnimationFrame=function(A){},Runtime.prototype.cancelAnimationFrame=function(A){},Runtime.prototype.assert=function(A,j){};var IS_COMPILED_CODE=!0;Runtime.byteArrayToString=function(A,j){function M(N){var O="",x,I=N.length;for(x=0;x<I;x+=1)O+=String.fromCharCode(N[x]&255);return O}function w(N){var O="",x,I=N.length,_=[],S,u,y,v;for(x=3<=I&&N[0]===239&&N[1]===187&&N[2]===191?3:0;x<I;x+=1)S=N[x],128>S?_.push(S):(x+=1,u=N[x],194<=S&&224>S?_.push((S&31)<<6|u&63):(x+=1,y=N[x],224<=S&&240>S?_.push((S&15)<<12|(u&63)<<6|y&63):(x+=1,v=N[x],240<=S&&245>S&&(S=(S&7)<<18|(u&63)<<12|(y&63)<<6|v&63,S-=65536,_.push((S>>10)+55296,(S&1023)+56320))))),1e3<=_.length&&(O+=String.fromCharCode.apply(null,_),_.length=0);return O+String.fromCharCode.apply(null,_)}var E;return j==="utf8"?E=w(A):(j!=="binary"&&this.log("Unsupported encoding: "+j),E=M(A)),E},Runtime.getVariable=function(g){try{return eval(g)}catch(A){}},Runtime.toJson=function(A){return JSON.stringify(A)},Runtime.fromJson=function(A){return JSON.parse(A)},Runtime.getFunctionName=function(A){return A.name===void 0?(A=/function\s+(\w+)/.exec(A))&&A[1]:A.name},Runtime.assert=function(A,j){if(!A)throw this.log("alert",`ASSERTION FAILED:
`+j),Error(j)};function BrowserRuntime(){function A(I){var _=I.length,S,u,y=0;for(S=0;S<_;S+=1)u=I.charCodeAt(S),y+=1+(128<u)+(2048<u),55040<u&&57344>u&&(y+=1,S+=1);return y}function j(I,_,S){var u=I.length,y,v;for(_=new Uint8Array(new ArrayBuffer(_)),S?(_[0]=239,_[1]=187,_[2]=191,v=3):v=0,S=0;S<u;S+=1)y=I.charCodeAt(S),128>y?(_[v]=y,v+=1):2048>y?(_[v]=192|y>>>6,_[v+1]=128|y&63,v+=2):55040>=y||57344<=y?(_[v]=224|y>>>12&15,_[v+1]=128|y>>>6&63,_[v+2]=128|y&63,v+=3):(S+=1,y=(y-55296<<10|I.charCodeAt(S)-56320)+65536,_[v]=240|y>>>18&7,_[v+1]=128|y>>>12&63,_[v+2]=128|y>>>6&63,_[v+3]=128|y&63,v+=4);return _}function M(I){var _=I.length,S=new Uint8Array(new ArrayBuffer(_)),u;for(u=0;u<_;u+=1)S[u]=I.charCodeAt(u)&255;return S}function w(I,_){var S;_!==void 0?S=I:_=I,console.log(_),x.enableAlerts&&S==="alert"&&alert(_)}function E(I,_,S){if(S.status!==0||S.responseText)if(S.status===200||S.status===0){if(S.response&&typeof S.response!="string")_==="binary"?(S=S.response,S=new Uint8Array(S)):S=String(S.response);else if(_==="binary")if(S.responseBody!==null&&typeof VBArray<"u"){S=new VBArray(S.responseBody).toArray();var u=S.length;for(_=new Uint8Array(new ArrayBuffer(u)),I=0;I<u;I+=1)_[I]=S[I];S=_}else{if((I=S.getResponseHeader("Content-Length"))&&(I=parseInt(I,10)),I&&I!==S.responseText.length)e:{u=S.responseText,_=!1;var y=A(u);if(typeof I=="number"){if(I!==y&&I!==y+3){u=void 0;break e}_=y+3===I,y=I}u=j(u,y,_)}u===void 0&&(u=M(S.responseText)),S=u}else S=S.responseText;S={err:null,data:S}}else S={err:S.responseText||S.statusText,data:null};else S={err:"File "+I+" is empty.",data:null};return S}function N(I,_,S){var u=new XMLHttpRequest;return u.open("GET",I,S),u.overrideMimeType&&(_!=="binary"?u.overrideMimeType("text/plain; charset="+_):u.overrideMimeType("text/plain; charset=x-user-defined")),u}function O(I,_,S){var u=N(I,_,!0);u.onreadystatechange=function(){var y;u.readyState===4&&(y=E(I,_,u),S(y.err,y.data))};try{u.send(null)}catch(y){S(y.message,null)}}var x=this;this.byteArrayFromString=function(I,_){var S;return _==="utf8"?S=j(I,A(I),!1):(_!=="binary"&&x.log("unknown encoding: "+_),S=M(I)),S},this.byteArrayToString=Runtime.byteArrayToString,this.getVariable=Runtime.getVariable,this.fromJson=Runtime.fromJson,this.toJson=Runtime.toJson,this.readFile=O,this.read=function(I,_,S,u){O(I,"binary",function(y,v){var m=null;if(v){if(typeof v=="string")throw"This should not happen.";m=v.subarray(_,_+S)}u(y,m)})},this.readFileSync=function(I,_){var S=N(I,_,!1),u;try{if(S.send(null),u=E(I,_,S),u.err)throw u.err;if(u.data===null)throw"No data read from "+I+"."}catch(y){throw y}return u.data},this.writeFile=function(I,_,S){var u=new XMLHttpRequest,y;u.open("PUT",I,!0),u.onreadystatechange=function(){u.readyState===4&&(u.status!==0||u.responseText?200<=u.status&&300>u.status||u.status===0?S(null):S("Status "+String(u.status)+": "+u.responseText||u.statusText):S("File "+I+" is empty."))},y=_.buffer&&!u.sendAsBinary?_.buffer:x.byteArrayToString(_,"binary");try{u.sendAsBinary?u.sendAsBinary(y):u.send(y)}catch(v){x.log("HUH? "+v+" "+_),S(v.message)}},this.deleteFile=function(I,_){var S=new XMLHttpRequest;S.open("DELETE",I,!0),S.onreadystatechange=function(){S.readyState===4&&(200>S.status&&300<=S.status?_(S.responseText):_(null))},S.send(null)},this.loadXML=function(I,_){var S=new XMLHttpRequest;S.open("GET",I,!0),S.overrideMimeType&&S.overrideMimeType("text/xml"),S.onreadystatechange=function(){S.readyState===4&&(S.status!==0||S.responseText?S.status===200||S.status===0?_(null,S.responseXML):_(S.responseText,null):_("File "+I+" is empty.",null))};try{S.send(null)}catch(u){_(u.message,null)}},this.log=w,this.enableAlerts=!0,this.assert=Runtime.assert,this.setTimeout=function(I,_){return setTimeout(function(){I()},_)},this.clearTimeout=function(I){clearTimeout(I)},this.libraryPaths=function(){return["lib"]},this.setCurrentDirectory=function(){},this.currentDirectory=function(){return""},this.type=function(){return"BrowserRuntime"},this.getDOMImplementation=function(){return window.document.implementation},this.parseXML=function(I){return new DOMParser().parseFromString(I,"text/xml")},this.exit=function(I){w("Calling exit with code "+String(I)+", but exit() is not implemented.")},this.getWindow=function(){return window},this.requestAnimationFrame=function(I){var _=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,S=0;if(_)_.bind(window),S=_(I);else return setTimeout(I,15);return S},this.cancelAnimationFrame=function(I){var _=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame;_?(_.bind(window),_(I)):clearTimeout(I)}}function NodeJSRuntime(){function A(I){var _=I.length,S,u=new Uint8Array(new ArrayBuffer(_));for(S=0;S<_;S+=1)u[S]=I[S];return u}function j(I,_,S){function u(y,v){if(y)return S(y,null);if(!v)return S("No data for "+I+".",null);if(typeof v=="string")return S(y,v);S(y,A(v))}I=E.resolve(N,I),_!=="binary"?w.readFile(I,_,u):w.readFile(I,null,u)}var M=this,w=require("fs"),E=require("path"),N="",O,x;this.byteArrayFromString=function(I,_){var S=new Buffer(I,_),u,y=S.length,v=new Uint8Array(new ArrayBuffer(y));for(u=0;u<y;u+=1)v[u]=S[u];return v},this.byteArrayToString=Runtime.byteArrayToString,this.getVariable=Runtime.getVariable,this.fromJson=Runtime.fromJson,this.toJson=Runtime.toJson,this.readFile=j,this.loadXML=function(I,_){j(I,"utf-8",function(S,u){if(S)return _(S,null);if(!u)return _("No data for "+I+".",null);_(null,M.parseXML(u))})},this.writeFile=function(I,_,S){_=new Buffer(_),I=E.resolve(N,I),w.writeFile(I,_,"binary",function(u){S(u||null)})},this.deleteFile=function(I,_){I=E.resolve(N,I),w.unlink(I,_)},this.read=function(I,_,S,u){I=E.resolve(N,I),w.open(I,"r+",666,function(y,v){if(y)u(y,null);else{var m=new Buffer(S);w.read(v,m,0,S,_,function(R){w.close(v),u(R,A(m))})}})},this.readFileSync=function(I,_){var S;if(S=w.readFileSync(I,_==="binary"?null:_),S===null)throw"File "+I+" could not be read.";return _==="binary"&&(S=A(S)),S},this.log=function(I,_){var S;_!==void 0?S=I:_=I,S==="alert"&&process.stderr.write(`
!!!!! ALERT !!!!!
`),process.stderr.write(_+`
`),S==="alert"&&process.stderr.write(`!!!!! ALERT !!!!!
`)},this.assert=Runtime.assert,this.setTimeout=function(I,_){return setTimeout(function(){I()},_)},this.clearTimeout=function(I){clearTimeout(I)},this.libraryPaths=function(){return[__dirname]},this.setCurrentDirectory=function(I){N=I},this.currentDirectory=function(){return N},this.type=function(){return"NodeJSRuntime"},this.getDOMImplementation=function(){return x},this.parseXML=function(I){return O.parseFromString(I,"text/xml")},this.exit=process.exit,this.getWindow=function(){return null},this.requestAnimationFrame=function(I){return setTimeout(I,15)},this.cancelAnimationFrame=function(I){clearTimeout(I)},O=new(require("xmldom")).DOMParser,x=M.parseXML("<a/>").implementation}function RhinoRuntime(){var A=this,j={},M=j.javax.xml.parsers.DocumentBuilderFactory.newInstance(),w,E,N="";M.setValidating(!1),M.setNamespaceAware(!0),M.setExpandEntityReferences(!1),M.setSchema(null),E=j.org.xml.sax.EntityResolver({resolveEntity:function(O,x){var I=new j.java.io.FileReader(x);return new j.org.xml.sax.InputSource(I)}}),w=M.newDocumentBuilder(),w.setEntityResolver(E),this.byteArrayFromString=function(O,x){var I,_=O.length,S=new Uint8Array(new ArrayBuffer(_));for(I=0;I<_;I+=1)S[I]=O.charCodeAt(I)&255;return S},this.byteArrayToString=Runtime.byteArrayToString,this.getVariable=Runtime.getVariable,this.fromJson=Runtime.fromJson,this.toJson=Runtime.toJson,this.loadXML=function(O,x){var I=new j.java.io.File(O),_=null;try{_=w.parse(I)}catch(S){return print(S),x(S,null)}x(null,_)},this.readFile=function(O,x,I){N&&(O=N+"/"+O);var _=new j.java.io.File(O),S=x==="binary"?"latin1":x;_.isFile()?((O=readFile(O,S))&&x==="binary"&&(O=A.byteArrayFromString(O,"binary")),I(null,O)):I(O+" is not a file.",null)},this.writeFile=function(O,x,I){N&&(O=N+"/"+O),O=new j.java.io.FileOutputStream(O);var _,S=x.length;for(_=0;_<S;_+=1)O.write(x[_]);O.close(),I(null)},this.deleteFile=function(O,x){N&&(O=N+"/"+O);var I=new j.java.io.File(O),_=O+Math.random(),_=new j.java.io.File(_);I.rename(_)?(_.deleteOnExit(),x(null)):x("Could not delete "+O)},this.read=function(O,x,I,_){N&&(O=N+"/"+O);var S;S=O;var u="binary";new j.java.io.File(S).isFile()?(u==="binary"&&(u="latin1"),S=readFile(S,u)):S=null,S?_(null,this.byteArrayFromString(S.substring(x,x+I),"binary")):_("Cannot read "+O,null)},this.readFileSync=function(O,x){if(!x)return"";var I=readFile(O,x);if(I===null)throw"File could not be read.";return I},this.log=function(O,x){var I;x!==void 0?I=O:x=O,I==="alert"&&print(`
!!!!! ALERT !!!!!`),print(x),I==="alert"&&print("!!!!! ALERT !!!!!")},this.assert=Runtime.assert,this.setTimeout=function(O){return O(),0},this.clearTimeout=function(){},this.libraryPaths=function(){return["lib"]},this.setCurrentDirectory=function(O){N=O},this.currentDirectory=function(){return N},this.type=function(){return"RhinoRuntime"},this.getDOMImplementation=function(){return w.getDOMImplementation()},this.parseXML=function(O){return O=new j.java.io.StringReader(O),O=new j.org.xml.sax.InputSource(O),w.parse(O)},this.exit=quit,this.getWindow=function(){return null},this.requestAnimationFrame=function(O){return O(),0},this.cancelAnimationFrame=function(){}}Runtime.create=function(){return typeof window<"u"?new BrowserRuntime:typeof require<"u"?new NodeJSRuntime:new RhinoRuntime};var runtime=Runtime.create(),core={},gui={},xmldom={},odf={},ops={},webodf={};(function(){webodf.Version=typeof webodf_version<"u"?webodf_version:"From Source"})(),function(){function g(A,j,M){var w=A+"/manifest.json",E,N;runtime.log("Loading manifest: "+w);try{E=runtime.readFileSync(w,"utf-8")}catch(O){if(M)runtime.log("No loadable manifest found.");else throw console.log(String(O)),O;return}M=JSON.parse(E);for(N in M)M.hasOwnProperty(N)&&(j[N]={dir:A,deps:M[N]})}function k(A,j,M){function w(x){if(!O[x]&&!M(x)){if(N[x])throw"Circular dependency detected for "+x+".";if(N[x]=!0,!j[x])throw"Missing dependency information for class "+x+".";var I=j[x],_=I.deps,S,u=_.length;for(S=0;S<u;S+=1)w(_[S]);N[x]=!1,O[x]=!0,E.push(I.dir+"/"+x.replace(".","/")+".js")}}var E=[],N={},O={};return A.forEach(w),E}function d(A,j){return j+(`
//# sourceURL=`+A)}function b(b){var f,e;for(f=0;f<b.length;f+=1)e=runtime.readFileSync(b[f],"utf-8"),e=d(b[f],e),eval(e)}function f(A){A=A.split(".");var j,M=p,w=A.length;for(j=0;j<w;j+=1){if(!M.hasOwnProperty(A[j]))return!1;M=M[A[j]]}return!0}var n,p={core,gui,xmldom,odf,ops};runtime.loadClasses=function(A,j){if(IS_COMPILED_CODE||A.length===0)return j&&j();var M;if(!(M=n)){M=[];var w=runtime.libraryPaths(),E;for(runtime.currentDirectory()&&w.indexOf(runtime.currentDirectory())===-1&&g(runtime.currentDirectory(),M,!0),E=0;E<w.length;E+=1)g(w[E],M)}if(n=M,A=k(A,n,f),A.length===0)return j&&j();if(runtime.type()==="BrowserRuntime"&&j){M=A,w=document.currentScript||document.documentElement.lastChild,E=document.createDocumentFragment();var N,O;for(O=0;O<M.length;O+=1)N=document.createElement("script"),N.type="text/javascript",N.charset="utf-8",N.async=!1,N.setAttribute("src",M[O]),E.appendChild(N);j&&(N.onload=j),w.parentNode.insertBefore(E,w)}else b(A),j&&j()},runtime.loadClass=function(A,j){runtime.loadClasses([A],j)}}(),function(){var A=function(j){return j};runtime.getTranslator=function(){return A},runtime.setTranslator=function(j){A=j},runtime.tr=function(j){var M=A(j);return M&&typeof M=="string"?M:j}}(),function(g){function k(d){if(d.length){var b=d[0];runtime.readFile(b,"utf8",function(f,n){function g(){var b;(b=eval(k))&&runtime.exit(b)}var r="",r=b.lastIndexOf("/"),k=n,r=r!==-1?b.substring(0,r):".";runtime.setCurrentDirectory(r),f?(runtime.log(f),runtime.exit(1)):k===null?(runtime.log("No code found for "+b),runtime.exit(1)):g.apply(null,d)})}}g=g?Array.prototype.slice.call(g):[],runtime.type()==="NodeJSRuntime"?k(process.argv.slice(2)):runtime.type()==="RhinoRuntime"?k(g):k(g.slice(1))}(typeof arguments<"u"&&arguments),function(){core.Async=function(){return{forEach:function(A,j,M){function w(x){O!==N&&(x?(O=N,M(x)):(O+=1,O===N&&M(null)))}var E,N=A.length,O=0;for(E=0;E<N;E+=1)j(A[E],w)},destroyAll:function(A,j){function M(w,E){E?j(E):w<A.length?A[w](function(N){M(w+1,N)}):j()}M(0,void 0)}}}()}();function makeBase64(){function A(z){var P,Y=z.length,$=new Uint8Array(new ArrayBuffer(Y));for(P=0;P<Y;P+=1)$[P]=z.charCodeAt(P)&255;return $}function j(z){var P,Y="",$,J=z.length-2;for($=0;$<J;$+=3)P=z[$]<<16|z[$+1]<<8|z[$+2],Y+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[P>>>18],Y+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[P>>>12&63],Y+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[P>>>6&63],Y+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[P&63];return $===J+1?(P=z[$]<<4,Y+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[P>>>6],Y+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[P&63],Y+="=="):$===J&&(P=z[$]<<10|z[$+1]<<2,Y+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[P>>>12],Y+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[P>>>6&63],Y+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[P&63],Y+="="),Y}function M(z){z=z.replace(/[^A-Za-z0-9+\/]+/g,"");var P=z.length,Y=new Uint8Array(new ArrayBuffer(3*P)),$=z.length%4,J=0,te,q;for(te=0;te<P;te+=4)q=(m[z.charAt(te)]||0)<<18|(m[z.charAt(te+1)]||0)<<12|(m[z.charAt(te+2)]||0)<<6|(m[z.charAt(te+3)]||0),Y[J]=q>>16,Y[J+1]=q>>8&255,Y[J+2]=q&255,J+=3;return P=3*P-[0,0,2,1][$],Y.subarray(0,P)}function w(z){var P,Y,$=z.length,J=0,te=new Uint8Array(new ArrayBuffer(3*$));for(P=0;P<$;P+=1)Y=z[P],128>Y?te[J++]=Y:(2048>Y?te[J++]=192|Y>>>6:(te[J++]=224|Y>>>12&15,te[J++]=128|Y>>>6&63),te[J++]=128|Y&63);return te.subarray(0,J)}function E(z){var P,Y,$,J,te=z.length,q=new Uint8Array(new ArrayBuffer(te)),K=0;for(P=0;P<te;P+=1)Y=z[P],128>Y?q[K++]=Y:(P+=1,$=z[P],224>Y?q[K++]=(Y&31)<<6|$&63:(P+=1,J=z[P],q[K++]=(Y&15)<<12|($&63)<<6|J&63));return q.subarray(0,K)}function N(z){return j(A(z))}function O(z){return String.fromCharCode.apply(String,M(z))}function x(z){return E(A(z))}function I(z){z=E(z);for(var P="",Y=0;Y<z.length;)P+=String.fromCharCode.apply(String,z.subarray(Y,Y+45e3)),Y+=45e3;return P}function _(z,P,Y){var $,J,te,q="";for(te=P;te<Y;te+=1)P=z.charCodeAt(te)&255,128>P?q+=String.fromCharCode(P):(te+=1,$=z.charCodeAt(te)&255,224>P?q+=String.fromCharCode((P&31)<<6|$&63):(te+=1,J=z.charCodeAt(te)&255,q+=String.fromCharCode((P&15)<<12|($&63)<<6|J&63)));return q}function S(z,P){function Y(){var te=J+1e5;te>z.length&&(te=z.length),$+=_(z,J,te),J=te,te=J===z.length,P($,te)&&!te&&runtime.setTimeout(Y,0)}var $="",J=0;1e5>z.length?P(_(z,0,z.length),!0):(typeof z!="string"&&(z=z.slice()),Y())}function u(z){return w(A(z))}function y(z){return String.fromCharCode.apply(String,w(z))}function v(z){return String.fromCharCode.apply(String,w(A(z)))}var m=function(z){var P={},Y,$;for(Y=0,$=z.length;Y<$;Y+=1)P[z.charAt(Y)]=Y;return P}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),R,V,Z=runtime.getWindow(),ne,ee;return Z&&Z.btoa?(ne=Z.btoa,R=function(z){return ne(v(z))}):(ne=N,R=function(z){return j(u(z))}),Z&&Z.atob?(ee=Z.atob,V=function(z){return z=ee(z),_(z,0,z.length)}):(ee=O,V=function(z){return I(M(z))}),core.Base64=function(){return this.convertByteArrayToBase64=this.convertUTF8ArrayToBase64=j,this.convertBase64ToByteArray=this.convertBase64ToUTF8Array=M,this.convertUTF16ArrayToByteArray=this.convertUTF16ArrayToUTF8Array=w,this.convertByteArrayToUTF16Array=this.convertUTF8ArrayToUTF16Array=E,this.convertUTF8StringToBase64=N,this.convertBase64ToUTF8String=O,this.convertUTF8StringToUTF16Array=x,this.convertByteArrayToUTF16String=this.convertUTF8ArrayToUTF16String=I,this.convertUTF8StringToUTF16String=S,this.convertUTF16StringToByteArray=this.convertUTF16StringToUTF8Array=u,this.convertUTF16ArrayToUTF8String=y,this.convertUTF16StringToUTF8String=v,this.convertUTF16StringToBase64=R,this.convertBase64ToUTF16String=V,this.fromBase64=O,this.toBase64=N,this.atob=ee,this.btoa=ne,this.utob=v,this.btou=S,this.encode=R,this.encodeURI=function(z){return R(z).replace(/[+\/]/g,function(P){return P==="+"?"-":"_"}).replace(/\\=+$/,"")},this.decode=function(z){return V(z.replace(/[\-_]/g,function(P){return P==="-"?"+":"/"}))},this},core.Base64}core.Base64=makeBase64(),core.CSSUnits=function(){var A=this,j={in:1,cm:2.54,mm:25.4,pt:72,pc:12,px:96};this.convert=function(M,w,E){return M*j[E]/j[w]},this.convertMeasure=function(M,w){var E,N;return M&&w&&(E=parseFloat(M),N=M.replace(E.toString(),""),E=A.convert(E,N,w)),E},this.getUnits=function(M){return M.substr(M.length-2,M.length)}},function(){function A(){var w,E,N,O,x,I,_,S,u;return M===void 0&&(E=(w=runtime.getWindow())&&w.document,I=E.documentElement,_=E.body,M={rangeBCRIgnoresElementBCR:!1,unscaledRangeClientRects:!1,elementBCRIgnoresBodyScroll:!1},E&&(O=E.createElement("div"),O.style.position="absolute",O.style.left="-99999px",O.style.transform="scale(2)",O.style["-webkit-transform"]="scale(2)",x=E.createElement("div"),O.appendChild(x),_.appendChild(O),w=E.createRange(),w.selectNode(x),M.rangeBCRIgnoresElementBCR=w.getClientRects().length===0,x.appendChild(E.createTextNode("Rect transform test")),E=x.getBoundingClientRect(),N=w.getBoundingClientRect(),M.unscaledRangeClientRects=2<Math.abs(E.height-N.height),O.style.transform="",O.style["-webkit-transform"]="",E=I.style.overflow,N=_.style.overflow,S=_.style.height,u=_.scrollTop,I.style.overflow="visible",_.style.overflow="visible",_.style.height="200%",_.scrollTop=_.scrollHeight,M.elementBCRIgnoresBodyScroll=w.getBoundingClientRect().top!==x.getBoundingClientRect().top,_.scrollTop=u,_.style.height=S,_.style.overflow=N,I.style.overflow=E,w.detach(),_.removeChild(O),w=Object.keys(M).map(function(y){return y+":"+String(M[y])}).join(", "),runtime.log("Detected browser quirks - "+w))),M}function j(w,E,N){for(w=w?w.firstElementChild:null;w;){if(w.localName===N&&w.namespaceURI===E)return w;w=w.nextElementSibling}return null}var M;core.DomUtilsImpl=function(){function w(v,m){for(var R=0,V;v.parentNode!==m;)runtime.assert(v.parentNode!==null,"parent is null"),v=v.parentNode;for(V=m.firstChild;V!==v;)R+=1,V=V.nextSibling;return R}function E(v,m){return 0>=v.compareBoundaryPoints(Range.START_TO_START,m)&&0<=v.compareBoundaryPoints(Range.END_TO_END,m)}function N(v,m){return 0>=v.compareBoundaryPoints(Range.END_TO_START,m)&&0<=v.compareBoundaryPoints(Range.START_TO_END,m)}function O(v,m){var R=null;return v.nodeType===Node.TEXT_NODE&&(v.length===0?(v.parentNode.removeChild(v),m.nodeType===Node.TEXT_NODE&&(R=m)):(m.nodeType===Node.TEXT_NODE&&(v.appendData(m.data),m.parentNode.removeChild(m)),R=v)),R}function x(v){for(var m=v.parentNode;v.firstChild;)m.insertBefore(v.firstChild,v);return m.removeChild(v),m}function I(v,m){var R=v.parentNode,V=v.firstChild,Z=m(v),ne;if(Z===NodeFilter.FILTER_SKIP)return R;for(;V;)ne=V.nextSibling,I(V,m),V=ne;return R&&Z===NodeFilter.FILTER_REJECT&&x(v),R}function _(v,m){return v===m||!!(v.compareDocumentPosition(m)&Node.DOCUMENT_POSITION_CONTAINED_BY)}function S(v,m){return A().unscaledRangeClientRects?v:v/m}function u(v,m,R){Object.keys(m).forEach(function(V){var ee=V.split(":"),Z=ee[1],ne=R(ee[0]),ee=m[V],z=typeof ee;z==="object"?Object.keys(ee).length&&(V=ne?v.getElementsByTagNameNS(ne,Z)[0]||v.ownerDocument.createElementNS(ne,V):v.getElementsByTagName(Z)[0]||v.ownerDocument.createElement(V),v.appendChild(V),u(V,ee,R)):ne&&(runtime.assert(z==="number"||z==="string","attempting to map unsupported type '"+z+"' (key: "+V+")"),v.setAttributeNS(ne,V,String(ee)))})}var y=null;this.splitBoundaries=function(v){var m,R=[],V,Z,ne;if(v.startContainer.nodeType===Node.TEXT_NODE||v.endContainer.nodeType===Node.TEXT_NODE){if(V=v.endContainer,Z=v.endContainer.nodeType!==Node.TEXT_NODE?v.endOffset===v.endContainer.childNodes.length:!1,ne=v.endOffset,m=v.endContainer,ne<m.childNodes.length)for(m=m.childNodes.item(ne),ne=0;m.firstChild;)m=m.firstChild;else for(;m.lastChild;)m=m.lastChild,ne=m.nodeType===Node.TEXT_NODE?m.textContent.length:m.childNodes.length;if(m===V&&(V=null),v.setEnd(m,ne),ne=v.endContainer,v.endOffset!==0&&ne.nodeType===Node.TEXT_NODE&&(m=ne,v.endOffset!==m.length&&(R.push(m.splitText(v.endOffset)),R.push(m))),ne=v.startContainer,v.startOffset!==0&&ne.nodeType===Node.TEXT_NODE&&(m=ne,v.startOffset!==m.length&&(ne=m.splitText(v.startOffset),R.push(m),R.push(ne),v.setStart(ne,0))),V!==null){for(ne=v.endContainer;ne.parentNode&&ne.parentNode!==V;)ne=ne.parentNode;Z=Z?V.childNodes.length:w(ne,V),v.setEnd(V,Z)}}return R},this.containsRange=E,this.rangesIntersect=N,this.rangeIntersection=function(v,m){var R;return N(v,m)&&(R=v.cloneRange(),v.compareBoundaryPoints(Range.START_TO_START,m)===-1&&R.setStart(m.startContainer,m.startOffset),v.compareBoundaryPoints(Range.END_TO_END,m)===1&&R.setEnd(m.endContainer,m.endOffset)),R},this.getNodesInRange=function(v,m,R){var V=[],Z=v.commonAncestorContainer,Z=Z.nodeType===Node.TEXT_NODE?Z.parentNode:Z;R=v.startContainer.ownerDocument.createTreeWalker(Z,R,m,!1);var ne,ee;if(v.endContainer.childNodes[v.endOffset-1]?(ne=v.endContainer.childNodes[v.endOffset-1],ee=Node.DOCUMENT_POSITION_PRECEDING|Node.DOCUMENT_POSITION_CONTAINED_BY):(ne=v.endContainer,ee=Node.DOCUMENT_POSITION_PRECEDING),v.startContainer.childNodes[v.startOffset])v=v.startContainer.childNodes[v.startOffset],R.currentNode=v;else{var z=v.startContainer;v.startOffset===(z.nodeType===Node.TEXT_NODE?z.length:z.childNodes.length)?(v=v.startContainer,R.currentNode=v,R.lastChild(),v=R.nextNode()):(v=v.startContainer,R.currentNode=v)}if(v){if(v=R.currentNode,v!==Z)for(v=v.parentNode;v&&v!==Z;)m(v)===NodeFilter.FILTER_REJECT&&(R.currentNode=v),v=v.parentNode;switch(v=R.currentNode,m(v)){case NodeFilter.FILTER_REJECT:for(v=R.nextSibling();!v&&R.parentNode();)v=R.nextSibling();break;case NodeFilter.FILTER_SKIP:v=R.nextNode()}for(;v&&(m=ne.compareDocumentPosition(v),!(m!==0&&!(m&ee)));)V.push(v),v=R.nextNode()}return V},this.normalizeTextNodes=function(v){v&&v.nextSibling&&(v=O(v,v.nextSibling)),v&&v.previousSibling&&O(v.previousSibling,v)},this.rangeContainsNode=function(v,m){var R=m.ownerDocument.createRange(),V=m.ownerDocument.createRange(),Z;return R.setStart(v.startContainer,v.startOffset),R.setEnd(v.endContainer,v.endOffset),V.selectNodeContents(m),Z=E(R,V),R.detach(),V.detach(),Z},this.mergeIntoParent=x,this.removeUnwantedNodes=I,this.removeAllChildNodes=function(v){for(;v.firstChild;)v.removeChild(v.firstChild)},this.getElementsByTagNameNS=function(v,m,R){var V=[];for(v=v.getElementsByTagNameNS(m,R),V.length=R=v.length,m=0;m<R;m+=1)V[m]=v.item(m);return V},this.getElementsByTagName=function(v,m){var R=[],V,Z,ne;for(V=v.getElementsByTagName(m),R.length=ne=V.length,Z=0;Z<ne;Z+=1)R[Z]=V.item(Z);return R},this.containsNode=function(v,m){return v===m||v.contains(m)},this.comparePoints=function(v,m,R,V){if(v===R)return V-m;var Z=v.compareDocumentPosition(R);return Z===2?Z=-1:Z===4?Z=1:Z===10?(m=w(v,R),Z=m<V?1:-1):(V=w(R,v),Z=V<m?-1:1),Z},this.adaptRangeDifferenceToZoomLevel=S,this.translateRect=function(v,m,R){return{top:S(v.top-m.top,R),left:S(v.left-m.left,R),bottom:S(v.bottom-m.top,R),right:S(v.right-m.left,R),width:S(v.width,R),height:S(v.height,R)}},this.getBoundingClientRect=function(v){var m=v.ownerDocument,R=A(),V=m.body;if((R.unscaledRangeClientRects===!1||R.rangeBCRIgnoresElementBCR)&&v.nodeType===Node.ELEMENT_NODE)return v=v.getBoundingClientRect(),R.elementBCRIgnoresBodyScroll?{left:v.left+V.scrollLeft,right:v.right+V.scrollLeft,top:v.top+V.scrollTop,bottom:v.bottom+V.scrollTop,width:v.width,height:v.height}:v;var Z;return y?Z=y:y=Z=m.createRange(),R=Z,R.selectNode(v),R.getBoundingClientRect()},this.mapKeyValObjOntoNode=function(v,m,R){Object.keys(m).forEach(function(V){var ne=V.split(":"),Z=ne[1],ne=R(ne[0]),ee=m[V];ne?(Z=v.getElementsByTagNameNS(ne,Z)[0],Z||(Z=v.ownerDocument.createElementNS(ne,V),v.appendChild(Z)),Z.textContent=ee):runtime.log("Key ignored: "+V)})},this.removeKeyElementsFromNode=function(v,m,R){m.forEach(function(V){var Z=V.split(":"),ne=Z[1];(Z=R(Z[0]))?(ne=v.getElementsByTagNameNS(Z,ne)[0])?ne.parentNode.removeChild(ne):runtime.log("Element for "+V+" not found."):runtime.log("Property Name ignored: "+V)})},this.getKeyValRepresentationOfNode=function(v,m){for(var R={},V=v.firstElementChild,Z;V;)(Z=m(V.namespaceURI))&&(R[Z+":"+V.localName]=V.textContent),V=V.nextElementSibling;return R},this.mapObjOntoNode=u,this.cloneEvent=function(v){var m=Object.create(null);return Object.keys(v.constructor.prototype).forEach(function(R){m[R]=v[R]}),m.prototype=v.constructor.prototype,m},this.getDirectChild=j,function(v){var m,R;R=runtime.getWindow(),R!==null&&(m=R.navigator.appVersion.toLowerCase(),R=m.indexOf("chrome")===-1&&(m.indexOf("applewebkit")!==-1||m.indexOf("safari")!==-1),m=m.indexOf("msie")!==-1||m.indexOf("trident")!==-1,R||m)&&(v.containsNode=_)}(this)},core.DomUtils=new core.DomUtilsImpl}(),core.Cursor=function(A,j){function M(u){u.parentNode&&(x.push(u.previousSibling),x.push(u.nextSibling),u.parentNode.removeChild(u))}function w(u,y,v){if(y.nodeType===Node.TEXT_NODE){runtime.assert(!!y,"putCursorIntoTextNode: invalid container");var m=y.parentNode;runtime.assert(!!m,"putCursorIntoTextNode: container without parent"),runtime.assert(0<=v&&v<=y.length,"putCursorIntoTextNode: offset is out of bounds"),v===0?m.insertBefore(u,y):(v!==y.length&&y.splitText(v),m.insertBefore(u,y.nextSibling))}else y.nodeType===Node.ELEMENT_NODE&&y.insertBefore(u,y.childNodes.item(v));x.push(u.previousSibling),x.push(u.nextSibling)}var E=A.createElementNS("urn:webodf:names:cursor","cursor"),N=A.createElementNS("urn:webodf:names:cursor","anchor"),O,x=[],I=A.createRange(),_,S=core.DomUtils;this.getNode=function(){return E},this.getAnchorNode=function(){return N.parentNode?N:E},this.getSelectedRange=function(){return _?(I.setStartBefore(E),I.collapse(!0)):(I.setStartAfter(O?N:E),I.setEndBefore(O?E:N)),I},this.setSelectedRange=function(u,y){I&&I!==u&&I.detach(),I=u,O=y!==!1,(_=u.collapsed)?(M(N),M(E),w(E,u.startContainer,u.startOffset)):(M(N),M(E),w(O?E:N,u.endContainer,u.endOffset),w(O?N:E,u.startContainer,u.startOffset)),x.forEach(S.normalizeTextNodes),x.length=0},this.hasForwardSelection=function(){return O},this.remove=function(){M(E),x.forEach(S.normalizeTextNodes),x.length=0},E.setAttributeNS("urn:webodf:names:cursor","memberId",j),N.setAttributeNS("urn:webodf:names:cursor","memberId",j)},core.Destroyable=function(){},core.Destroyable.prototype.destroy=function(A){},core.EventSource=function(){},core.EventSource.prototype.subscribe=function(A,j){},core.EventSource.prototype.unsubscribe=function(A,j){},core.EventNotifier=function(A){function j(w){runtime.assert(!M.hasOwnProperty(w),'Duplicated event ids: "'+w+'" registered more than once.'),M[w]=[]}var M={};this.emit=function(w,E){var N,O;for(runtime.assert(M.hasOwnProperty(w),'unknown event fired "'+w+'"'),O=M[w],N=0;N<O.length;N+=1)O[N](E)},this.subscribe=function(w,E){runtime.assert(M.hasOwnProperty(w),'tried to subscribe to unknown event "'+w+'"'),M[w].push(E)},this.unsubscribe=function(w,E){var N;runtime.assert(M.hasOwnProperty(w),'tried to unsubscribe from unknown event "'+w+'"'),N=M[w].indexOf(E),runtime.assert(N!==-1,'tried to unsubscribe unknown callback from event "'+w+'"'),N!==-1&&M[w].splice(N,1)},this.register=j,A&&A.forEach(j)},core.ScheduledTask=function(A,j,M){function w(){O&&(M(N),O=!1)}function E(){w(),A.apply(void 0,x),x=null}var N,O=!1,x=[],I=!1;this.trigger=function(){runtime.assert(I===!1,"Can't trigger destroyed ScheduledTask instance"),x=Array.prototype.slice.call(arguments),O||(O=!0,N=j(E))},this.triggerImmediate=function(){runtime.assert(I===!1,"Can't trigger destroyed ScheduledTask instance"),x=Array.prototype.slice.call(arguments),E()},this.processRequests=function(){O&&E()},this.cancel=w,this.restart=function(){runtime.assert(I===!1,"Can't trigger destroyed ScheduledTask instance"),w(),O=!0,N=j(E)},this.destroy=function(_){w(),I=!0,_()}},function(){var A;core.Task={},core.Task.SUPPRESS_MANUAL_PROCESSING=!1,core.Task.processTasks=function(){core.Task.SUPPRESS_MANUAL_PROCESSING||A.performRedraw()},core.Task.createRedrawTask=function(j){return new core.ScheduledTask(j,A.requestRedrawTask,A.cancelRedrawTask)},core.Task.createTimeoutTask=function(j,M){return new core.ScheduledTask(j,function(w){return runtime.setTimeout(w,M)},runtime.clearTimeout)},A=new function(){var j={};this.requestRedrawTask=function(M){var w=runtime.requestAnimationFrame(function(){M(),delete j[w]});return j[w]=M,w},this.performRedraw=function(){Object.keys(j).forEach(function(M){j[M](),runtime.cancelAnimationFrame(parseInt(M,10))}),j={}},this.cancelRedrawTask=function(M){runtime.cancelAnimationFrame(M),delete j[M]}}}(),core.EventSubscriptions=function(){function A(O,x,I){O.subscribe(x,I),M.push({eventSource:O,eventid:x,callback:I})}function j(){var O=[];M.forEach(function(x){x.eventSource.unsubscribe(x.eventid,x.callback)}),M.length=0,Object.keys(E).forEach(function(x){E[x].forEach(function(I){O.push(I.task.destroy)}),delete E[x]}),core.Async.destroyAll(O,function(){}),w=new core.EventNotifier}var M=[],w=new core.EventNotifier,E={},N=0;this.addSubscription=A,this.addFrameSubscription=function(O,x,I){var _,S,u,y;for(E.hasOwnProperty(x)||(E[x]=[]),u=E[x],y=0;y<u.length;y+=1)if(u[y].eventSource===O){_=u[y];break}_||(S="s"+N,N+=1,w.register(S),_={frameEventId:S,eventSource:O,task:core.Task.createRedrawTask(function(){w.emit(S,void 0)})},u.push(_),A(O,x,_.task.trigger)),w.subscribe(_.frameEventId,I)},this.unsubscribeAll=j,this.destroy=function(O){j(),O()}},core.LazyProperty=function(A){var j,M=!1;this.value=function(){return M||(j=A(),M=!0),j},this.reset=function(){M=!1}},core.LoopWatchDog=function(A,j){var M=Date.now(),w=0;this.check=function(){var E;if(A&&(E=Date.now(),E-M>A))throw runtime.log("alert","watchdog timeout"),"timeout!";if(0<j&&(w+=1,w>j))throw runtime.log("alert","watchdog loop overflow"),"loop overflow"}},core.NodeFilterChain=function(A){var j=NodeFilter.FILTER_REJECT,M=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(w){var E;for(E=0;E<A.length;E+=1)if(A[E].acceptNode(w)===j)return j;return M}},core.PositionIterator=function(A,j,M,w){function E(){this.acceptNode=function(Z){return!Z||Z.nodeType===v&&Z.length===0?V:R}}function N(Z){this.acceptNode=function(ne){return!ne||ne.nodeType===v&&ne.length===0?V:Z.acceptNode(ne)}}function O(){var Z=S.currentNode,ne=Z.nodeType;u=ne===v?Z.length-1:ne===m?1:0}function x(){if(S.previousSibling()===null){if(!S.parentNode()||S.currentNode===A)return S.firstChild(),!1;u=0}else O();return!0}function I(){var Z=S.currentNode,ne;if(ne=y(Z),Z!==A)for(Z=Z.parentNode;Z&&Z!==A;)y(Z)===V&&(S.currentNode=Z,ne=V),Z=Z.parentNode;return ne===V?(u=S.currentNode.nodeType===v?Z.length:1,Z=_.nextPosition()):Z=ne===R?!0:_.nextPosition(),Z&&runtime.assert(y(S.currentNode)===R,"moveToAcceptedNode did not result in walker being on an accepted node"),Z}var _=this,S,u,y,v=Node.TEXT_NODE,m=Node.ELEMENT_NODE,R=NodeFilter.FILTER_ACCEPT,V=NodeFilter.FILTER_REJECT;this.nextPosition=function(){var Z=S.currentNode,ne=Z.nodeType;if(Z===A)return!1;if(u===0&&ne===m)S.firstChild()===null&&(u=1);else if(ne===v&&u+1<Z.length)u+=1;else if(S.nextSibling()!==null)u=0;else if(S.parentNode())u=1;else return!1;return!0},this.previousPosition=function(){var Z=!0,ne=S.currentNode;return u===0?Z=x():ne.nodeType===v?--u:S.lastChild()!==null?O():ne===A?Z=!1:u=0,Z},this.previousNode=x,this.container=function(){var Z=S.currentNode,ne=Z.nodeType;return u===0&&ne!==v&&(Z=Z.parentNode),Z},this.rightNode=function(){var Z=S.currentNode,ne=Z.nodeType;if(ne===v&&u===Z.length)for(Z=Z.nextSibling;Z&&y(Z)!==R;)Z=Z.nextSibling;else ne===m&&u===1&&(Z=null);return Z},this.leftNode=function(){var Z=S.currentNode;if(u===0)for(Z=Z.previousSibling;Z&&y(Z)!==R;)Z=Z.previousSibling;else if(Z.nodeType===m)for(Z=Z.lastChild;Z&&y(Z)!==R;)Z=Z.previousSibling;return Z},this.getCurrentNode=function(){return S.currentNode},this.unfilteredDomOffset=function(){if(S.currentNode.nodeType===v)return u;for(var Z=0,ne=S.currentNode,ne=u===1?ne.lastChild:ne.previousSibling;ne;)Z+=1,ne=ne.previousSibling;return Z},this.getPreviousSibling=function(){var Z=S.currentNode,ne=S.previousSibling();return S.currentNode=Z,ne},this.getNextSibling=function(){var Z=S.currentNode,ne=S.nextSibling();return S.currentNode=Z,ne},this.setPositionBeforeElement=function(Z){return runtime.assert(!!Z,"setPositionBeforeElement called without element"),S.currentNode=Z,u=0,I()},this.setUnfilteredPosition=function(Z,ne){return runtime.assert(!!Z,"PositionIterator.setUnfilteredPosition called without container"),S.currentNode=Z,Z.nodeType===v?(u=ne,runtime.assert(ne<=Z.length,"Error in setPosition: "+ne+" > "+Z.length),runtime.assert(0<=ne,"Error in setPosition: "+ne+" < 0"),ne===Z.length&&(S.nextSibling()?u=0:S.parentNode()?u=1:runtime.assert(!1,"Error in setUnfilteredPosition: position not valid."))):ne<Z.childNodes.length?(S.currentNode=Z.childNodes.item(ne),u=0):u=1,I()},this.moveToEnd=function(){S.currentNode=A,u=1},this.moveToEndOfNode=function(Z){Z.nodeType===v?_.setUnfilteredPosition(Z,Z.length):(S.currentNode=Z,u=1)},this.isBeforeNode=function(){return u===0},this.getNodeFilter=function(){return y},y=(M?new N(M):new E).acceptNode,y.acceptNode=y,j=j||NodeFilter.SHOW_ALL,runtime.assert(A.nodeType!==Node.TEXT_NODE,"Internet Explorer doesn't allow tree walker roots to be text nodes"),S=A.ownerDocument.createTreeWalker(A,j,y,w),u=0,S.firstChild()===null&&(u=1)},core.PositionFilter=function(){},core.PositionFilter.FilterResult={FILTER_ACCEPT:1,FILTER_REJECT:2,FILTER_SKIP:3},core.PositionFilter.prototype.acceptPosition=function(A){},core.PositionFilterChain=function(){var A=[],j=core.PositionFilter.FilterResult.FILTER_ACCEPT,M=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(w){var E;for(E=0;E<A.length;E+=1)if(A[E].acceptPosition(w)===M)return M;return j},this.addFilter=function(w){A.push(w)}},core.StepDirection={PREVIOUS:1,NEXT:2},core.StepIterator=function(A,j){function M(){u=null,v=y=void 0}function w(){return v===void 0&&(v=A.acceptPosition(j)===_),v}function E(m,R){return M(),j.setUnfilteredPosition(m,R)}function N(){return u||(u=j.container()),u}function O(){return y===void 0&&(y=j.unfilteredDomOffset()),y}function x(){for(M();j.nextPosition();)if(M(),w())return!0;return!1}function I(){for(M();j.previousPosition();)if(M(),w())return!0;return!1}var _=core.PositionFilter.FilterResult.FILTER_ACCEPT,S=core.StepDirection.NEXT,u,y,v;this.isStep=w,this.setPosition=E,this.container=N,this.offset=O,this.nextStep=x,this.previousStep=I,this.advanceStep=function(m){return m===S?x():I()},this.roundToClosestStep=function(){var m,R,V=w();return V||(m=N(),R=O(),V=I(),V||(E(m,R),V=x())),V},this.roundToPreviousStep=function(){var m=w();return m||(m=I()),m},this.roundToNextStep=function(){var m=w();return m||(m=x()),m},this.leftNode=function(){return j.leftNode()},this.snapshot=function(){return new core.StepIterator.StepSnapshot(N(),O())},this.restore=function(m){E(m.container,m.offset)}},core.StepIterator.StepSnapshot=function(A,j){this.container=A,this.offset=j},core.Utils=function(){function A(j,M){if(M&&Array.isArray(M)){if(j=j||[],!Array.isArray(j))throw"Destination is not an array.";j=j.concat(M.map(function(w){return A(null,w)}))}else if(M&&typeof M=="object"){if(j=j||{},typeof j!="object")throw"Destination is not an object.";Object.keys(M).forEach(function(w){j[w]=A(j[w],M[w])})}else j=M;return j}this.hashString=function(j){var M=0,w,E;for(w=0,E=j.length;w<E;w+=1)M=(M<<5)-M+j.charCodeAt(w),M|=0;return M},this.mergeObjects=function(j,M){return Object.keys(M).forEach(function(w){j[w]=A(j[w],M[w])}),j}},core.Zip=function(A,j){function M(_,S){var u=x.file(_);u?S(null,u.asUint8Array()):S(_+" not found.",null)}function w(_,S){M(_,function(u,y){if(u||y===null)return S(u,null);var v=runtime.byteArrayToString(y,"utf8");S(null,v)})}function E(_,S){try{_(x.generate({type:"uint8array",compression:"STORE"}))}catch(u){S(u.message)}}function N(_,S){E(function(u){runtime.writeFile(_,u,S)},S)}var O=this,x,I=new core.Base64;this.load=M,this.save=function(_,S,u,y){x.file(_,S,{date:y,compression:u?"DEFLATE":"STORE"})},this.remove=function(_){var S=x.file(_)!==null;return x.remove(_),S},this.write=function(_){N(A,_)},this.writeAs=N,this.createByteArray=E,this.loadContentXmlAsFragments=function(_,S){w(_,function(u,y){if(u)return S.rootElementReady(u);S.rootElementReady(null,y,!0)})},this.loadAsString=w,this.loadAsDOM=function(_,S){w(_,function(u,y){if(u||y===null)S(u,null);else{var v=new DOMParser().parseFromString(y,"text/xml");S(null,v)}})},this.loadAsDataURL=function(_,S,u){M(_,function(y,v){if(y||!v)return u(y,null);var m=0,R;for(S||(S=v[1]===80&&v[2]===78&&v[3]===71?"image/png":v[0]===255&&v[1]===216&&v[2]===255?"image/jpeg":v[0]===71&&v[1]===73&&v[2]===70?"image/gif":""),R="data:"+S+";base64,";m<v.length;)R+=I.convertUTF8ArrayToBase64(v.subarray(m,Math.min(m+45e3,v.length))),m+=45e3;u(null,R)})},this.getEntries=function(){return Object.keys(x.files).map(function(_){return{filename:_,date:x.files[_].date}})},x=new externs.JSZip,j!==null&&runtime.readFile(A,"binary",function(_,S){if(typeof S=="string"&&(_="file was read as a string. Should be Uint8Array."),_||!S||S.length===0)j("File '"+A+"' cannot be read. Err: "+(_||"[none]"),O);else try{x.load(S,{checkCRC32:!1}),j(null,O)}catch(u){j(u.message,O)}})},core.SimpleClientRect=null,gui.CommonConstraints={EDIT:{ANNOTATIONS:{ONLY_DELETE_OWN:"onlyDeleteOwn"},REVIEW_MODE:"reviewMode"}},gui.SessionConstraints=function(){function A(w){j.hasOwnProperty(w)||(j[w]=!1,M.register(w))}var j={},M=new core.EventNotifier;this.registerConstraint=A,this.subscribe=function(w,E){A(w),M.subscribe(w,E)},this.unsubscribe=function(w,E){M.unsubscribe(w,E)},this.setState=function(w,E){runtime.assert(j.hasOwnProperty(w)===!0,"No such constraint"),j[w]!==E&&(j[w]=E,M.emit(w,E))},this.getState=function(w){return runtime.assert(j.hasOwnProperty(w)===!0,"No such constraint"),j[w]}},gui.BlacklistNamespaceNodeFilter=function(A){var j={},M=NodeFilter.FILTER_REJECT,w=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(E){return!E||j.hasOwnProperty(E.namespaceURI)?M:w},function(){A.forEach(function(E){j[E]=!0})}()},odf.Namespaces={namespaceMap:{config:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",db:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dc:"http://purl.org/dc/elements/1.1/",dr3d:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",draw:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chart:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fo:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",form:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",math:"http://www.w3.org/1998/Math/MathML",meta:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",number:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",office:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentation:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",style:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svg:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",table:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",text:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",xforms:"http://www.w3.org/2002/xforms",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},prefixMap:{},configns:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",dbns:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dcns:"http://purl.org/dc/elements/1.1/",dr3dns:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",drawns:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chartns:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fons:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",formns:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",mathns:"http://www.w3.org/1998/Math/MathML",metans:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",numberns:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",officens:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentationns:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",stylens:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svgns:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",tablens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",textns:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",xformsns:"http://www.w3.org/2002/xforms",xlinkns:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/XML/1998/namespace"},function(){var A=odf.Namespaces.namespaceMap,j=odf.Namespaces.prefixMap,M;for(M in A)A.hasOwnProperty(M)&&(j[A[M]]=M)}(),odf.Namespaces.forEachPrefix=function(A){var j=odf.Namespaces.namespaceMap,M;for(M in j)j.hasOwnProperty(M)&&A(M,j[M])},odf.Namespaces.lookupNamespaceURI=function(A){var j=null;return odf.Namespaces.namespaceMap.hasOwnProperty(A)&&(j=odf.Namespaces.namespaceMap[A]),j},odf.Namespaces.lookupPrefix=function(A){var j=odf.Namespaces.prefixMap;return j.hasOwnProperty(A)?j[A]:null},odf.Namespaces.lookupNamespaceURI.lookupNamespaceURI=odf.Namespaces.lookupNamespaceURI,function(){odf.OdfSchemaImpl=function(){var A=[["config:config-item","uncategorized"],["form:item","object"],["form:option","uncategorized"],["math:math","field"],["meta:user-defined","uncategorized"],["number:currency-symbol","uncategorized"],["number:embedded-text","uncategorized"],["number:text","uncategorized"],["presentation:date-time-decl","uncategorized"],["presentation:footer-decl","uncategorized"],["presentation:header-decl","uncategorized"],["svg:desc","text"],["svg:title","text"],["table:desc","uncategorized"],["table:title","uncategorized"],["text:a","text"],["text:author-initials","field"],["text:author-name","field"],["text:bibliography-mark","field"],["text:bookmark-ref","field"],["text:chapter","field"],["text:character-count","field"],["text:conditional-text","field"],["text:creation-date","field"],["text:creation-time","field"],["text:creator","field"],["text:database-display","field"],["text:database-name","field"],["text:database-row-number","field"],["text:date","field"],["text:dde-connection","field"],["text:description","field"],["text:editing-cycles","field"],["text:editing-duration","field"],["text:execute-macro","uncategorized"],["text:expression","uncategorized"],["text:file-name","field"],["text:h","text"],["text:hidden-paragraph","text"],["text:hidden-text","text"],["text:image-count","field"],["text:index-entry-span","uncategorized"],["text:index-title-template","uncategorized"],["text:initial-creator","field"],["text:keywords","field"],["text:linenumbering-separator","style"],["text:measure","uncategorized"],["text:meta","uncategorized"],["text:meta-field","uncategorized"],["text:modification-date","field"],["text:modification-time","field"],["text:note-citation","field"],["text:note-continuation-notice-backward","style"],["text:note-continuation-notice-forward","style"],["text:note-ref","field"],["text:object-count","field"],["text:p","text"],["text:page-continuation","uncategorized"],["text:page-count","field"],["text:page-number","field"],["text:page-variable-get","field"],["text:page-variable-set","field"],["text:paragraph-count","field"],["text:placeholder","field"],["text:print-date","field"],["text:print-time","field"],["text:printed-by","field"],["text:reference-ref","field"],["text:ruby-base","text"],["text:ruby-text","text"],["text:script","text"],["text:sender-city","field"],["text:sender-company","field"],["text:sender-country","field"],["text:sender-email","field"],["text:sender-fax","field"],["text:sender-firstname","field"],["text:sender-initials","field"],["text:sender-lastname","field"],["text:sender-phone-private","field"],["text:sender-phone-work","field"],["text:sender-position","field"],["text:sender-postal-code","field"],["text:sender-state-or-province","field"],["text:sender-street","field"],["text:sender-title","field"],["text:sequence","uncategorized"],["text:sequence-ref","uncategorized"],["text:sheet-name","uncategorized"],["text:span","text"],["text:subject","field"],["text:table-count","field"],["text:table-formula","deprecated"],["text:template-name","uncategorized"],["text:text-input","field"],["text:time","field"],["text:title","field"],["text:user-defined","field"],["text:user-field-get","field"],["text:user-field-input","field"],["text:variable-get","field"],["text:variable-input","field"],["text:variable-set","field"],["text:word-count","field"],["xforms:model","uncategorized"]],j={};this.isTextContainer=function(M,w){return j[M+":"+w]==="text"},this.isField=function(M,w){return j[M+":"+w]==="field"},this.getFields=function(){return A.filter(function(M){return M[1]==="field"}).map(function(M){return M[0]})},function(){A.forEach(function(M){var w=M[1],E=M[0].split(":");M=E[0];var E=E[1],N=odf.Namespaces.lookupNamespaceURI(M);N?j[N+":"+E]=w:runtime.log("DEBUG: OdfSchema - unknown prefix '"+M+"'")})}()},odf.OdfSchema=new odf.OdfSchemaImpl}(),odf.OdfUtilsImpl=function(){function A(le){return(le&&le.localName)==="image"&&le.namespaceURI===he}function j(le){return le!==null&&le.nodeType===Node.ELEMENT_NODE&&le.localName==="frame"&&le.namespaceURI===he&&le.getAttributeNS(ie,"anchor-type")==="as-char"}function M(le){var me;return(me=(le&&le.localName)==="annotation"&&le.namespaceURI===odf.Namespaces.officens)||(me=(le&&le.localName)==="div"&&le.className==="annotationWrapper"),me}function w(le){return(le&&le.localName)==="a"&&le.namespaceURI===ie}function E(le){var me=le&&le.localName;return(me==="p"||me==="h")&&le.namespaceURI===ie}function N(le,me){for(le&&me!==void 0&&!E(le)&&le.childNodes.item(me)&&(le=le.childNodes.item(me));le&&!E(le);)le=le.parentNode;return le}function O(le,me){for(;le&&le!==me;){if(le.namespaceURI===odf.Namespaces.officens&&le.localName==="annotation")return le;le=le.parentNode}return null}function x(le){return/^[ \t\r\n]+$/.test(le)}function I(le){if(le===null||le.nodeType!==Node.ELEMENT_NODE)return!1;var me=le.localName;return rt.isTextContainer(le.namespaceURI,me)||me==="span"&&le.className==="webodf-annotationHighlight"}function _(le){return le===null||le.nodeType!==Node.ELEMENT_NODE?!1:rt.isField(le.namespaceURI,le.localName)}function S(le){var me=le&&le.localName,De=!1;return me&&(le=le.namespaceURI,le===ie&&(De=me==="s"||me==="tab"||me==="line-break")),De}function u(le){return S(le)||_(le)||j(le)||M(le)}function y(le){var me=le&&le.localName,De=!1;return me&&(le=le.namespaceURI,le===ie&&(De=me==="s")),De}function v(le){return ze.indexOf(le.namespaceURI)!==-1}function m(le){if(S(le)||_(le))return!1;if(I(le.parentNode)&&le.nodeType===Node.TEXT_NODE)return le.textContent.length===0;for(le=le.firstChild;le;){if(v(le)||!m(le))return!1;le=le.nextSibling}return!0}function R(le){for(;le.firstChild!==null&&I(le);)le=le.firstChild;return le}function V(le){for(;le.lastChild!==null&&I(le);)le=le.lastChild;return le}function Z(le){for(;!E(le)&&le.previousSibling===null;)le=le.parentNode;return E(le)?null:V(le.previousSibling)}function ne(le){for(;!E(le)&&le.nextSibling===null;)le=le.parentNode;return E(le)?null:R(le.nextSibling)}function ee(le){for(var me=!1;le;)if(le.nodeType===Node.TEXT_NODE)if(le.length===0)le=Z(le);else return!x(le.data.substr(le.length-1,1));else u(le)?(me=y(le)===!1,le=null):le=Z(le);return me}function z(le){var me=!1,De;for(le=le&&R(le);le;){if(De=le.nodeType===Node.TEXT_NODE?le.length:0,0<De&&!x(le.data)){me=!0;break}if(u(le)){me=!0;break}le=ne(le)}return me}function P(le,me){return x(le.data.substr(me))?!z(ne(le)):!1}function Y(le,me){var De=le.data,Me;return!x(De[me])||u(le.parentNode)?!1:(0<me?x(De[me-1])||(Me=!0):ee(Z(le))&&(Me=!0),Me===!0?!P(le,me):!1)}function $(le){return(le=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px)|(%))/.exec(le))?{value:parseFloat(le[1]),unit:le[3]}:null}function J(le){return(le=$(le))&&(0>le.value||le.unit==="%")?null:le}function te(le){return(le=$(le))&&le.unit!=="%"?null:le}function q(le){switch(le.namespaceURI){case odf.Namespaces.drawns:case odf.Namespaces.svgns:case odf.Namespaces.dr3dns:return!1;case odf.Namespaces.textns:switch(le.localName){case"note-body":case"ruby-text":return!1}break;case odf.Namespaces.officens:switch(le.localName){case"annotation":case"binary-data":case"event-listeners":return!1}break;default:switch(le.localName){case"cursor":case"editinfo":return!1}}return!0}function K(le){return!!(N(le)&&(!x(le.textContent)||Y(le,0)))}function U(le,me){for(;0<me.length&&!Ne.rangeContainsNode(le,me[0]);)me.shift();for(;0<me.length&&!Ne.rangeContainsNode(le,me[me.length-1]);)me.pop()}function F(le,me,De){var Me;return Me=Ne.getNodesInRange(le,function(Re){var we=NodeFilter.FILTER_REJECT;return S(Re.parentNode)||_(Re.parentNode)||M(Re)?we=NodeFilter.FILTER_REJECT:Re.nodeType===Node.TEXT_NODE?(De||K(Re))&&(we=NodeFilter.FILTER_ACCEPT):u(Re)?we=NodeFilter.FILTER_ACCEPT:(q(Re)||I(Re))&&(we=NodeFilter.FILTER_SKIP),we},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT),me||U(le,Me),Me}function re(le,me,De){for(;le;){if(De(le)){me[0]!==le&&me.unshift(le);break}if(M(le))break;le=le.parentNode}}function W(le,me){var De=le;if(me<De.childNodes.length-1)De=De.childNodes[me+1];else{for(;!De.nextSibling;)De=De.parentNode;De=De.nextSibling}for(;De.firstChild;)De=De.firstChild;return De}var ie=odf.Namespaces.textns,he=odf.Namespaces.drawns,ve=odf.Namespaces.xlinkns,Ne=core.DomUtils,ze=[odf.Namespaces.dbns,odf.Namespaces.dcns,odf.Namespaces.dr3dns,odf.Namespaces.drawns,odf.Namespaces.chartns,odf.Namespaces.formns,odf.Namespaces.numberns,odf.Namespaces.officens,odf.Namespaces.presentationns,odf.Namespaces.stylens,odf.Namespaces.svgns,odf.Namespaces.tablens,odf.Namespaces.textns],rt=odf.OdfSchema;this.isImage=A,this.isCharacterFrame=j,this.isInlineRoot=M,this.isTextSpan=function(le){return(le&&le.localName)==="span"&&le.namespaceURI===ie},this.isHyperlink=w,this.getHyperlinkTarget=function(le){return le.getAttributeNS(ve,"href")||""},this.isParagraph=E,this.getParagraphElement=N,this.getParentAnnotation=O,this.isWithinAnnotation=function(le,me){return!!O(le,me)},this.getAnnotationCreator=function(le){return le.getElementsByTagNameNS(odf.Namespaces.dcns,"creator")[0].textContent},this.isListItem=function(le){return(le&&le.localName)==="list-item"&&le.namespaceURI===ie},this.isLineBreak=function(le){return(le&&le.localName)==="line-break"&&le.namespaceURI===ie},this.isODFWhitespace=x,this.isGroupingElement=I,this.isFieldElement=_,this.isCharacterElement=S,this.isAnchoredAsCharacterElement=u,this.isSpaceElement=y,this.isODFNode=v,this.hasNoODFContent=m,this.firstChild=R,this.lastChild=V,this.previousNode=Z,this.nextNode=ne,this.scanLeftForNonSpace=ee,this.lookLeftForCharacter=function(le){var me,De=me=0;return le.nodeType===Node.TEXT_NODE&&(De=le.length),0<De?(me=le.data,me=x(me.substr(De-1,1))?De===1?ee(Z(le))?2:0:x(me.substr(De-2,1))?0:2:1):u(le)&&(me=1),me},this.lookRightForCharacter=function(le){var me=!1,De=0;return le&&le.nodeType===Node.TEXT_NODE&&(De=le.length),0<De?me=!x(le.data.substr(0,1)):u(le)&&(me=!0),me},this.scanLeftForAnyCharacter=function(le){var me=!1,De;for(le=le&&V(le);le;){if(De=le.nodeType===Node.TEXT_NODE?le.length:0,0<De&&!x(le.data)){me=!0;break}if(u(le)){me=!0;break}le=Z(le)}return me},this.scanRightForAnyCharacter=z,this.isTrailingWhitespace=P,this.isSignificantWhitespace=Y,this.isDowngradableSpaceElement=function(le){return y(le)?ee(Z(le))&&z(ne(le)):!1},this.parseLength=$,this.parseNonNegativeLength=J,this.parseFoFontSize=function(le){var me;return me=(me=$(le))&&(0>=me.value||me.unit==="%")?null:me,me||te(le)},this.parseFoLineHeight=function(le){return J(le)||te(le)},this.isTextContentContainingNode=q,this.getTextNodes=function(le,me){var De;return De=Ne.getNodesInRange(le,function(Me){var Re=NodeFilter.FILTER_REJECT;return Me.nodeType===Node.TEXT_NODE?K(Me)&&(Re=NodeFilter.FILTER_ACCEPT):q(Me)&&(Re=NodeFilter.FILTER_SKIP),Re},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT),me||U(le,De),De},this.getTextElements=F,this.getParagraphElements=function(le){var me;return me=Ne.getNodesInRange(le,function(De){var Me=NodeFilter.FILTER_REJECT;return E(De)?Me=NodeFilter.FILTER_ACCEPT:(q(De)||I(De))&&(Me=NodeFilter.FILTER_SKIP),Me},NodeFilter.SHOW_ELEMENT),re(le.startContainer,me,E),me},this.getImageElements=function(le){var me;return me=Ne.getNodesInRange(le,function(De){var Me=NodeFilter.FILTER_SKIP;return A(De)&&(Me=NodeFilter.FILTER_ACCEPT),Me},NodeFilter.SHOW_ELEMENT),re(le.startContainer,me,A),me},this.getHyperlinkElements=function(le){var me=[],De=le.cloneRange();return le.collapsed&&le.endContainer.nodeType===Node.ELEMENT_NODE&&(le=W(le.endContainer,le.endOffset),le.nodeType===Node.TEXT_NODE&&De.setEnd(le,1)),F(De,!0,!1).forEach(function(Me){for(Me=Me.parentNode;!E(Me);){if(w(Me)&&me.indexOf(Me)===-1){me.push(Me);break}Me=Me.parentNode}}),De.detach(),me},this.getNormalizedFontFamilyName=function(le){return/^(["'])(?:.|[\n\r])*?\1$/.test(le)||(le=le.replace(/^[ \t\r\n\f]*((?:.|[\n\r])*?)[ \t\r\n\f]*$/,"$1"),/[ \t\r\n\f]/.test(le)&&(le="'"+le.replace(/[ \t\r\n\f]+/g," ")+"'")),le}},odf.OdfUtils=new odf.OdfUtilsImpl,gui.OdfTextBodyNodeFilter=function(){var A=odf.OdfUtils,j=Node.TEXT_NODE,M=NodeFilter.FILTER_REJECT,w=NodeFilter.FILTER_ACCEPT,E=odf.Namespaces.textns;this.acceptNode=function(N){if(N.nodeType===j){if(!A.isGroupingElement(N.parentNode))return M}else if(N.namespaceURI===E&&N.localName==="tracked-changes")return M;return w}},xmldom.LSSerializerFilter=function(){},xmldom.LSSerializerFilter.prototype.acceptNode=function(A){},odf.OdfNodeFilter=function(){this.acceptNode=function(A){return A.namespaceURI==="http://www.w3.org/1999/xhtml"?NodeFilter.FILTER_SKIP:A.namespaceURI&&A.namespaceURI.match(/^urn:webodf:/)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}},xmldom.XPathIterator=function(){},xmldom.XPathIterator.prototype.next=function(){},xmldom.XPathIterator.prototype.reset=function(){};function createXPathSingleton(){function A(S,u,y){return S!==-1&&(S<u||u===-1)&&(S<y||y===-1)}function j(S){for(var u=[],y=0,v=S.length,m;y<v;){var R=S,V=v,Z=u,ne="",ee=[],z=R.indexOf("[",y),P=R.indexOf("/",y),Y=R.indexOf("=",y);if(A(P,z,Y)?(ne=R.substring(y,P),y=P+1):A(z,P,Y)?(ne=R.substring(y,z),y=_(R,z,ee)):A(Y,P,z)?(ne=R.substring(y,Y),y=Y):(ne=R.substring(y,V),y=V),Z.push({location:ne,predicates:ee}),y<v&&S[y]==="="){if(m=S.substring(y+1,v),2<m.length&&(m[0]==="'"||m[0]==='"'))m=m.slice(1,m.length-1);else try{m=parseInt(m,10)}catch{}y=v}}return{steps:u,value:m}}function M(){var S=null,u=!1;this.setNode=function(y){S=y},this.reset=function(){u=!1},this.next=function(){var y=u?null:S;return u=!0,y}}function w(S,u,y){this.reset=function(){S.reset()},this.next=function(){for(var v=S.next();v&&(v.nodeType===Node.ELEMENT_NODE&&(v=v.getAttributeNodeNS(u,y)),!v);)v=S.next();return v}}function E(S,u){var y=S.next(),v=null;this.reset=function(){S.reset(),y=S.next(),v=null},this.next=function(){for(;y;){if(v)if(u&&v.firstChild)v=v.firstChild;else{for(;!v.nextSibling&&v!==y;)v=v.parentNode;v===y?y=S.next():v=v.nextSibling}else do(v=y.firstChild)||(y=S.next());while(y&&!v);if(v&&v.nodeType===Node.ELEMENT_NODE)return v}return null}}function N(S,u){this.reset=function(){S.reset()},this.next=function(){for(var y=S.next();y&&!u(y);)y=S.next();return y}}function O(S,u,y){u=u.split(":",2);var v=y(u[0]),m=u[1];return new N(S,function(R){return R.localName===m&&R.namespaceURI===v})}function x(S,u,y){var v=new M,m=I(v,u,y),R=u.value;return R===void 0?new N(S,function(V){return v.setNode(V),m.reset(),m.next()!==null}):new N(S,function(V){return v.setNode(V),m.reset(),(V=m.next())?V.nodeValue===R:!1})}var I,_;return _=function(S,u,y){for(var v=u,m=S.length,R=0;v<m;)S[v]==="]"?(--R,0>=R&&y.push(j(S.substring(u,v)))):S[v]==="["&&(0>=R&&(u=v+1),R+=1),v+=1;return v},I=function(S,u,y){var v,m,R,V;for(v=0;v<u.steps.length;v+=1){if(R=u.steps[v],m=R.location,m==="")S=new E(S,!1);else if(m[0]==="@"){if(m=m.substr(1).split(":",2),V=y(m[0]),!V)throw"No namespace associated with the prefix "+m[0];S=new w(S,V,m[1])}else m!=="."&&(S=new E(S,!1),m.indexOf(":")!==-1&&(S=O(S,m,y)));for(m=0;m<R.predicates.length;m+=1)V=R.predicates[m],S=x(S,V,y)}return S},{getODFElementsWithXPath:function(S,u,y){var v=S.ownerDocument,m=[],R=null;if(v&&typeof v.evaluate=="function")for(y=v.evaluate(u,S,y,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null),R=y.iterateNext();R!==null;)R.nodeType===Node.ELEMENT_NODE&&m.push(R),R=y.iterateNext();else{for(m=new M,m.setNode(S),S=j(u),m=I(m,S,y),S=[],y=m.next();y;)S.push(y),y=m.next();m=S}return m}}}xmldom.XPath=createXPathSingleton(),odf.StyleInfo=function(){function A(q,K){var U,F,re,W,ie,he=0;for((U=J[q.localName])&&(re=U[q.namespaceURI])&&(he=re.length),U=0;U<he;U+=1)F=re[U],W=F.ns,ie=F.localname,(F=q.getAttributeNS(W,ie))&&q.setAttributeNS(W,Y[W]+ie,K+F);for(re=q.firstElementChild;re;)A(re,K),re=re.nextElementSibling}function j(q,K){var U,F,re,W,ie,he=0;for((U=J[q.localName])&&(re=U[q.namespaceURI])&&(he=re.length),U=0;U<he;U+=1)F=re[U],W=F.ns,ie=F.localname,(F=q.getAttributeNS(W,ie))&&(F=F.replace(K,""),q.setAttributeNS(W,Y[W]+ie,F));for(re=q.firstElementChild;re;)j(re,K),re=re.nextElementSibling}function M(q,K){var U,F,re,W,ie,he=0;for((U=J[q.localName])&&(re=U[q.namespaceURI])&&(he=re.length),U=0;U<he;U+=1)W=re[U],F=W.ns,ie=W.localname,(F=q.getAttributeNS(F,ie))&&(K=K||{},W=W.keyname,K.hasOwnProperty(W)?K[W][F]=1:(ie={},ie[F]=1,K[W]=ie));return K}function w(q,K){var U,F;for(M(q,K),U=q.firstChild;U;)U.nodeType===Node.ELEMENT_NODE&&(F=U,w(F,K)),U=U.nextSibling}function E(q,K,U){this.key=q,this.name=K,this.family=U,this.requires={}}function N(q,K,U){var F=q+'"'+K,re=U[F];return re||(re=U[F]=new E(F,q,K)),re}function O(q,K,U){var F,re,W,ie,he,ve=0;if(F=q.getAttributeNS(ee,"name"),ie=q.getAttributeNS(ee,"family"),F&&ie&&(K=N(F,ie,U)),K)for((F=J[q.localName])&&(W=F[q.namespaceURI])&&(ve=W.length),F=0;F<ve;F+=1)ie=W[F],re=ie.ns,he=ie.localname,(re=q.getAttributeNS(re,he))&&(ie=ie.keyname,ie=N(re,ie,U),K.requires[ie.key]=ie);for(q=q.firstElementChild;q;)O(q,K,U),q=q.nextElementSibling;return U}function x(q,K){var U=K[q.family];U||(U=K[q.family]={}),U[q.name]=1,Object.keys(q.requires).forEach(function(F){x(q.requires[F],K)})}function I(q,K){var U=O(q,null,{});Object.keys(U).forEach(function(F){F=U[F];var re=K[F.family];re&&re.hasOwnProperty(F.name)&&x(F,K)})}function _(q,K){function U(ie){(ie=W.getAttributeNS(ee,ie))&&(q[ie]=!0)}var F=["font-name","font-name-asian","font-name-complex"],re,W;for(re=K&&K.firstElementChild;re;)W=re,F.forEach(U),_(q,W),re=re.nextElementSibling}function S(q,K){function U(ie){var he=W.getAttributeNS(ee,ie);he&&K.hasOwnProperty(he)&&W.setAttributeNS(ee,"style:"+ie,K[he])}var F=["font-name","font-name-asian","font-name-complex"],re,W;for(re=q&&q.firstElementChild;re;)W=re,F.forEach(U),S(W,K),re=re.nextElementSibling}var u=odf.Namespaces.chartns,y=odf.Namespaces.dbns,v=odf.Namespaces.dr3dns,m=odf.Namespaces.drawns,R=odf.Namespaces.formns,V=odf.Namespaces.numberns,Z=odf.Namespaces.officens,ne=odf.Namespaces.presentationns,ee=odf.Namespaces.stylens,z=odf.Namespaces.tablens,P=odf.Namespaces.textns,Y={"urn:oasis:names:tc:opendocument:xmlns:chart:1.0":"chart:","urn:oasis:names:tc:opendocument:xmlns:database:1.0":"db:","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0":"dr3d:","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":"draw:","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":"fo:","urn:oasis:names:tc:opendocument:xmlns:form:1.0":"form:","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":"number:","urn:oasis:names:tc:opendocument:xmlns:office:1.0":"office:","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0":"presentation:","urn:oasis:names:tc:opendocument:xmlns:style:1.0":"style:","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0":"svg:","urn:oasis:names:tc:opendocument:xmlns:table:1.0":"table:","urn:oasis:names:tc:opendocument:xmlns:text:1.0":"chart:","http://www.w3.org/XML/1998/namespace":"xml:"},$={text:[{ens:ee,en:"tab-stop",ans:ee,a:"leader-text-style"},{ens:ee,en:"drop-cap",ans:ee,a:"style-name"},{ens:P,en:"notes-configuration",ans:P,a:"citation-body-style-name"},{ens:P,en:"notes-configuration",ans:P,a:"citation-style-name"},{ens:P,en:"a",ans:P,a:"style-name"},{ens:P,en:"alphabetical-index",ans:P,a:"style-name"},{ens:P,en:"linenumbering-configuration",ans:P,a:"style-name"},{ens:P,en:"list-level-style-number",ans:P,a:"style-name"},{ens:P,en:"ruby-text",ans:P,a:"style-name"},{ens:P,en:"span",ans:P,a:"style-name"},{ens:P,en:"a",ans:P,a:"visited-style-name"},{ens:ee,en:"text-properties",ans:ee,a:"text-line-through-text-style"},{ens:P,en:"alphabetical-index-source",ans:P,a:"main-entry-style-name"},{ens:P,en:"index-entry-bibliography",ans:P,a:"style-name"},{ens:P,en:"index-entry-chapter",ans:P,a:"style-name"},{ens:P,en:"index-entry-link-end",ans:P,a:"style-name"},{ens:P,en:"index-entry-link-start",ans:P,a:"style-name"},{ens:P,en:"index-entry-page-number",ans:P,a:"style-name"},{ens:P,en:"index-entry-span",ans:P,a:"style-name"},{ens:P,en:"index-entry-tab-stop",ans:P,a:"style-name"},{ens:P,en:"index-entry-text",ans:P,a:"style-name"},{ens:P,en:"index-title-template",ans:P,a:"style-name"},{ens:P,en:"list-level-style-bullet",ans:P,a:"style-name"},{ens:P,en:"outline-level-style",ans:P,a:"style-name"}],paragraph:[{ens:m,en:"caption",ans:m,a:"text-style-name"},{ens:m,en:"circle",ans:m,a:"text-style-name"},{ens:m,en:"connector",ans:m,a:"text-style-name"},{ens:m,en:"control",ans:m,a:"text-style-name"},{ens:m,en:"custom-shape",ans:m,a:"text-style-name"},{ens:m,en:"ellipse",ans:m,a:"text-style-name"},{ens:m,en:"frame",ans:m,a:"text-style-name"},{ens:m,en:"line",ans:m,a:"text-style-name"},{ens:m,en:"measure",ans:m,a:"text-style-name"},{ens:m,en:"path",ans:m,a:"text-style-name"},{ens:m,en:"polygon",ans:m,a:"text-style-name"},{ens:m,en:"polyline",ans:m,a:"text-style-name"},{ens:m,en:"rect",ans:m,a:"text-style-name"},{ens:m,en:"regular-polygon",ans:m,a:"text-style-name"},{ens:Z,en:"annotation",ans:m,a:"text-style-name"},{ens:R,en:"column",ans:R,a:"text-style-name"},{ens:ee,en:"style",ans:ee,a:"next-style-name"},{ens:z,en:"body",ans:z,a:"paragraph-style-name"},{ens:z,en:"even-columns",ans:z,a:"paragraph-style-name"},{ens:z,en:"even-rows",ans:z,a:"paragraph-style-name"},{ens:z,en:"first-column",ans:z,a:"paragraph-style-name"},{ens:z,en:"first-row",ans:z,a:"paragraph-style-name"},{ens:z,en:"last-column",ans:z,a:"paragraph-style-name"},{ens:z,en:"last-row",ans:z,a:"paragraph-style-name"},{ens:z,en:"odd-columns",ans:z,a:"paragraph-style-name"},{ens:z,en:"odd-rows",ans:z,a:"paragraph-style-name"},{ens:P,en:"notes-configuration",ans:P,a:"default-style-name"},{ens:P,en:"alphabetical-index-entry-template",ans:P,a:"style-name"},{ens:P,en:"bibliography-entry-template",ans:P,a:"style-name"},{ens:P,en:"h",ans:P,a:"style-name"},{ens:P,en:"illustration-index-entry-template",ans:P,a:"style-name"},{ens:P,en:"index-source-style",ans:P,a:"style-name"},{ens:P,en:"object-index-entry-template",ans:P,a:"style-name"},{ens:P,en:"p",ans:P,a:"style-name"},{ens:P,en:"table-index-entry-template",ans:P,a:"style-name"},{ens:P,en:"table-of-content-entry-template",ans:P,a:"style-name"},{ens:P,en:"table-index-entry-template",ans:P,a:"style-name"},{ens:P,en:"user-index-entry-template",ans:P,a:"style-name"},{ens:ee,en:"page-layout-properties",ans:ee,a:"register-truth-ref-style-name"}],chart:[{ens:u,en:"axis",ans:u,a:"style-name"},{ens:u,en:"chart",ans:u,a:"style-name"},{ens:u,en:"data-label",ans:u,a:"style-name"},{ens:u,en:"data-point",ans:u,a:"style-name"},{ens:u,en:"equation",ans:u,a:"style-name"},{ens:u,en:"error-indicator",ans:u,a:"style-name"},{ens:u,en:"floor",ans:u,a:"style-name"},{ens:u,en:"footer",ans:u,a:"style-name"},{ens:u,en:"grid",ans:u,a:"style-name"},{ens:u,en:"legend",ans:u,a:"style-name"},{ens:u,en:"mean-value",ans:u,a:"style-name"},{ens:u,en:"plot-area",ans:u,a:"style-name"},{ens:u,en:"regression-curve",ans:u,a:"style-name"},{ens:u,en:"series",ans:u,a:"style-name"},{ens:u,en:"stock-gain-marker",ans:u,a:"style-name"},{ens:u,en:"stock-loss-marker",ans:u,a:"style-name"},{ens:u,en:"stock-range-line",ans:u,a:"style-name"},{ens:u,en:"subtitle",ans:u,a:"style-name"},{ens:u,en:"title",ans:u,a:"style-name"},{ens:u,en:"wall",ans:u,a:"style-name"}],section:[{ens:P,en:"alphabetical-index",ans:P,a:"style-name"},{ens:P,en:"bibliography",ans:P,a:"style-name"},{ens:P,en:"illustration-index",ans:P,a:"style-name"},{ens:P,en:"index-title",ans:P,a:"style-name"},{ens:P,en:"object-index",ans:P,a:"style-name"},{ens:P,en:"section",ans:P,a:"style-name"},{ens:P,en:"table-of-content",ans:P,a:"style-name"},{ens:P,en:"table-index",ans:P,a:"style-name"},{ens:P,en:"user-index",ans:P,a:"style-name"}],ruby:[{ens:P,en:"ruby",ans:P,a:"style-name"}],table:[{ens:y,en:"query",ans:y,a:"style-name"},{ens:y,en:"table-representation",ans:y,a:"style-name"},{ens:z,en:"background",ans:z,a:"style-name"},{ens:z,en:"table",ans:z,a:"style-name"}],"table-column":[{ens:y,en:"column",ans:y,a:"style-name"},{ens:z,en:"table-column",ans:z,a:"style-name"}],"table-row":[{ens:y,en:"query",ans:y,a:"default-row-style-name"},{ens:y,en:"table-representation",ans:y,a:"default-row-style-name"},{ens:z,en:"table-row",ans:z,a:"style-name"}],"table-cell":[{ens:y,en:"column",ans:y,a:"default-cell-style-name"},{ens:z,en:"table-column",ans:z,a:"default-cell-style-name"},{ens:z,en:"table-row",ans:z,a:"default-cell-style-name"},{ens:z,en:"body",ans:z,a:"style-name"},{ens:z,en:"covered-table-cell",ans:z,a:"style-name"},{ens:z,en:"even-columns",ans:z,a:"style-name"},{ens:z,en:"covered-table-cell",ans:z,a:"style-name"},{ens:z,en:"even-columns",ans:z,a:"style-name"},{ens:z,en:"even-rows",ans:z,a:"style-name"},{ens:z,en:"first-column",ans:z,a:"style-name"},{ens:z,en:"first-row",ans:z,a:"style-name"},{ens:z,en:"last-column",ans:z,a:"style-name"},{ens:z,en:"last-row",ans:z,a:"style-name"},{ens:z,en:"odd-columns",ans:z,a:"style-name"},{ens:z,en:"odd-rows",ans:z,a:"style-name"},{ens:z,en:"table-cell",ans:z,a:"style-name"}],graphic:[{ens:v,en:"cube",ans:m,a:"style-name"},{ens:v,en:"extrude",ans:m,a:"style-name"},{ens:v,en:"rotate",ans:m,a:"style-name"},{ens:v,en:"scene",ans:m,a:"style-name"},{ens:v,en:"sphere",ans:m,a:"style-name"},{ens:m,en:"caption",ans:m,a:"style-name"},{ens:m,en:"circle",ans:m,a:"style-name"},{ens:m,en:"connector",ans:m,a:"style-name"},{ens:m,en:"control",ans:m,a:"style-name"},{ens:m,en:"custom-shape",ans:m,a:"style-name"},{ens:m,en:"ellipse",ans:m,a:"style-name"},{ens:m,en:"frame",ans:m,a:"style-name"},{ens:m,en:"g",ans:m,a:"style-name"},{ens:m,en:"line",ans:m,a:"style-name"},{ens:m,en:"measure",ans:m,a:"style-name"},{ens:m,en:"page-thumbnail",ans:m,a:"style-name"},{ens:m,en:"path",ans:m,a:"style-name"},{ens:m,en:"polygon",ans:m,a:"style-name"},{ens:m,en:"polyline",ans:m,a:"style-name"},{ens:m,en:"rect",ans:m,a:"style-name"},{ens:m,en:"regular-polygon",ans:m,a:"style-name"},{ens:Z,en:"annotation",ans:m,a:"style-name"}],presentation:[{ens:v,en:"cube",ans:ne,a:"style-name"},{ens:v,en:"extrude",ans:ne,a:"style-name"},{ens:v,en:"rotate",ans:ne,a:"style-name"},{ens:v,en:"scene",ans:ne,a:"style-name"},{ens:v,en:"sphere",ans:ne,a:"style-name"},{ens:m,en:"caption",ans:ne,a:"style-name"},{ens:m,en:"circle",ans:ne,a:"style-name"},{ens:m,en:"connector",ans:ne,a:"style-name"},{ens:m,en:"control",ans:ne,a:"style-name"},{ens:m,en:"custom-shape",ans:ne,a:"style-name"},{ens:m,en:"ellipse",ans:ne,a:"style-name"},{ens:m,en:"frame",ans:ne,a:"style-name"},{ens:m,en:"g",ans:ne,a:"style-name"},{ens:m,en:"line",ans:ne,a:"style-name"},{ens:m,en:"measure",ans:ne,a:"style-name"},{ens:m,en:"page-thumbnail",ans:ne,a:"style-name"},{ens:m,en:"path",ans:ne,a:"style-name"},{ens:m,en:"polygon",ans:ne,a:"style-name"},{ens:m,en:"polyline",ans:ne,a:"style-name"},{ens:m,en:"rect",ans:ne,a:"style-name"},{ens:m,en:"regular-polygon",ans:ne,a:"style-name"},{ens:Z,en:"annotation",ans:ne,a:"style-name"}],"drawing-page":[{ens:m,en:"page",ans:m,a:"style-name"},{ens:ne,en:"notes",ans:m,a:"style-name"},{ens:ee,en:"handout-master",ans:m,a:"style-name"},{ens:ee,en:"master-page",ans:m,a:"style-name"}],"list-style":[{ens:P,en:"list",ans:P,a:"style-name"},{ens:P,en:"numbered-paragraph",ans:P,a:"style-name"},{ens:P,en:"list-item",ans:P,a:"style-override"},{ens:ee,en:"style",ans:ee,a:"list-style-name"}],data:[{ens:ee,en:"style",ans:ee,a:"data-style-name"},{ens:ee,en:"style",ans:ee,a:"percentage-data-style-name"},{ens:ne,en:"date-time-decl",ans:ee,a:"data-style-name"},{ens:P,en:"creation-date",ans:ee,a:"data-style-name"},{ens:P,en:"creation-time",ans:ee,a:"data-style-name"},{ens:P,en:"database-display",ans:ee,a:"data-style-name"},{ens:P,en:"date",ans:ee,a:"data-style-name"},{ens:P,en:"editing-duration",ans:ee,a:"data-style-name"},{ens:P,en:"expression",ans:ee,a:"data-style-name"},{ens:P,en:"meta-field",ans:ee,a:"data-style-name"},{ens:P,en:"modification-date",ans:ee,a:"data-style-name"},{ens:P,en:"modification-time",ans:ee,a:"data-style-name"},{ens:P,en:"print-date",ans:ee,a:"data-style-name"},{ens:P,en:"print-time",ans:ee,a:"data-style-name"},{ens:P,en:"table-formula",ans:ee,a:"data-style-name"},{ens:P,en:"time",ans:ee,a:"data-style-name"},{ens:P,en:"user-defined",ans:ee,a:"data-style-name"},{ens:P,en:"user-field-get",ans:ee,a:"data-style-name"},{ens:P,en:"user-field-input",ans:ee,a:"data-style-name"},{ens:P,en:"variable-get",ans:ee,a:"data-style-name"},{ens:P,en:"variable-input",ans:ee,a:"data-style-name"},{ens:P,en:"variable-set",ans:ee,a:"data-style-name"}],"page-layout":[{ens:ne,en:"notes",ans:ee,a:"page-layout-name"},{ens:ee,en:"handout-master",ans:ee,a:"page-layout-name"},{ens:ee,en:"master-page",ans:ee,a:"page-layout-name"}]},J,te=xmldom.XPath;this.collectUsedFontFaces=_,this.changeFontFaceNames=S,this.UsedStyleList=function(q,K){var U={};this.uses=function(F){var re=F.localName,W=F.getAttributeNS(m,"name")||F.getAttributeNS(ee,"name");return F=re==="style"?F.getAttributeNS(ee,"family"):F.namespaceURI===V?"data":re,(F=U[F])?0<F[W]:!1},w(q,U),K&&I(K,U)},this.getStyleName=function(q,K){var U,F,re=J[K.localName];if(re&&(re=re[K.namespaceURI])){for(F=0;F<re.length;F+=1)if(re[F].keyname===q&&(re=re[F],K.hasAttributeNS(re.ns,re.localname))){U=K.getAttributeNS(re.ns,re.localname);break}}return U},this.hasDerivedStyles=function(q,K,U){var F=U.getAttributeNS(ee,"name");return U=U.getAttributeNS(ee,"family"),!!te.getODFElementsWithXPath(q,'//style:*[@style:parent-style-name="'+F+'"][@style:family="'+U+'"]',K).length},this.prefixStyleNames=function(q,K,U){var F;if(q){for(F=q.firstChild;F;){if(F.nodeType===Node.ELEMENT_NODE){var re=F,W=K,ie=re.getAttributeNS(m,"name"),he=void 0;ie?he=m:(ie=re.getAttributeNS(ee,"name"))&&(he=ee),he&&re.setAttributeNS(he,Y[he]+"name",W+ie)}F=F.nextSibling}A(q,K),U&&A(U,K)}},this.removePrefixFromStyleNames=function(q,K,U){var F=new RegExp("^"+K);if(q){for(K=q.firstChild;K;){if(K.nodeType===Node.ELEMENT_NODE){var re=K,W=F,ie=re.getAttributeNS(m,"name"),he=void 0;ie?he=m:(ie=re.getAttributeNS(ee,"name"))&&(he=ee),he&&(ie=ie.replace(W,""),re.setAttributeNS(he,Y[he]+"name",ie))}K=K.nextSibling}j(q,F),U&&j(U,F)}},this.determineStylesForNode=M,J=function(){var q,K,U,F,re,W={},ie,he,ve,Ne;for(U in $)if($.hasOwnProperty(U))for(F=$[U],K=F.length,q=0;q<K;q+=1)re=F[q],ve=re.en,Ne=re.ens,W.hasOwnProperty(ve)?ie=W[ve]:W[ve]=ie={},ie.hasOwnProperty(Ne)?he=ie[Ne]:ie[Ne]=he=[],he.push({ns:re.ans,localname:re.a,keyname:U});return W}()},typeof Object.create!="function"&&(Object.create=function(A){var j=function(){};return j.prototype=A,new j}),xmldom.LSSerializer=function(){function A(E){var N=E||{},O=function(S){var u={},y;for(y in S)S.hasOwnProperty(y)&&(u[S[y]]=y);return u}(E),x=[N],I=[O],_=0;this.push=function(){_+=1,N=x[_]=Object.create(N),O=I[_]=Object.create(O)},this.pop=function(){x.pop(),I.pop(),--_,N=x[_],O=I[_]},this.getLocalNamespaceDefinitions=function(){return O},this.getQName=function(S){var u=S.namespaceURI,y=0,v;if(!u)return S.localName;if(v=O[u])return v+":"+S.localName;do{if(v||!S.prefix?(v="ns"+y,y+=1):v=S.prefix,N[v]===u)break;if(!N[v]){N[v]=u,O[u]=v;break}v=null}while(v===null);return v+":"+S.localName}}function j(E){return E.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")}function M(E,N){var O="",x=w.filter?w.filter.acceptNode(N):NodeFilter.FILTER_ACCEPT,I;if(x===NodeFilter.FILTER_ACCEPT&&N.nodeType===Node.ELEMENT_NODE){E.push(),I=E.getQName(N);var _,S=N.attributes,u,y,v,m="",R;for(_="<"+I,u=S.length,y=0;y<u;y+=1)v=S.item(y),v.namespaceURI!=="http://www.w3.org/2000/xmlns/"&&(R=w.filter?w.filter.acceptNode(v):NodeFilter.FILTER_ACCEPT,R===NodeFilter.FILTER_ACCEPT&&(R=E.getQName(v),v=typeof v.value=="string"?j(v.value):v.value,m+=" "+(R+'="'+v+'"')));u=E.getLocalNamespaceDefinitions();for(y in u)u.hasOwnProperty(y)&&((S=u[y])?S!=="xmlns"&&(_+=" xmlns:"+u[y]+'="'+y+'"'):_+=' xmlns="'+y+'"');O+=_+(m+">")}if(x===NodeFilter.FILTER_ACCEPT||x===NodeFilter.FILTER_SKIP){for(x=N.firstChild;x;)O+=M(E,x),x=x.nextSibling;N.nodeValue&&(O+=j(N.nodeValue))}return I&&(O+="</"+I+">",E.pop()),O}var w=this;this.filter=null,this.writeToString=function(E,N){if(!E)return"";var O=new A(N);return M(O,E)}},function(){function A(S){var u,y=x.length;for(u=0;u<y;u+=1)if(S.namespaceURI==="urn:oasis:names:tc:opendocument:xmlns:office:1.0"&&S.localName===x[u])return u;return-1}function j(S,u){var y=new E.UsedStyleList(S,u),v=new odf.OdfNodeFilter;this.acceptNode=function(m){var R=v.acceptNode(m);return R===NodeFilter.FILTER_ACCEPT&&m.parentNode===u&&m.nodeType===Node.ELEMENT_NODE&&(R=y.uses(m)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT),R}}function M(S,u){var y=new j(S,u);this.acceptNode=function(v){var m=y.acceptNode(v);return m!==NodeFilter.FILTER_ACCEPT||!v.parentNode||v.parentNode.namespaceURI!==odf.Namespaces.textns||v.parentNode.localName!=="s"&&v.parentNode.localName!=="tab"||(m=NodeFilter.FILTER_REJECT),m}}function w(S,u){if(u){var y=A(u),v,m=S.firstChild;if(y!==-1){for(;m&&(v=A(m),!(v!==-1&&v>y));)m=m.nextSibling;S.insertBefore(u,m)}}}var E=new odf.StyleInfo,N=core.DomUtils,O=odf.Namespaces.stylens,x="meta settings scripts font-face-decls styles automatic-styles master-styles body".split(" "),I=Date.now()+"_webodf_",_=new core.Base64;odf.ODFElement=function(){},odf.ODFDocumentElement=function(){},odf.ODFDocumentElement.prototype=new odf.ODFElement,odf.ODFDocumentElement.prototype.constructor=odf.ODFDocumentElement,odf.ODFDocumentElement.prototype.fontFaceDecls=null,odf.ODFDocumentElement.prototype.manifest=null,odf.ODFDocumentElement.prototype.settings=null,odf.ODFDocumentElement.namespaceURI="urn:oasis:names:tc:opendocument:xmlns:office:1.0",odf.ODFDocumentElement.localName="document",odf.AnnotationElement=function(){},odf.OdfPart=function(S,u,y,v){var m=this;this.size=0,this.type=null,this.name=S,this.container=y,this.url=null,this.mimetype=u,this.onstatereadychange=this.document=null,this.EMPTY=0,this.LOADING=1,this.DONE=2,this.state=this.EMPTY,this.data="",this.load=function(){v!==null&&(this.mimetype=u,v.loadAsDataURL(S,u,function(R,V){R&&runtime.log(R),m.url=V,m.onchange&&m.onchange(m),m.onstatereadychange&&m.onstatereadychange(m)}))}},odf.OdfPart.prototype.load=function(){},odf.OdfPart.prototype.getUrl=function(){return this.data?"data:;base64,"+_.toBase64(this.data):null},odf.OdfContainer=function S(u,y){function v(ue){for(var Se=ue.firstChild,be;Se;)be=Se.nextSibling,Se.nodeType===Node.ELEMENT_NODE?v(Se):Se.nodeType===Node.PROCESSING_INSTRUCTION_NODE&&ue.removeChild(Se),Se=be}function m(ue){var Se={},be,Fe,ut=ue.ownerDocument.createNodeIterator(ue,NodeFilter.SHOW_ELEMENT,null,!1);for(ue=ut.nextNode();ue;)ue.namespaceURI==="urn:oasis:names:tc:opendocument:xmlns:office:1.0"&&(ue.localName==="annotation"?(be=ue.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))&&(Se.hasOwnProperty(be)?runtime.log("Warning: annotation name used more than once with <office:annotation/>: '"+be+"'"):Se[be]=ue):ue.localName==="annotation-end"&&((be=ue.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))?Se.hasOwnProperty(be)?(Fe=Se[be],Fe.annotationEndElement?runtime.log("Warning: annotation name used more than once with <office:annotation-end/>: '"+be+"'"):Fe.annotationEndElement=ue):runtime.log("Warning: annotation end without an annotation start, name: '"+be+"'"):runtime.log("Warning: annotation end without a name found"))),ue=ut.nextNode()}function R(ue,Se){for(var be=ue&&ue.firstChild;be;)be.nodeType===Node.ELEMENT_NODE&&be.setAttributeNS("urn:webodf:names:scope","scope",Se),be=be.nextSibling}function V(ue,Se){for(var be=we.rootElement.meta,be=be&&be.firstChild;be&&(be.namespaceURI!==ue||be.localName!==Se);)be=be.nextSibling;for(be=be&&be.firstChild;be&&be.nodeType!==Node.TEXT_NODE;)be=be.nextSibling;return be?be.data:null}function Z(ue){var Se={},be;for(ue=ue.firstChild;ue;)ue.nodeType===Node.ELEMENT_NODE&&ue.namespaceURI===O&&ue.localName==="font-face"&&(be=ue.getAttributeNS(O,"name"),Se[be]=ue),ue=ue.nextSibling;return Se}function ne(ue,Se){var be=null,Fe,ut,Pt;if(ue)for(be=ue.cloneNode(!0),Fe=be.firstElementChild;Fe;)ut=Fe.nextElementSibling,(Pt=Fe.getAttributeNS("urn:webodf:names:scope","scope"))&&Pt!==Se&&be.removeChild(Fe),Fe=ut;return be}function ee(ue,Se){var be,Fe,ut,Pt=null,yt={};if(ue)for(Se.forEach(function(At){E.collectUsedFontFaces(yt,At)}),Pt=ue.cloneNode(!0),be=Pt.firstElementChild;be;)Fe=be.nextElementSibling,ut=be.getAttributeNS(O,"name"),yt[ut]||Pt.removeChild(be),be=Fe;return Pt}function z(ue){var Se=we.rootElement.ownerDocument,be;if(ue){v(ue.documentElement);try{be=Se.importNode(ue.documentElement,!0)}catch{}}return be}function P(ue){we.state=ue,we.onchange&&we.onchange(we),we.onstatereadychange&&we.onstatereadychange(we)}function Y(ue){We=null,we.rootElement=ue,ue.fontFaceDecls=N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls"),ue.styles=N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),ue.automaticStyles=N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),ue.masterStyles=N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),ue.body=N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body"),ue.meta=N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),ue.settings=N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings"),ue.scripts=N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","scripts"),m(ue)}function $(ue){var Se=z(ue),be=we.rootElement,Fe;Se&&Se.localName==="document-styles"&&Se.namespaceURI==="urn:oasis:names:tc:opendocument:xmlns:office:1.0"?(be.fontFaceDecls=N.getDirectChild(Se,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls"),w(be,be.fontFaceDecls),Fe=N.getDirectChild(Se,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),be.styles=Fe||ue.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),w(be,be.styles),Fe=N.getDirectChild(Se,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),be.automaticStyles=Fe||ue.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),R(be.automaticStyles,"document-styles"),w(be,be.automaticStyles),Se=N.getDirectChild(Se,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),be.masterStyles=Se||ue.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),w(be,be.masterStyles),E.prefixStyleNames(be.automaticStyles,I,be.masterStyles)):P(S.INVALID)}function J(ue){ue=z(ue);var Se,be,Fe,ut;if(ue&&ue.localName==="document-content"&&ue.namespaceURI==="urn:oasis:names:tc:opendocument:xmlns:office:1.0"){if(Se=we.rootElement,Fe=N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls"),Se.fontFaceDecls&&Fe){ut=Se.fontFaceDecls;var Pt,yt,At,ri,$t={};for(be=Z(ut),ri=Z(Fe),Fe=Fe.firstElementChild;Fe;){if(Pt=Fe.nextElementSibling,Fe.namespaceURI===O&&Fe.localName==="font-face")if(yt=Fe.getAttributeNS(O,"name"),be.hasOwnProperty(yt)){if(!Fe.isEqualNode(be[yt])){At=yt;for(var Rt=be,zt=ri,et=0,ct=void 0,ct=At=At.replace(/\d+$/,"");Rt.hasOwnProperty(ct)||zt.hasOwnProperty(ct);)et+=1,ct=At+et;At=ct,Fe.setAttributeNS(O,"style:name",At),ut.appendChild(Fe),be[At]=Fe,delete ri[yt],$t[yt]=At}}else ut.appendChild(Fe),be[yt]=Fe,delete ri[yt];Fe=Pt}ut=$t}else Fe&&(Se.fontFaceDecls=Fe,w(Se,Fe));if(be=N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),R(be,"document-content"),ut&&E.changeFontFaceNames(be,ut),Se.automaticStyles&&be)for(ut=be.firstChild;ut;)Se.automaticStyles.appendChild(ut),ut=be.firstChild;else be&&(Se.automaticStyles=be,w(Se,be));if(ue=N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body"),ue===null)throw"<office:body/> tag is mising.";Se.body=ue,w(Se,Se.body)}else P(S.INVALID)}function te(ue){ue=z(ue);var Se;ue&&ue.localName==="document-meta"&&ue.namespaceURI==="urn:oasis:names:tc:opendocument:xmlns:office:1.0"&&(Se=we.rootElement,Se.meta=N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),w(Se,Se.meta))}function q(ue){ue=z(ue);var Se;ue&&ue.localName==="document-settings"&&ue.namespaceURI==="urn:oasis:names:tc:opendocument:xmlns:office:1.0"&&(Se=we.rootElement,Se.settings=N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings"),w(Se,Se.settings))}function K(ue){ue=z(ue);var Se;if(ue&&ue.localName==="manifest"&&ue.namespaceURI==="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0")for(Se=we.rootElement,Se.manifest=ue,ue=Se.manifest.firstElementChild;ue;)ue.localName==="file-entry"&&ue.namespaceURI==="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"&&(Ve[ue.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","full-path")]=ue.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","media-type")),ue=ue.nextElementSibling}function U(ue,Se,be){ue=N.getElementsByTagName(ue,Se);var Fe;for(Fe=0;Fe<ue.length;Fe+=1)Se=ue[Fe],be.hasOwnProperty(Se.namespaceURI)||Se.parentNode.removeChild(Se)}function F(ue){U(ue,"script",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:office:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:table:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:text:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":!0}),U(ue,"style",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:style:1.0":!0})}function re(ue){var Se=ue.firstElementChild,be=[],Fe,ut,Pt,yt=ue.attributes,At=yt.length;for(Fe=0;Fe<At;Fe+=1)Pt=yt.item(Fe),ut=Pt.localName.substr(0,2).toLowerCase(),Pt.namespaceURI===null&&ut==="on"&&be.push(Pt);for(At=be.length,Fe=0;Fe<At;Fe+=1)ue.removeAttributeNode(be[Fe]);for(;Se;)re(Se),Se=Se.nextElementSibling}function W(ue){var Se=ue.shift();Se?ke.loadAsDOM(Se.path,function(be,Fe){Fe&&(F(Fe),re(Fe.documentElement)),Se.handler(Fe),we.state===S.INVALID?be?runtime.log("ERROR: Unable to load "+Se.path+" - "+be):runtime.log("ERROR: Unable to load "+Se.path):(be&&runtime.log("DEBUG: Unable to load "+Se.path+" - "+be),W(ue))}):(m(we.rootElement),P(S.DONE))}function ie(ue){var Se="";return odf.Namespaces.forEachPrefix(function(be,Fe){Se+=" xmlns:"+be+'="'+Fe+'"'}),'<?xml version="1.0" encoding="UTF-8"?><office:'+ue+" "+Se+' office:version="1.2">'}function he(){var ue=new xmldom.LSSerializer,Se=ie("document-meta");return ue.filter=new odf.OdfNodeFilter,Se+=ue.writeToString(we.rootElement.meta,odf.Namespaces.namespaceMap),Se+"</office:document-meta>"}function ve(ue,Se){var be=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:file-entry");return be.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:full-path",ue),be.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:media-type",Se),be}function Ne(){var ue=runtime.parseXML('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2"></manifest:manifest>'),Se=ue.documentElement,be=new xmldom.LSSerializer,Fe;for(Fe in Ve)Ve.hasOwnProperty(Fe)&&Se.appendChild(ve(Fe,Ve[Fe]));return be.filter=new odf.OdfNodeFilter,`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
`+be.writeToString(ue,odf.Namespaces.namespaceMap)}function ze(){var ue,Se,be,Fe=odf.Namespaces.namespaceMap,ut=new xmldom.LSSerializer,Pt=ie("document-styles");return Se=ne(we.rootElement.automaticStyles,"document-styles"),be=we.rootElement.masterStyles.cloneNode(!0),ue=ee(we.rootElement.fontFaceDecls,[be,we.rootElement.styles,Se]),E.removePrefixFromStyleNames(Se,I,be),ut.filter=new j(be,Se),Pt+=ut.writeToString(ue,Fe),Pt+=ut.writeToString(we.rootElement.styles,Fe),Pt+=ut.writeToString(Se,Fe),Pt+=ut.writeToString(be,Fe),Pt+"</office:document-styles>"}function rt(){var ue,Se,be=odf.Namespaces.namespaceMap,Fe=new xmldom.LSSerializer,ut=ie("document-content");return Se=ne(we.rootElement.automaticStyles,"document-content"),ue=ee(we.rootElement.fontFaceDecls,[Se]),Fe.filter=new M(we.rootElement.body,Se),ut+=Fe.writeToString(ue,be),ut+=Fe.writeToString(Se,be),ut+=Fe.writeToString(we.rootElement.body,be),ut+"</office:document-content>"}function le(ue,Se){runtime.loadXML(ue,function(be,Fe){if(be)Se(be);else if(Fe){F(Fe),re(Fe.documentElement);var ut=z(Fe);ut&&ut.localName==="document"&&ut.namespaceURI==="urn:oasis:names:tc:opendocument:xmlns:office:1.0"?(Y(ut),P(S.DONE)):P(S.INVALID)}else Se("No DOM was loaded.")})}function me(ue,Se){var be;be=we.rootElement;var Fe=be.meta;Fe||(be.meta=Fe=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),w(be,Fe)),be=Fe,ue&&N.mapKeyValObjOntoNode(be,ue,odf.Namespaces.lookupNamespaceURI),Se&&N.removeKeyElementsFromNode(be,Se,odf.Namespaces.lookupNamespaceURI)}function De(ue,Se){function be(ri,$t){var Rt;$t||($t=ri),Rt=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",$t),yt[ri]=Rt,yt.appendChild(Rt)}var Fe=new core.Zip("",null),ut="application/vnd.oasis.opendocument."+ue+(Se===!0?"-template":""),Pt=runtime.byteArrayFromString(ut,"utf8"),yt=we.rootElement,At=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",ue);return Fe.save("mimetype",Pt,!1,new Date),be("meta"),be("settings"),be("scripts"),be("fontFaceDecls","font-face-decls"),be("styles"),be("automaticStyles","automatic-styles"),be("masterStyles","master-styles"),be("body"),yt.body.appendChild(At),Ve["/"]=ut,Ve["settings.xml"]="text/xml",Ve["meta.xml"]="text/xml",Ve["styles.xml"]="text/xml",Ve["content.xml"]="text/xml",P(S.DONE),Fe}function Me(){var ue,Se=new Date,be="";we.rootElement.settings&&we.rootElement.settings.firstElementChild&&(ue=new xmldom.LSSerializer,be=ie("document-settings"),ue.filter=new odf.OdfNodeFilter,be+=ue.writeToString(we.rootElement.settings,odf.Namespaces.namespaceMap),be+="</office:document-settings>"),(ue=be)?(ue=runtime.byteArrayFromString(ue,"utf8"),ke.save("settings.xml",ue,!0,Se)):ke.remove("settings.xml"),be=runtime.getWindow(),ue="WebODF/"+webodf.Version,be&&(ue=ue+" "+be.navigator.userAgent),me({"meta:generator":ue},null),ue=runtime.byteArrayFromString(he(),"utf8"),ke.save("meta.xml",ue,!0,Se),ue=runtime.byteArrayFromString(ze(),"utf8"),ke.save("styles.xml",ue,!0,Se),ue=runtime.byteArrayFromString(rt(),"utf8"),ke.save("content.xml",ue,!0,Se),ue=runtime.byteArrayFromString(Ne(),"utf8"),ke.save("META-INF/manifest.xml",ue,!0,Se)}function Re(ue,Se){Me(),ke.writeAs(ue,function(be){Se(be)})}var we=this,ke,Ve={},We,$e="";this.onstatereadychange=y,this.state=this.onchange=null,this.getMetadata=V,this.setRootElement=Y,this.getContentElement=function(){var ue;if(We||(ue=we.rootElement.body,We=N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","text")||N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","presentation")||N.getDirectChild(ue,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","spreadsheet")),!We)throw"Could not find content element in <office:body/>.";return We},this.getDocumentType=function(){var ue=we.getContentElement();return ue&&ue.localName},this.isTemplate=function(){return Ve["/"].substr(-9)==="-template"},this.setIsTemplate=function(ue){var Se=Ve["/"],be=Se.substr(-9)==="-template";ue!==be&&(Se=ue?Se+"-template":Se.substr(0,Se.length-9),Ve["/"]=Se,ue=runtime.byteArrayFromString(Se,"utf8"),ke.save("mimetype",ue,!1,new Date))},this.getPart=function(ue){return new odf.OdfPart(ue,Ve[ue],we,ke)},this.getPartData=function(ue,Se){ke.load(ue,Se)},this.setMetadata=me,this.incrementEditingCycles=function(){var ue=V(odf.Namespaces.metans,"editing-cycles"),ue=ue?parseInt(ue,10):0;return isNaN(ue)&&(ue=0),me({"meta:editing-cycles":ue+1},null),ue+1},this.createByteArray=function(ue,Se){Me(),ke.createByteArray(ue,Se)},this.saveAs=Re,this.save=function(ue){Re($e,ue)},this.getUrl=function(){return $e},this.setBlob=function(ue,Se,be){be=_.convertBase64ToByteArray(be),ke.save(ue,be,!1,new Date),Ve.hasOwnProperty(ue)&&runtime.log(ue+" has been overwritten."),Ve[ue]=Se},this.removeBlob=function(ue){var Se=ke.remove(ue);runtime.assert(Se,"file is not found: "+ue),delete Ve[ue]},this.state=S.LOADING,this.rootElement=function(ue){var Se=document.createElementNS(ue.namespaceURI,ue.localName),be;ue=new ue.Type;for(be in ue)ue.hasOwnProperty(be)&&(Se[be]=ue[be]);return Se}({Type:odf.ODFDocumentElement,namespaceURI:odf.ODFDocumentElement.namespaceURI,localName:odf.ODFDocumentElement.localName}),u===odf.OdfContainer.DocumentType.TEXT?ke=De("text"):u===odf.OdfContainer.DocumentType.TEXT_TEMPLATE?ke=De("text",!0):u===odf.OdfContainer.DocumentType.PRESENTATION?ke=De("presentation"):u===odf.OdfContainer.DocumentType.PRESENTATION_TEMPLATE?ke=De("presentation",!0):u===odf.OdfContainer.DocumentType.SPREADSHEET?ke=De("spreadsheet"):u===odf.OdfContainer.DocumentType.SPREADSHEET_TEMPLATE?ke=De("spreadsheet",!0):($e=u,ke=new core.Zip($e,function(ue,Se){ke=Se,ue?le($e,function(be){ue&&(ke.error=ue+`
`+be,P(S.INVALID))}):W([{path:"styles.xml",handler:$},{path:"content.xml",handler:J},{path:"meta.xml",handler:te},{path:"settings.xml",handler:q},{path:"META-INF/manifest.xml",handler:K}])}))},odf.OdfContainer.EMPTY=0,odf.OdfContainer.LOADING=1,odf.OdfContainer.DONE=2,odf.OdfContainer.INVALID=3,odf.OdfContainer.SAVING=4,odf.OdfContainer.MODIFIED=5,odf.OdfContainer.getContainer=function(S){return new odf.OdfContainer(S,null)}}(),odf.OdfContainer.DocumentType={TEXT:1,TEXT_TEMPLATE:2,PRESENTATION:3,PRESENTATION_TEMPLATE:4,SPREADSHEET:5,SPREADSHEET_TEMPLATE:6},gui.AnnotatableCanvas=function(){},gui.AnnotatableCanvas.prototype.refreshSize=function(){},gui.AnnotatableCanvas.prototype.getZoomLevel=function(){},gui.AnnotatableCanvas.prototype.getSizer=function(){},gui.AnnotationViewManager=function(A,j,M,w){function E(v){var m=v.annotationEndElement,R=S.createRange(),V=v.getAttributeNS(odf.Namespaces.officens,"name");m&&(R.setStart(v,v.childNodes.length),R.setEnd(m,0),v=u.getTextNodes(R,!1),v.forEach(function(Z){var ne;e:{for(ne=Z.parentNode;ne.namespaceURI!==odf.Namespaces.officens||ne.localName!=="body";){if(ne.namespaceURI==="http://www.w3.org/1999/xhtml"&&ne.className==="webodf-annotationHighlight"&&ne.getAttribute("annotation")===V){ne=!0;break e}ne=ne.parentNode}ne=!1}ne||(ne=S.createElement("span"),ne.className="webodf-annotationHighlight",ne.setAttribute("annotation",V),Z.parentNode.replaceChild(ne,Z),ne.appendChild(Z))})),R.detach()}function N(v){var m=A.getSizer();v?(M.style.display="inline-block",m.style.paddingRight=y.getComputedStyle(M).width):(M.style.display="none",m.style.paddingRight=0),A.refreshSize()}function O(){_.sort(function(v,m){return v.compareDocumentPosition(m)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1})}function x(){var v;for(v=0;v<_.length;v+=1){var V=_[v],m=V.parentNode,Z=m.nextElementSibling,R=Z.nextElementSibling,$=m.parentNode,ne=0,ne=_[_.indexOf(V)-1],ee=void 0,V=A.getZoomLevel();m.style.left=(M.getBoundingClientRect().left-$.getBoundingClientRect().left)/V+"px",m.style.width=M.getBoundingClientRect().width/V+"px",Z.style.width=parseFloat(m.style.left)-30+"px",ne?(ee=ne.parentNode.getBoundingClientRect(),20>=($.getBoundingClientRect().top-ee.bottom)/V?m.style.top=Math.abs($.getBoundingClientRect().top-ee.bottom)/V+20+"px":m.style.top="0px"):m.style.top="0px",R.style.left=Z.getBoundingClientRect().width/V+"px";var Z=R.style,$=R.getBoundingClientRect().left/V,ne=R.getBoundingClientRect().top/V,ee=m.getBoundingClientRect().left/V,z=m.getBoundingClientRect().top/V,P=0,Y=0,P=ee-$,P=P*P,Y=z-ne,Y=Y*Y,$=Math.sqrt(P+Y);Z.width=$+"px",ne=Math.asin((m.getBoundingClientRect().top-R.getBoundingClientRect().top)/(V*parseFloat(R.style.width))),R.style.transform="rotate("+ne+"rad)",R.style.MozTransform="rotate("+ne+"rad)",R.style.WebkitTransform="rotate("+ne+"rad)",R.style.msTransform="rotate("+ne+"rad)"}}function I(v){var m=_.indexOf(v),R=v.parentNode.parentNode;R.localName==="div"&&(R.parentNode.insertBefore(v,R),R.parentNode.removeChild(R)),v=v.getAttributeNS(odf.Namespaces.officens,"name"),v=S.querySelectorAll('span.webodf-annotationHighlight[annotation="'+v+'"]');for(var V,R=0;R<v.length;R+=1){for(V=v.item(R);V.firstChild;)V.parentNode.insertBefore(V.firstChild,V);V.parentNode.removeChild(V)}m!==-1&&_.splice(m,1),_.length===0&&N(!1)}var _=[],S=j.ownerDocument,u=odf.OdfUtils,y=runtime.getWindow();runtime.assert(!!y,"Expected to be run in an environment which has a global window, like a browser."),this.rerenderAnnotations=x,this.rehighlightAnnotations=function(){_.forEach(function(v){E(v)})},this.getMinimumHeightForAnnotationPane=function(){return M.style.display!=="none"&&0<_.length?(_[_.length-1].parentNode.getBoundingClientRect().bottom-M.getBoundingClientRect().top)/A.getZoomLevel()+"px":null},this.addAnnotations=function(v){v.length!==0&&(N(!0),v.forEach(function(m){_.push(m);var R=S.createElement("div"),V=S.createElement("div"),Z=S.createElement("div"),ne=S.createElement("div"),ee;R.className="annotationWrapper",R.setAttribute("creator",u.getAnnotationCreator(m)),m.parentNode.insertBefore(R,m),V.className="annotationNote",V.appendChild(m),w&&(ee=S.createElement("div"),ee.className="annotationRemoveButton",V.appendChild(ee)),Z.className="annotationConnector horizontal",ne.className="annotationConnector angular",R.appendChild(V),R.appendChild(Z),R.appendChild(ne),m.annotationEndElement&&E(m)}),O(),x())},this.forgetAnnotation=I,this.forgetAnnotations=function(){for(;_.length;)I(_[0])}},gui.Viewport=function(){},gui.Viewport.prototype.scrollIntoView=function(A,j){},gui.SingleScrollViewport=function(A){this.scrollIntoView=function(j,M){var w,E,N,O;O=A.offsetHeight-A.clientHeight,N=A.offsetWidth-A.clientWidth;var x=A.getBoundingClientRect();j&&x&&(w=x.left+5,E=x.top+5,N=x.right-(N+5),O=x.bottom-(O+5),M||j.top<E?A.scrollTop-=E-j.top:(j.top>O||j.bottom>O)&&(A.scrollTop=j.bottom-j.top<=O-E?A.scrollTop+(j.bottom-O):A.scrollTop+(j.top-E)),j.left<w?A.scrollLeft-=w-j.left:j.right>N&&(A.scrollLeft=j.right-j.left<=N-w?A.scrollLeft+(j.right-N):A.scrollLeft-(w-j.left)))}},function(){function A(E,N,O,x,I){var _,S=0,u;for(u in E)if(E.hasOwnProperty(u)){if(S===O){_=u;break}S+=1}_?N.getPartData(E[_].href,function(y,v){if(y)runtime.log(y);else if(v){var m="@font-face { font-family: "+(E[_].family||_)+"; src: url(data:application/x-font-ttf;charset=binary;base64,"+w.convertUTF8ArrayToBase64(v)+') format("truetype"); }';try{x.insertRule(m,x.cssRules.length)}catch(R){runtime.log("Problem inserting rule in CSS: "+runtime.toJson(R)+`
Rule: `+m)}}else runtime.log("missing font data for "+E[_].href);A(E,N,O+1,x,I)}):I&&I()}var j=xmldom.XPath,M=odf.OdfUtils,w=new core.Base64;odf.FontLoader=function(){this.loadFonts=function(E,N){for(var O=E.rootElement.fontFaceDecls;N.cssRules.length;)N.deleteRule(N.cssRules.length-1);if(O){var x={},I,_,S,u;if(O)for(O=j.getODFElementsWithXPath(O,"style:font-face[svg:font-face-src]",odf.Namespaces.lookupNamespaceURI),I=0;I<O.length;I+=1)_=O[I],S=_.getAttributeNS(odf.Namespaces.stylens,"name"),u=M.getNormalizedFontFamilyName(_.getAttributeNS(odf.Namespaces.svgns,"font-family")),_=j.getODFElementsWithXPath(_,"svg:font-face-src/svg:font-face-uri",odf.Namespaces.lookupNamespaceURI),0<_.length&&(_=_[0].getAttributeNS(odf.Namespaces.xlinkns,"href"),x[S]={href:_,family:u});A(x,E,0,N)}}}}(),odf.Formatting=function(){function A($){return($=Y[$])?z.mergeObjects({},$):{}}function j(){for(var q=u.rootElement.fontFaceDecls,$={},J,te,q=q&&q.firstElementChild;q;)(J=q.getAttributeNS(m,"name"))&&((te=q.getAttributeNS(v,"font-family"))||0<q.getElementsByTagNameNS(v,"font-face-uri").length)&&($[J]=te),q=q.nextElementSibling;return $}function M($){for(var J=u.rootElement.styles.firstElementChild;J;){if(J.namespaceURI===m&&J.localName==="default-style"&&J.getAttributeNS(m,"family")===$)return J;J=J.nextElementSibling}return null}function w($,J,te){var q,K,U;for(te=te||[u.rootElement.automaticStyles,u.rootElement.styles],U=0;U<te.length;U+=1)for(q=te[U],q=q.firstElementChild;q;){if(K=q.getAttributeNS(m,"name"),q.namespaceURI===m&&q.localName==="style"&&q.getAttributeNS(m,"family")===J&&K===$||J==="list-style"&&q.namespaceURI===R&&q.localName==="list-style"&&K===$||J==="data"&&q.namespaceURI===V&&K===$)return q;q=q.nextElementSibling}return null}function E($){for(var J,te,q,K,U={},F=$.firstElementChild;F;){if(F.namespaceURI===m)for(q=U[F.nodeName]={},te=F.attributes,J=0;J<te.length;J+=1)K=te.item(J),q[K.name]=K.value;F=F.nextElementSibling}for(te=$.attributes,J=0;J<te.length;J+=1)K=te.item(J),U[K.name]=K.value;return U}function N($,J){for(var te=u.rootElement.styles,q,K={},U=$.getAttributeNS(m,"family"),F=$;F;)q=E(F),K=z.mergeObjects(q,K),F=(q=F.getAttributeNS(m,"parent-style-name"))?w(q,U,[te]):null;return(F=M(U))&&(q=E(F),K=z.mergeObjects(q,K)),J!==!1&&(q=A(U),K=z.mergeObjects(q,K)),K}function O($,J){function te(W){Object.keys(W).forEach(function(ie){Object.keys(W[ie]).forEach(function(he){F+="|"+ie+":"+he+"|"})})}for(var q=$.nodeType===Node.TEXT_NODE?$.parentNode:$,K,U=[],F="",re=!1;q&&!ne.isInlineRoot(q)&&q.parentNode!==u.rootElement;)!re&&ne.isGroupingElement(q)&&(re=!0),(K=y.determineStylesForNode(q))&&U.push(K),q=q.parentNode;return re&&(U.forEach(te),J&&(J[F]=U)),re?U:void 0}function x($){var J={orderedStyles:[],styleProperties:{}};return $.forEach(function(te){Object.keys(te).forEach(function(q){var K=Object.keys(te[q])[0],U={name:K,family:q,displayName:void 0,isCommonStyle:!1},F;(F=w(K,q))?(q=N(F),J.styleProperties=z.mergeObjects(q,J.styleProperties),U.displayName=F.getAttributeNS(m,"display-name")||void 0,U.isCommonStyle=F.parentNode===u.rootElement.styles):runtime.log("No style element found for '"+K+"' of family '"+q+"'"),J.orderedStyles.push(U)})}),J}function I($,J){var te={},q=[];return J||(J={}),$.forEach(function(K){O(K,te)}),Object.keys(te).forEach(function(K){J[K]||(J[K]=x(te[K])),q.push(J[K])}),q}function _($){for(var J=u.rootElement.masterStyles.firstElementChild;J&&(J.namespaceURI!==m||J.localName!=="master-page"||J.getAttributeNS(m,"name")!==$);)J=J.nextElementSibling;return J}function S($,J){var te;return $&&(te=P.convertMeasure($,"px")),te===void 0&&J&&(te=P.convertMeasure(J,"px")),te}var u,y=new odf.StyleInfo,v=odf.Namespaces.svgns,m=odf.Namespaces.stylens,R=odf.Namespaces.textns,V=odf.Namespaces.numberns,Z=odf.Namespaces.fons,ne=odf.OdfUtils,ee=core.DomUtils,z=new core.Utils,P=new core.CSSUnits,Y={paragraph:{"style:paragraph-properties":{"fo:text-align":"left"}}};this.getSystemDefaultStyleAttributes=A,this.setOdfContainer=function($){u=$},this.getFontMap=j,this.getAvailableParagraphStyles=function(){for(var q=u.rootElement.styles,$,J,te=[],q=q&&q.firstElementChild;q;)q.localName==="style"&&q.namespaceURI===m&&($=q.getAttributeNS(m,"family"),$==="paragraph"&&($=q.getAttributeNS(m,"name"),J=q.getAttributeNS(m,"display-name")||$,$&&J&&te.push({name:$,displayName:J}))),q=q.nextElementSibling;return te},this.isStyleUsed=function($){var J,te=u.rootElement;return J=y.hasDerivedStyles(te,odf.Namespaces.lookupNamespaceURI,$),$=new y.UsedStyleList(te.styles).uses($)||new y.UsedStyleList(te.automaticStyles).uses($)||new y.UsedStyleList(te.body).uses($),J||$},this.getDefaultStyleElement=M,this.getStyleElement=w,this.getStyleAttributes=E,this.getInheritedStyleAttributes=N,this.getFirstCommonParentStyleNameOrSelf=function($){var J=u.rootElement.styles,te;return(te=w($,"paragraph",[u.rootElement.automaticStyles]))&&($=te.getAttributeNS(m,"parent-style-name"),!$)?null:(te=w($,"paragraph",[J]))?$:null},this.hasParagraphStyle=function($){return!!w($,"paragraph")},this.getAppliedStyles=I,this.getAppliedStylesForElement=function($,J){return I([$],J)[0]},this.updateStyle=function($,J){var te,q;ee.mapObjOntoNode($,J,odf.Namespaces.lookupNamespaceURI),(te=(te=J["style:text-properties"])&&te["style:font-name"])&&!j().hasOwnProperty(te)&&(q=$.ownerDocument.createElementNS(m,"style:font-face"),q.setAttributeNS(m,"style:name",te),q.setAttributeNS(v,"svg:font-family",te),u.rootElement.fontFaceDecls.appendChild(q))},this.createDerivedStyleObject=function($,J,te){var q=w($,J);return runtime.assert(!!q,"No style element found for '"+$+"' of family '"+J+"'"),$=q.parentNode===u.rootElement.styles?{"style:parent-style-name":$}:E(q),$["style:family"]=J,z.mergeObjects($,te),$},this.getDefaultTabStopDistance=function(){for(var $=M("paragraph"),$=$&&$.firstElementChild,J;$;)$.namespaceURI===m&&$.localName==="paragraph-properties"&&(J=$.getAttributeNS(m,"tab-stop-distance")),$=$.nextElementSibling;return J||(J="1.25cm"),ne.parseNonNegativeLength(J)},this.getMasterPageElement=_,this.getContentSize=function($,J){var te,q,K,U,F,re,W,ie,he,ve;e:{if(q=w($,J),runtime.assert(J==="paragraph"||J==="table","styleFamily must be either paragraph or table"),q&&((q=q.getAttributeNS(m,"master-page-name"))&&((te=_(q))||runtime.log("WARN: No master page definition found for "+q)),te||(te=_("Standard")),te||(te=u.rootElement.masterStyles.getElementsByTagNameNS(m,"master-page")[0])||runtime.log("WARN: Document has no master pages defined"),te)){for(q=te.getAttributeNS(m,"page-layout-name"),K=u.rootElement.automaticStyles.getElementsByTagNameNS(m,"page-layout"),U=0;U<K.length;U+=1)if(te=K.item(U),te.getAttributeNS(m,"name")===q)break e}te=null}return te||(te=ee.getDirectChild(u.rootElement.styles,m,"default-page-layout")),(te=ee.getDirectChild(te,m,"page-layout-properties"))?(te.getAttributeNS(m,"print-orientation")==="landscape"?(q="29.7cm",K="21.001cm"):(q="21.001cm",K="29.7cm"),q=S(te.getAttributeNS(Z,"page-width"),q),K=S(te.getAttributeNS(Z,"page-height"),K),U=S(te.getAttributeNS(Z,"margin")),U===void 0?(U=S(te.getAttributeNS(Z,"margin-left"),"2cm"),F=S(te.getAttributeNS(Z,"margin-right"),"2cm"),re=S(te.getAttributeNS(Z,"margin-top"),"2cm"),W=S(te.getAttributeNS(Z,"margin-bottom"),"2cm")):U=F=re=W=U,ie=S(te.getAttributeNS(Z,"padding")),ie===void 0?(ie=S(te.getAttributeNS(Z,"padding-left"),"0cm"),he=S(te.getAttributeNS(Z,"padding-right"),"0cm"),ve=S(te.getAttributeNS(Z,"padding-top"),"0cm"),te=S(te.getAttributeNS(Z,"padding-bottom"),"0cm")):ie=he=ve=te=ie):(q=S("21.001cm"),K=S("29.7cm"),U=F=re=W=U=S("2cm"),ie=he=ve=te=ie=S("0cm")),{width:q-U-F-ie-he,height:K-re-W-ve-te}}},function(){var A=odf.Namespaces.stylens,j=odf.Namespaces.textns,M={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"};odf.StyleTreeNode=function(w){this.derivedStyles={},this.element=w},odf.StyleTree=function(w,E){function N(S){var u,y,v,m={};if(!S)return m;for(S=S.firstElementChild;S;)(y=S.namespaceURI!==A||S.localName!=="style"&&S.localName!=="default-style"?S.namespaceURI===j&&S.localName==="list-style"?"list":S.namespaceURI!==A||S.localName!=="page-layout"&&S.localName!=="default-page-layout"?void 0:"page":S.getAttributeNS(A,"family"))&&((u=S.getAttributeNS(A,"name"))||(u=""),m.hasOwnProperty(y)?v=m[y]:m[y]=v={},v[u]=S),S=S.nextElementSibling;return m}function O(S,u){if(S.hasOwnProperty(u))return S[u];var y=null,v=Object.keys(S),m;for(m=0;m<v.length&&!(y=O(S[v[m]].derivedStyles,u));m+=1);return y}function x(S,u,y){var v,m,R;return u.hasOwnProperty(S)?(v=new odf.StyleTreeNode(u[S]),m=v.element.getAttributeNS(A,"parent-style-name"),R=null,m&&(R=O(y,m)||x(m,u,y)),R?R.derivedStyles[S]=v:y[S]=v,delete u[S],v):null}function I(S,u){S&&Object.keys(S).forEach(function(y){x(y,S,u)})}var _={};this.getStyleTree=function(){return _},function(){var S,u,y;u=N(w),y=N(E),Object.keys(M).forEach(function(v){S=_[v]={},I(u[v],S),I(y[v],S)})}()}}(),function(){function A(I,_){try{I.insertRule(_,I.cssRules.length)}catch(S){runtime.log("cannot load rule: "+_+" - "+S)}}function j(I,_){this.listCounterCount=0,this.contentRules=I,this.counterIdStack=[],this.continuedCounterIdStack=_}function M(I){function _(v,m,R,V){var Z=m.namespaceURI===N&&m.localName==="list",ne=m.namespaceURI===N&&m.localName==="list-item";if(Z||ne){if(Z){var Z=R+=1,ee,z,P;for(V.listCounterCount+=1,ne=v+"-level"+Z+"-"+V.listCounterCount,m.setAttributeNS("urn:webodf:names:helper","counter-id",ne),ee=V.continuedCounterIdStack.shift(),ee||(ee=ne,u+=ne+" 1 ",z='text|list[webodfhelper|counter-id="'+ne+'"] > text|list-item:first-child > :not(text|list):first-child:before',z+="{",z+="counter-increment: "+ee+" 0;",z+="}",A(I,z));V.counterIdStack.length>=Z;)V.counterIdStack.pop();for(V.counterIdStack.push(ee),P=V.contentRules[Z.toString()]||"",z=1;z<=Z;z+=1)P=P.replace(z+"webodf-listLevel",V.counterIdStack[z-1]);z='text|list[webodfhelper|counter-id="'+ne+'"] > text|list-item > :not(text|list):first-child:before',z+="{",z+=P,z+="counter-increment: "+ee+";",z+="}",A(I,z)}for(m=m.firstElementChild;m;)_(v,m,R,V),m=m.nextElementSibling}else V.continuedCounterIdStack=[]}var S=0,u="",y={};this.createCounterRules=function(v,m,R){var V=m.getAttributeNS(O,"id"),Z=[];R&&(R=R.getAttributeNS("urn:webodf:names:helper","counter-id"),Z=y[R].slice(0)),v=new j(v,Z),V?V="Y"+V:(S+=1,V="X"+S),_(V,m,0,v),y[V+"-level1-1"]=v.counterIdStack},this.initialiseCreatedCounters=function(){var v;v="office|document{"+("counter-reset: "+u+";"),v+="}",A(I,v)}}var w=odf.Namespaces.fons,E=odf.Namespaces.stylens,N=odf.Namespaces.textns,O=odf.Namespaces.xmlns,x={1:"decimal",a:"lower-latin",A:"upper-latin",i:"lower-roman",I:"upper-roman"};odf.ListStyleToCss=function(){function I(m){var R=v.parseLength(m);return R?y.convert(R.value,R.unit,"px"):(runtime.log("Could not parse value '"+m+"'."),0)}function _(m){return m.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function S(m,R){var V;return m&&(V=m.getAttributeNS(N,"style-name")),V===R}function u(m,R,V){R=R.getElementsByTagNameNS(N,"list"),m=new M(m);var Z,ne,ee,z,P,Y,$={},J;for(J=0;J<R.length;J+=1)if(Z=R.item(J),Y=Z.getAttributeNS(N,"style-name")){ee=Z.getAttributeNS(N,"continue-numbering"),z=Z.getAttributeNS(N,"continue-list"),(P=Z.getAttributeNS(O,"id"))&&($[P]=Z),P=V[Y].element.firstElementChild;for(var te=void 0,q={};P;){var te=(te=P.getAttributeNS(N,"level"))&&parseInt(te,10),K=P,U="",F=void 0,re=void 0,W=F=void 0;if(K.localName==="list-level-style-number"){var ve=K,U=ve.getAttributeNS(E,"num-format"),F=ve.getAttributeNS(E,"num-suffix")||"",re=ve.getAttributeNS(E,"num-prefix")||"",ie="",he=ve.getAttributeNS(N,"level"),ve=ve.getAttributeNS(N,"display-levels");if(re&&(ie+='"'+_(re)+`"
`),x.hasOwnProperty(U))for(he=he?parseInt(he,10):1,ve=ve?parseInt(ve,10):1;0<ve;)ie+=" counter("+(he-ve+1)+"webodf-listLevel,"+x[U]+")",1<ve&&(ie+='"."'),--ve;else ie=U?ie+(' "'+U+'"'):ie+' ""';U="content:"+ie+' "'+_(F)+'"'}else K.localName==="list-level-style-image"?U="content: none":K.localName==="list-level-style-bullet"&&(U=K.getAttributeNS(N,"bullet-char"),U='content: "'+_(U)+'"');(F=K.getElementsByTagNameNS(E,"list-level-properties")[0])&&(re=F.getAttributeNS(N,"list-level-position-and-space-mode"),re==="label-alignment"&&((F=F.getElementsByTagNameNS(E,"list-level-label-alignment")[0])&&(W=F.getAttributeNS(N,"label-followed-by")),W==="space"&&(U+=' "\\a0"'))),q[te]=`
`+U+`;
`,P=P.nextElementSibling}P=q,ee&&!z&&S(ne,Y)?m.createCounterRules(P,Z,ne):z&&S($[z],Y)?m.createCounterRules(P,Z,$[z]):m.createCounterRules(P,Z),ne=Z}m.initialiseCreatedCounters()}var y=new core.CSSUnits,v=odf.OdfUtils;this.applyListStyles=function(m,R,V){var Z,ne;(Z=R.list)&&Object.keys(Z).forEach(function(ee){ne=Z[ee];for(var z=ne.element.firstElementChild;z;){if(z.namespaceURI===N){for(var P=m,Y=z,$='text|list[text|style-name="'+ee+'"]',J=Y.getAttributeNS(N,"level"),he=void 0,te=void 0,W=te=void 0,ie=void 0,q=void 0,K=he=void 0,U=void 0,F=void 0,re=void 0,ie=void 0,W=(te=Y.getElementsByTagNameNS(E,"list-level-properties")[0])&&te.getAttributeNS(N,"list-level-position-and-space-mode"),ie=te&&te.getElementsByTagNameNS(E,"list-level-label-alignment")[0],he=J=J&&parseInt(J,10);1<he;)$+=" > text|list-item > text|list",--he;switch(he=te&&te.getAttributeNS(w,"text-align")||"left",he){case"end":he="right";break;case"start":he="left"}W==="label-alignment"?(q=ie&&ie.getAttributeNS(w,"margin-left")||"0px",F=ie&&ie.getAttributeNS(w,"text-indent")||"0px",re=ie&&ie.getAttributeNS(N,"label-followed-by"),ie=I(q)):(q=te&&te.getAttributeNS(N,"space-before")||"0px",K=te&&te.getAttributeNS(N,"min-label-width")||"0px",U=te&&te.getAttributeNS(N,"min-label-distance")||"0px",ie=I(q)+I(K)),te=$+" > text|list-item",te+="{",te+="margin-left: "+ie+"px;",te+="}",A(P,te),te=$+" > text|list-item > text|list",te+="{",te+="margin-left: "+-ie+"px;",te+="}",A(P,te),te=$+" > text|list-item > :not(text|list):first-child:before",te+="{",te+="text-align: "+he+";",te+="display: inline-block;",W==="label-alignment"?(te+="margin-left: "+F+";",re==="listtab"&&(te+="padding-right: 0.2cm;")):(te+="min-width: "+K+";",te+="margin-left: "+(parseFloat(K)===0?"":"-")+K+";",te+="padding-right: "+U+";"),te+="}",A(P,te)}z=z.nextElementSibling}}),u(m,V,Z)}}}(),odf.LazyStyleProperties=function(A,j){var M={};this.value=function(w){var E;return M.hasOwnProperty(w)?E=M[w]:(E=j[w](),E===void 0&&A&&(E=A.value(w)),M[w]=E),E},this.reset=function(w){A=w,M={}}},odf.StyleParseUtils=function(){function A(M){var w,E;return M=(M=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px))/.exec(M))?{value:parseFloat(M[1]),unit:M[3]}:null,E=M&&M.unit,E==="px"?w=M.value:E==="cm"?w=M.value/2.54*96:E==="mm"?w=M.value/25.4*96:E==="in"?w=96*M.value:E==="pt"?w=M.value/.75:E==="pc"&&(w=16*M.value),w}var j=odf.Namespaces.stylens;this.parseLength=A,this.parsePositiveLengthOrPercent=function(M,w,E){var N;M&&(N=parseFloat(M.substr(0,M.indexOf("%"))),isNaN(N)&&(N=void 0));var O;return N!==void 0?(E&&(O=E.value(w)),N=O===void 0?void 0:O/100*N):N=A(M),N},this.getPropertiesElement=function(M,w,E){for(w=E?E.nextElementSibling:w.firstElementChild;w!==null&&(w.localName!==M||w.namespaceURI!==j);)w=w.nextElementSibling;return w},this.parseAttributeList=function(M){return M&&(M=M.replace(/^\s*(.*?)\s*$/g,"$1")),M&&0<M.length?M.split(/\s+/):[]}},odf.Style2CSS=function(){function A(le,me,De){var Me=[];De=De.derivedStyles;var Re,we=Z[le],ke;we===void 0?me=null:(ke=me?"["+we+'|style-name="'+me+'"]':"",we==="presentation"&&(we="draw",ke=me?'[presentation|style-name="'+me+'"]':""),me=we+"|"+ne[le].join(ke+","+we+"|")+ke),me!==null&&Me.push(me);for(Re in De)De.hasOwnProperty(Re)&&(me=A(le,Re,De[Re]),Me=Me.concat(me));return Me}function j(le){var De="",me="",De=null;return le.localName==="default-style"?null:(De=le.getAttributeNS(S,"parent-style-name"),me=le.getAttributeNS(S,"family"),De=ze.getODFElementsWithXPath(ve,De?"//style:*[@style:name='"+De+"'][@style:family='"+me+"']":"//style:default-style[@style:family='"+me+"']",odf.Namespaces.lookupNamespaceURI)[0])}function M(le,me){var De="",Me,Re,we;for(Me=0;Me<me.length;Me+=1)if(Re=me[Me],we=le.getAttributeNS(Re[0],Re[1])){if(we=we.trim(),F.hasOwnProperty(Re[1])){var ke=we,Ve=ke.indexOf(" "),We=void 0;we=void 0,Ve!==-1?(We=ke.substring(0,Ve),we=ke.substring(Ve)):(We=ke,we=""),(We=ie.parseLength(We))&&We.unit==="pt"&&.75>We.value&&(ke="0.75pt"+we),we=ke}else if(re.hasOwnProperty(Re[1])){var ke=le,Ve=Re[0],We=Re[1],$e=ie.parseLength(we),ue=void 0,Se=void 0,Fe=void 0,be=void 0,Fe=void 0;if($e&&$e.unit==="%"){for(ue=$e.value/100,Se=j(ke.parentNode),be="0";Se;){if((Fe=R.getDirectChild(Se,S,"paragraph-properties"))&&(Fe=ie.parseLength(Fe.getAttributeNS(Ve,We)))){if(Fe.unit!=="%"){be=Fe.value*ue+Fe.unit;break}ue*=Fe.value/100}Se=j(Se)}we=be}}Re[2]&&(De+=Re[2]+":"+we+";")}return De}function w(le,me,De,Me){return me+me+De+De+Me+Me}function E(le,me){var De=[le],Me=me.derivedStyles;return Object.keys(Me).forEach(function(Re){Re=E(Re,Me[Re]),De=De.concat(Re)}),De}function N(le,me,De,Me){function Re(We,$e){var ue=[],Se;We.forEach(function(be){we.forEach(function(Fe){ue.push('draw|page[webodfhelper|page-style-name="'+Fe+'"] draw|frame[presentation|class="'+be+'"]')})}),0<ue.length&&(Se=ue.join(",")+"{visibility:"+$e+";}",le.insertRule(Se,le.cssRules.length))}var we=E(me,Me),ke=[],Ve=[];["page-number","date-time","header","footer"].forEach(function(We){var $e;$e=De.getAttributeNS(m,"display-"+We),$e==="true"?ke.push(We):$e==="false"&&Ve.push(We)}),Re(ke,"visible"),Re(Ve,"hidden")}function O(le,me,De,Me){var Re,we;if(me==="page"){var ke=Me.element,Ve="",We,$e;$e=We="",De=R.getDirectChild(ke,S,"page-layout-properties");var ue;if(De)if(ue=ke.getAttributeNS(S,"name"),Ve+=M(De,K),(We=R.getDirectChild(De,S,"background-image"))&&($e=We.getAttributeNS(v,"href"))&&(Ve=Ve+("background-image: url('odfkit:"+$e+"');")+M(We,z)),he==="presentation")for(ke=(ke=R.getDirectChild(ke.parentNode.parentNode,_,"master-styles"))&&ke.firstElementChild;ke;)ke.namespaceURI===S&&ke.localName==="master-page"&&ke.getAttributeNS(S,"page-layout-name")===ue&&($e=ke.getAttributeNS(S,"name"),We='draw|page[draw|master-page-name="'+$e+'"] {'+Ve+"}",$e='office|body, draw|page[draw|master-page-name="'+$e+'"] {'+M(De,U)+" }",le.insertRule(We,le.cssRules.length),le.insertRule($e,le.cssRules.length)),ke=ke.nextElementSibling;else he==="text"&&(We="office|text {"+Ve+"}",$e="office|body {width: "+De.getAttributeNS(I,"page-width")+";}",le.insertRule(We,le.cssRules.length),le.insertRule($e,le.cssRules.length))}else{if(Ve=A(me,De,Me).join(","),ue="",ke=R.getDirectChild(Me.element,S,"text-properties")){var Se=ke,be=we="";switch(We="",$e=1,ke=""+M(Se,ee),Re=Se.getAttributeNS(S,"text-underline-style"),Re==="solid"&&(we+=" underline"),Re=Se.getAttributeNS(S,"text-line-through-style"),Re==="solid"&&(we+=" line-through"),we.length&&(ke=ke+("text-decoration:"+we+`;
`)+("text-decoration-line:"+we+`;
`),ke+="-moz-text-decoration-line:"+we+`;
`),Re=Se.getAttributeNS(S,"text-line-through-type"),Re){case"double":be+=" double";break;case"single":be+=" single"}if(be&&(ke+="text-decoration-style:"+be+`;
`,ke+="-moz-text-decoration-style:"+be+`;
`),(we=Se.getAttributeNS(S,"font-name")||Se.getAttributeNS(I,"font-family"))&&(Re=W[we],ke+="font-family: "+(Re||we)+";"),(Re=Se.getAttributeNS(S,"text-position"))&&(we=V.parseAttributeList(Re),Re=we[0],we=we[1],ke+="vertical-align: "+Re+`
; `,we&&($e=parseFloat(we)/100)),Se.hasAttributeNS(I,"font-size")||$e!==1){for(Se=Se.parentNode;Se;){if(Re=(Re=R.getDirectChild(Se,S,"text-properties"))?ie.parseFoFontSize(Re.getAttributeNS(I,"font-size")):null){if(Re.unit!=="%"){We="font-size: "+Re.value*$e+Re.unit+";";break}$e*=Re.value/100}Se=j(Se)}We||(We="font-size: "+parseFloat(Ne)*$e+rt.getUnits(Ne)+";")}ke+=We,ue+=ke}(ke=R.getDirectChild(Me.element,S,"paragraph-properties"))&&(We=ke,ke=""+M(We,P),($e=R.getDirectChild(We,S,"background-image"))&&(Se=$e.getAttributeNS(v,"href"))&&(ke=ke+("background-image: url('odfkit:"+Se+"');")+M($e,z)),(We=We.getAttributeNS(I,"line-height"))&&We!=="normal"&&(We=ie.parseFoLineHeight(We),ke=We.unit!=="%"?ke+("line-height: "+We.value+We.unit+";"):ke+("line-height: "+We.value/100+";")),ue+=ke),(ke=R.getDirectChild(Me.element,S,"graphic-properties"))&&(Se=ke,ke=""+M(Se,Y),We=Se.getAttributeNS(x,"opacity"),$e=Se.getAttributeNS(x,"fill"),Se=Se.getAttributeNS(x,"fill-color"),$e==="solid"||$e==="hatch"?Se&&Se!=="none"?(We=isNaN(parseFloat(We))?1:parseFloat(We)/100,$e=Se.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,w),(Se=($e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec($e))?{r:parseInt($e[1],16),g:parseInt($e[2],16),b:parseInt($e[3],16)}:null)&&(ke+="background-color: rgba("+Se.r+","+Se.g+","+Se.b+","+We+");")):ke+="background: none;":$e==="none"&&(ke+="background: none;"),ue+=ke),(ke=R.getDirectChild(Me.element,S,"drawing-page-properties"))&&(We=ke,$e=""+M(We,Y),We.getAttributeNS(m,"background-visible")==="true"&&($e+="background: none;"),ue+=$e,N(le,De,ke,Me)),(ke=R.getDirectChild(Me.element,S,"table-cell-properties"))&&(De=ue,ue=""+M(ke,$),ue=De+ue),(ke=R.getDirectChild(Me.element,S,"table-row-properties"))&&(De=ue,ue=""+M(ke,te),ue=De+ue),(ke=R.getDirectChild(Me.element,S,"table-column-properties"))&&(De=ue,ue=""+M(ke,J),ue=De+ue),(ke=R.getDirectChild(Me.element,S,"table-properties"))&&(De=ue,ue=""+M(ke,q),ke=ke.getAttributeNS(y,"border-model"),ke==="collapsing"?ue+="border-collapse:collapse;":ke==="separating"&&(ue+="border-collapse:separate;"),ue=De+ue),ue.length!==0&&le.insertRule(Ve+"{"+ue+"}",le.cssRules.length)}for(var Fe in Me.derivedStyles)Me.derivedStyles.hasOwnProperty(Fe)&&O(le,me,Fe,Me.derivedStyles[Fe])}var x=odf.Namespaces.drawns,I=odf.Namespaces.fons,_=odf.Namespaces.officens,S=odf.Namespaces.stylens,u=odf.Namespaces.svgns,y=odf.Namespaces.tablens,v=odf.Namespaces.xlinkns,m=odf.Namespaces.presentationns,R=core.DomUtils,V=new odf.StyleParseUtils,Z={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"},ne={graphic:"circle connected control custom-shape ellipse frame g line measure page page-thumbnail path polygon polyline rect regular-polygon".split(" "),paragraph:"alphabetical-index-entry-template h illustration-index-entry-template index-source-style object-index-entry-template p table-index-entry-template table-of-content-entry-template user-index-entry-template".split(" "),presentation:"caption circle connector control custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),"drawing-page":"caption circle connector control page custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),ruby:["ruby","ruby-text"],section:"alphabetical-index bibliography illustration-index index-title object-index section table-of-content table-index user-index".split(" "),table:["background","table"],"table-cell":"body covered-table-cell even-columns even-rows first-column first-row last-column last-row odd-columns odd-rows table-cell".split(" "),"table-column":["table-column"],"table-row":["table-row"],text:"a index-entry-chapter index-entry-link-end index-entry-link-start index-entry-page-number index-entry-span index-entry-tab-stop index-entry-text index-title-template linenumbering-configuration list-level-style-number list-level-style-bullet outline-level-style span".split(" "),list:["list-item"]},ee=[[I,"color","color"],[I,"background-color","background-color"],[I,"font-weight","font-weight"],[I,"font-style","font-style"]],z=[[S,"repeat","background-repeat"]],P=[[I,"background-color","background-color"],[I,"text-align","text-align"],[I,"text-indent","text-indent"],[I,"padding","padding"],[I,"padding-left","padding-left"],[I,"padding-right","padding-right"],[I,"padding-top","padding-top"],[I,"padding-bottom","padding-bottom"],[I,"border-left","border-left"],[I,"border-right","border-right"],[I,"border-top","border-top"],[I,"border-bottom","border-bottom"],[I,"margin","margin"],[I,"margin-left","margin-left"],[I,"margin-right","margin-right"],[I,"margin-top","margin-top"],[I,"margin-bottom","margin-bottom"],[I,"border","border"]],Y=[[I,"background-color","background-color"],[I,"min-height","min-height"],[x,"stroke","border"],[u,"stroke-color","border-color"],[u,"stroke-width","border-width"],[I,"border","border"],[I,"border-left","border-left"],[I,"border-right","border-right"],[I,"border-top","border-top"],[I,"border-bottom","border-bottom"]],$=[[I,"background-color","background-color"],[I,"border-left","border-left"],[I,"border-right","border-right"],[I,"border-top","border-top"],[I,"border-bottom","border-bottom"],[I,"border","border"]],J=[[S,"column-width","width"]],te=[[S,"row-height","height"],[I,"keep-together",null]],q=[[S,"width","width"],[I,"margin-left","margin-left"],[I,"margin-right","margin-right"],[I,"margin-top","margin-top"],[I,"margin-bottom","margin-bottom"]],K=[[I,"background-color","background-color"],[I,"padding","padding"],[I,"padding-left","padding-left"],[I,"padding-right","padding-right"],[I,"padding-top","padding-top"],[I,"padding-bottom","padding-bottom"],[I,"border","border"],[I,"border-left","border-left"],[I,"border-right","border-right"],[I,"border-top","border-top"],[I,"border-bottom","border-bottom"],[I,"margin","margin"],[I,"margin-left","margin-left"],[I,"margin-right","margin-right"],[I,"margin-top","margin-top"],[I,"margin-bottom","margin-bottom"]],U=[[I,"page-width","width"],[I,"page-height","height"]],F={border:!0,"border-left":!0,"border-right":!0,"border-top":!0,"border-bottom":!0,"stroke-width":!0},re={margin:!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"margin-bottom":!0},W={},ie=odf.OdfUtils,he,ve,Ne,ze=xmldom.XPath,rt=new core.CSSUnits;this.style2css=function(le,me,De,Me,Re){function we($e,ue){ke="@namespace "+$e+" url("+ue+");";try{De.insertRule(ke,De.cssRules.length)}catch{}}var ke,Ve,We;for(ve=me;De.cssRules.length;)De.deleteRule(De.cssRules.length-1);odf.Namespaces.forEachPrefix(we),we("webodfhelper","urn:webodf:names:helper"),W=Me,he=le,Ne=runtime.getWindow().getComputedStyle(document.body,null).getPropertyValue("font-size")||"12pt";for(We in Z)if(Z.hasOwnProperty(We))for(Ve in le=Re[We],le)le.hasOwnProperty(Ve)&&O(De,We,Ve,le[Ve])}},function(){function A(j,M){var w=this;this.getDistance=function(E){var N=w.x-E.x;return E=w.y-E.y,Math.sqrt(N*N+E*E)},this.getCenter=function(E){return new A((w.x+E.x)/2,(w.y+E.y)/2)},w.x=j,w.y=M}gui.ZoomHelper=function(){function j(te,q,K,U){te=U?"translate3d("+te+"px, "+q+"px, 0) scale3d("+K+", "+K+", 1)":"translate("+te+"px, "+q+"px) scale("+K+")",y.style.WebkitTransform=te,y.style.MozTransform=te,y.style.msTransform=te,y.style.OTransform=te,y.style.transform=te}function M(te){te?j(-v.x,-v.y,V,!0):(j(0,0,V,!0),j(0,0,V,!1))}function w(te){if(ne&&$){var q=ne.style.overflow,K=ne.classList.contains("webodf-customScrollbars");te&&K||!te&&!K||(te?(ne.classList.add("webodf-customScrollbars"),ne.style.overflow="hidden",runtime.requestAnimationFrame(function(){ne.style.overflow=q})):ne.classList.remove("webodf-customScrollbars"))}}function E(){j(-v.x,-v.y,V,!0),ne.scrollLeft=0,ne.scrollTop=0,J=ee.style.overflow,ee.style.overflow="visible",w(!1)}function N(){j(0,0,V,!0),ne.scrollLeft=v.x,ne.scrollTop=v.y,ee.style.overflow=J||"",w(!0)}function O(te){return new A(te.pageX-y.offsetLeft,te.pageY-y.offsetTop)}function x(te){if(m){v.x-=te.x-m.x,v.y-=te.y-m.y;var q=v;v=new A(Math.min(Math.max(q.x,y.offsetLeft),(y.offsetLeft+y.offsetWidth)*V-ne.clientWidth),Math.min(Math.max(q.y,y.offsetTop),(y.offsetTop+y.offsetHeight)*V-ne.clientHeight))}m=te}function I(te){var q=te.touches.length,K=0<q?O(te.touches[0]):null;te=1<q?O(te.touches[1]):null,K&&te?(R=K.getDistance(te),Z=V,m=K.getCenter(te),E(),Y=P.PINCH):K&&(m=K,Y=P.SCROLL)}function _(te){var K=te.touches.length,q=0<K?O(te.touches[0]):null,K=1<K?O(te.touches[1]):null;if(q&&K)if(te.preventDefault(),Y===P.SCROLL)Y=P.PINCH,E(),R=q.getDistance(K);else{te=q.getCenter(K),q=q.getDistance(K)/R,x(te);var K=V,U=Math.min(4,y.offsetParent.clientWidth/y.offsetWidth);V=Z*q,V=Math.min(Math.max(V,U),4),q=V/K,v.x+=(q-1)*(te.x+v.x),v.y+=(q-1)*(te.y+v.y),M(!0)}else q&&(Y===P.PINCH?(Y=P.SCROLL,N()):x(q))}function S(){Y===P.PINCH&&(z.emit(gui.ZoomHelper.signalZoomChanged,V),N(),M(!1)),Y=P.NONE}function u(){ne&&(ne.removeEventListener("touchstart",I,!1),ne.removeEventListener("touchmove",_,!1),ne.removeEventListener("touchend",S,!1))}var y,v,m,R,V,Z,ne,ee,z=new core.EventNotifier([gui.ZoomHelper.signalZoomChanged]),P={NONE:0,SCROLL:1,PINCH:2},Y=P.NONE,$=runtime.getWindow().hasOwnProperty("ontouchstart"),J="";this.subscribe=function(te,q){z.subscribe(te,q)},this.unsubscribe=function(te,q){z.unsubscribe(te,q)},this.getZoomLevel=function(){return V},this.setZoomLevel=function(te){y&&(V=te,M(!1),z.emit(gui.ZoomHelper.signalZoomChanged,V))},this.destroy=function(te){u(),w(!1),te()},this.setZoomableElement=function(te){u(),y=te,ne=y.offsetParent,ee=y.parentNode,M(!1),ne&&(ne.addEventListener("touchstart",I,!1),ne.addEventListener("touchmove",_,!1),ne.addEventListener("touchend",S,!1)),w(!0)},Z=V=1,v=new A(0,0)},gui.ZoomHelper.signalZoomChanged="zoomChanged"}(),ops.Canvas=function(){},ops.Canvas.prototype.getZoomLevel=function(){},ops.Canvas.prototype.getElement=function(){},ops.Canvas.prototype.getSizer=function(){},ops.Canvas.prototype.getZoomHelper=function(){},function(){function A(){function U(W){re=!0,runtime.setTimeout(function(){try{W()}catch(ie){runtime.log(String(ie)+`
`+ie.stack)}re=!1,0<F.length&&U(F.pop())},10)}var F=[],re=!1;this.clearQueue=function(){F.length=0},this.addToQueue=function(W){if(F.length===0&&!re)return U(W);F.push(W)}}function j(U){function F(){for(;0<re.cssRules.length;)re.deleteRule(0);re.insertRule("#shadowContent draw|page {display:none;}",0),re.insertRule("office|presentation draw|page {display:none;}",1),re.insertRule("#shadowContent draw|page:nth-of-type("+W+") {display:block;}",2),re.insertRule("office|presentation draw|page:nth-of-type("+W+") {display:block;}",3)}var re=U.sheet,W=1;this.showFirstPage=function(){W=1,F()},this.showNextPage=function(){W+=1,F()},this.showPreviousPage=function(){1<W&&(--W,F())},this.showPage=function(ie){0<ie&&(W=ie,F())},this.css=U,this.destroy=function(ie){U.parentNode.removeChild(U),ie()}}function M(U){U=U.sheet;for(var F=U.cssRules;F.length;)U.deleteRule(F.length-1)}function w(U,F,re){var W=new odf.Style2CSS,ie=new odf.ListStyleToCss;re=re.sheet;var he=new odf.StyleTree(U.rootElement.styles,U.rootElement.automaticStyles).getStyleTree();W.style2css(U.getDocumentType(),U.rootElement,re,F.getFontMap(),he),ie.applyListStyles(re,he,U.rootElement.body)}function E(U,F){new odf.FontLoader().loadFonts(U,F.sheet)}function N(U,F,re){var W=null;U=U.rootElement.body.getElementsByTagNameNS(te,re+"-decl"),re=F.getAttributeNS(te,"use-"+re+"-name");var ie;if(re&&0<U.length){for(F=0;F<U.length;F+=1)if(ie=U[F],ie.getAttributeNS(te,"name")===re){W=ie.textContent;break}}return W}function O(U,F,re,W){var ie=U.ownerDocument;for(F=K.getElementsByTagNameNS(U,F,re),U=0;U<F.length;U+=1)K.removeAllChildNodes(F[U]),W&&(re=F[U],re.appendChild(ie.createTextNode(W)))}function x(U,F,re){F.setAttributeNS("urn:webodf:names:helper","styleid",U);var W,ie=F.getAttributeNS($,"anchor-type"),he=F.getAttributeNS(P,"x"),ve=F.getAttributeNS(P,"y"),Ne=F.getAttributeNS(P,"width"),ze=F.getAttributeNS(P,"height"),rt=F.getAttributeNS(ne,"min-height"),le=F.getAttributeNS(ne,"min-width");ie==="as-char"?W="display: inline-block;":ie||he||ve?W="position: absolute;":(Ne||ze||rt||le)&&(W="display: block;"),he&&(W+="left: "+he+";"),ve&&(W+="top: "+ve+";"),Ne&&(W+="width: "+Ne+";"),ze&&(W+="height: "+ze+";"),rt&&(W+="min-height: "+rt+";"),le&&(W+="min-width: "+le+";"),W&&(W="draw|"+F.localName+'[webodfhelper|styleid="'+U+'"] {'+W+"}",re.insertRule(W,re.cssRules.length))}function I(U){for(U=U.firstChild;U;){if(U.namespaceURI===ee&&U.localName==="binary-data")return"data:image/png;base64,"+U.textContent.replace(/[\r\n\s]/g,"");U=U.nextSibling}return""}function _(U,F,re,W){function ie(ze){ze&&(ze='draw|image[webodfhelper|styleid="'+U+'"] {'+("background-image: url("+ze+");")+"}",W.insertRule(ze,W.cssRules.length))}function he(ze){ie(ze.url)}re.setAttributeNS("urn:webodf:names:helper","styleid",U);var ve=re.getAttributeNS(J,"href"),Ne;if(ve)try{Ne=F.getPart(ve),Ne.onchange=he,Ne.load()}catch(ze){runtime.log("slight problem: "+String(ze))}else ve=I(re),ie(ve)}function S(U){var F=U.ownerDocument;K.getElementsByTagNameNS(U,$,"line-break").forEach(function(re){re.hasChildNodes()||re.appendChild(F.createElement("br"))})}function u(U){var F=U.ownerDocument;K.getElementsByTagNameNS(U,$,"s").forEach(function(re){var W,ie;if(K.removeAllChildNodes(re),re.appendChild(F.createTextNode(" ")),ie=parseInt(re.getAttributeNS($,"c"),10),1<ie)for(re.removeAttributeNS($,"c"),W=1;W<ie;W+=1)re.parentNode.insertBefore(re.cloneNode(!0),re)})}function y(U){K.getElementsByTagNameNS(U,$,"tab").forEach(function(F){F.textContent="	"})}function v(U,F){function re(rt,le){var me=Ne.documentElement.namespaceURI;le.substr(0,6)==="video/"?(ie=Ne.createElementNS(me,"video"),ie.setAttribute("controls","controls"),he=Ne.createElementNS(me,"source"),rt&&he.setAttribute("src",rt),he.setAttribute("type",le),ie.appendChild(he),F.parentNode.appendChild(ie)):F.innerHtml="Unrecognised Plugin"}function W(rt){re(rt.url,rt.mimetype)}var ie,he,ve,Ne=F.ownerDocument,ze;if(ve=F.getAttributeNS(J,"href"))try{ze=U.getPart(ve),ze.onchange=W,ze.load()}catch(rt){runtime.log("slight problem: "+String(rt))}else runtime.log("using MP4 data fallback"),ve=I(F),re(ve,"video/mp4")}function m(U){var F=U.getElementsByTagName("head")[0],re,W;for(re=U.styleSheets.length,W=F.firstElementChild;W&&(W.localName!=="style"||!W.hasAttribute("webodfcss"));)W=W.nextElementSibling;return W?(re=parseInt(W.getAttribute("webodfcss"),10),W.setAttribute("webodfcss",re+1),W):(typeof webodf_css=="string"?re=webodf_css:(W="webodf.css",runtime.currentDirectory&&(W=runtime.currentDirectory(),0<W.length&&W.substr(-1)!=="/"&&(W+="/"),W+="../webodf.css"),re=runtime.readFileSync(W,"utf-8")),W=U.createElementNS(F.namespaceURI,"style"),W.setAttribute("media","screen, print, handheld, projection"),W.setAttribute("type","text/css"),W.setAttribute("webodfcss","1"),W.appendChild(U.createTextNode(re)),F.appendChild(W),W)}function R(U){var F=parseInt(U.getAttribute("webodfcss"),10);F===1?U.parentNode.removeChild(U):U.setAttribute("count",F-1)}function V(U){var F=U.getElementsByTagName("head")[0],re=U.createElementNS(F.namespaceURI,"style"),W="";return re.setAttribute("type","text/css"),re.setAttribute("media","screen, print, handheld, projection"),odf.Namespaces.forEachPrefix(function(ie,he){W+="@namespace "+ie+" url("+he+`);
`}),W+=`@namespace webodfhelper url(urn:webodf:names:helper);
`,re.appendChild(U.createTextNode(W)),F.appendChild(re),re}var Z=odf.Namespaces.drawns,ne=odf.Namespaces.fons,ee=odf.Namespaces.officens,z=odf.Namespaces.stylens,P=odf.Namespaces.svgns,Y=odf.Namespaces.tablens,$=odf.Namespaces.textns,J=odf.Namespaces.xlinkns,te=odf.Namespaces.presentationns,q=xmldom.XPath,K=core.DomUtils;odf.OdfCanvas=function(U,F){function re(et,ct,It){function at(Je,ei,ki,ti){$t.addToQueue(function(){_(Je,ei,ki,ti)})}var vt,Ke;for(vt=ct.getElementsByTagNameNS(Z,"image"),ct=0;ct<vt.length;ct+=1)Ke=vt.item(ct),at("image"+String(ct),et,Ke,It)}function W(et,ct){function It(Je,ei){$t.addToQueue(function(){v(Je,ei)})}var at,vt,Ke;for(vt=ct.getElementsByTagNameNS(Z,"plugin"),at=0;at<vt.length;at+=1)Ke=vt.item(at),It(et,Ke)}function ie(){var et;et=Re.firstChild;var ct=Rt.getZoomLevel();et&&(Re.style.WebkitTransformOrigin="0% 0%",Re.style.MozTransformOrigin="0% 0%",Re.style.msTransformOrigin="0% 0%",Re.style.OTransformOrigin="0% 0%",Re.style.transformOrigin="0% 0%",We&&((et=We.getMinimumHeightForAnnotationPane())?Re.style.minHeight=et:Re.style.removeProperty("min-height")),U.style.width=Math.round(ct*Re.offsetWidth)+"px",U.style.height=Math.round(ct*Re.offsetHeight)+"px",U.style.display="inline-block")}function he(et,ct){var It=be.sheet;K.removeAllChildNodes(U),Re=le.createElementNS(U.namespaceURI,"div"),Re.style.display="inline-block",Re.style.background="white",Re.style.setProperty("float","left","important"),Re.appendChild(ct),U.appendChild(Re),we=le.createElementNS(U.namespaceURI,"div"),we.id="annotationsPane",Fe=le.createElementNS(U.namespaceURI,"div"),Fe.id="shadowContent",Fe.style.position="absolute",Fe.style.top=0,Fe.style.left=0,et.getContentElement().appendChild(Fe);var at=ct.body,vt,Ke=[],Je;for(vt=at.firstElementChild;vt&&vt!==at;)if(vt.namespaceURI===Z&&(Ke[Ke.length]=vt),vt.firstElementChild)vt=vt.firstElementChild;else{for(;vt&&vt!==at&&!vt.nextElementSibling;)vt=vt.parentNode;vt&&vt.nextElementSibling&&(vt=vt.nextElementSibling)}for(Je=0;Je<Ke.length;Je+=1)vt=Ke[Je],x("frame"+String(Je),vt,It);for(Ke=q.getODFElementsWithXPath(at,".//*[*[@text:anchor-type='paragraph']]",odf.Namespaces.lookupNamespaceURI),vt=0;vt<Ke.length;vt+=1)at=Ke[vt],at.setAttributeNS&&at.setAttributeNS("urn:webodf:names:helper","containsparagraphanchor",!0);at=De,vt=Fe;var ei,ki,ti,je,Xe=0,_t;if(Je=et.rootElement.ownerDocument,(Ke=ct.body.firstElementChild)&&Ke.namespaceURI===ee&&(Ke.localName==="presentation"||Ke.localName==="drawing"))for(Ke=Ke.firstElementChild;Ke;){if(ei=(ei=Ke.getAttributeNS(Z,"master-page-name"))?at.getMasterPageElement(ei):null){for(ki=Ke.getAttributeNS("urn:webodf:names:helper","styleid"),ti=Je.createElementNS(Z,"draw:page"),_t=ei.firstElementChild,Xe=0;_t;)_t.getAttributeNS(te,"placeholder")!=="true"&&(je=_t.cloneNode(!0),ti.appendChild(je)),_t=_t.nextElementSibling,Xe+=1;_t=je=Xe=void 0;for(var fe=K.getElementsByTagNameNS(ti,Z,"frame"),Xe=0;Xe<fe.length;Xe+=1)je=fe[Xe],(_t=je.getAttributeNS(te,"class"))&&!/^(date-time|footer|header|page-number)$/.test(_t)&&je.parentNode.removeChild(je);for(je=K.getElementsByTagNameNS(ti,Z,"*"),Xe=0;Xe<je.length;Xe+=1)x(ki+"_"+Xe,je[Xe],It);vt.appendChild(ti),Xe=String(vt.getElementsByTagNameNS(Z,"page").length),O(ti,$,"page-number",Xe),O(ti,te,"header",N(et,Ke,"header")),O(ti,te,"footer",N(et,Ke,"footer")),x(ki,ti,It),ti.setAttributeNS("urn:webodf:names:helper","page-style-name",Ke.getAttributeNS(Z,"style-name")),ti.setAttributeNS(Z,"draw:master-page-name",ei.getAttributeNS(z,"name"))}Ke=Ke.nextElementSibling}for(at=U.namespaceURI,Ke=K.getElementsByTagNameNS(ct.body,Y,"table-cell"),vt=0;vt<Ke.length;vt+=1)Je=Ke[vt],Je.hasAttributeNS(Y,"number-columns-spanned")&&Je.setAttributeNS(at,"colspan",Je.getAttributeNS(Y,"number-columns-spanned")),Je.hasAttributeNS(Y,"number-rows-spanned")&&Je.setAttributeNS(at,"rowspan",Je.getAttributeNS(Y,"number-rows-spanned"));S(ct.body),u(ct.body),y(ct.body),re(et,ct.body,It),W(et,ct.body),Re.insertBefore(Fe,Re.firstChild),Rt.setZoomableElement(Re)}function ve(et){ke?(we.parentNode||Re.appendChild(we),We&&We.forgetAnnotations(),We=new gui.AnnotationViewManager(rt,et.body,we,Ve),et=K.getElementsByTagNameNS(et.body,ee,"annotation"),We.addAnnotations(et),ie()):we.parentNode&&(Re.removeChild(we),We.forgetAnnotations(),ie())}function Ne(et){function ct(){M(ue),M(Se),M(be),K.removeAllChildNodes(U),U.style.display="inline-block";var It=me.rootElement;U.ownerDocument.importNode(It,!0),De.setOdfContainer(me),E(me,ue),w(me,De,Se),he(me,It),ve(It),et||$t.addToQueue(function(){var at=[me];if(ut.hasOwnProperty("statereadychange")){var vt=ut.statereadychange,Ke;for(Ke=0;Ke<vt.length;Ke+=1)vt[Ke].apply(null,at)}})}me.state===odf.OdfContainer.DONE?ct():(runtime.log("WARNING: refreshOdf called but ODF was not DONE."),Pt=runtime.setTimeout(function It(){me.state===odf.OdfContainer.DONE?ct():(runtime.log("will be back later..."),Pt=runtime.setTimeout(It,500))},100))}function ze(et){$t.clearQueue(),K.removeAllChildNodes(U),U.appendChild(U.ownerDocument.createTextNode(runtime.tr("Loading")+et+"...")),U.removeAttribute("style"),me=new odf.OdfContainer(et,function(ct){me=ct,Ne(!1)})}runtime.assert(U!=null,"odf.OdfCanvas constructor needs DOM element"),runtime.assert(U.ownerDocument!==null&&U.ownerDocument!==void 0,"odf.OdfCanvas constructor needs DOM");var rt=this,le=U.ownerDocument,me,De=new odf.Formatting,Me,Re=null,we=null,ke=!1,Ve=!1,We=null,$e,ue,Se,be,Fe,ut={},Pt,yt,At=!1,ri=!1,$t=new A,Rt=new gui.ZoomHelper,zt=F||new gui.SingleScrollViewport(U.parentNode);this.refreshCSS=function(){At=!0,yt.trigger()},this.refreshSize=function(){yt.trigger()},this.odfContainer=function(){return me},this.setOdfContainer=function(et,ct){me=et,Ne(ct===!0)},this.load=this.load=ze,this.save=function(et){me.save(et)},this.addListener=function(et,ct){switch(et){case"click":var It=et;U.addEventListener?U.addEventListener(It,ct,!1):U.attachEvent?U.attachEvent("on"+It,ct):U["on"+It]=ct;break;default:It=ut.hasOwnProperty(et)?ut[et]:ut[et]=[],ct&&It.indexOf(ct)===-1&&It.push(ct)}},this.getFormatting=function(){return De},this.getAnnotationViewManager=function(){return We},this.refreshAnnotations=function(){ve(me.rootElement)},this.rerenderAnnotations=function(){We&&(ri=!0,yt.trigger())},this.getSizer=function(){return Re},this.enableAnnotations=function(et,ct){et!==ke&&(ke=et,Ve=ct,me&&ve(me.rootElement))},this.addAnnotation=function(et){We&&(We.addAnnotations([et]),ie())},this.forgetAnnotation=function(et){We&&(We.forgetAnnotation(et),ie())},this.getZoomHelper=function(){return Rt},this.setZoomLevel=function(et){Rt.setZoomLevel(et)},this.getZoomLevel=function(){return Rt.getZoomLevel()},this.fitToContainingElement=function(et,ct){var at=Rt.getZoomLevel(),It=U.offsetHeight/at,at=et/(U.offsetWidth/at);ct/It<at&&(at=ct/It),Rt.setZoomLevel(at)},this.fitToWidth=function(et){var ct=U.offsetWidth/Rt.getZoomLevel();Rt.setZoomLevel(et/ct)},this.fitSmart=function(et,ct){var It,at;at=Rt.getZoomLevel(),It=U.offsetWidth/at,at=U.offsetHeight/at,It=et/It,ct!==void 0&&ct/at<It&&(It=ct/at),Rt.setZoomLevel(Math.min(1,It))},this.fitToHeight=function(et){var ct=U.offsetHeight/Rt.getZoomLevel();Rt.setZoomLevel(et/ct)},this.showFirstPage=function(){Me.showFirstPage()},this.showNextPage=function(){Me.showNextPage()},this.showPreviousPage=function(){Me.showPreviousPage()},this.showPage=function(et){Me.showPage(et),ie()},this.getElement=function(){return U},this.getViewport=function(){return zt},this.addCssForFrameWithImage=function(et){var ct=et.getAttributeNS(Z,"name"),It=et.firstElementChild;x(ct,et,be.sheet),It&&_(ct+"img",me,It,be.sheet)},this.destroy=function(et){var ct=le.getElementsByTagName("head")[0],It=[Me.destroy,yt.destroy];runtime.clearTimeout(Pt),we&&we.parentNode&&we.parentNode.removeChild(we),Rt.destroy(function(){Re&&(U.removeChild(Re),Re=null)}),R($e),ct.removeChild(ue),ct.removeChild(Se),ct.removeChild(be),core.Async.destroyAll(It,et)},$e=m(le),Me=new j(V(le)),ue=V(le),Se=V(le),be=V(le),yt=core.Task.createRedrawTask(function(){At&&(w(me,De,Se),At=!1),ri&&(We&&We.rerenderAnnotations(),ri=!1),ie()}),Rt.subscribe(gui.ZoomHelper.signalZoomChanged,ie)}}(),odf.StepUtils=function(){this.getContentBounds=function(A){var j=A.container(),M,w;return runtime.assert(A.isStep(),"Step iterator must be on a step"),j.nodeType===Node.TEXT_NODE&&0<A.offset()?M=A.offset():(j=A.leftNode())&&j.nodeType===Node.TEXT_NODE&&(M=j.length),j&&(j.nodeType===Node.TEXT_NODE?(runtime.assert(0<M,"Empty text node found"),w={container:j,startOffset:M-1,endOffset:M}):w={container:j,startOffset:0,endOffset:j.childNodes.length}),w}},ops.MemberProperties=function(){},ops.Member=function(A,j){var M=new ops.MemberProperties;this.getMemberId=function(){return A},this.getProperties=function(){return M},this.setProperties=function(w){Object.keys(w).forEach(function(E){M[E]=w[E]})},this.removeProperties=function(w){Object.keys(w).forEach(function(E){E!=="fullName"&&E!=="color"&&E!=="imageUrl"&&M.hasOwnProperty(E)&&delete M[E]})},runtime.assert(!!A,"No memberId was supplied!"),j.fullName||(j.fullName=runtime.tr("Unknown Author")),j.color||(j.color="black"),j.imageUrl||(j.imageUrl="avatar-joe.png"),M=j},ops.Document=function(){},ops.Document.prototype.getMemberIds=function(){},ops.Document.prototype.removeCursor=function(A){},ops.Document.prototype.getDocumentElement=function(){},ops.Document.prototype.getRootNode=function(){},ops.Document.prototype.getDOMDocument=function(){},ops.Document.prototype.cloneDocumentElement=function(){},ops.Document.prototype.setDocumentElement=function(A){},ops.Document.prototype.subscribe=function(A,j){},ops.Document.prototype.unsubscribe=function(A,j){},ops.Document.prototype.getCanvas=function(){},ops.Document.prototype.createRootFilter=function(A){},ops.Document.prototype.createPositionIterator=function(A){},ops.Document.prototype.hasCursor=function(A){},ops.Document.signalCursorAdded="cursor/added",ops.Document.signalCursorRemoved="cursor/removed",ops.Document.signalCursorMoved="cursor/moved",ops.Document.signalMemberAdded="member/added",ops.Document.signalMemberUpdated="member/updated",ops.Document.signalMemberRemoved="member/removed",ops.OdtCursor=function(A,j){var M=this,w={},E,N,O=new core.EventNotifier([ops.OdtCursor.signalCursorUpdated]);this.removeFromDocument=function(){N.remove()},this.subscribe=function(x,I){O.subscribe(x,I)},this.unsubscribe=function(x,I){O.unsubscribe(x,I)},this.getMemberId=function(){return A},this.getNode=function(){return N.getNode()},this.getAnchorNode=function(){return N.getAnchorNode()},this.getSelectedRange=function(){return N.getSelectedRange()},this.setSelectedRange=function(x,I){N.setSelectedRange(x,I),O.emit(ops.OdtCursor.signalCursorUpdated,M)},this.hasForwardSelection=function(){return N.hasForwardSelection()},this.getDocument=function(){return j},this.getSelectionType=function(){return E},this.setSelectionType=function(x){w.hasOwnProperty(x)?E=x:runtime.log("Invalid selection type: "+x)},this.resetSelectionType=function(){M.setSelectionType(ops.OdtCursor.RangeSelection)},N=new core.Cursor(j.getDOMDocument(),A),w[ops.OdtCursor.RangeSelection]=!0,w[ops.OdtCursor.RegionSelection]=!0,M.resetSelectionType()},ops.OdtCursor.RangeSelection="Range",ops.OdtCursor.RegionSelection="Region",ops.OdtCursor.signalCursorUpdated="cursorUpdated",function(){var A=0;ops.StepsCache=function(j,M,w){function E(z,P){var Y=this;this.nodeId=z,this.steps=-1,this.node=P,this.previousBookmark=this.nextBookmark=null,this.setIteratorPosition=function($){$.setPositionBeforeElement(P),w(Y.steps,$)}}function N(z,P,Y){var $=this;this.nodeId=z,this.steps=P,this.node=Y,this.previousBookmark=this.nextBookmark=null,this.setIteratorPosition=function(J){J.setUnfilteredPosition(Y,0),w($.steps,J)}}function O(z,P){var Y="["+z.nodeId;return P&&(Y+=" => "+P.nodeId),Y+"]"}function x(){if(ops.StepsCache.ENABLE_CACHE_VERIFICATION===!0){for(var z=V,P,Y,$,J=new core.LoopWatchDog(0,1e5),te={};z;)J.check(),(P=z.previousBookmark)?runtime.assert(P.nextBookmark===z,"Broken bookmark link to previous @"+O(P,z)):(runtime.assert(z===V,"Broken bookmark link @"+O(z)),runtime.assert(Z===void 0||V===V||V.steps<=Z,"Base point is damaged @"+O(z))),(Y=z.nextBookmark)&&runtime.assert(Y.previousBookmark===z,"Broken bookmark link to next @"+O(z,Y)),(Z===void 0||z===V||z.steps<=Z)&&(runtime.assert(R.containsNode(j,z.node),"Disconnected node is being reported as undamaged @"+O(z)),P&&($=z.node.compareDocumentPosition(P.node),runtime.assert($===0||($&ee)!==0,"Bookmark order with previous does not reflect DOM order @"+O(P,z))),Y&&R.containsNode(j,Y.node)&&($=z.node.compareDocumentPosition(Y.node),runtime.assert($===0||($&ne)!==0,"Bookmark order with next does not reflect DOM order @"+O(z,Y)))),z=z.nextBookmark;Object.keys(v).forEach(function(q){var K=v[q];(Z===void 0||q<=Z)&&runtime.assert(K.steps<=q,"Bookmark step of "+K.steps+" exceeds cached step lookup for "+q+" @"+O(K)),runtime.assert(te.hasOwnProperty(K.nodeId)===!1,"Bookmark "+O(K)+" appears twice in cached step lookup at steps "+te[K.nodeId]+" and "+q),te[K.nodeId]=q})}}function I(z){var P="";return z.nodeType===Node.ELEMENT_NODE&&(P=z.getAttributeNS("urn:webodf:names:steps","nodeId")||""),P}function _(z){var P=A.toString();return z.setAttributeNS("urn:webodf:names:steps","nodeId",P),A+=1,P}function S(z){var P,Y,$=new core.LoopWatchDog(0,1e4);for(Z!==void 0&&z>Z&&(z=Z),P=Math.floor(z/M)*M;!Y&&0<=P;)Y=v[P],P-=M;for(Y=Y||V;Y.nextBookmark&&Y.nextBookmark.steps<=z;)$.check(),Y=Y.nextBookmark;return runtime.assert(z===-1||Y.steps<=z,"Bookmark @"+O(Y)+" at step "+Y.steps+" exceeds requested step of "+z),Y}function u(z){z.previousBookmark&&(z.previousBookmark.nextBookmark=z.nextBookmark),z.nextBookmark&&(z.nextBookmark.previousBookmark=z.previousBookmark)}function y(z){for(var P,Y=null;!Y&&z&&z!==j;)(P=I(z))&&(Y=m[P])&&Y.node!==z&&(runtime.log("Cloned node detected. Creating new bookmark"),Y=null,z.removeAttributeNS("urn:webodf:names:steps","nodeId")),z=z.parentNode;return Y}var v={},m={},R=core.DomUtils,V,Z,ne=Node.DOCUMENT_POSITION_FOLLOWING,ee=Node.DOCUMENT_POSITION_PRECEDING;this.updateBookmark=function(z,P){var Y,$=Math.ceil(z/M)*M,J,te,q;if(Z!==void 0&&Z<z){for(J=S(Z),te=J.nextBookmark;te&&te.steps<=z;)Y=te.nextBookmark,q=Math.ceil(te.steps/M)*M,v[q]===te&&delete v[q],R.containsNode(j,te.node)?te.steps=z+1:(u(te),delete m[te.nodeId]),te=Y;Z=z}else J=S(z);if(te=I(P)||_(P),Y=m[te],Y?Y.node!==P&&(runtime.log("Cloned node detected. Creating new bookmark"),te=_(P),Y=m[te]=new E(te,P)):Y=m[te]=new E(te,P),te=Y,te.steps!==z&&(Y=Math.ceil(te.steps/M)*M,Y!==$&&v[Y]===te&&delete v[Y],te.steps=z),J!==te&&J.nextBookmark!==te){if(J.steps===te.steps)for(;te.node.compareDocumentPosition(J.node)&ne&&J!==V;)J=J.previousBookmark;J!==te&&J.nextBookmark!==te&&(u(te),Y=J.nextBookmark,te.nextBookmark=J.nextBookmark,te.previousBookmark=J,J.nextBookmark=te,Y&&(Y.previousBookmark=te))}J=v[$],(!J||te.steps>J.steps)&&(v[$]=te),x()},this.setToClosestStep=function(z,P){var Y;return x(),Y=S(z),Y.setIteratorPosition(P),Y.steps},this.setToClosestDomPoint=function(z,P,Y){var $,J;if(x(),z===j&&P===0)$=V;else if(z===j&&P===j.childNodes.length)for(J in $=V,v)v.hasOwnProperty(J)&&(z=v[J],z.steps>$.steps&&($=z));else if($=y(z.childNodes.item(P)||z),!$)for(Y.setUnfilteredPosition(z,P);!$&&Y.previousNode();)$=y(Y.getCurrentNode());return $=$||V,Z!==void 0&&$.steps>Z&&($=S(Z)),$.setIteratorPosition(Y),$.steps},this.damageCacheAfterStep=function(z){0>z&&(z=-1),(Z===void 0||z<Z)&&(Z=z),x()},function(){var z=I(j)||_(j);V=new N(z,0,j)}()},ops.StepsCache.ENABLE_CACHE_VERIFICATION=!1,ops.StepsCache.Bookmark=function(){},ops.StepsCache.Bookmark.prototype.setIteratorPosition=function(j){}}(),function(){ops.OdtStepsTranslator=function(A,j,M,w){function E(y,v,m){var R=v.getCurrentNode();v.isBeforeNode()&&x.isParagraph(R)&&(m||(y+=1),O.updateBookmark(y,R))}function N(y,v){if(!v||M.acceptPosition(y)===_)return!0;for(;y.previousPosition();)if(M.acceptPosition(y)===_){if(v(S,y.container(),y.unfilteredDomOffset()))return!0;break}for(;y.nextPosition();)if(M.acceptPosition(y)===_){if(v(u,y.container(),y.unfilteredDomOffset()))return!0;break}return!1}var O,x=odf.OdfUtils,I=core.DomUtils,_=core.PositionFilter.FilterResult.FILTER_ACCEPT,S=core.StepDirection.PREVIOUS,u=core.StepDirection.NEXT;this.convertStepsToDomPoint=function(y){var v,m;if(isNaN(y))throw new TypeError("Requested steps is not numeric ("+y+")");if(0>y)throw new RangeError("Requested steps is negative ("+y+")");for(v=O.setToClosestStep(y,j);v<y&&j.nextPosition();)(m=M.acceptPosition(j)===_)&&(v+=1),E(v,j,m);if(v!==y)throw new RangeError("Requested steps ("+y+") exceeds available steps ("+v+")");return{node:j.container(),offset:j.unfilteredDomOffset()}},this.convertDomPointToSteps=function(y,v,m){var R;if(I.containsNode(A,y)||(v=0>I.comparePoints(A,0,y,v),y=A,v=v?0:A.childNodes.length),j.setUnfilteredPosition(y,v),N(j,m)||j.setUnfilteredPosition(y,v),m=j.container(),v=j.unfilteredDomOffset(),y=O.setToClosestDomPoint(m,v,j),0>I.comparePoints(j.container(),j.unfilteredDomOffset(),m,v))return 0<y?y-1:y;for(;(j.container()!==m||j.unfilteredDomOffset()!==v)&&j.nextPosition();)(R=M.acceptPosition(j)===_)&&(y+=1),E(y,j,R);return y+0},this.prime=function(){var y,v;for(y=O.setToClosestStep(0,j);j.nextPosition();)(v=M.acceptPosition(j)===_)&&(y+=1),E(y,j,v)},this.handleStepsInserted=function(y){O.damageCacheAfterStep(y.position)},this.handleStepsRemoved=function(y){O.damageCacheAfterStep(y.position-1)},O=new ops.StepsCache(A,w,function(y,v){do{if(M.acceptPosition(v)===_){E(y,v,!0);break}E(y-1,v,!1)}while(v.nextPosition())})}}(),ops.Operation=function(){},ops.Operation.prototype.init=function(A){},ops.Operation.prototype.execute=function(A){},ops.Operation.prototype.spec=function(){},ops.TextPositionFilter=function(){function A(x,I){for(;x&&I(x)!==N;)x=x.previousSibling;return x}function j(x,I,_,S){var u;if(I){if(M.isInlineRoot(I)&&M.isGroupingElement(_))return O;if(S=M.lookLeftForCharacter(I),S===1||S===2&&(M.scanRightForAnyCharacter(_)||M.scanRightForAnyCharacter(M.nextNode(x))))return N}else if(M.isGroupingElement(x)&&M.isInlineRoot(A(x.previousSibling,S)))return N;return S=I===null&&M.isParagraph(x),u=M.lookRightForCharacter(_),S?u?N:M.scanRightForAnyCharacter(_)?O:N:u?(I=I||M.previousNode(x),M.scanLeftForAnyCharacter(I)?O:N):O}var M=odf.OdfUtils,w=Node.ELEMENT_NODE,E=Node.TEXT_NODE,N=core.PositionFilter.FilterResult.FILTER_ACCEPT,O=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(x){var I=x.container(),_=I.nodeType,S,u,y;if(_!==w&&_!==E)return O;if(_===E){if(_=x.unfilteredDomOffset(),S=I.data,runtime.assert(_!==S.length,"Unexpected offset."),0<_){if(x=S[_-1],!M.isODFWhitespace(x))return N;if(1<_){if(x=S[_-2],!M.isODFWhitespace(x))y=N;else if(!M.isODFWhitespace(S.substr(0,_)))return O}else u=M.previousNode(I),M.scanLeftForNonSpace(u)&&(y=N);return y===N?M.isTrailingWhitespace(I,_)?O:N:(x=S[_],M.isODFWhitespace(x)||M.scanLeftForAnyCharacter(M.previousNode(I))?O:N)}u=x.leftNode(),y=I,I=I.parentNode,y=j(I,u,y,x.getNodeFilter())}else M.isGroupingElement(I)?(u=x.leftNode(),y=x.rightNode(),y=j(I,u,y,x.getNodeFilter())):y=O;return y}};function RootFilter(A,j,M){var w=core.PositionFilter.FilterResult.FILTER_ACCEPT,E=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(N){N=N.container();var O;return O=typeof A=="string"?j[A].getNode():A,M(N)===M(O)?w:E}}ops.OdtDocument=function(A){function j(q){return new core.PositionIterator(q,Y,te,!1)}function M(){var q=A.odfContainer().getContentElement(),K=q&&q.localName;return runtime.assert(K==="text","Unsupported content element type '"+K+"' for OdtDocument"),q}function w(){return u.getDocumentElement().ownerDocument}function E(q){for(;q&&!(q.namespaceURI===odf.Namespaces.officens&&q.localName==="text"||q.namespaceURI===odf.Namespaces.officens&&q.localName==="annotation");)q=q.parentNode;return q}function N(q,K,U,F){F=j(F);var re;return U.length===1?re=U[0]:(re=new core.PositionFilterChain,U.forEach(re.addFilter)),U=new core.StepIterator(re,F),U.setPosition(q,K),U}function O(q){var K=j(M());return q=z.convertStepsToDomPoint(q),K.setUnfilteredPosition(q.node,q.offset),K}function x(q){return q===ne}function I(q){var F=q.spec(),K=F.memberid,U=new Date(F.timestamp).toISOString(),F=A.odfContainer();q.isEdit&&(K=u.getMember(K).getProperties().fullName,F.setMetadata({"dc:creator":K,"dc:date":U},null),K={setProperties:{"dc:creator":K,"dc:date":U},removedProperties:[]},P||(K.setProperties["meta:editing-cycles"]=F.incrementEditingCycles(),F.setMetadata(null,["meta:editing-duration","meta:document-statistic"])),P=q,u.emit(ops.OdtDocument.signalMetadataUpdated,K))}function _(q){var K,U=[],F,re=2;runtime.assert(q.isStep(),"positionIterator is not at a step");do{if((K=y.getContentBounds(q))&&(K=K.container,v.isDowngradableSpaceElement(K))){for(F=K.lastChild;K.firstChild;)U.push(K.firstChild),K.parentNode.insertBefore(K.firstChild,K);K.parentNode.removeChild(K),q.setPosition(F,F.nodeType===Node.TEXT_NODE?F.length:F.childNodes.length),q.roundToPreviousStep()}--re}while(0<re&&q.nextStep());U.forEach(m.normalizeTextNodes)}function S(q,K,U){return q=q.childNodes.item(K)||q,(q=v.getParagraphElement(q))&&m.containsNode(U,q)?q:U}var u=this,y,v=odf.OdfUtils,m=core.DomUtils,R={},V={},Z=new core.EventNotifier([ops.Document.signalMemberAdded,ops.Document.signalMemberUpdated,ops.Document.signalMemberRemoved,ops.Document.signalCursorAdded,ops.Document.signalCursorRemoved,ops.Document.signalCursorMoved,ops.OdtDocument.signalParagraphChanged,ops.OdtDocument.signalParagraphStyleModified,ops.OdtDocument.signalCommonStyleCreated,ops.OdtDocument.signalCommonStyleDeleted,ops.OdtDocument.signalTableAdded,ops.OdtDocument.signalOperationStart,ops.OdtDocument.signalOperationEnd,ops.OdtDocument.signalProcessingBatchStart,ops.OdtDocument.signalProcessingBatchEnd,ops.OdtDocument.signalUndoStackChanged,ops.OdtDocument.signalStepsInserted,ops.OdtDocument.signalStepsRemoved,ops.OdtDocument.signalMetadataUpdated,ops.OdtDocument.signalAnnotationAdded]),ne=core.StepDirection.NEXT,ee,z,P,Y=NodeFilter.SHOW_ALL,$=new gui.BlacklistNamespaceNodeFilter(["urn:webodf:names:cursor","urn:webodf:names:editinfo"]),J=new gui.OdfTextBodyNodeFilter,te=new core.NodeFilterChain([$,J]);this.createPositionIterator=j,this.getDocumentElement=function(){return A.odfContainer().rootElement},this.cloneDocumentElement=function(){var q=u.getDocumentElement(),K=A.getAnnotationViewManager();return K&&K.forgetAnnotations(),q=q.cloneNode(!0),A.refreshAnnotations(),u.fixCursorPositions(),q},this.setDocumentElement=function(q){var K=A.odfContainer();Z.unsubscribe(ops.OdtDocument.signalStepsInserted,z.handleStepsInserted),Z.unsubscribe(ops.OdtDocument.signalStepsRemoved,z.handleStepsRemoved),K.setRootElement(q),A.setOdfContainer(K,!0),A.refreshCSS(),q=M(),z=new ops.OdtStepsTranslator(q,j(q),ee,500),Z.subscribe(ops.OdtDocument.signalStepsInserted,z.handleStepsInserted),Z.subscribe(ops.OdtDocument.signalStepsRemoved,z.handleStepsRemoved)},this.getDOMDocument=w,this.getRootElement=E,this.createStepIterator=N,this.getIteratorAtPosition=O,this.convertCursorStepToDomPoint=function(q){return z.convertStepsToDomPoint(q)},this.convertDomPointToCursorStep=function(q,K,U){var F;return U===ne&&(F=x),z.convertDomPointToSteps(q,K,F)},this.convertDomToCursorRange=function(q){var K;return K=z.convertDomPointToSteps(q.anchorNode,q.anchorOffset),q=q.anchorNode===q.focusNode&&q.anchorOffset===q.focusOffset?K:z.convertDomPointToSteps(q.focusNode,q.focusOffset),{position:K,length:q-K}},this.convertCursorToDomRange=function(q,K){var U=w().createRange(),F,re;return F=z.convertStepsToDomPoint(q),K?(re=z.convertStepsToDomPoint(q+K),0<K?(U.setStart(F.node,F.offset),U.setEnd(re.node,re.offset)):(U.setStart(re.node,re.offset),U.setEnd(F.node,F.offset))):U.setStart(F.node,F.offset),U},this.upgradeWhitespacesAtPosition=function(q){var K=O(q),K=new core.StepIterator(ee,K),U,F=2;runtime.assert(K.isStep(),"positionIterator is not at a step (requested step: "+q+")");do{if((U=y.getContentBounds(K))&&(q=U.container,U=U.startOffset,q.nodeType===Node.TEXT_NODE&&v.isSignificantWhitespace(q,U))){runtime.assert(q.data[U]===" ","upgradeWhitespaceToElement: textNode.data[offset] should be a literal space");var re=q.ownerDocument.createElementNS(odf.Namespaces.textns,"text:s"),W=q.parentNode,ie=q;re.appendChild(q.ownerDocument.createTextNode(" ")),q.length===1?W.replaceChild(re,q):(q.deleteData(U,1),0<U&&(U<q.length&&q.splitText(U),ie=q.nextSibling),W.insertBefore(re,ie)),q=re,K.setPosition(q,q.childNodes.length),K.roundToPreviousStep()}--F}while(0<F&&K.nextStep())},this.downgradeWhitespaces=_,this.downgradeWhitespacesAtPosition=function(q){q=O(q),q=new core.StepIterator(ee,q),_(q)},this.getTextNodeAtStep=function(q,K){var U=O(q),F=U.container(),re,W=0,ie=null;if(F.nodeType===Node.TEXT_NODE?(re=F,W=U.unfilteredDomOffset(),0<re.length&&(0<W&&(re=re.splitText(W)),re.parentNode.insertBefore(w().createTextNode(""),re),re=re.previousSibling,W=0)):(re=w().createTextNode(""),W=0,F.insertBefore(re,U.rightNode())),K){if(R[K]&&u.getCursorPosition(K)===q){for(ie=R[K].getNode();ie.nextSibling&&ie.nextSibling.localName==="cursor";)ie.parentNode.insertBefore(ie.nextSibling,ie);0<re.length&&re.nextSibling!==ie&&(re=w().createTextNode(""),W=0),ie.parentNode.insertBefore(re,ie)}}else for(;re.nextSibling&&re.nextSibling.localName==="cursor";)re.parentNode.insertBefore(re.nextSibling,re);for(;re.previousSibling&&re.previousSibling.nodeType===Node.TEXT_NODE;)U=re.previousSibling,U.appendData(re.data),W=U.length,re=U,re.parentNode.removeChild(re.nextSibling);for(;re.nextSibling&&re.nextSibling.nodeType===Node.TEXT_NODE;)U=re.nextSibling,re.appendData(U.data),re.parentNode.removeChild(U);return{textNode:re,offset:W}},this.fixCursorPositions=function(){Object.keys(R).forEach(function(q){var K=R[q],U=E(K.getNode()),F=u.createRootFilter(U),re,W,ie,he=!1;ie=K.getSelectedRange(),re=S(ie.startContainer,ie.startOffset,U),W=N(ie.startContainer,ie.startOffset,[ee,F],re),ie.collapsed?U=W:(re=S(ie.endContainer,ie.endOffset,U),U=N(ie.endContainer,ie.endOffset,[ee,F],re)),W.isStep()&&U.isStep()?W.container()!==U.container()||W.offset()!==U.offset()||ie.collapsed&&K.getAnchorNode()===K.getNode()||(he=!0,ie.setStart(W.container(),W.offset()),ie.collapse(!0)):(he=!0,runtime.assert(W.roundToClosestStep(),"No walkable step found for cursor owned by "+q),ie.setStart(W.container(),W.offset()),runtime.assert(U.roundToClosestStep(),"No walkable step found for cursor owned by "+q),ie.setEnd(U.container(),U.offset())),he&&(K.setSelectedRange(ie,K.hasForwardSelection()),u.emit(ops.Document.signalCursorMoved,K))})},this.getCursorPosition=function(q){return(q=R[q])?z.convertDomPointToSteps(q.getNode(),0):0},this.getCursorSelection=function(q){q=R[q];var K=0,U=0;return q&&(K=z.convertDomPointToSteps(q.getNode(),0),U=z.convertDomPointToSteps(q.getAnchorNode(),0)),{position:U,length:K-U}},this.getPositionFilter=function(){return ee},this.getOdfCanvas=function(){return A},this.getCanvas=function(){return A},this.getRootNode=M,this.addMember=function(q){runtime.assert(V[q.getMemberId()]===void 0,"This member already exists"),V[q.getMemberId()]=q},this.getMember=function(q){return V.hasOwnProperty(q)?V[q]:null},this.removeMember=function(q){delete V[q]},this.getCursor=function(q){return R[q]},this.hasCursor=function(q){return R.hasOwnProperty(q)},this.getMemberIds=function(){return Object.keys(V)},this.addCursor=function(q){runtime.assert(!!q,"OdtDocument::addCursor without cursor");var K=q.getMemberId(),U=u.convertCursorToDomRange(0,0);runtime.assert(typeof K=="string","OdtDocument::addCursor has cursor without memberid"),runtime.assert(!R[K],"OdtDocument::addCursor is adding a duplicate cursor with memberid "+K),q.setSelectedRange(U,!0),R[K]=q},this.removeCursor=function(q){var K=R[q];return K?(K.removeFromDocument(),delete R[q],u.emit(ops.Document.signalCursorRemoved,q),!0):!1},this.moveCursor=function(q,K,U,F){q=R[q],K=u.convertCursorToDomRange(K,U),q&&(q.setSelectedRange(K,0<=U),q.setSelectionType(F||ops.OdtCursor.RangeSelection))},this.getFormatting=function(){return A.getFormatting()},this.emit=function(q,K){Z.emit(q,K)},this.subscribe=function(q,K){Z.subscribe(q,K)},this.unsubscribe=function(q,K){Z.unsubscribe(q,K)},this.createRootFilter=function(q){return new RootFilter(q,R,E)},this.close=function(q){q()},this.destroy=function(q){q()},function(){var q=M();ee=new ops.TextPositionFilter,y=new odf.StepUtils,z=new ops.OdtStepsTranslator(q,j(q),ee,500),Z.subscribe(ops.OdtDocument.signalStepsInserted,z.handleStepsInserted),Z.subscribe(ops.OdtDocument.signalStepsRemoved,z.handleStepsRemoved),Z.subscribe(ops.OdtDocument.signalOperationEnd,I),Z.subscribe(ops.OdtDocument.signalProcessingBatchEnd,core.Task.processTasks)}()},ops.OdtDocument.signalParagraphChanged="paragraph/changed",ops.OdtDocument.signalTableAdded="table/added",ops.OdtDocument.signalCommonStyleCreated="style/created",ops.OdtDocument.signalCommonStyleDeleted="style/deleted",ops.OdtDocument.signalParagraphStyleModified="paragraphstyle/modified",ops.OdtDocument.signalOperationStart="operation/start",ops.OdtDocument.signalOperationEnd="operation/end",ops.OdtDocument.signalProcessingBatchStart="router/batchstart",ops.OdtDocument.signalProcessingBatchEnd="router/batchend",ops.OdtDocument.signalUndoStackChanged="undo/changed",ops.OdtDocument.signalStepsInserted="steps/inserted",ops.OdtDocument.signalStepsRemoved="steps/removed",ops.OdtDocument.signalMetadataUpdated="metadata/updated",ops.OdtDocument.signalAnnotationAdded="annotation/added",ops.OpAddAnnotation=function(){function A(x,I,_){var S=x.getTextNodeAtStep(_,j);S&&(x=S.textNode,_=x.parentNode,S.offset!==x.length&&x.splitText(S.offset),_.insertBefore(I,x.nextSibling),x.length===0&&_.removeChild(x))}var j,M,w,E,N,O;this.init=function(x){j=x.memberid,M=parseInt(x.timestamp,10),w=parseInt(x.position,10),E=x.length!==void 0?parseInt(x.length,10)||0:void 0,N=x.name},this.isEdit=!0,this.group=void 0,this.execute=function(x){var I=x.getCursor(j),_,S;O=x.getDOMDocument();var u=new Date(M),y,v,m;return y=O.createElementNS(odf.Namespaces.officens,"office:annotation"),y.setAttributeNS(odf.Namespaces.officens,"office:name",N),_=O.createElementNS(odf.Namespaces.dcns,"dc:creator"),_.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",j),_.textContent=x.getMember(j).getProperties().fullName,S=O.createElementNS(odf.Namespaces.dcns,"dc:date"),S.appendChild(O.createTextNode(u.toISOString())),u=O.createElementNS(odf.Namespaces.textns,"text:list"),v=O.createElementNS(odf.Namespaces.textns,"text:list-item"),m=O.createElementNS(odf.Namespaces.textns,"text:p"),v.appendChild(m),u.appendChild(v),y.appendChild(_),y.appendChild(S),y.appendChild(u),E!==void 0&&(_=O.createElementNS(odf.Namespaces.officens,"office:annotation-end"),_.setAttributeNS(odf.Namespaces.officens,"office:name",N),y.annotationEndElement=_,A(x,_,w+E)),A(x,y,w),x.emit(ops.OdtDocument.signalStepsInserted,{position:w}),I&&(_=O.createRange(),S=y.getElementsByTagNameNS(odf.Namespaces.textns,"p")[0],_.selectNodeContents(S),I.setSelectedRange(_,!1),I.setSelectionType(ops.OdtCursor.RangeSelection),x.emit(ops.Document.signalCursorMoved,I)),x.getOdfCanvas().addAnnotation(y),x.fixCursorPositions(),x.emit(ops.OdtDocument.signalAnnotationAdded,{memberId:j,annotation:y}),!0},this.spec=function(){return{optype:"AddAnnotation",memberid:j,timestamp:M,position:w,length:E,name:N}}},ops.OpAddCursor=function(){var A,j;this.init=function(M){A=M.memberid,j=M.timestamp},this.isEdit=!1,this.group=void 0,this.execute=function(M){var w=M.getCursor(A);return w?!1:(w=new ops.OdtCursor(A,M),M.addCursor(w),M.emit(ops.Document.signalCursorAdded,w),!0)},this.spec=function(){return{optype:"AddCursor",memberid:A,timestamp:j}}},ops.OpAddMember=function(){var A,j,M;this.init=function(w){A=w.memberid,j=parseInt(w.timestamp,10),M=w.setProperties},this.isEdit=!1,this.group=void 0,this.execute=function(w){var E;return w.getMember(A)?!1:(E=new ops.Member(A,M),w.addMember(E),w.emit(ops.Document.signalMemberAdded,E),!0)},this.spec=function(){return{optype:"AddMember",memberid:A,timestamp:j,setProperties:M}}},ops.OpAddStyle=function(){var A,j,M,w,E,N,O=odf.Namespaces.stylens;this.init=function(x){A=x.memberid,j=x.timestamp,M=x.styleName,w=x.styleFamily,E=x.isAutomaticStyle==="true"||x.isAutomaticStyle===!0,N=x.setProperties},this.isEdit=!0,this.group=void 0,this.execute=function(x){var I=x.getOdfCanvas().odfContainer(),_=x.getFormatting(),S=x.getDOMDocument().createElementNS(O,"style:style");return S?(N&&_.updateStyle(S,N),S.setAttributeNS(O,"style:family",w),S.setAttributeNS(O,"style:name",M),E?I.rootElement.automaticStyles.appendChild(S):I.rootElement.styles.appendChild(S),x.getOdfCanvas().refreshCSS(),E||x.emit(ops.OdtDocument.signalCommonStyleCreated,{name:M,family:w}),!0):!1},this.spec=function(){return{optype:"AddStyle",memberid:A,timestamp:j,styleName:M,styleFamily:w,isAutomaticStyle:E,setProperties:N}}},odf.ObjectNameGenerator=function(A,j){function M(v,m){var R={};this.generateName=function(){var V=m(),Z=0,ne;do ne=v+Z,Z+=1;while(R[ne]||V[ne]);return R[ne]=!0,ne}}function w(){var v={};return[A.rootElement.automaticStyles,A.rootElement.styles].forEach(function(m){for(m=m.firstElementChild;m;)m.namespaceURI===E&&m.localName==="style"&&(v[m.getAttributeNS(E,"name")]=!0),m=m.nextElementSibling}),v}var E=odf.Namespaces.stylens,N=odf.Namespaces.drawns,O=odf.Namespaces.xlinkns,x=new core.Utils().hashString(j),I=null,_=null,S=null,u={},y={};this.generateStyleName=function(){return I===null&&(I=new M("auto"+x+"_",function(){return w()})),I.generateName()},this.generateFrameName=function(){var v,m,R;if(_===null){for(m=A.rootElement.body.getElementsByTagNameNS(N,"frame"),v=0;v<m.length;v+=1)R=m.item(v),u[R.getAttributeNS(N,"name")]=!0;_=new M("fr"+x+"_",function(){return u})}return _.generateName()},this.generateImageName=function(){var v,m,R;if(S===null){for(R=A.rootElement.body.getElementsByTagNameNS(N,"image"),v=0;v<R.length;v+=1)m=R.item(v),m=m.getAttributeNS(O,"href"),m=m.substring(9,m.lastIndexOf(".")),y[m]=!0;S=new M("img"+x+"_",function(){return y})}return S.generateName()}},odf.TextStyleApplicator=function(A,j,M){function w(_){function S(y,v){return typeof y=="object"&&typeof v=="object"?Object.keys(y).every(function(m){return S(y[m],v[m])}):y===v}var u={};this.isStyleApplied=function(y){return y=j.getAppliedStylesForElement(y,u).styleProperties,S(_,y)}}function E(_){var S={};this.applyStyleToContainer=function(u){var y;y=u.getAttributeNS(x,"style-name");var v=u.ownerDocument;if(y=y||"",!S.hasOwnProperty(y)){var m=y,R;R=y?j.createDerivedStyleObject(y,"text",_):_,v=v.createElementNS(I,"style:style"),j.updateStyle(v,R),v.setAttributeNS(I,"style:name",A.generateStyleName()),v.setAttributeNS(I,"style:family","text"),v.setAttributeNS("urn:webodf:names:scope","scope","document-content"),M.appendChild(v),S[m]=v}y=S[y].getAttributeNS(I,"name"),u.setAttributeNS(x,"text:style-name",y)}}function N(_,S){var u=_.ownerDocument,y=_.parentNode,v,m,R,V=new core.LoopWatchDog(1e4);for(m=[],m.push(_),R=_.nextSibling;R&&O.rangeContainsNode(S,R);)V.check(),m.push(R),R=R.nextSibling;if(y.localName!=="span"||y.namespaceURI!==x?(v=u.createElementNS(x,"text:span"),y.insertBefore(v,_),u=!1):(_.previousSibling&&!O.rangeContainsNode(S,y.firstChild)?(v=y.cloneNode(!1),y.parentNode.insertBefore(v,y.nextSibling)):v=y,u=!0),m.forEach(function(Z){Z.parentNode!==v&&v.appendChild(Z)}),R&&u)for(m=v.cloneNode(!1),v.parentNode.insertBefore(m,v.nextSibling);R;)V.check(),u=R.nextSibling,m.appendChild(R),R=u;return v}var O=core.DomUtils,x=odf.Namespaces.textns,I=odf.Namespaces.stylens;this.applyStyle=function(_,S,u){var y={},v,m,R,V;runtime.assert(u&&u.hasOwnProperty("style:text-properties"),"applyStyle without any text properties"),y["style:text-properties"]=u["style:text-properties"],R=new E(y),V=new w(y),_.forEach(function(Z){v=V.isStyleApplied(Z),v===!1&&(m=N(Z,S),R.applyStyleToContainer(m))})}},ops.OpApplyDirectStyling=function(){function A(I,_,S){var u=I.getOdfCanvas().odfContainer(),y=x.splitBoundaries(_),v=O.getTextNodes(_,!1);new odf.TextStyleApplicator(new odf.ObjectNameGenerator(u,j),I.getFormatting(),u.rootElement.automaticStyles).applyStyle(v,_,S),y.forEach(x.normalizeTextNodes)}var j,M,w,E,N,O=odf.OdfUtils,x=core.DomUtils;this.init=function(I){j=I.memberid,M=I.timestamp,w=parseInt(I.position,10),E=parseInt(I.length,10),N=I.setProperties},this.isEdit=!0,this.group=void 0,this.execute=function(I){var _=I.convertCursorToDomRange(w,E),S=O.getParagraphElements(_);return A(I,_,N),_.detach(),I.getOdfCanvas().refreshCSS(),I.fixCursorPositions(),S.forEach(function(u){I.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:u,memberId:j,timeStamp:M})}),I.getOdfCanvas().rerenderAnnotations(),!0},this.spec=function(){return{optype:"ApplyDirectStyling",memberid:j,timestamp:M,position:w,length:E,setProperties:N}}},ops.OpApplyHyperlink=function(){function A(I){for(;I;){if(x.isHyperlink(I))return!0;I=I.parentNode}return!1}var j,M,w,E,N,O=core.DomUtils,x=odf.OdfUtils;this.init=function(I){j=I.memberid,M=I.timestamp,w=I.position,E=I.length,N=I.hyperlink},this.isEdit=!0,this.group=void 0,this.execute=function(I){var _=I.getDOMDocument(),S=I.convertCursorToDomRange(w,E),u=O.splitBoundaries(S),y=[],v=x.getTextNodes(S,!1);return v.length===0?!1:(v.forEach(function(m){var R=x.getParagraphElement(m);runtime.assert(A(m)===!1,"The given range should not contain any link.");var V=N,Z=_.createElementNS(odf.Namespaces.textns,"text:a");Z.setAttributeNS(odf.Namespaces.xlinkns,"xlink:type","simple"),Z.setAttributeNS(odf.Namespaces.xlinkns,"xlink:href",V),m.parentNode.insertBefore(Z,m),Z.appendChild(m),y.indexOf(R)===-1&&y.push(R)}),u.forEach(O.normalizeTextNodes),S.detach(),I.fixCursorPositions(),I.getOdfCanvas().refreshSize(),I.getOdfCanvas().rerenderAnnotations(),y.forEach(function(m){I.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:m,memberId:j,timeStamp:M})}),!0)},this.spec=function(){return{optype:"ApplyHyperlink",memberid:j,timestamp:M,position:w,length:E,hyperlink:N}}},ops.OpInsertImage=function(){var A,j,M,w,E,N,O,x,I=odf.Namespaces.drawns,_=odf.Namespaces.svgns,S=odf.Namespaces.textns,u=odf.Namespaces.xlinkns,y=odf.OdfUtils;this.init=function(v){A=v.memberid,j=v.timestamp,M=v.position,w=v.filename,E=v.frameWidth,N=v.frameHeight,O=v.frameStyleName,x=v.frameName},this.isEdit=!0,this.group=void 0,this.execute=function(v){var m=v.getOdfCanvas(),Z=v.getTextNodeAtStep(M,A),R,V;if(!Z)return!1;R=Z.textNode,V=y.getParagraphElement(R);var Z=Z.offset!==R.length?R.splitText(Z.offset):R.nextSibling,ee=v.getDOMDocument(),ne=ee.createElementNS(I,"draw:image"),ee=ee.createElementNS(I,"draw:frame");return ne.setAttributeNS(u,"xlink:href",w),ne.setAttributeNS(u,"xlink:type","simple"),ne.setAttributeNS(u,"xlink:show","embed"),ne.setAttributeNS(u,"xlink:actuate","onLoad"),ee.setAttributeNS(I,"draw:style-name",O),ee.setAttributeNS(I,"draw:name",x),ee.setAttributeNS(S,"text:anchor-type","as-char"),ee.setAttributeNS(_,"svg:width",E),ee.setAttributeNS(_,"svg:height",N),ee.appendChild(ne),R.parentNode.insertBefore(ee,Z),v.emit(ops.OdtDocument.signalStepsInserted,{position:M}),R.length===0&&R.parentNode.removeChild(R),m.addCssForFrameWithImage(ee),m.refreshCSS(),v.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:V,memberId:A,timeStamp:j}),m.rerenderAnnotations(),!0},this.spec=function(){return{optype:"InsertImage",memberid:A,timestamp:j,filename:w,position:M,frameWidth:E,frameHeight:N,frameStyleName:O,frameName:x}}},ops.OpInsertTable=function(){function A(u,y){var v;if(_.length===1)v=_[0];else if(_.length===3)switch(u){case 0:v=_[0];break;case w-1:v=_[2];break;default:v=_[1]}else v=_[u];if(v.length===1)return v[0];if(v.length===3)switch(y){case 0:return v[0];case E-1:return v[2];default:return v[1]}return v[y]}var j,M,w,E,N,O,x,I,_,S=odf.OdfUtils;this.init=function(u){j=u.memberid,M=u.timestamp,N=u.position,w=u.initialRows,E=u.initialColumns,O=u.tableName,x=u.tableStyleName,I=u.tableColumnStyleName,_=u.tableCellStyleMatrix},this.isEdit=!0,this.group=void 0,this.execute=function(u){var y=u.getTextNodeAtStep(N),v=u.getRootNode();if(y){var m=u.getDOMDocument(),R=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table"),V=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-column"),Z,ne,ee,z;for(x&&R.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",x),O&&R.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:name",O),V.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:number-columns-repeated",E),I&&V.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",I),R.appendChild(V),ee=0;ee<w;ee+=1){for(V=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-row"),z=0;z<E;z+=1)Z=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-cell"),(ne=A(ee,z))&&Z.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",ne),ne=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:p"),Z.appendChild(ne),V.appendChild(Z);R.appendChild(V)}return y=S.getParagraphElement(y.textNode),v.insertBefore(R,y.nextSibling),u.emit(ops.OdtDocument.signalStepsInserted,{position:N}),u.getOdfCanvas().refreshSize(),u.emit(ops.OdtDocument.signalTableAdded,{tableElement:R,memberId:j,timeStamp:M}),u.getOdfCanvas().rerenderAnnotations(),!0}return!1},this.spec=function(){return{optype:"InsertTable",memberid:j,timestamp:M,position:N,initialRows:w,initialColumns:E,tableName:O,tableStyleName:x,tableColumnStyleName:I,tableCellStyleMatrix:_}}},ops.OpInsertText=function(){function A(x){return x!=="	"&&O.isODFWhitespace(x)}var j,M,w,E,N,O=odf.OdfUtils;this.init=function(x){j=x.memberid,M=x.timestamp,w=x.position,N=x.text,E=x.moveCursor==="true"||x.moveCursor===!0},this.isEdit=!0,this.group=void 0,this.execute=function(x){var I,_,S,u=null,y=x.getDOMDocument(),v,m=0,R,V=x.getCursor(j),Z;if(x.upgradeWhitespacesAtPosition(w),I=x.getTextNodeAtStep(w)){for(_=I.textNode,u=_.nextSibling,S=_.parentNode,v=O.getParagraphElement(_),Z=0;Z<N.length;Z+=1){if(!(R=N[Z]==="	")){R=N;var ne=Z;R=A(R[ne])&&(ne===0||ne===R.length-1||A(R[ne-1]))}R&&(m===0?(I.offset!==_.length&&(u=_.splitText(I.offset)),0<Z&&_.appendData(N.substring(0,Z))):m<Z&&(m=N.substring(m,Z),S.insertBefore(y.createTextNode(m),u)),m=Z+1,N[Z]==="	"?(R=y.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:tab"),R.appendChild(y.createTextNode("	"))):(N[Z]!==" "&&runtime.log("WARN: InsertText operation contains non-tab, non-space whitespace character (character code "+N.charCodeAt(Z)+")"),R=y.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:s"),R.appendChild(y.createTextNode(" "))),S.insertBefore(R,u))}return m===0?_.insertData(I.offset,N):m<N.length&&(I=N.substring(m),S.insertBefore(y.createTextNode(I),u)),S=_.parentNode,u=_.nextSibling,S.removeChild(_),S.insertBefore(_,u),_.length===0&&_.parentNode.removeChild(_),x.emit(ops.OdtDocument.signalStepsInserted,{position:w}),V&&E&&(x.moveCursor(j,w+N.length,0),x.emit(ops.Document.signalCursorMoved,V)),x.downgradeWhitespacesAtPosition(w),x.downgradeWhitespacesAtPosition(w+N.length),x.getOdfCanvas().refreshSize(),x.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:v,memberId:j,timeStamp:M}),x.getOdfCanvas().rerenderAnnotations(),!0}return!1},this.spec=function(){return{optype:"InsertText",memberid:j,timestamp:M,position:w,text:N,moveCursor:E}}},odf.CollapsingRules=function(A){function j(N){return w.isODFNode(N)||N.localName==="br"&&w.isLineBreak(N.parentNode)||N.nodeType===Node.TEXT_NODE&&w.isODFNode(N.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}function M(N){var O;return N.nodeType===Node.TEXT_NODE?(O=N.parentNode,O.removeChild(N)):O=E.removeUnwantedNodes(N,j),(N=O)&&(N=O,N=!w.isParagraph(N)&&N!==A&&w.hasNoODFContent(N)),N?M(O):O}var w=odf.OdfUtils,E=core.DomUtils;this.mergeChildrenIntoParent=M},ops.OpMergeParagraph=function(){function A(v){return odf.OdfUtils.isInlineRoot(v)?NodeFilter.FILTER_SKIP:S.isGroupingElement(v)&&S.hasNoODFContent(v)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}function j(v){if(v.nodeType===Node.TEXT_NODE){if(v.length===0)return runtime.log("WARN: Empty text node found during merge operation"),!0;if(S.isODFWhitespace(v.data)&&S.isSignificantWhitespace(v,0)===!1)return!0;v="#text"}else v=(v.prefix?v.prefix+":":"")+v.localName;return runtime.log("WARN: Unexpected text element found near paragraph boundary ["+v+"]"),!1}function M(v){v.collapsed||(u.splitBoundaries(v),v=S.getTextElements(v,!1,!0).filter(j),v.forEach(function(m){m.parentNode.removeChild(m)}))}function w(v,m,R){v=v.convertCursorStepToDomPoint(m);var V=S.getParagraphElement(v.node,v.offset);return runtime.assert(!!V,"Paragraph not found at step "+m),R&&R.setPosition(v.node,v.offset),V}var E,N,O,x,I,_,S=odf.OdfUtils,u=core.DomUtils,y=odf.Namespaces.textns;this.init=function(v){E=v.memberid,N=v.timestamp,O=v.moveCursor,x=v.paragraphStyleName,I=parseInt(v.sourceStartPosition,10),_=parseInt(v.destinationStartPosition,10)},this.isEdit=!0,this.group=void 0,this.execute=function(v){var m,R,V=v.getCursor(E);m=v.getRootNode();var Z=new odf.CollapsingRules(m),ne=v.createStepIterator(m,0,[v.getPositionFilter()],m),ee;runtime.assert(_<I,"Destination paragraph ("+_+") must be before source paragraph ("+I+")"),R=w(v,_),m=w(v,I,ne),ne.previousStep(),runtime.assert(u.containsNode(R,ne.container()),"Destination paragraph must be adjacent to the source paragraph"),ee=R.ownerDocument.createRange(),ne.setPosition(R,R.childNodes.length),ne.roundToPreviousStep(),ee.setStart(ne.container(),ne.offset()),ee.setEnd(R,R.childNodes.length),M(ee),ee=R.childNodes.length;var z=m.ownerDocument.createRange();for(ne.setPosition(m,0),ne.roundToNextStep(),z.setStart(m,0),z.setEnd(ne.container(),ne.offset()),M(z),z=m.firstChild;z;)z.localName==="editinfo"?m.removeChild(z):(R.appendChild(z),u.removeUnwantedNodes(z,A)),z=m.firstChild;return runtime.assert(m.childNodes.length===0,"Source paragraph should be empty before it is removed"),Z.mergeChildrenIntoParent(m),v.emit(ops.OdtDocument.signalStepsRemoved,{position:I-1}),ne.setPosition(R,ee),ne.roundToClosestStep(),ne.previousStep()||ne.roundToNextStep(),v.downgradeWhitespaces(ne),x?R.setAttributeNS(y,"text:style-name",x):R.removeAttributeNS(y,"style-name"),V&&O&&(v.moveCursor(E,I-1,0),v.emit(ops.Document.signalCursorMoved,V)),v.fixCursorPositions(),v.getOdfCanvas().refreshSize(),v.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:R,memberId:E,timeStamp:N}),v.getOdfCanvas().rerenderAnnotations(),!0},this.spec=function(){return{optype:"MergeParagraph",memberid:E,timestamp:N,moveCursor:O,paragraphStyleName:x,sourceStartPosition:I,destinationStartPosition:_}}},ops.OpMoveCursor=function(){var A,j,M,w,E;this.init=function(N){A=N.memberid,j=N.timestamp,M=N.position,w=N.length||0,E=N.selectionType||ops.OdtCursor.RangeSelection},this.isEdit=!1,this.group=void 0,this.execute=function(N){var O=N.getCursor(A),x;return O?(x=N.convertCursorToDomRange(M,w),O.setSelectedRange(x,0<=w),O.setSelectionType(E),N.emit(ops.Document.signalCursorMoved,O),!0):!1},this.spec=function(){return{optype:"MoveCursor",memberid:A,timestamp:j,position:M,length:w,selectionType:E}}},ops.OpRemoveAnnotation=function(){var A,j,M,w,E=core.DomUtils;this.init=function(N){A=N.memberid,j=N.timestamp,M=parseInt(N.position,10),w=parseInt(N.length,10)},this.isEdit=!0,this.group=void 0,this.execute=function(N){function O(_){I.parentNode.insertBefore(_,I)}for(var x=N.getIteratorAtPosition(M).container(),I;x.namespaceURI!==odf.Namespaces.officens||x.localName!=="annotation";)x=x.parentNode;return x===null?!1:(I=x,x=I.annotationEndElement,N.getOdfCanvas().forgetAnnotation(I),E.getElementsByTagNameNS(I,"urn:webodf:names:cursor","cursor").forEach(O),E.getElementsByTagNameNS(I,"urn:webodf:names:cursor","anchor").forEach(O),I.parentNode.removeChild(I),x&&x.parentNode.removeChild(x),N.emit(ops.OdtDocument.signalStepsRemoved,{position:0<M?M-1:M}),N.getOdfCanvas().rerenderAnnotations(),N.fixCursorPositions(),!0)},this.spec=function(){return{optype:"RemoveAnnotation",memberid:A,timestamp:j,position:M,length:w}}},ops.OpRemoveBlob=function(){var A,j,M;this.init=function(w){A=w.memberid,j=w.timestamp,M=w.filename},this.isEdit=!0,this.group=void 0,this.execute=function(w){return w.getOdfCanvas().odfContainer().removeBlob(M),!0},this.spec=function(){return{optype:"RemoveBlob",memberid:A,timestamp:j,filename:M}}},ops.OpRemoveCursor=function(){var A,j;this.init=function(M){A=M.memberid,j=M.timestamp},this.isEdit=!1,this.group=void 0,this.execute=function(M){return!!M.removeCursor(A)},this.spec=function(){return{optype:"RemoveCursor",memberid:A,timestamp:j}}},ops.OpRemoveHyperlink=function(){var A,j,M,w,E=core.DomUtils,N=odf.OdfUtils;this.init=function(O){A=O.memberid,j=O.timestamp,M=O.position,w=O.length},this.isEdit=!0,this.group=void 0,this.execute=function(O){var x=O.convertCursorToDomRange(M,w),I=N.getHyperlinkElements(x);return runtime.assert(I.length===1,"The given range should only contain a single link."),I=E.mergeIntoParent(I[0]),x.detach(),O.fixCursorPositions(),O.getOdfCanvas().refreshSize(),O.getOdfCanvas().rerenderAnnotations(),O.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:N.getParagraphElement(I),memberId:A,timeStamp:j}),!0},this.spec=function(){return{optype:"RemoveHyperlink",memberid:A,timestamp:j,position:M,length:w}}},ops.OpRemoveMember=function(){var A,j;this.init=function(M){A=M.memberid,j=parseInt(M.timestamp,10)},this.isEdit=!1,this.group=void 0,this.execute=function(M){return M.getMember(A)?(M.removeMember(A),M.emit(ops.Document.signalMemberRemoved,A),!0):!1},this.spec=function(){return{optype:"RemoveMember",memberid:A,timestamp:j}}},ops.OpRemoveStyle=function(){var A,j,M,w;this.init=function(E){A=E.memberid,j=E.timestamp,M=E.styleName,w=E.styleFamily},this.isEdit=!0,this.group=void 0,this.execute=function(E){var N=E.getFormatting().getStyleElement(M,w);return N?(N.parentNode.removeChild(N),E.getOdfCanvas().refreshCSS(),E.emit(ops.OdtDocument.signalCommonStyleDeleted,{name:M,family:w}),!0):!1},this.spec=function(){return{optype:"RemoveStyle",memberid:A,timestamp:j,styleName:M,styleFamily:w}}},ops.OpRemoveText=function(){var A,j,M,w,E=odf.OdfUtils,N=core.DomUtils;this.init=function(O){runtime.assert(0<=O.length,"OpRemoveText only supports positive lengths"),A=O.memberid,j=O.timestamp,M=parseInt(O.position,10),w=parseInt(O.length,10)},this.isEdit=!0,this.group=void 0,this.execute=function(O){var x,I,_,S=O.getCursor(A),u=new odf.CollapsingRules(O.getRootNode());return O.upgradeWhitespacesAtPosition(M),O.upgradeWhitespacesAtPosition(M+w),x=O.convertCursorToDomRange(M,w),N.splitBoundaries(x),I=E.getTextElements(x,!1,!0),_=E.getParagraphElement(x.startContainer,x.startOffset),runtime.assert(_!==void 0,"Attempting to remove text outside a paragraph element"),x.detach(),I.forEach(function(y){y.parentNode?(runtime.assert(N.containsNode(_,y),"RemoveText only supports removing elements within the same paragraph"),u.mergeChildrenIntoParent(y)):runtime.log("WARN: text element has already been removed from it's container")}),O.emit(ops.OdtDocument.signalStepsRemoved,{position:M}),O.downgradeWhitespacesAtPosition(M),O.fixCursorPositions(),O.getOdfCanvas().refreshSize(),O.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:_,memberId:A,timeStamp:j}),S&&(S.resetSelectionType(),O.emit(ops.Document.signalCursorMoved,S)),O.getOdfCanvas().rerenderAnnotations(),!0},this.spec=function(){return{optype:"RemoveText",memberid:A,timestamp:j,position:M,length:w}}},ops.OpSetBlob=function(){var A,j,M,w,E;this.init=function(N){A=N.memberid,j=N.timestamp,M=N.filename,w=N.mimetype,E=N.content},this.isEdit=!0,this.group=void 0,this.execute=function(N){return N.getOdfCanvas().odfContainer().setBlob(M,w,E),!0},this.spec=function(){return{optype:"SetBlob",memberid:A,timestamp:j,filename:M,mimetype:w,content:E}}},ops.OpSetParagraphStyle=function(){function A(O,x,I){var _=[O.getPositionFilter()],S=I.container();return I=I.unfilteredDomOffset(),O.createStepIterator(S,I,_,x).previousStep()===!1}var j,M,w,E,N=odf.OdfUtils;this.init=function(O){j=O.memberid,M=O.timestamp,w=O.position,E=O.styleName},this.isEdit=!0,this.group=void 0,this.execute=function(O){var x,I;return x=O.getIteratorAtPosition(w),(I=N.getParagraphElement(x.container()))?(runtime.assert(A(O,I,x),"SetParagraphStyle position should be the first position in the paragraph"),E?I.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:style-name",E):I.removeAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","style-name"),O.getOdfCanvas().refreshSize(),O.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:I,timeStamp:M,memberId:j}),O.getOdfCanvas().rerenderAnnotations(),!0):!1},this.spec=function(){return{optype:"SetParagraphStyle",memberid:j,timestamp:M,position:w,styleName:E}}},ops.OpSplitParagraph=function(){var A,j,M,w,E,N,O=odf.OdfUtils,x=odf.Namespaces.textns;this.init=function(I){A=I.memberid,j=I.timestamp,w=I.position,M=I.sourceParagraphPosition,N=I.paragraphStyleName,E=I.moveCursor==="true"||I.moveCursor===!0},this.isEdit=!0,this.group=void 0,this.execute=function(I){var _,S,u,y,v,m,R,V=I.getCursor(A);if(I.upgradeWhitespacesAtPosition(w),_=I.getTextNodeAtStep(w),!_||(S=O.getParagraphElement(_.textNode),!S))return!1;for(u=O.isListItem(S.parentNode)?S.parentNode:S,_.offset===0?(R=_.textNode.previousSibling,m=null):(R=_.textNode,m=_.offset>=_.textNode.length?null:_.textNode.splitText(_.offset)),y=_.textNode;y!==u;){if(y=y.parentNode,v=y.cloneNode(!1),m&&v.appendChild(m),R)for(;R&&R.nextSibling;)v.appendChild(R.nextSibling);else for(;y.firstChild;)v.appendChild(y.firstChild);y.parentNode.insertBefore(v,y.nextSibling),R=y,m=v}return O.isListItem(m)&&(m=m.childNodes.item(0)),N?m.setAttributeNS(x,"text:style-name",N):m.removeAttributeNS(x,"style-name"),_.textNode.length===0&&_.textNode.parentNode.removeChild(_.textNode),I.emit(ops.OdtDocument.signalStepsInserted,{position:w}),V&&E&&(I.moveCursor(A,w+1,0),I.emit(ops.Document.signalCursorMoved,V)),I.fixCursorPositions(),I.getOdfCanvas().refreshSize(),I.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:S,memberId:A,timeStamp:j}),I.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:m,memberId:A,timeStamp:j}),I.getOdfCanvas().rerenderAnnotations(),!0},this.spec=function(){return{optype:"SplitParagraph",memberid:A,timestamp:j,position:w,sourceParagraphPosition:M,paragraphStyleName:N,moveCursor:E}}},ops.OpUpdateMember=function(){function A(N){var O="//dc:creator[@editinfo:memberid='"+j+"']";for(N=xmldom.XPath.getODFElementsWithXPath(N.getRootNode(),O,function(x){return x==="editinfo"?"urn:webodf:names:editinfo":odf.Namespaces.lookupNamespaceURI(x)}),O=0;O<N.length;O+=1)N[O].textContent=w.fullName}var j,M,w,E;this.init=function(N){j=N.memberid,M=parseInt(N.timestamp,10),w=N.setProperties,E=N.removedProperties},this.isEdit=!1,this.group=void 0,this.execute=function(N){var O=N.getMember(j);return O?(E&&O.removeProperties(E),w&&(O.setProperties(w),w.fullName&&A(N)),N.emit(ops.Document.signalMemberUpdated,O),!0):!1},this.spec=function(){return{optype:"UpdateMember",memberid:j,timestamp:M,setProperties:w,removedProperties:E}}},ops.OpUpdateMetadata=function(){var A,j,M,w;this.init=function(E){A=E.memberid,j=parseInt(E.timestamp,10),M=E.setProperties,w=E.removedProperties},this.isEdit=!0,this.group=void 0,this.execute=function(E){var N=E.getOdfCanvas().odfContainer(),O=null;return w&&(O=w.attributes.split(",")),N.setMetadata(M,O),E.emit(ops.OdtDocument.signalMetadataUpdated,{setProperties:M!==null?M:{},removedProperties:O!==null?O:[]}),!0},this.spec=function(){return{optype:"UpdateMetadata",memberid:A,timestamp:j,setProperties:M,removedProperties:w}}},ops.OpUpdateParagraphStyle=function(){function A(x,I){var _,S,u=I?I.split(","):[];for(_=0;_<u.length;_+=1)S=u[_].split(":"),x.removeAttributeNS(odf.Namespaces.lookupNamespaceURI(S[0]),S[1])}var j,M,w,E,N,O=odf.Namespaces.stylens;this.init=function(x){j=x.memberid,M=x.timestamp,w=x.styleName,E=x.setProperties,N=x.removedProperties},this.isEdit=!0,this.group=void 0,this.execute=function(x){var I=x.getFormatting(),_,S,u;return(_=w!==""?I.getStyleElement(w,"paragraph"):I.getDefaultStyleElement("paragraph"))?(S=_.getElementsByTagNameNS(O,"paragraph-properties").item(0),u=_.getElementsByTagNameNS(O,"text-properties").item(0),E&&I.updateStyle(_,E),N&&(I=N["style:paragraph-properties"],S&&I&&(A(S,I.attributes),S.attributes.length===0&&_.removeChild(S)),I=N["style:text-properties"],u&&I&&(A(u,I.attributes),u.attributes.length===0&&_.removeChild(u)),A(_,N.attributes)),x.getOdfCanvas().refreshCSS(),x.emit(ops.OdtDocument.signalParagraphStyleModified,w),x.getOdfCanvas().rerenderAnnotations(),!0):!1},this.spec=function(){return{optype:"UpdateParagraphStyle",memberid:j,timestamp:M,styleName:w,setProperties:E,removedProperties:N}}},ops.OperationFactory=function(){function A(M){return function(w){return new M}}var j;this.register=function(M,w){j[M]=w},this.create=function(M){var w=null,E=j[M.optype];return E&&(w=E(M),w.init(M)),w},j={AddMember:A(ops.OpAddMember),UpdateMember:A(ops.OpUpdateMember),RemoveMember:A(ops.OpRemoveMember),AddCursor:A(ops.OpAddCursor),ApplyDirectStyling:A(ops.OpApplyDirectStyling),SetBlob:A(ops.OpSetBlob),RemoveBlob:A(ops.OpRemoveBlob),InsertImage:A(ops.OpInsertImage),InsertTable:A(ops.OpInsertTable),InsertText:A(ops.OpInsertText),RemoveText:A(ops.OpRemoveText),MergeParagraph:A(ops.OpMergeParagraph),SplitParagraph:A(ops.OpSplitParagraph),SetParagraphStyle:A(ops.OpSetParagraphStyle),UpdateParagraphStyle:A(ops.OpUpdateParagraphStyle),AddStyle:A(ops.OpAddStyle),RemoveStyle:A(ops.OpRemoveStyle),MoveCursor:A(ops.OpMoveCursor),RemoveCursor:A(ops.OpRemoveCursor),AddAnnotation:A(ops.OpAddAnnotation),RemoveAnnotation:A(ops.OpRemoveAnnotation),UpdateMetadata:A(ops.OpUpdateMetadata),ApplyHyperlink:A(ops.OpApplyHyperlink),RemoveHyperlink:A(ops.OpRemoveHyperlink)}},ops.OperationRouter=function(){},ops.OperationRouter.prototype.setOperationFactory=function(A){},ops.OperationRouter.prototype.setPlaybackFunction=function(A){},ops.OperationRouter.prototype.push=function(A){},ops.OperationRouter.prototype.close=function(A){},ops.OperationRouter.prototype.subscribe=function(A,j){},ops.OperationRouter.prototype.unsubscribe=function(A,j){},ops.OperationRouter.prototype.hasLocalUnsyncedOps=function(){},ops.OperationRouter.prototype.hasSessionHostConnection=function(){},ops.OperationRouter.signalProcessingBatchStart="router/batchstart",ops.OperationRouter.signalProcessingBatchEnd="router/batchend",ops.TrivialOperationRouter=function(){var A=new core.EventNotifier([ops.OperationRouter.signalProcessingBatchStart,ops.OperationRouter.signalProcessingBatchEnd]),j,M,w=0;this.setOperationFactory=function(E){j=E},this.setPlaybackFunction=function(E){M=E},this.push=function(E){w+=1,A.emit(ops.OperationRouter.signalProcessingBatchStart,{}),E.forEach(function(N){N=N.spec(),N.timestamp=Date.now(),N=j.create(N),N.group="g"+w,M(N)}),A.emit(ops.OperationRouter.signalProcessingBatchEnd,{})},this.close=function(E){E()},this.subscribe=function(E,N){A.subscribe(E,N)},this.unsubscribe=function(E,N){A.unsubscribe(E,N)},this.hasLocalUnsyncedOps=function(){return!1},this.hasSessionHostConnection=function(){return!0}},ops.Session=function(A){function j(O){E.emit(ops.OdtDocument.signalProcessingBatchStart,O)}function M(O){E.emit(ops.OdtDocument.signalProcessingBatchEnd,O)}var w=new ops.OperationFactory,E=new ops.OdtDocument(A),N=null;this.setOperationFactory=function(O){w=O,N&&N.setOperationFactory(w)},this.setOperationRouter=function(O){N&&(N.unsubscribe(ops.OperationRouter.signalProcessingBatchStart,j),N.unsubscribe(ops.OperationRouter.signalProcessingBatchEnd,M)),N=O,N.subscribe(ops.OperationRouter.signalProcessingBatchStart,j),N.subscribe(ops.OperationRouter.signalProcessingBatchEnd,M),O.setPlaybackFunction(function(x){return E.emit(ops.OdtDocument.signalOperationStart,x),x.execute(E)?(E.emit(ops.OdtDocument.signalOperationEnd,x),!0):!1}),O.setOperationFactory(w)},this.getOperationFactory=function(){return w},this.getOdtDocument=function(){return E},this.enqueue=function(O){N.push(O)},this.close=function(O){N.close(function(x){x?O(x):E.close(O)})},this.destroy=function(O){E.destroy(O)},this.setOperationRouter(new ops.TrivialOperationRouter)},gui.AnnotationController=function(A,j,M){function w(){var y=x.getCursor(M),y=y&&y.getNode(),v=!1;y&&(v=!S.isWithinAnnotation(y,x.getRootNode())),v!==I&&(I=v,_.emit(gui.AnnotationController.annotatableChanged,I))}function E(y){y.getMemberId()===M&&w()}function N(y){y===M&&w()}function O(y){y.getMemberId()===M&&w()}var x=A.getOdtDocument(),I=!1,_=new core.EventNotifier([gui.AnnotationController.annotatableChanged]),S=odf.OdfUtils,u=core.StepDirection.NEXT;this.isAnnotatable=function(){return I},this.addAnnotation=function(){var y=new ops.OpAddAnnotation,m=x.getCursorSelection(M),v=m.length,m=m.position;I&&(v===0?v=void 0:(m=0<=v?m:m+v,v=Math.abs(v)),y.init({memberid:M,position:m,length:v,name:M+Date.now()}),A.enqueue([y]))},this.removeAnnotation=function(y){var v,m;v=x.getMember(M).getProperties().fullName,(j.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)!==!0||v===S.getAnnotationCreator(y))&&(v=x.convertDomPointToCursorStep(y,0,u),m=x.convertDomPointToCursorStep(y,y.childNodes.length),y=new ops.OpRemoveAnnotation,y.init({memberid:M,position:v,length:m-v}),m=new ops.OpMoveCursor,m.init({memberid:M,position:0<v?v-1:v,length:0}),A.enqueue([y,m]))},this.subscribe=function(y,v){_.subscribe(y,v)},this.unsubscribe=function(y,v){_.unsubscribe(y,v)},this.destroy=function(y){x.unsubscribe(ops.Document.signalCursorAdded,E),x.unsubscribe(ops.Document.signalCursorRemoved,N),x.unsubscribe(ops.Document.signalCursorMoved,O),y()},j.registerConstraint(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN),x.subscribe(ops.Document.signalCursorAdded,E),x.subscribe(ops.Document.signalCursorRemoved,N),x.subscribe(ops.Document.signalCursorMoved,O),w()},gui.AnnotationController.annotatableChanged="annotatable/changed",gui.Avatar=function(A,j){var M=this,w,E,N;this.setColor=function(O){E.style.borderColor=O},this.setImageUrl=function(O){M.isVisible()?E.src=O:N=O},this.isVisible=function(){return w.style.display==="block"},this.show=function(){N&&(E.src=N,N=void 0),w.style.display="block"},this.hide=function(){w.style.display="none"},this.markAsFocussed=function(O){O?w.classList.add("active"):w.classList.remove("active")},this.destroy=function(O){A.removeChild(w),O()},function(){var O=A.ownerDocument;w=O.createElement("div"),E=O.createElement("img"),w.appendChild(E),w.style.display=j?"block":"none",w.className="handle",A.appendChild(w)}()},gui.StepInfo=function(){},gui.StepInfo.VisualDirection={LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1},gui.StepInfo.prototype.container=function(){},gui.StepInfo.prototype.offset=function(){},gui.VisualStepScanner=function(){},gui.VisualStepScanner.prototype.process=function(A,j,M){},gui.GuiStepUtils=function(){function A(x){x=M.getContentBounds(x);var I,_=null;return x&&(x.container.nodeType===Node.TEXT_NODE?(I=x.container.ownerDocument.createRange(),I.setStart(x.container,x.startOffset),I.setEnd(x.container,x.endOffset),(_=0<I.getClientRects().length?I.getBoundingClientRect():null)&&x.container.data.substring(x.startOffset,x.endOffset)===" "&&1>=_.width&&(_=null),I.detach()):(j.isCharacterElement(x.container)||j.isCharacterFrame(x.container))&&(_=w.getBoundingClientRect(x.container))),_}var j=odf.OdfUtils,M=new odf.StepUtils,w=core.DomUtils,E=core.StepDirection.NEXT,N=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT,O=gui.StepInfo.VisualDirection.RIGHT_TO_LEFT;this.getContentRect=A,this.moveToFilteredStep=function(x,I,_){function S(ee,z){return z.process(ne,m,R)&&(ee=!0,!V&&z.token&&(V=z.token)),ee}var u=I===E,y,v,m,R,V,Z=x.snapshot();y=!1;var ne;do y=A(x),ne={token:x.snapshot(),container:x.container,offset:x.offset,direction:I,visualDirection:I===E?N:O},v=x.nextStep()?A(x):null,x.restore(ne.token),u?(m=y,R=v):(m=v,R=y),y=_.reduce(S,!1);while(!y&&x.advanceStep(I));return y||_.forEach(function(ee){!V&&ee.token&&(V=ee.token)}),x.restore(V||Z),!!V}},gui.Caret=function(A,j,M,w){function E(){u.style.opacity=u.style.opacity==="0"?"1":"0",P.trigger()}function N(){return R.selectNodeContents(m),R.getBoundingClientRect()}function O(K){return q[K]!==te[K]}function x(){Object.keys(te).forEach(function(K){q[K]=te[K]})}function I(){if(te.isShown===!1||A.getSelectionType()!==ops.OdtCursor.RangeSelection||!w&&!A.getSelectedRange().collapsed?(te.visibility="hidden",u.style.visibility="hidden",P.cancel()):(te.visibility="visible",u.style.visibility="visible",te.isFocused===!1?(u.style.opacity="1",P.cancel()):((Y||O("visibility"))&&(u.style.opacity="1",P.cancel()),P.trigger())),J||$){var K;K=A.getNode();var U,F,re=Z.getBoundingClientRect(V.getSizer()),W=!1,ie=0;if(K.removeAttributeNS("urn:webodf:names:cursor","caret-sizer-active"),0<K.getClientRects().length)F=N(),ie=F.left-Z.getBoundingClientRect(K).left,W=!0;else if(ee.setPosition(K,0),F=ne.getContentRect(ee),!F&&ee.nextStep()&&(U=ne.getContentRect(ee))&&(F=U,W=!0),F||(K.setAttributeNS("urn:webodf:names:cursor","caret-sizer-active","true"),F=N(),W=!0),!F)for(runtime.log("WARN: No suitable client rectangle found for visual caret for "+A.getMemberId());K;){if(0<K.getClientRects().length){F=Z.getBoundingClientRect(K),W=!0;break}K=K.parentNode}F=Z.translateRect(F,re,V.getZoomLevel()),K={top:F.top,height:F.height,right:W?F.left:F.right,width:Z.adaptRangeDifferenceToZoomLevel(ie,V.getZoomLevel())},8>K.height&&(K={top:K.top-(8-K.height)/2,height:8,right:K.right}),S.style.height=K.height+"px",S.style.top=K.top+"px",S.style.left=K.right-K.width+"px",S.style.width=K.width?K.width+"px":"",v&&(K=runtime.getWindow().getComputedStyle(A.getNode(),null),K.font?v.style.font=K.font:(v.style.fontStyle=K.fontStyle,v.style.fontVariant=K.fontVariant,v.style.fontWeight=K.fontWeight,v.style.fontSize=K.fontSize,v.style.lineHeight=K.lineHeight,v.style.fontFamily=K.fontFamily))}te.isShown&&$&&j.scrollIntoView(u.getBoundingClientRect()),O("isFocused")&&y.markAsFocussed(te.isFocused),x(),J=$=Y=!1}function _(K){S.parentNode.removeChild(S),m.parentNode.removeChild(m),K()}var S,u,y,v,m,R,V=A.getDocument().getCanvas(),Z=core.DomUtils,ne=new gui.GuiStepUtils,ee,z,P,Y=!1,$=!1,J=!1,te={isFocused:!1,isShown:!0,visibility:"hidden"},q={isFocused:!te.isFocused,isShown:!te.isShown,visibility:"hidden"};this.handleUpdate=function(){J=!0,z.trigger()},this.refreshCursorBlinking=function(){Y=!0,z.trigger()},this.setFocus=function(){te.isFocused=!0,z.trigger()},this.removeFocus=function(){te.isFocused=!1,z.trigger()},this.show=function(){te.isShown=!0,z.trigger()},this.hide=function(){te.isShown=!1,z.trigger()},this.setAvatarImageUrl=function(K){y.setImageUrl(K)},this.setColor=function(K){u.style.borderColor=K,y.setColor(K)},this.getCursor=function(){return A},this.getFocusElement=function(){return u},this.toggleHandleVisibility=function(){y.isVisible()?y.hide():y.show()},this.showHandle=function(){y.show()},this.hideHandle=function(){y.hide()},this.setOverlayElement=function(K){v=K,S.appendChild(K),J=!0,z.trigger()},this.ensureVisible=function(){$=!0,z.trigger()},this.getBoundingClientRect=function(){return Z.getBoundingClientRect(S)},this.destroy=function(K){core.Async.destroyAll([z.destroy,P.destroy,y.destroy,_],K)},function(){var K=A.getDocument(),U=[K.createRootFilter(A.getMemberId()),K.getPositionFilter()],F=K.getDOMDocument();R=F.createRange(),m=F.createElement("span"),m.className="webodf-caretSizer",m.textContent="|",A.getNode().appendChild(m),S=F.createElement("div"),S.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",A.getMemberId()),S.className="webodf-caretOverlay",u=F.createElement("div"),u.className="caret",S.appendChild(u),y=new gui.Avatar(S,M),V.getSizer().appendChild(S),ee=K.createStepIterator(A.getNode(),0,U,K.getRootNode()),z=core.Task.createRedrawTask(I),P=core.Task.createTimeoutTask(E,500),z.triggerImmediate()}()},odf.TextSerializer=function(){function A(w){var E="",N=j.filter?j.filter.acceptNode(w):NodeFilter.FILTER_ACCEPT,O=w.nodeType,x;if((N===NodeFilter.FILTER_ACCEPT||N===NodeFilter.FILTER_SKIP)&&M.isTextContentContainingNode(w))for(x=w.firstChild;x;)E+=A(x),x=x.nextSibling;return N===NodeFilter.FILTER_ACCEPT&&(O===Node.ELEMENT_NODE&&M.isParagraph(w)?E+=`
`:O===Node.TEXT_NODE&&w.textContent&&(E+=w.textContent)),E}var j=this,M=odf.OdfUtils;this.filter=null,this.writeToString=function(w){return w?(w=A(w),w[w.length-1]===`
`&&(w=w.substr(0,w.length-1)),w):""}},gui.MimeDataExporter=function(){var A;this.exportRangeToDataTransfer=function(j,M){var w;w=M.startContainer.ownerDocument.createElement("span"),w.appendChild(M.cloneContents()),w=A.writeToString(w);try{j.setData("text/plain",w)}catch{j.setData("Text",w)}},A=new odf.TextSerializer,A.filter=new odf.OdfNodeFilter},gui.Clipboard=function(A){this.setDataFromRange=function(j,M){var w,E=j.clipboardData;return w=runtime.getWindow(),!E&&w&&(E=w.clipboardData),E?(w=!0,A.exportRangeToDataTransfer(E,M),j.preventDefault()):w=!1,w}},gui.SessionContext=function(A,j){var M=A.getOdtDocument(),w=odf.OdfUtils;this.isLocalCursorWithinOwnAnnotation=function(){var E=M.getCursor(j),N;return E?(N=E&&E.getNode(),E=M.getMember(j).getProperties().fullName,!!((N=w.getParentAnnotation(N,M.getRootNode()))&&w.getAnnotationCreator(N)===E)):!1}},gui.StyleSummary=function(A){function j(N,O){var x=N+"|"+O,I;return E.hasOwnProperty(x)||(I=[],A.forEach(function(_){_=(_=_.styleProperties[N])&&_[O],I.indexOf(_)===-1&&I.push(_)}),E[x]=I),E[x]}function M(N,O,x){return function(){var I=j(N,O);return x.length>=I.length&&I.every(function(_){return x.indexOf(_)!==-1})}}function w(N,O){var x=j(N,O);return x.length===1?x[0]:void 0}var E={};this.getPropertyValues=j,this.getCommonValue=w,this.isBold=M("style:text-properties","fo:font-weight",["bold"]),this.isItalic=M("style:text-properties","fo:font-style",["italic"]),this.hasUnderline=M("style:text-properties","style:text-underline-style",["solid"]),this.hasStrikeThrough=M("style:text-properties","style:text-line-through-style",["solid"]),this.fontSize=function(){var N=w("style:text-properties","fo:font-size");return N&&parseFloat(N)},this.fontName=function(){return w("style:text-properties","style:font-name")},this.isAlignedLeft=M("style:paragraph-properties","fo:text-align",["left","start"]),this.isAlignedCenter=M("style:paragraph-properties","fo:text-align",["center"]),this.isAlignedRight=M("style:paragraph-properties","fo:text-align",["right","end"]),this.isAlignedJustified=M("style:paragraph-properties","fo:text-align",["justify"]),this.text={isBold:this.isBold,isItalic:this.isItalic,hasUnderline:this.hasUnderline,hasStrikeThrough:this.hasStrikeThrough,fontSize:this.fontSize,fontName:this.fontName},this.paragraph={isAlignedLeft:this.isAlignedLeft,isAlignedCenter:this.isAlignedCenter,isAlignedRight:this.isAlignedRight,isAlignedJustified:this.isAlignedJustified}},gui.DirectFormattingController=function(A,j,M,w,E,N,O){function x(){return Re.value().styleSummary}function I(){return Re.value().enabledFeatures}function _(we){var ke;return we.collapsed?(ke=we.startContainer,ke.hasChildNodes()&&we.startOffset<ke.childNodes.length&&(ke=ke.childNodes.item(we.startOffset)),we=[ke]):we=ze.getTextElements(we,!0,!1),we}function S(){var we=ve.getCursor(w),ke=we&&we.getSelectedRange(),Ve=[],Ve=[],We=!0,$e={directTextStyling:!0,directParagraphStyling:!0};return ke&&(Ve=_(ke),Ve.length===0&&(Ve=[ke.startContainer,ke.endContainer],We=!1),Ve=ve.getFormatting().getAppliedStyles(Ve)),Ve[0]!==void 0&&De&&(Ve[0].styleProperties=Ne.mergeObjects(Ve[0].styleProperties,De)),j.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)===!0&&($e.directTextStyling=$e.directParagraphStyling=M.isLocalCursorWithinOwnAnnotation()),$e.directTextStyling&&($e.directTextStyling=We&&we!==void 0&&we.getSelectionType()===ops.OdtCursor.RangeSelection),{enabledFeatures:$e,appliedStyles:Ve,styleSummary:new gui.StyleSummary(Ve)}}function u(we,ke){var Ve={};return Object.keys(we).forEach(function(We){var $e=we[We](),ue=ke[We]();$e!==ue&&(Ve[We]=ue)}),Ve}function y(){var we,ke;ke=Me.styleSummary;var Ve=Re.value(),We=Ve.styleSummary,$e=Me.enabledFeatures,ue=Ve.enabledFeatures;we=u(ke.text,We.text),ke=u(ke.paragraph,We.paragraph),$e=!(ue.directTextStyling===$e.directTextStyling&&ue.directParagraphStyling===$e.directParagraphStyling),Me=Ve,$e&&rt.emit(gui.DirectFormattingController.enabledChanged,ue),0<Object.keys(we).length&&rt.emit(gui.DirectFormattingController.textStylingChanged,we),0<Object.keys(ke).length&&rt.emit(gui.DirectFormattingController.paragraphStylingChanged,ke)}function v(){Re.reset(),y()}function m(we){(typeof we=="string"?we:we.getMemberId())===w&&Re.reset()}function R(){Re.reset()}function V(we){var ke=ve.getCursor(w);we=we.paragraphElement,ke&&ze.getParagraphElement(ke.getNode())===we&&Re.reset()}function Z(we,ke){return ke(!we()),!0}function ne(we){if(I().directTextStyling){var ke=ve.getCursorSelection(w),Ve={"style:text-properties":we};ke.length!==0?(we=new ops.OpApplyDirectStyling,we.init({memberid:w,position:ke.position,length:ke.length,setProperties:Ve}),A.enqueue([we])):(De=Ne.mergeObjects(De||{},Ve),Re.reset())}}function ee(we,ke){var Ve={};Ve[we]=ke,ne(Ve)}function z(we){we=we.spec(),De&&we.memberid===w&&we.optype!=="SplitParagraph"&&(De=null,Re.reset())}function P(we){ee("fo:font-weight",we?"bold":"normal")}function Y(we){ee("fo:font-style",we?"italic":"normal")}function $(we){ee("style:text-underline-style",we?"solid":"none")}function J(we){ee("style:text-line-through-style",we?"solid":"none")}function te(we){if(I().directParagraphStyling){var ke=ve.getCursor(w).getSelectedRange(),ke=ze.getParagraphElements(ke),Ve=ve.getFormatting(),We=[],$e={},ue;ke.forEach(function(Se){var be=ve.convertDomPointToCursorStep(Se,0,me),Fe=Se.getAttributeNS(odf.Namespaces.textns,"style-name"),ut;Se=Fe?$e.hasOwnProperty(Fe)?$e[Fe]:void 0:ue,Se||(Se=E.generateStyleName(),Fe?($e[Fe]=Se,ut=Ve.createDerivedStyleObject(Fe,"paragraph",{})):(ue=Se,ut={}),ut=we(ut),Fe=new ops.OpAddStyle,Fe.init({memberid:w,styleName:Se.toString(),styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:ut}),We.push(Fe)),Fe=new ops.OpSetParagraphStyle,Fe.init({memberid:w,styleName:Se.toString(),position:be}),We.push(Fe)}),A.enqueue(We)}}function q(we){te(function(ke){return Ne.mergeObjects(ke,we)})}function K(we){q({"style:paragraph-properties":{"fo:text-align":we}})}function U(we,ke){var Ve=ve.getFormatting().getDefaultTabStopDistance(),We=ke["style:paragraph-properties"],$e;return We&&(We=We["fo:margin-left"],$e=ze.parseLength(We)),Ne.mergeObjects(ke,{"style:paragraph-properties":{"fo:margin-left":$e&&$e.unit===Ve.unit?$e.value+we*Ve.value+$e.unit:we*Ve.value+Ve.unit}})}function F(we,ke){var Ve=_(we),Ve=Ve.length===0?[we.startContainer]:Ve,Ve=ve.getFormatting().getAppliedStyles(Ve),We=0<Ve.length?Ve[0].styleProperties:void 0,$e=ve.getFormatting().getAppliedStylesForElement(ke).styleProperties;return!We||We["style:family"]!=="text"||!We["style:text-properties"]?!1:!$e||!$e["style:text-properties"]?!0:(We=We["style:text-properties"],$e=$e["style:text-properties"],!Object.keys(We).every(function(ue){return We[ue]===$e[ue]}))}function re(){}function W(){return!1}function ie(){return!1}var he=this,ve=A.getOdtDocument(),Ne=new core.Utils,ze=odf.OdfUtils,rt=new core.EventNotifier([gui.DirectFormattingController.enabledChanged,gui.DirectFormattingController.textStylingChanged,gui.DirectFormattingController.paragraphStylingChanged]),le=odf.Namespaces.textns,me=core.StepDirection.NEXT,De=null,Me,Re;this.enabledFeatures=I,this.formatTextSelection=ne,this.createCursorStyleOp=function(we,ke,Ve){var We=null,$e=De;return Ve&&($e=(Ve=Re.value().appliedStyles[0])&&Ve.styleProperties),$e&&$e["style:text-properties"]&&(We=new ops.OpApplyDirectStyling,We.init({memberid:w,position:we,length:ke,setProperties:{"style:text-properties":$e["style:text-properties"]}}),De=null,Re.reset()),We},this.setBold=P,this.setItalic=Y,this.setHasUnderline=$,this.setHasStrikethrough=J,this.setFontSize=function(we){ee("fo:font-size",we+"pt")},this.setFontName=function(we){ee("style:font-name",we)},this.getAppliedStyles=function(){return Re.value().appliedStyles},this.toggleBold=Z.bind(he,function(){return x().isBold()},P),this.toggleItalic=Z.bind(he,function(){return x().isItalic()},Y),this.toggleUnderline=Z.bind(he,function(){return x().hasUnderline()},$),this.toggleStrikethrough=Z.bind(he,function(){return x().hasStrikeThrough()},J),this.isBold=function(){return x().isBold()},this.isItalic=function(){return x().isItalic()},this.hasUnderline=function(){return x().hasUnderline()},this.hasStrikeThrough=function(){return x().hasStrikeThrough()},this.fontSize=function(){return x().fontSize()},this.fontName=function(){return x().fontName()},this.isAlignedLeft=function(){return x().isAlignedLeft()},this.isAlignedCenter=function(){return x().isAlignedCenter()},this.isAlignedRight=function(){return x().isAlignedRight()},this.isAlignedJustified=function(){return x().isAlignedJustified()},this.alignParagraphLeft=function(){return K("left"),!0},this.alignParagraphCenter=function(){return K("center"),!0},this.alignParagraphRight=function(){return K("right"),!0},this.alignParagraphJustified=function(){return K("justify"),!0},this.indent=function(){return te(U.bind(null,1)),!0},this.outdent=function(){return te(U.bind(null,-1)),!0},this.createParagraphStyleOps=function(we){if(!I().directParagraphStyling)return[];var ke=ve.getCursor(w),Ve=ke.getSelectedRange(),We=[],$e,ue;ke.hasForwardSelection()?($e=ke.getAnchorNode(),ue=ke.getNode()):($e=ke.getNode(),ue=ke.getAnchorNode()),ke=ze.getParagraphElement(ue),runtime.assert(!!ke,"DirectFormattingController: Cursor outside paragraph");var Se=ke,be=[ve.getPositionFilter(),ve.createRootFilter(w)];return ve.createStepIterator(Ve.endContainer,Ve.endOffset,be,Se).nextStep()!==!1||(ue!==$e&&(ke=ze.getParagraphElement($e)),!De&&!F(Ve,ke))||(Ve=(Ve=Re.value().appliedStyles[0])&&Ve.styleProperties,!Ve)||((ke=ke.getAttributeNS(le,"style-name"))&&(Ve={"style:text-properties":Ve["style:text-properties"]},Ve=ve.getFormatting().createDerivedStyleObject(ke,"paragraph",Ve)),$e=E.generateStyleName(),ke=new ops.OpAddStyle,ke.init({memberid:w,styleName:$e,styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:Ve}),We.push(ke),ke=new ops.OpSetParagraphStyle,ke.init({memberid:w,styleName:$e,position:we}),We.push(ke)),We},this.subscribe=function(we,ke){rt.subscribe(we,ke)},this.unsubscribe=function(we,ke){rt.unsubscribe(we,ke)},this.destroy=function(we){ve.unsubscribe(ops.Document.signalCursorAdded,m),ve.unsubscribe(ops.Document.signalCursorRemoved,m),ve.unsubscribe(ops.Document.signalCursorMoved,m),ve.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,R),ve.unsubscribe(ops.OdtDocument.signalParagraphChanged,V),ve.unsubscribe(ops.OdtDocument.signalOperationEnd,z),ve.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,y),j.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,v),we()},function(){ve.subscribe(ops.Document.signalCursorAdded,m),ve.subscribe(ops.Document.signalCursorRemoved,m),ve.subscribe(ops.Document.signalCursorMoved,m),ve.subscribe(ops.OdtDocument.signalParagraphStyleModified,R),ve.subscribe(ops.OdtDocument.signalParagraphChanged,V),ve.subscribe(ops.OdtDocument.signalOperationEnd,z),ve.subscribe(ops.OdtDocument.signalProcessingBatchEnd,y),j.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,v),Re=new core.LazyProperty(S),Me=Re.value(),N||(he.formatTextSelection=re,he.setBold=re,he.setItalic=re,he.setHasUnderline=re,he.setHasStrikethrough=re,he.setFontSize=re,he.setFontName=re,he.toggleBold=ie,he.toggleItalic=ie,he.toggleUnderline=ie,he.toggleStrikethrough=ie),O||(he.alignParagraphCenter=W,he.alignParagraphJustified=W,he.alignParagraphLeft=W,he.alignParagraphRight=W,he.createParagraphStyleOps=function(){return[]},he.indent=W,he.outdent=W)}()},gui.DirectFormattingController.enabledChanged="enabled/changed",gui.DirectFormattingController.textStylingChanged="textStyling/changed",gui.DirectFormattingController.paragraphStylingChanged="paragraphStyling/changed",gui.DirectFormattingController.SelectionInfo=function(){},gui.KeyboardHandler=function(){function A(E,N){switch(N||(N=j.None),E){case gui.KeyboardHandler.KeyCode.LeftMeta:case gui.KeyboardHandler.KeyCode.RightMeta:case gui.KeyboardHandler.KeyCode.MetaInMozilla:N|=j.Meta;break;case gui.KeyboardHandler.KeyCode.Ctrl:N|=j.Ctrl;break;case gui.KeyboardHandler.KeyCode.Alt:N|=j.Alt;break;case gui.KeyboardHandler.KeyCode.Shift:N|=j.Shift}return E+":"+N}var j=gui.KeyboardHandler.Modifier,M=null,w={};this.setDefault=function(E){M=E},this.bind=function(E,N,O,x){E=A(E,N),runtime.assert(x||w.hasOwnProperty(E)===!1,"tried to overwrite the callback handler of key combo: "+E),w[E]=O},this.unbind=function(E,N){var O=A(E,N);delete w[O]},this.reset=function(){M=null,w={}},this.handleEvent=function(E){var N=E.keyCode,O=j.None;E.metaKey&&(O|=j.Meta),E.ctrlKey&&(O|=j.Ctrl),E.altKey&&(O|=j.Alt),E.shiftKey&&(O|=j.Shift),N=A(N,O),N=w[N],O=!1,N?O=N():M!==null&&(O=M(E)),O&&(E.preventDefault?E.preventDefault():E.returnValue=!1)}},gui.KeyboardHandler.Modifier={None:0,Meta:1,Ctrl:2,Alt:4,CtrlAlt:6,Shift:8,MetaShift:9,CtrlShift:10,AltShift:12},gui.KeyboardHandler.KeyCode={Backspace:8,Tab:9,Clear:12,Enter:13,Shift:16,Ctrl:17,Alt:18,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LeftMeta:91,RightMeta:93,MetaInMozilla:224},gui.HyperlinkClickHandler=function(A,j,M){function w(){var m=A();runtime.assert(!!m.classList,"Document container has no classList element"),m.classList.remove("webodf-inactiveLinks")}function E(){var m=A();runtime.assert(!!m.classList,"Document container has no classList element"),m.classList.add("webodf-inactiveLinks")}function N(){u.removeEventListener("focus",E,!1),v.forEach(function(m){j.unbind(m.keyCode,m.modifier),M.unbind(m.keyCode,m.modifier)}),v.length=0}function O(m){if(N(),m!==x.None){switch(u.addEventListener("focus",E,!1),m){case x.Ctrl:v.push({keyCode:I.Ctrl,modifier:x.None});break;case x.Meta:v.push({keyCode:I.LeftMeta,modifier:x.None}),v.push({keyCode:I.RightMeta,modifier:x.None}),v.push({keyCode:I.MetaInMozilla,modifier:x.None})}v.forEach(function(R){j.bind(R.keyCode,R.modifier,w),M.bind(R.keyCode,R.modifier,E)})}}var x=gui.KeyboardHandler.Modifier,I=gui.KeyboardHandler.KeyCode,_=xmldom.XPath,S=odf.OdfUtils,u=runtime.getWindow(),y=x.None,v=[];runtime.assert(u!==null,"Expected to be run in an environment which has a global window, like a browser."),this.handleClick=function(m){var R=m.target||m.srcElement,V,Z;if(m.ctrlKey?V=x.Ctrl:m.metaKey&&(V=x.Meta),y===x.None||y===V){e:{for(;R!==null;){if(S.isHyperlink(R))break e;if(S.isParagraph(R))break;R=R.parentNode}R=null}R&&(R=S.getHyperlinkTarget(R),R!==""&&(R[0]==="#"?(R=R.substring(1),V=A(),Z=_.getODFElementsWithXPath(V,"//text:bookmark-start[@text:name='"+R+"']",odf.Namespaces.lookupNamespaceURI),Z.length===0&&(Z=_.getODFElementsWithXPath(V,"//text:bookmark[@text:name='"+R+"']",odf.Namespaces.lookupNamespaceURI)),0<Z.length&&Z[0].scrollIntoView(!0)):/^\s*(javascript|data):/.test(R)?runtime.log("WARN:","potentially malicious URL ignored"):u.open(R),m.preventDefault?m.preventDefault():m.returnValue=!1))}},this.setModifier=function(m){y!==m&&(runtime.assert(m===x.None||m===x.Ctrl||m===x.Meta,"Unsupported KeyboardHandler.Modifier value: "+m),y=m,y!==x.None?E():w(),O(y))},this.getModifier=function(){return y},this.destroy=function(m){E(),N(),m()}},gui.EventManager=function(A){function j(U){function F(Ne,ze,rt){var le,me=!1;le="on"+ze,Ne.attachEvent&&(Ne.attachEvent(le,rt),me=!0),!me&&Ne.addEventListener&&(Ne.addEventListener(ze,rt,!1),me=!0),me&&!z[ze]||!Ne.hasOwnProperty(le)||(Ne[le]=rt)}function re(Ne,ze,rt){var le="on"+ze;Ne.detachEvent&&Ne.detachEvent(le,rt),Ne.removeEventListener&&Ne.removeEventListener(ze,rt,!1),Ne[le]===rt&&(Ne[le]=null)}function W(Ne){if(he.indexOf(Ne)===-1){if(he.push(Ne),ie.filters.every(function(ze){return ze(Ne)}))try{ve.emit(U,Ne)}catch(ze){runtime.log("Error occurred while processing "+U+`:
`+ze.message+`
`+ze.stack)}runtime.setTimeout(function(){he.splice(he.indexOf(Ne),1)},0)}}var ie=this,he=[],ve=new core.EventNotifier([U]);this.filters=[],this.subscribe=function(Ne){ve.subscribe(U,Ne)},this.unsubscribe=function(Ne){ve.unsubscribe(U,Ne)},this.destroy=function(){re(ee,U,W),re(J,U,W),re(te,U,W)},P[U]&&F(ee,U,W),F(J,U,W),F(te,U,W)}function M(U,F,re){function W(ve){re(ve,ie,function(Ne){Ne.type=U,he.emit(U,Ne)})}var ie={},he=new core.EventNotifier([U]);this.subscribe=function(ve){he.subscribe(U,ve)},this.unsubscribe=function(ve){he.unsubscribe(U,ve)},this.destroy=function(){F.forEach(function(ve){q.unsubscribe(ve,W)})},function(){F.forEach(function(ve){q.subscribe(ve,W)})}()}function w(U){runtime.clearTimeout(U),delete K[U]}function E(U,F){var re=runtime.setTimeout(function(){U(),w(re)},F);return K[re]=!0,re}function N(U,F,re){var W=U.touches.length,ie=U.touches[0],he=F.timer;U.type==="touchmove"||U.type==="touchend"?he&&w(he):U.type==="touchstart"&&(W!==1?runtime.clearTimeout(he):he=E(function(){re({clientX:ie.clientX,clientY:ie.clientY,pageX:ie.pageX,pageY:ie.pageY,target:U.target||U.srcElement||null,detail:1})},400)),F.timer=he}function O(U,F,re){var W=U.touches[0],ie=U.target||U.srcElement||null,he=F.target;U.touches.length!==1||U.type==="touchend"?he=null:U.type==="touchstart"&&ie.getAttribute("class")==="webodf-draggable"?he=ie:U.type==="touchmove"&&he&&(U.preventDefault(),U.stopPropagation(),re({clientX:W.clientX,clientY:W.clientY,pageX:W.pageX,pageY:W.pageY,target:he,detail:1})),F.target=he}function x(U,F,re){var W=U.target||U.srcElement||null,ie=F.dragging;U.type==="drag"?ie=!0:U.type==="touchend"&&ie&&(ie=!1,U=U.changedTouches[0],re({clientX:U.clientX,clientY:U.clientY,pageX:U.pageX,pageY:U.pageY,target:W,detail:1})),F.dragging=ie}function I(){te.classList.add("webodf-touchEnabled"),q.unsubscribe("touchstart",I)}function _(U){var F=U.scrollX,re=U.scrollY;this.restore=function(){U.scrollX===F&&U.scrollY===re||U.scrollTo(F,re)}}function S(U){var F=U.scrollTop,re=U.scrollLeft;this.restore=function(){(U.scrollTop!==F||U.scrollLeft!==re)&&(U.scrollTop=F,U.scrollLeft=re)}}function u(U,F){var re=$[U]||Y[U]||null;return!re&&F&&(re=$[U]=new j(U)),re}function y(U,F){u(U,!0).subscribe(F)}function v(U,F){var re=u(U,!1);re&&re.unsubscribe(F)}function m(){return A.getDOMDocument().activeElement===J}function R(){m()&&J.blur(),J.setAttribute("disabled","true")}function V(){J.removeAttribute("disabled")}function Z(U){for(var F=[];U;)(U.scrollWidth>U.clientWidth||U.scrollHeight>U.clientHeight)&&F.push(new S(U)),U=U.parentNode;return F.push(new _(ee)),F}function ne(){var U;m()||(U=Z(J),V(),J.focus(),U.forEach(function(F){F.restore()}))}var ee=runtime.getWindow(),z={beforecut:!0,beforepaste:!0,longpress:!0,drag:!0,dragstop:!0},P={mousedown:!0,mouseup:!0,focus:!0},Y={},$={},J,te=A.getCanvas().getElement(),q=this,K={};this.addFilter=function(U,F){u(U,!0).filters.push(F)},this.removeFilter=function(U,F){var re=u(U,!0),W=re.filters.indexOf(F);W!==-1&&re.filters.splice(W,1)},this.subscribe=y,this.unsubscribe=v,this.hasFocus=m,this.focus=ne,this.getEventTrap=function(){return J},this.setEditing=function(U){var F=m();F&&J.blur(),U?J.removeAttribute("readOnly"):J.setAttribute("readOnly","true"),F&&ne()},this.destroy=function(U){v("touchstart",I),Object.keys(K).forEach(function(F){w(parseInt(F,10))}),K.length=0,Object.keys(Y).forEach(function(F){Y[F].destroy()}),Y={},v("mousedown",R),v("mouseup",V),v("contextmenu",V),Object.keys($).forEach(function(F){$[F].destroy()}),$={},J.parentNode.removeChild(J),U()},function(){var U=A.getOdfCanvas().getSizer(),F=U.ownerDocument;runtime.assert(!!ee,"EventManager requires a window object to operate correctly"),J=F.createElement("textarea"),J.id="eventTrap",J.setAttribute("tabindex","-1"),J.setAttribute("readOnly","true"),J.setAttribute("rows","1"),U.appendChild(J),y("mousedown",R),y("mouseup",V),y("contextmenu",V),Y.longpress=new M("longpress",["touchstart","touchmove","touchend"],N),Y.drag=new M("drag",["touchstart","touchmove","touchend"],O),Y.dragstop=new M("dragstop",["drag","touchend"],x),y("touchstart",I)}()},gui.IOSSafariSupport=function(A){function j(){M.innerHeight!==M.outerHeight&&(w.style.display="none",runtime.requestAnimationFrame(function(){w.style.display="block"}))}var M=runtime.getWindow(),w=A.getEventTrap();this.destroy=function(E){A.unsubscribe("focus",j),w.removeAttribute("autocapitalize"),w.style.WebkitTransform="",E()},A.subscribe("focus",j),w.setAttribute("autocapitalize","off"),w.style.WebkitTransform="translateX(-10000px)"},gui.HyperlinkController=function(A,j,M,w){function E(){var S=!0;j.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)===!0&&(S=M.isLocalCursorWithinOwnAnnotation()),S!==_&&(_=S,I.emit(gui.HyperlinkController.enabledChanged,_))}function N(S){S.getMemberId()===w&&E()}var O=odf.OdfUtils,x=A.getOdtDocument(),I=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),_=!1;this.isEnabled=function(){return _},this.subscribe=function(S,u){I.subscribe(S,u)},this.unsubscribe=function(S,u){I.unsubscribe(S,u)},this.addHyperlink=function(S,u){if(_){var y=x.getCursorSelection(w),v=new ops.OpApplyHyperlink,m=[];(y.length===0||u)&&(u=u||S,v=new ops.OpInsertText,v.init({memberid:w,position:y.position,text:u}),y.length=u.length,m.push(v)),v=new ops.OpApplyHyperlink,v.init({memberid:w,position:y.position,length:y.length,hyperlink:S}),m.push(v),A.enqueue(m)}},this.removeHyperlinks=function(){if(_){var S=x.createPositionIterator(x.getRootNode()),u=x.getCursor(w).getSelectedRange(),y=O.getHyperlinkElements(u),v=u.collapsed&&y.length===1,m=x.getDOMDocument().createRange(),R=[],V,Z;y.length!==0&&(y.forEach(function(ne){m.selectNodeContents(ne),V=x.convertDomToCursorRange({anchorNode:m.startContainer,anchorOffset:m.startOffset,focusNode:m.endContainer,focusOffset:m.endOffset}),Z=new ops.OpRemoveHyperlink,Z.init({memberid:w,position:V.position,length:V.length}),R.push(Z)}),v||(v=y[0],u.comparePoint(v,0)===-1&&(m.setStart(v,0),m.setEnd(u.startContainer,u.startOffset),V=x.convertDomToCursorRange({anchorNode:m.startContainer,anchorOffset:m.startOffset,focusNode:m.endContainer,focusOffset:m.endOffset}),0<V.length&&(Z=new ops.OpApplyHyperlink,Z.init({memberid:w,position:V.position,length:V.length,hyperlink:O.getHyperlinkTarget(v)}),R.push(Z))),y=y[y.length-1],S.moveToEndOfNode(y),S=S.unfilteredDomOffset(),u.comparePoint(y,S)===1&&(m.setStart(u.endContainer,u.endOffset),m.setEnd(y,S),V=x.convertDomToCursorRange({anchorNode:m.startContainer,anchorOffset:m.startOffset,focusNode:m.endContainer,focusOffset:m.endOffset}),0<V.length&&(Z=new ops.OpApplyHyperlink,Z.init({memberid:w,position:V.position,length:V.length,hyperlink:O.getHyperlinkTarget(y)}),R.push(Z)))),A.enqueue(R),m.detach())}},this.destroy=function(S){x.unsubscribe(ops.Document.signalCursorMoved,N),j.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,E),S()},x.subscribe(ops.Document.signalCursorMoved,N),j.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,E),E()},gui.HyperlinkController.enabledChanged="enabled/changed",gui.ImageController=function(A,j,M,w,E){function N(){var m=!0;j.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)===!0&&(m=M.isLocalCursorWithinOwnAnnotation()),m!==v&&(v=m,y.emit(gui.ImageController.enabledChanged,v))}function O(m){m.getMemberId()===w&&N()}var x={"image/gif":".gif","image/jpeg":".jpg","image/png":".png"},I=odf.Namespaces.textns,_=A.getOdtDocument(),S=odf.OdfUtils,u=_.getFormatting(),y=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),v=!1;this.isEnabled=function(){return v},this.subscribe=function(m,R){y.subscribe(m,R)},this.unsubscribe=function(m,R){y.unsubscribe(m,R)},this.insertImage=function(m,R,V,Z){if(v){var ne=new core.CSSUnits;if(runtime.assert(0<V&&0<Z,"Both width and height of the image should be greater than 0px."),Z={width:V,height:Z},V=S.getParagraphElement(_.getCursor(w).getNode()).getAttributeNS(I,"style-name")){V=u.getContentSize(V,"paragraph");var z=1,ee=1;Z.width>V.width&&(z=V.width/Z.width),Z.height>V.height&&(ee=V.height/Z.height),V=Math.min(z,ee),Z={width:Z.width*V,height:Z.height*V}}V=ne.convert(Z.width,"px","cm")+"cm",ne=ne.convert(Z.height,"px","cm")+"cm",ee=_.getOdfCanvas().odfContainer().rootElement.styles,Z=m.toLowerCase();var z=x.hasOwnProperty(Z)?x[Z]:null,P;Z=[],runtime.assert(z!==null,"Image type is not supported: "+m),z="Pictures/"+E.generateImageName()+z,P=new ops.OpSetBlob,P.init({memberid:w,filename:z,mimetype:m,content:R}),Z.push(P),u.getStyleElement("Graphics","graphic",[ee])||(m=new ops.OpAddStyle,m.init({memberid:w,styleName:"Graphics",styleFamily:"graphic",isAutomaticStyle:!1,setProperties:{"style:graphic-properties":{"text:anchor-type":"paragraph","svg:x":"0cm","svg:y":"0cm","style:wrap":"dynamic","style:number-wrapped-paragraphs":"no-limit","style:wrap-contour":"false","style:vertical-pos":"top","style:vertical-rel":"paragraph","style:horizontal-pos":"center","style:horizontal-rel":"paragraph"}}}),Z.push(m)),m=E.generateStyleName(),R=new ops.OpAddStyle,R.init({memberid:w,styleName:m,styleFamily:"graphic",isAutomaticStyle:!0,setProperties:{"style:parent-style-name":"Graphics","style:graphic-properties":{"style:vertical-pos":"top","style:vertical-rel":"baseline","style:horizontal-pos":"center","style:horizontal-rel":"paragraph","fo:background-color":"transparent","style:background-transparency":"100%","style:shadow":"none","style:mirror":"none","fo:clip":"rect(0cm, 0cm, 0cm, 0cm)","draw:luminance":"0%","draw:contrast":"0%","draw:red":"0%","draw:green":"0%","draw:blue":"0%","draw:gamma":"100%","draw:color-inversion":"false","draw:image-opacity":"100%","draw:color-mode":"standard"}}}),Z.push(R),P=new ops.OpInsertImage,P.init({memberid:w,position:_.getCursorPosition(w),filename:z,frameWidth:V,frameHeight:ne,frameStyleName:m,frameName:E.generateFrameName()}),Z.push(P),A.enqueue(Z)}},this.destroy=function(m){_.unsubscribe(ops.Document.signalCursorMoved,O),j.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,N),m()},_.subscribe(ops.Document.signalCursorMoved,O),j.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,N),N()},gui.ImageController.enabledChanged="enabled/changed",gui.ImageSelector=function(A){function j(){var O=A.getSizer(),x=E.createElement("div");return x.id="imageSelector",x.style.borderWidth="1px",O.appendChild(x),w.forEach(function(I){var _=E.createElement("div");_.className=I,x.appendChild(_)}),x}var M=odf.Namespaces.svgns,w="topLeft topRight bottomRight bottomLeft topMiddle rightMiddle bottomMiddle leftMiddle".split(" "),E=A.getElement().ownerDocument,N=!1;this.select=function(O){var x,I,_=E.getElementById("imageSelector");_||(_=j()),N=!0,x=_.parentNode,I=O.getBoundingClientRect();var S=x.getBoundingClientRect(),u=A.getZoomLevel();x=(I.left-S.left)/u-1,I=(I.top-S.top)/u-1,_.style.display="block",_.style.left=x+"px",_.style.top=I+"px",_.style.width=O.getAttributeNS(M,"width"),_.style.height=O.getAttributeNS(M,"height")},this.clearSelection=function(){var O;N&&(O=E.getElementById("imageSelector"))&&(O.style.display="none"),N=!1},this.isSelectorElement=function(O){var x=E.getElementById("imageSelector");return x?O===x||O.parentNode===x:!1}},function(){function A(j){function M(x){return O=x.which&&String.fromCharCode(x.which)===N,N=void 0,O===!1}function w(){O=!1}function E(x){N=x.data,O=!1}var N,O=!1;this.destroy=function(x){j.unsubscribe("textInput",w),j.unsubscribe("compositionend",E),j.removeFilter("keypress",M),x()},j.subscribe("textInput",w),j.subscribe("compositionend",E),j.addFilter("keypress",M)}gui.InputMethodEditor=function(j,M){function w(J){u&&(J?u.getNode().setAttributeNS("urn:webodf:names:cursor","composing","true"):(u.getNode().removeAttributeNS("urn:webodf:names:cursor","composing"),m.textContent=""))}function E(){V&&(V=!1,w(!1),ne.emit(gui.InputMethodEditor.signalCompositionEnd,{data:Z}),Z="")}function N(){$||($=!0,E(),u&&u.getSelectedRange().collapsed?y.value="":y.value=z.writeToString(u.getSelectedRange().cloneContents()),y.setSelectionRange(0,y.value.length),$=!1)}function O(){M.hasFocus()&&R.trigger()}function x(){ee=void 0,R.cancel(),w(!0),V||ne.emit(gui.InputMethodEditor.signalCompositionStart,{data:""})}function I(J){J=ee=J.data,V=!0,Z+=J,R.trigger()}function _(J){J.data!==ee&&(J=J.data,V=!0,Z+=J,R.trigger()),ee=void 0}function S(){m.textContent=y.value}var u=null,y=M.getEventTrap(),v=y.ownerDocument,m,R,V=!1,Z="",ne=new core.EventNotifier([gui.InputMethodEditor.signalCompositionStart,gui.InputMethodEditor.signalCompositionEnd]),ee,z,P=[],Y,$=!1;this.subscribe=ne.subscribe,this.unsubscribe=ne.unsubscribe,this.registerCursor=function(J){J.getMemberId()===j&&(u=J,u.getNode().appendChild(m),J.subscribe(ops.OdtCursor.signalCursorUpdated,O),M.subscribe("input",S),M.subscribe("compositionupdate",S))},this.removeCursor=function(J){u&&J===j&&(u.getNode().removeChild(m),u.unsubscribe(ops.OdtCursor.signalCursorUpdated,O),M.unsubscribe("input",S),M.unsubscribe("compositionupdate",S),u=null)},this.destroy=function(J){M.unsubscribe("compositionstart",x),M.unsubscribe("compositionend",I),M.unsubscribe("textInput",_),M.unsubscribe("keypress",E),M.unsubscribe("focus",N),core.Async.destroyAll(Y,J)},function(){z=new odf.TextSerializer,z.filter=new odf.OdfNodeFilter,M.subscribe("compositionstart",x),M.subscribe("compositionend",I),M.subscribe("textInput",_),M.subscribe("keypress",E),M.subscribe("focus",N),P.push(new A(M)),Y=P.map(function(J){return J.destroy}),m=v.createElement("span"),m.setAttribute("id","composer"),R=core.Task.createTimeoutTask(N,1),Y.push(R.destroy)}()},gui.InputMethodEditor.signalCompositionStart="input/compositionstart",gui.InputMethodEditor.signalCompositionEnd="input/compositionend"}(),gui.MetadataController=function(A,j){function M(x){N.emit(gui.MetadataController.signalMetadataChanged,x)}function w(x){var I=O.indexOf(x)===-1;return I||runtime.log("Setting "+x+" is restricted."),I}var E=A.getOdtDocument(),N=new core.EventNotifier([gui.MetadataController.signalMetadataChanged]),O=["dc:creator","dc:date","meta:editing-cycles","meta:editing-duration","meta:document-statistic"];this.setMetadata=function(x,I){var _={},S="",u;x&&Object.keys(x).filter(w).forEach(function(y){_[y]=x[y]}),I&&(S=I.filter(w).join(",")),(0<S.length||0<Object.keys(_).length)&&(u=new ops.OpUpdateMetadata,u.init({memberid:j,setProperties:_,removedProperties:0<S.length?{attributes:S}:null}),A.enqueue([u]))},this.getMetadata=function(x){var I;return runtime.assert(typeof x=="string","Property must be a string"),I=x.split(":"),runtime.assert(I.length===2,"Property must be a namespace-prefixed string"),x=odf.Namespaces.lookupNamespaceURI(I[0]),runtime.assert(!!x,"Prefix must be for an ODF namespace."),E.getOdfCanvas().odfContainer().getMetadata(x,I[1])},this.subscribe=function(x,I){N.subscribe(x,I)},this.unsubscribe=function(x,I){N.unsubscribe(x,I)},this.destroy=function(x){E.unsubscribe(ops.OdtDocument.signalMetadataUpdated,M),x()},E.subscribe(ops.OdtDocument.signalMetadataUpdated,M)},gui.MetadataController.signalMetadataChanged="metadata/changed",gui.PasteController=function(A,j,M,w){function E(){x=j.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)===!0?M.isLocalCursorWithinOwnAnnotation():!0}function N(u){u.getMemberId()===w&&E()}var O=A.getOdtDocument(),x=!1,I=odf.Namespaces.textns,_=core.StepDirection.NEXT,S=odf.OdfUtils;this.isEnabled=function(){return x},this.paste=function(u){if(x){var y=O.getCursorPosition(w),v=O.getCursor(w).getNode(),v=S.getParagraphElement(v),m=v.getAttributeNS(I,"style-name")||"",R=y,V=[],Z=O.convertDomPointToCursorStep(v,0,_);u.replace(/\r/g,"").split(`
`).forEach(function(ne){var ee=new ops.OpInsertText,z=new ops.OpSplitParagraph;ee.init({memberid:w,position:R,text:ne,moveCursor:!0}),V.push(ee),R+=ne.length,z.init({memberid:w,position:R,paragraphStyleName:m,sourceParagraphPosition:Z,moveCursor:!0}),V.push(z),Z=R+=1}),V.pop(),A.enqueue(V)}},this.destroy=function(u){O.unsubscribe(ops.Document.signalCursorMoved,N),j.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,E),u()},O.subscribe(ops.Document.signalCursorMoved,N),j.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,E),E()},gui.ClosestXOffsetScanner=function(A){function j(O){return O!==null&&E!==void 0?Math.abs(O-A)>E:!1}function M(O){O!==null&&j(O)===!1&&(E=Math.abs(O-A))}var w=this,E,N=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT;this.token=void 0,this.process=function(O,x,I){var _,S;return O.visualDirection===N?(_=x&&x.right,S=I&&I.left):(_=x&&x.left,S=I&&I.right),j(_)||j(S)?!0:((x||I)&&(M(_),M(S),w.token=O.token),!1)}},gui.LineBoundaryScanner=function(){var A=this,j=null;this.token=void 0,this.process=function(M,w,E){var N;if(N=E)if(j){var x=j;N=Math.min(x.bottom-x.top,E.bottom-E.top);var O=Math.max(x.top,E.top),x=Math.min(x.bottom,E.bottom)-O;N=.4>=(0<N?x/N:0)}else N=!1;return!w||E&&!N||(A.token=M.token),N?!0:(j=(M=j)&&w?{left:Math.min(M.left,w.left),right:Math.max(M.right,w.right),top:Math.min(M.top,w.top),bottom:Math.min(M.bottom,w.bottom)}:M||w,!1)}},gui.ParagraphBoundaryScanner=function(){var A=this,j=!1,M,w=odf.OdfUtils;this.token=void 0,this.process=function(E){var N=w.getParagraphElement(E.container());return j||(M=N,j=!0),M!==N?!0:(A.token=E.token,!1)}},odf.WordBoundaryFilter=function(A,j){function M(m,R,V){for(var Z=null,ne=A.getRootNode(),ee;m!==ne&&m!==null&&Z===null;)ee=0>R?m.previousSibling:m.nextSibling,V(ee)===NodeFilter.FILTER_ACCEPT&&(Z=ee),m=m.parentNode;return Z}function w(m,R){var V;return m===null?v.NO_NEIGHBOUR:O.isCharacterElement(m)?v.SPACE_CHAR:m.nodeType===E||O.isTextSpan(m)||O.isHyperlink(m)?(V=m.textContent.charAt(R()),I.test(V)?v.SPACE_CHAR:x.test(V)?v.PUNCTUATION_CHAR:v.WORD_CHAR):v.OTHER}var E=Node.TEXT_NODE,N=Node.ELEMENT_NODE,O=odf.OdfUtils,x=/[!-#%-*,-\/:-;?-@\[-\]_{}\u00a1\u00ab\u00b7\u00bb\u00bf;\u00b7\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u169b-\u169c\u16eb-\u16ed\u1735-\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u1944-\u1945\u19de-\u19df\u1a1e-\u1a1f\u1b5a-\u1b60\u1c3b-\u1c3f\u1c7e-\u1c7f\u2000-\u206e\u207d-\u207e\u208d-\u208e\u3008-\u3009\u2768-\u2775\u27c5-\u27c6\u27e6-\u27ef\u2983-\u2998\u29d8-\u29db\u29fc-\u29fd\u2cf9-\u2cfc\u2cfe-\u2cff\u2e00-\u2e7e\u3000-\u303f\u30a0\u30fb\ua60d-\ua60f\ua673\ua67e\ua874-\ua877\ua8ce-\ua8cf\ua92e-\ua92f\ua95f\uaa5c-\uaa5f\ufd3e-\ufd3f\ufe10-\ufe19\ufe30-\ufe52\ufe54-\ufe61\ufe63\ufe68\ufe6a-\ufe6b\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|\ud800[\udd00-\udd01\udf9f\udfd0]|\ud802[\udd1f\udd3f\ude50-\ude58]|\ud809[\udc00-\udc7e]/,I=/\s/,_=core.PositionFilter.FilterResult.FILTER_ACCEPT,S=core.PositionFilter.FilterResult.FILTER_REJECT,u=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,y=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,v={NO_NEIGHBOUR:0,SPACE_CHAR:1,PUNCTUATION_CHAR:2,WORD_CHAR:3,OTHER:4};this.acceptPosition=function(m){var R=m.container(),V=m.leftNode(),Z=m.rightNode(),ne=m.unfilteredDomOffset,ee=function(){return m.unfilteredDomOffset()-1};return R.nodeType===N&&(Z===null&&(Z=M(R,1,m.getNodeFilter())),V===null&&(V=M(R,-1,m.getNodeFilter()))),R!==Z&&(ne=function(){return 0}),R!==V&&V!==null&&(ee=function(){return V.textContent.length-1}),R=w(V,ee),Z=w(Z,ne),R===v.WORD_CHAR&&Z===v.WORD_CHAR||R===v.PUNCTUATION_CHAR&&Z===v.PUNCTUATION_CHAR||j===u&&R!==v.NO_NEIGHBOUR&&Z===v.SPACE_CHAR||j===y&&R===v.SPACE_CHAR&&Z!==v.NO_NEIGHBOUR?S:_}},odf.WordBoundaryFilter.IncludeWhitespace={None:0,TRAILING:1,LEADING:2},gui.SelectionController=function(A,j){function M(F){var re=F.spec();(F.isEdit||re.memberid===j)&&($=void 0,J.cancel())}function w(){var F=V.getCursor(j).getNode();return V.createStepIterator(F,0,[ee,P],V.getRootElement(F))}function E(F,re,W){W=new odf.WordBoundaryFilter(V,W);var ie=V.getRootElement(F)||V.getRootNode(),he=V.createRootFilter(ie);return V.createStepIterator(F,re,[ee,he,W],ie)}function N(F,re){return re?{anchorNode:F.startContainer,anchorOffset:F.startOffset,focusNode:F.endContainer,focusOffset:F.endOffset}:{anchorNode:F.endContainer,anchorOffset:F.endOffset,focusNode:F.startContainer,focusOffset:F.startOffset}}function O(F,re,W){var ie=new ops.OpMoveCursor;return ie.init({memberid:j,position:F,length:re||0,selectionType:W}),ie}function x(F,re,W){var ie;ie=V.getCursor(j),ie=N(ie.getSelectedRange(),ie.hasForwardSelection()),ie.focusNode=F,ie.focusOffset=re,W||(ie.anchorNode=ie.focusNode,ie.anchorOffset=ie.focusOffset),F=V.convertDomToCursorRange(ie),A.enqueue([O(F.position,F.length)])}function I(F){var re;re=E(F.startContainer,F.startOffset,te),re.roundToPreviousStep()&&F.setStart(re.container(),re.offset()),re=E(F.endContainer,F.endOffset,q),re.roundToNextStep()&&F.setEnd(re.container(),re.offset())}function _(F){var W=ne.getParagraphElements(F),re=W[0],W=W[W.length-1];re&&F.setStart(re,0),W&&(ne.isParagraph(F.endContainer)&&F.endOffset===0?F.setEndBefore(W):F.setEnd(W,W.childNodes.length))}function S(F,re,W,ie){var he,ve;ie?(he=W.startContainer,ve=W.startOffset):(he=W.endContainer,ve=W.endOffset),Z.containsNode(F,he)||(ve=0>Z.comparePoints(F,0,he,ve)?0:F.childNodes.length,he=F),F=V.createStepIterator(he,ve,re,ne.getParagraphElement(he)||F),F.roundToClosestStep()||runtime.assert(!1,"No step found in requested range"),ie?W.setStart(F.container(),F.offset()):W.setEnd(F.container(),F.offset())}function u(F,re){var W=w();W.advanceStep(F)&&x(W.container(),W.offset(),re)}function y(F,re){var W,ie=$,he=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];ie===void 0&&Y&&(ie=Y()),isNaN(ie)||(W=w(),z.moveToFilteredStep(W,F,he)&&W.advanceStep(F)&&(he=[new gui.ClosestXOffsetScanner(ie),new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner],z.moveToFilteredStep(W,F,he)&&(x(W.container(),W.offset(),re),$=ie,J.restart())))}function v(F,re){var W=w(),ie=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];z.moveToFilteredStep(W,F,ie)&&x(W.container(),W.offset(),re)}function m(F,re){var W=V.getCursor(j),W=N(W.getSelectedRange(),W.hasForwardSelection()),W=E(W.focusNode,W.focusOffset,te);W.advanceStep(F)&&x(W.container(),W.offset(),re)}function R(F,re,W){var he=!1,ie=V.getCursor(j),ie=N(ie.getSelectedRange(),ie.hasForwardSelection()),he=V.getRootElement(ie.focusNode);runtime.assert(!!he,"SelectionController: Cursor outside root"),ie=V.createStepIterator(ie.focusNode,ie.focusOffset,[ee,P],he),ie.roundToClosestStep(),ie.advanceStep(F)&&(W=W(ie.container()))&&(F===K?(ie.setPosition(W,0),he=ie.roundToNextStep()):(ie.setPosition(W,W.childNodes.length),he=ie.roundToPreviousStep()),he&&x(ie.container(),ie.offset(),re))}var V=A.getOdtDocument(),Z=core.DomUtils,ne=odf.OdfUtils,ee=V.getPositionFilter(),z=new gui.GuiStepUtils,P=V.createRootFilter(j),Y=null,$,J,te=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,q=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,K=core.StepDirection.PREVIOUS,U=core.StepDirection.NEXT;this.selectionToRange=function(F){var re=0<=Z.comparePoints(F.anchorNode,F.anchorOffset,F.focusNode,F.focusOffset),W=F.focusNode.ownerDocument.createRange();return re?(W.setStart(F.anchorNode,F.anchorOffset),W.setEnd(F.focusNode,F.focusOffset)):(W.setStart(F.focusNode,F.focusOffset),W.setEnd(F.anchorNode,F.anchorOffset)),{range:W,hasForwardSelection:re}},this.rangeToSelection=N,this.selectImage=function(F){var W=V.getRootElement(F),re=V.createRootFilter(W),W=V.createStepIterator(F,0,[re,V.getPositionFilter()],W),ie;W.roundToPreviousStep()||runtime.assert(!1,"No walkable position before frame"),re=W.container(),ie=W.offset(),W.setPosition(F,F.childNodes.length),W.roundToNextStep()||runtime.assert(!1,"No walkable position after frame"),F=V.convertDomToCursorRange({anchorNode:re,anchorOffset:ie,focusNode:W.container(),focusOffset:W.offset()}),F=O(F.position,F.length,ops.OdtCursor.RegionSelection),A.enqueue([F])},this.expandToWordBoundaries=I,this.expandToParagraphBoundaries=_,this.selectRange=function(F,re,W){var ie=V.getOdfCanvas().getElement(),he,ve=[ee];he=Z.containsNode(ie,F.startContainer),ie=Z.containsNode(ie,F.endContainer),(he||ie)&&(he&&ie&&(W===2?I(F):3<=W&&_(F)),(W=re?V.getRootElement(F.startContainer):V.getRootElement(F.endContainer))||(W=V.getRootNode()),ve.push(V.createRootFilter(W)),S(W,ve,F,!0),S(W,ve,F,!1),F=N(F,re),re=V.convertDomToCursorRange(F),F=V.getCursorSelection(j),(re.position!==F.position||re.length!==F.length)&&(F=O(re.position,re.length,ops.OdtCursor.RangeSelection),A.enqueue([F])))},this.moveCursorToLeft=function(){return u(K,!1),!0},this.moveCursorToRight=function(){return u(U,!1),!0},this.extendSelectionToLeft=function(){return u(K,!0),!0},this.extendSelectionToRight=function(){return u(U,!0),!0},this.setCaretXPositionLocator=function(F){Y=F},this.moveCursorUp=function(){return y(K,!1),!0},this.moveCursorDown=function(){return y(U,!1),!0},this.extendSelectionUp=function(){return y(K,!0),!0},this.extendSelectionDown=function(){return y(U,!0),!0},this.moveCursorBeforeWord=function(){return m(K,!1),!0},this.moveCursorPastWord=function(){return m(U,!1),!0},this.extendSelectionBeforeWord=function(){return m(K,!0),!0},this.extendSelectionPastWord=function(){return m(U,!0),!0},this.moveCursorToLineStart=function(){return v(K,!1),!0},this.moveCursorToLineEnd=function(){return v(U,!1),!0},this.extendSelectionToLineStart=function(){return v(K,!0),!0},this.extendSelectionToLineEnd=function(){return v(U,!0),!0},this.extendSelectionToParagraphStart=function(){return R(K,!0,ne.getParagraphElement),!0},this.extendSelectionToParagraphEnd=function(){return R(U,!0,ne.getParagraphElement),!0},this.moveCursorToParagraphStart=function(){return R(K,!1,ne.getParagraphElement),!0},this.moveCursorToParagraphEnd=function(){return R(U,!1,ne.getParagraphElement),!0},this.moveCursorToDocumentStart=function(){return R(K,!1,V.getRootElement),!0},this.moveCursorToDocumentEnd=function(){return R(U,!1,V.getRootElement),!0},this.extendSelectionToDocumentStart=function(){return R(K,!0,V.getRootElement),!0},this.extendSelectionToDocumentEnd=function(){return R(U,!0,V.getRootElement),!0},this.extendSelectionToEntireDocument=function(){var F=V.getCursor(j),F=V.getRootElement(F.getNode()),re,W,ie;return runtime.assert(!!F,"SelectionController: Cursor outside root"),ie=V.createStepIterator(F,0,[ee,P],F),ie.roundToClosestStep(),re=ie.container(),W=ie.offset(),ie.setPosition(F,F.childNodes.length),ie.roundToClosestStep(),F=V.convertDomToCursorRange({anchorNode:re,anchorOffset:W,focusNode:ie.container(),focusOffset:ie.offset()}),A.enqueue([O(F.position,F.length)]),!0},this.destroy=function(F){V.unsubscribe(ops.OdtDocument.signalOperationStart,M),core.Async.destroyAll([J.destroy],F)},function(){J=core.Task.createTimeoutTask(function(){$=void 0},2e3),V.subscribe(ops.OdtDocument.signalOperationStart,M)}()},gui.TextController=function(A,j,M,w,E,N){function O(){R=j.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)===!0?M.isLocalCursorWithinOwnAnnotation():!0}function x(ne){ne.getMemberId()===w&&O()}function I(ne,ee,z){var P=[y.getPositionFilter()];return z&&P.push(y.createRootFilter(ne.startContainer)),z=y.createStepIterator(ne.startContainer,ne.startOffset,P,ee),z.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range start"),ee=y.convertDomPointToCursorStep(z.container(),z.offset()),ne.collapsed?ne=ee:(z.setPosition(ne.endContainer,ne.endOffset),z.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range end"),ne=y.convertDomPointToCursorStep(z.container(),z.offset())),{position:ee,length:ne-ee}}function _(ne){var ee,z,P,Y=v.getParagraphElements(ne),$=ne.cloneRange(),J=[];return ee=Y[0],1<Y.length&&(v.hasNoODFContent(ee)&&(ee=Y[Y.length-1]),z=ee.getAttributeNS(odf.Namespaces.textns,"style-name")||""),Y.forEach(function(te,q){var K,U;$.setStart(te,0),$.collapse(!0),K=I($,te,!1).position,0<q&&(U=new ops.OpMergeParagraph,U.init({memberid:w,paragraphStyleName:z,destinationStartPosition:P,sourceStartPosition:K,moveCursor:q===1}),J.unshift(U)),P=K,$.selectNodeContents(te),(K=m.rangeIntersection($,ne))&&(K=I(K,te,!0),0<K.length&&(U=new ops.OpRemoveText,U.init({memberid:w,position:K.position,length:K.length}),J.unshift(U)))}),J}function S(ne){return 0>ne.length&&(ne.position+=ne.length,ne.length=-ne.length),ne}function u(ne){if(!R)return!1;var ee,z=y.getCursor(w).getSelectedRange().cloneRange(),P=S(y.getCursorSelection(w)),Y;if(P.length===0){P=void 0,ee=y.getCursor(w).getNode(),Y=y.getRootElement(ee);var $=[y.getPositionFilter(),y.createRootFilter(Y)];Y=y.createStepIterator(ee,0,$,Y),Y.roundToClosestStep()&&(ne?Y.nextStep():Y.previousStep())&&(P=S(y.convertDomToCursorRange({anchorNode:ee,anchorOffset:0,focusNode:Y.container(),focusOffset:Y.offset()})),ne?(z.setStart(ee,0),z.setEnd(Y.container(),Y.offset())):(z.setStart(Y.container(),Y.offset()),z.setEnd(ee,0)))}return P&&A.enqueue(_(z)),P!==void 0}var y=A.getOdtDocument(),v=odf.OdfUtils,m=core.DomUtils,R=!1,V=odf.Namespaces.textns,Z=core.StepDirection.NEXT;this.isEnabled=function(){return R},this.enqueueParagraphSplittingOps=function(){if(!R)return!1;var P=y.getCursor(w),ne=P.getSelectedRange(),ee=S(y.getCursorSelection(w)),z=[],P=v.getParagraphElement(P.getNode()),Y=P.getAttributeNS(V,"style-name")||"";return 0<ee.length&&(z=z.concat(_(ne))),ne=new ops.OpSplitParagraph,ne.init({memberid:w,position:ee.position,paragraphStyleName:Y,sourceParagraphPosition:y.convertDomPointToCursorStep(P,0,Z),moveCursor:!0}),z.push(ne),N&&(ee=N(ee.position+1),z=z.concat(ee)),A.enqueue(z),!0},this.removeTextByBackspaceKey=function(){return u(!1)},this.removeTextByDeleteKey=function(){return u(!0)},this.removeCurrentSelection=function(){if(!R)return!1;var ne=y.getCursor(w).getSelectedRange();return A.enqueue(_(ne)),!0},this.insertText=function(ne){if(R){var ee=y.getCursor(w).getSelectedRange(),z=S(y.getCursorSelection(w)),P=[],Y=!1;0<z.length&&(P=P.concat(_(ee)),Y=!0),ee=new ops.OpInsertText,ee.init({memberid:w,position:z.position,text:ne,moveCursor:!0}),P.push(ee),E&&(ne=E(z.position,ne.length,Y))&&P.push(ne),A.enqueue(P)}},this.destroy=function(ne){y.unsubscribe(ops.Document.signalCursorMoved,x),j.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,O),ne()},y.subscribe(ops.Document.signalCursorMoved,x),j.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,O),O()},gui.UndoManager=function(){},gui.UndoManager.prototype.subscribe=function(A,j){},gui.UndoManager.prototype.unsubscribe=function(A,j){},gui.UndoManager.prototype.setDocument=function(A){},gui.UndoManager.prototype.setInitialState=function(){},gui.UndoManager.prototype.initialize=function(){},gui.UndoManager.prototype.purgeInitialState=function(){},gui.UndoManager.prototype.setPlaybackFunction=function(A){},gui.UndoManager.prototype.hasUndoStates=function(){},gui.UndoManager.prototype.hasRedoStates=function(){},gui.UndoManager.prototype.moveForward=function(A){},gui.UndoManager.prototype.moveBackward=function(A){},gui.UndoManager.prototype.onOperationExecuted=function(A){},gui.UndoManager.prototype.isDocumentModified=function(){},gui.UndoManager.prototype.setDocumentModified=function(A){},gui.UndoManager.signalUndoStackChanged="undoStackChanged",gui.UndoManager.signalUndoStateCreated="undoStateCreated",gui.UndoManager.signalUndoStateModified="undoStateModified",gui.UndoManager.signalDocumentModifiedChanged="documentModifiedChanged",gui.SessionControllerOptions=function(){this.annotationsEnabled=this.directParagraphStylingEnabled=this.directTextStylingEnabled=!1},function(){var A=core.PositionFilter.FilterResult.FILTER_ACCEPT;gui.SessionController=function(j,M,w,E){function N(je,Xe){var _t=ie.getDOMDocument(),fe=null;return _t.caretRangeFromPoint?(_t=_t.caretRangeFromPoint(je,Xe),fe={container:_t.startContainer,offset:_t.startOffset}):_t.caretPositionFromPoint&&(_t=_t.caretPositionFromPoint(je,Xe))&&_t.offsetNode&&(fe={container:_t.offsetNode,offset:_t.offset}),fe}function O(je){var Xe=ie.getCursor(M).getSelectedRange();Xe.collapsed?je.preventDefault():le.setDataFromRange(je,Xe)?ut.removeCurrentSelection():runtime.log("Cut operation failed")}function x(){return ie.getCursor(M).getSelectedRange().collapsed!==!1}function I(je){var Xe=ie.getCursor(M).getSelectedRange();Xe.collapsed?je.preventDefault():le.setDataFromRange(je,Xe)||runtime.log("Copy operation failed")}function _(je){var Xe;W.clipboardData&&W.clipboardData.getData?Xe=W.clipboardData.getData("Text"):je.clipboardData&&je.clipboardData.getData&&(Xe=je.clipboardData.getData("text/plain")),Xe&&(ut.removeCurrentSelection(),Rt.paste(Xe)),je.preventDefault?je.preventDefault():je.returnValue=!1}function S(){return!1}function u(je){$e&&$e.onOperationExecuted(je)}function y(je){ie.emit(ops.OdtDocument.signalUndoStackChanged,je)}function v(){var je;return $e?(je=ue.hasFocus(),$e.moveBackward(1),je&&ue.focus(),!0):!1}function m(){var je;return $e?(je=ue.hasFocus(),$e.moveForward(1),je&&ue.focus(),!0):!1}function R(je){var Xe=ie.getCursor(M).getSelectedRange(),_t=(je.target||je.srcElement||null).getAttribute("end");Xe&&_t&&(je=N(je.clientX,je.clientY))&&(At.setUnfilteredPosition(je.container,je.offset),Ve.acceptPosition(At)===A&&(Xe=Xe.cloneRange(),_t==="left"?Xe.setStart(At.container(),At.unfilteredDomOffset()):Xe.setEnd(At.container(),At.unfilteredDomOffset()),w.setSelectedRange(Xe,_t==="right"),ie.emit(ops.Document.signalCursorMoved,w)))}function V(){at.selectRange(w.getSelectedRange(),w.hasForwardSelection(),1)}function Z(){var je=W.getSelection(),Xe=0<je.rangeCount&&at.selectionToRange(je);Re&&Xe&&(ke=!0,yt.clearSelection(),At.setUnfilteredPosition(je.focusNode,je.focusOffset),Ve.acceptPosition(At)===A&&(et===2?at.expandToWordBoundaries(Xe.range):3<=et&&at.expandToParagraphBoundaries(Xe.range),w.setSelectedRange(Xe.range,Xe.hasForwardSelection),ie.emit(ops.Document.signalCursorMoved,w)))}function ne(je){var Xe=je.target||je.srcElement||null,_t=ie.getCursor(M);(Re=Xe!==null&&Ne.containsNode(ie.getOdfCanvas().getElement(),Xe))&&(ke=!1,Xe=ie.getRootElement(Xe)||ie.getRootNode(),Ve=ie.createRootFilter(Xe),et=je.button===0?je.detail:0,_t&&je.shiftKey?W.getSelection().collapse(_t.getAnchorNode(),0):(je=W.getSelection(),Xe=_t.getSelectedRange(),je.extend?_t.hasForwardSelection()?(je.collapse(Xe.startContainer,Xe.startOffset),je.extend(Xe.endContainer,Xe.endOffset)):(je.collapse(Xe.endContainer,Xe.endOffset),je.extend(Xe.startContainer,Xe.startOffset)):(je.removeAllRanges(),je.addRange(Xe.cloneRange()))),1<et&&Z())}function ee(je){var _t=ie.getRootElement(je),Xe=ie.createRootFilter(_t),_t=ie.createStepIterator(je,0,[Xe,ie.getPositionFilter()],_t);return _t.setPosition(je,je.childNodes.length),_t.roundToNextStep()?{container:_t.container(),offset:_t.offset()}:null}function z(je){var Xe;Xe=(Xe=W.getSelection())?{anchorNode:Xe.anchorNode,anchorOffset:Xe.anchorOffset,focusNode:Xe.focusNode,focusOffset:Xe.focusOffset}:null;var _t=W.getSelection().isCollapsed,fe,tt;Xe.anchorNode||Xe.focusNode||!(fe=N(je.clientX,je.clientY))||(Xe.anchorNode=fe.container,Xe.anchorOffset=fe.offset,Xe.focusNode=Xe.anchorNode,Xe.focusOffset=Xe.anchorOffset),ze.isImage(Xe.focusNode)&&Xe.focusOffset===0&&ze.isCharacterFrame(Xe.focusNode.parentNode)?(tt=Xe.focusNode.parentNode,fe=tt.getBoundingClientRect(),je.clientX>fe.left&&(fe=ee(tt))&&(Xe.focusNode=fe.container,Xe.focusOffset=fe.offset,_t&&(Xe.anchorNode=Xe.focusNode,Xe.anchorOffset=Xe.focusOffset))):ze.isImage(Xe.focusNode.firstChild)&&Xe.focusOffset===1&&ze.isCharacterFrame(Xe.focusNode)&&(fe=ee(Xe.focusNode))&&(Xe.anchorNode=Xe.focusNode=fe.container,Xe.anchorOffset=Xe.focusOffset=fe.offset),Xe.anchorNode&&Xe.focusNode&&(Xe=at.selectionToRange(Xe),at.selectRange(Xe.range,Xe.hasForwardSelection,je.button===0?je.detail:0)),ue.focus()}function P(je){var Xe;(Xe=N(je.clientX,je.clientY))&&(je=Xe.container,Xe=Xe.offset,je={anchorNode:je,anchorOffset:Xe,focusNode:je,focusOffset:Xe},je=at.selectionToRange(je),at.selectRange(je.range,je.hasForwardSelection,2),ue.focus())}function Y(je){var Xe=je.target||je.srcElement||null,_t,fe,tt;ri.processRequests(),Re&&(ze.isImage(Xe)&&ze.isCharacterFrame(Xe.parentNode)&&W.getSelection().isCollapsed?(at.selectImage(Xe.parentNode),ue.focus()):yt.isSelectorElement(Xe)?ue.focus():ke?(Xe=w.getSelectedRange(),fe=Xe.collapsed,ze.isImage(Xe.endContainer)&&Xe.endOffset===0&&ze.isCharacterFrame(Xe.endContainer.parentNode)&&(tt=Xe.endContainer.parentNode,tt=ee(tt))&&(Xe.setEnd(tt.container,tt.offset),fe&&Xe.collapse(!1)),at.selectRange(Xe,w.hasForwardSelection(),je.button===0?je.detail:0),ue.focus()):ki?z(je):(_t=Ne.cloneEvent(je),We=runtime.setTimeout(function(){z(_t)},0)),et=0,ke=Re=!1)}function $(je){var Xe=ie.getCursor(M).getSelectedRange();Xe.collapsed||rt.exportRangeToDataTransfer(je.dataTransfer,Xe)}function J(){Re&&ue.focus(),et=0,ke=Re=!1}function te(je){Y(je)}function q(je){var Xe=je.target||je.srcElement||null,_t=null;Xe.className==="annotationRemoveButton"?(runtime.assert(Se,"Remove buttons are displayed on annotations while annotation editing is disabled in the controller."),_t=Xe.parentNode.getElementsByTagNameNS(odf.Namespaces.officens,"annotation").item(0),be.removeAnnotation(_t),ue.focus()):Xe.getAttribute("class")!=="webodf-draggable"&&Y(je)}function K(je){(je=je.data)&&(je.indexOf(`
`)===-1?ut.insertText(je):Rt.paste(je))}function U(je){return function(){return je(),!0}}function F(je){return function(Xe){return ie.getCursor(M).getSelectionType()===ops.OdtCursor.RangeSelection?je(Xe):!0}}function re(je){ue.unsubscribe("keydown",me.handleEvent),ue.unsubscribe("keypress",De.handleEvent),ue.unsubscribe("keyup",Me.handleEvent),ue.unsubscribe("copy",I),ue.unsubscribe("mousedown",ne),ue.unsubscribe("mousemove",ri.trigger),ue.unsubscribe("mouseup",q),ue.unsubscribe("contextmenu",te),ue.unsubscribe("dragstart",$),ue.unsubscribe("dragend",J),ue.unsubscribe("click",ct.handleClick),ue.unsubscribe("longpress",P),ue.unsubscribe("drag",R),ue.unsubscribe("dragstop",V),ie.unsubscribe(ops.OdtDocument.signalOperationEnd,$t.trigger),ie.unsubscribe(ops.Document.signalCursorAdded,zt.registerCursor),ie.unsubscribe(ops.Document.signalCursorRemoved,zt.removeCursor),ie.unsubscribe(ops.OdtDocument.signalOperationEnd,u),je()}var W=runtime.getWindow(),ie=j.getOdtDocument(),he=new gui.SessionConstraints,ve=new gui.SessionContext(j,M),Ne=core.DomUtils,ze=odf.OdfUtils,rt=new gui.MimeDataExporter,le=new gui.Clipboard(rt),me=new gui.KeyboardHandler,De=new gui.KeyboardHandler,Me=new gui.KeyboardHandler,Re=!1,we=new odf.ObjectNameGenerator(ie.getOdfCanvas().odfContainer(),M),ke=!1,Ve=null,We,$e=null,ue=new gui.EventManager(ie),Se=E.annotationsEnabled,be=new gui.AnnotationController(j,he,M),Fe=new gui.DirectFormattingController(j,he,ve,M,we,E.directTextStylingEnabled,E.directParagraphStylingEnabled),ut=new gui.TextController(j,he,ve,M,Fe.createCursorStyleOp,Fe.createParagraphStyleOps),Pt=new gui.ImageController(j,he,ve,M,we),yt=new gui.ImageSelector(ie.getOdfCanvas()),At=ie.createPositionIterator(ie.getRootNode()),ri,$t,Rt=new gui.PasteController(j,he,ve,M),zt=new gui.InputMethodEditor(M,ue),et=0,ct=new gui.HyperlinkClickHandler(ie.getOdfCanvas().getElement,me,Me),It=new gui.HyperlinkController(j,he,ve,M),at=new gui.SelectionController(j,M),vt=new gui.MetadataController(j,M),Ke=gui.KeyboardHandler.Modifier,Je=gui.KeyboardHandler.KeyCode,ei=W.navigator.appVersion.toLowerCase().indexOf("mac")!==-1,ki=["iPad","iPod","iPhone"].indexOf(W.navigator.platform)!==-1,ti;runtime.assert(W!==null,"Expected to be run in an environment which has a global window, like a browser."),this.undo=v,this.redo=m,this.insertLocalCursor=function(){runtime.assert(j.getOdtDocument().getCursor(M)===void 0,"Inserting local cursor a second time.");var je=new ops.OpAddCursor;je.init({memberid:M}),j.enqueue([je]),ue.focus()},this.removeLocalCursor=function(){runtime.assert(j.getOdtDocument().getCursor(M)!==void 0,"Removing local cursor without inserting before.");var je=new ops.OpRemoveCursor;je.init({memberid:M}),j.enqueue([je])},this.startEditing=function(){zt.subscribe(gui.InputMethodEditor.signalCompositionStart,ut.removeCurrentSelection),zt.subscribe(gui.InputMethodEditor.signalCompositionEnd,K),ue.subscribe("beforecut",x),ue.subscribe("cut",O),ue.subscribe("beforepaste",S),ue.subscribe("paste",_),$e&&$e.initialize(),ue.setEditing(!0),ct.setModifier(ei?Ke.Meta:Ke.Ctrl),me.bind(Je.Backspace,Ke.None,U(ut.removeTextByBackspaceKey),!0),me.bind(Je.Delete,Ke.None,ut.removeTextByDeleteKey),me.bind(Je.Tab,Ke.None,F(function(){return ut.insertText("	"),!0})),ei?(me.bind(Je.Clear,Ke.None,ut.removeCurrentSelection),me.bind(Je.B,Ke.Meta,F(Fe.toggleBold)),me.bind(Je.I,Ke.Meta,F(Fe.toggleItalic)),me.bind(Je.U,Ke.Meta,F(Fe.toggleUnderline)),me.bind(Je.L,Ke.MetaShift,F(Fe.alignParagraphLeft)),me.bind(Je.E,Ke.MetaShift,F(Fe.alignParagraphCenter)),me.bind(Je.R,Ke.MetaShift,F(Fe.alignParagraphRight)),me.bind(Je.J,Ke.MetaShift,F(Fe.alignParagraphJustified)),Se&&me.bind(Je.C,Ke.MetaShift,be.addAnnotation),me.bind(Je.Z,Ke.Meta,v),me.bind(Je.Z,Ke.MetaShift,m)):(me.bind(Je.B,Ke.Ctrl,F(Fe.toggleBold)),me.bind(Je.I,Ke.Ctrl,F(Fe.toggleItalic)),me.bind(Je.U,Ke.Ctrl,F(Fe.toggleUnderline)),me.bind(Je.L,Ke.CtrlShift,F(Fe.alignParagraphLeft)),me.bind(Je.E,Ke.CtrlShift,F(Fe.alignParagraphCenter)),me.bind(Je.R,Ke.CtrlShift,F(Fe.alignParagraphRight)),me.bind(Je.J,Ke.CtrlShift,F(Fe.alignParagraphJustified)),Se&&me.bind(Je.C,Ke.CtrlAlt,be.addAnnotation),me.bind(Je.Z,Ke.Ctrl,v),me.bind(Je.Z,Ke.CtrlShift,m)),De.setDefault(F(function(je){var Xe;return Xe=je.which===null||je.which===void 0?String.fromCharCode(je.keyCode):je.which!==0&&je.charCode!==0?String.fromCharCode(je.which):null,!Xe||je.altKey||je.ctrlKey||je.metaKey?!1:(ut.insertText(Xe),!0)})),De.bind(Je.Enter,Ke.None,F(ut.enqueueParagraphSplittingOps))},this.endEditing=function(){zt.unsubscribe(gui.InputMethodEditor.signalCompositionStart,ut.removeCurrentSelection),zt.unsubscribe(gui.InputMethodEditor.signalCompositionEnd,K),ue.unsubscribe("cut",O),ue.unsubscribe("beforecut",x),ue.unsubscribe("paste",_),ue.unsubscribe("beforepaste",S),ue.setEditing(!1),ct.setModifier(Ke.None),me.bind(Je.Backspace,Ke.None,function(){return!0},!0),me.unbind(Je.Delete,Ke.None),me.unbind(Je.Tab,Ke.None),ei?(me.unbind(Je.Clear,Ke.None),me.unbind(Je.B,Ke.Meta),me.unbind(Je.I,Ke.Meta),me.unbind(Je.U,Ke.Meta),me.unbind(Je.L,Ke.MetaShift),me.unbind(Je.E,Ke.MetaShift),me.unbind(Je.R,Ke.MetaShift),me.unbind(Je.J,Ke.MetaShift),Se&&me.unbind(Je.C,Ke.MetaShift),me.unbind(Je.Z,Ke.Meta),me.unbind(Je.Z,Ke.MetaShift)):(me.unbind(Je.B,Ke.Ctrl),me.unbind(Je.I,Ke.Ctrl),me.unbind(Je.U,Ke.Ctrl),me.unbind(Je.L,Ke.CtrlShift),me.unbind(Je.E,Ke.CtrlShift),me.unbind(Je.R,Ke.CtrlShift),me.unbind(Je.J,Ke.CtrlShift),Se&&me.unbind(Je.C,Ke.CtrlAlt),me.unbind(Je.Z,Ke.Ctrl),me.unbind(Je.Z,Ke.CtrlShift)),De.setDefault(null),De.unbind(Je.Enter,Ke.None)},this.getInputMemberId=function(){return M},this.getSession=function(){return j},this.getSessionConstraints=function(){return he},this.setUndoManager=function(je){$e&&$e.unsubscribe(gui.UndoManager.signalUndoStackChanged,y),($e=je)&&($e.setDocument(ie),$e.setPlaybackFunction(j.enqueue),$e.subscribe(gui.UndoManager.signalUndoStackChanged,y))},this.getUndoManager=function(){return $e},this.getMetadataController=function(){return vt},this.getAnnotationController=function(){return be},this.getDirectFormattingController=function(){return Fe},this.getHyperlinkClickHandler=function(){return ct},this.getHyperlinkController=function(){return It},this.getImageController=function(){return Pt},this.getSelectionController=function(){return at},this.getTextController=function(){return ut},this.getEventManager=function(){return ue},this.getKeyboardHandlers=function(){return{keydown:me,keypress:De}},this.destroy=function(je){var Xe=[ri.destroy,$t.destroy,Fe.destroy,zt.destroy,ue.destroy,ct.destroy,It.destroy,vt.destroy,at.destroy,ut.destroy,re];ti&&Xe.unshift(ti.destroy),runtime.clearTimeout(We),core.Async.destroyAll(Xe,je)},ri=core.Task.createRedrawTask(Z),$t=core.Task.createRedrawTask(function(){var je=ie.getCursor(M);if(je&&je.getSelectionType()===ops.OdtCursor.RegionSelection&&(je=ze.getImageElements(je.getSelectedRange())[0])){yt.select(je.parentNode);return}yt.clearSelection()}),me.bind(Je.Left,Ke.None,F(at.moveCursorToLeft)),me.bind(Je.Right,Ke.None,F(at.moveCursorToRight)),me.bind(Je.Up,Ke.None,F(at.moveCursorUp)),me.bind(Je.Down,Ke.None,F(at.moveCursorDown)),me.bind(Je.Left,Ke.Shift,F(at.extendSelectionToLeft)),me.bind(Je.Right,Ke.Shift,F(at.extendSelectionToRight)),me.bind(Je.Up,Ke.Shift,F(at.extendSelectionUp)),me.bind(Je.Down,Ke.Shift,F(at.extendSelectionDown)),me.bind(Je.Home,Ke.None,F(at.moveCursorToLineStart)),me.bind(Je.End,Ke.None,F(at.moveCursorToLineEnd)),me.bind(Je.Home,Ke.Ctrl,F(at.moveCursorToDocumentStart)),me.bind(Je.End,Ke.Ctrl,F(at.moveCursorToDocumentEnd)),me.bind(Je.Home,Ke.Shift,F(at.extendSelectionToLineStart)),me.bind(Je.End,Ke.Shift,F(at.extendSelectionToLineEnd)),me.bind(Je.Up,Ke.CtrlShift,F(at.extendSelectionToParagraphStart)),me.bind(Je.Down,Ke.CtrlShift,F(at.extendSelectionToParagraphEnd)),me.bind(Je.Home,Ke.CtrlShift,F(at.extendSelectionToDocumentStart)),me.bind(Je.End,Ke.CtrlShift,F(at.extendSelectionToDocumentEnd)),ei?(me.bind(Je.Left,Ke.Alt,F(at.moveCursorBeforeWord)),me.bind(Je.Right,Ke.Alt,F(at.moveCursorPastWord)),me.bind(Je.Left,Ke.Meta,F(at.moveCursorToLineStart)),me.bind(Je.Right,Ke.Meta,F(at.moveCursorToLineEnd)),me.bind(Je.Home,Ke.Meta,F(at.moveCursorToDocumentStart)),me.bind(Je.End,Ke.Meta,F(at.moveCursorToDocumentEnd)),me.bind(Je.Left,Ke.AltShift,F(at.extendSelectionBeforeWord)),me.bind(Je.Right,Ke.AltShift,F(at.extendSelectionPastWord)),me.bind(Je.Left,Ke.MetaShift,F(at.extendSelectionToLineStart)),me.bind(Je.Right,Ke.MetaShift,F(at.extendSelectionToLineEnd)),me.bind(Je.Up,Ke.AltShift,F(at.extendSelectionToParagraphStart)),me.bind(Je.Down,Ke.AltShift,F(at.extendSelectionToParagraphEnd)),me.bind(Je.Up,Ke.MetaShift,F(at.extendSelectionToDocumentStart)),me.bind(Je.Down,Ke.MetaShift,F(at.extendSelectionToDocumentEnd)),me.bind(Je.A,Ke.Meta,F(at.extendSelectionToEntireDocument))):(me.bind(Je.Left,Ke.Ctrl,F(at.moveCursorBeforeWord)),me.bind(Je.Right,Ke.Ctrl,F(at.moveCursorPastWord)),me.bind(Je.Left,Ke.CtrlShift,F(at.extendSelectionBeforeWord)),me.bind(Je.Right,Ke.CtrlShift,F(at.extendSelectionPastWord)),me.bind(Je.A,Ke.Ctrl,F(at.extendSelectionToEntireDocument))),ki&&(ti=new gui.IOSSafariSupport(ue)),ue.subscribe("keydown",me.handleEvent),ue.subscribe("keypress",De.handleEvent),ue.subscribe("keyup",Me.handleEvent),ue.subscribe("copy",I),ue.subscribe("mousedown",ne),ue.subscribe("mousemove",ri.trigger),ue.subscribe("mouseup",q),ue.subscribe("contextmenu",te),ue.subscribe("dragstart",$),ue.subscribe("dragend",J),ue.subscribe("click",ct.handleClick),ue.subscribe("longpress",P),ue.subscribe("drag",R),ue.subscribe("dragstop",V),ie.subscribe(ops.OdtDocument.signalOperationEnd,$t.trigger),ie.subscribe(ops.Document.signalCursorAdded,zt.registerCursor),ie.subscribe(ops.Document.signalCursorRemoved,zt.removeCursor),ie.subscribe(ops.OdtDocument.signalOperationEnd,u)}}(),gui.CaretManager=function(A,j){function M(_){return N.hasOwnProperty(_)?N[_]:null}function w(){return Object.keys(N).map(function(_){return N[_]})}function E(_){var S=N[_];S&&(delete N[_],_===A.getInputMemberId()?(x.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,S.ensureVisible),x.unsubscribe(ops.Document.signalCursorMoved,S.refreshCursorBlinking),I.unsubscribe("compositionupdate",S.handleUpdate),I.unsubscribe("compositionend",S.handleUpdate),I.unsubscribe("focus",S.setFocus),I.unsubscribe("blur",S.removeFocus),O.removeEventListener("focus",S.show,!1),O.removeEventListener("blur",S.hide,!1)):x.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,S.handleUpdate),S.destroy(function(){}))}var N={},O=runtime.getWindow(),x=A.getSession().getOdtDocument(),I=A.getEventManager();this.registerCursor=function(_,S,u){var y=_.getMemberId();return _=new gui.Caret(_,j,S,u),N[y]=_,y===A.getInputMemberId()?(runtime.log("Starting to track input on new cursor of "+y),x.subscribe(ops.OdtDocument.signalProcessingBatchEnd,_.ensureVisible),x.subscribe(ops.Document.signalCursorMoved,_.refreshCursorBlinking),I.subscribe("compositionupdate",_.handleUpdate),I.subscribe("compositionend",_.handleUpdate),I.subscribe("focus",_.setFocus),I.subscribe("blur",_.removeFocus),O.addEventListener("focus",_.show,!1),O.addEventListener("blur",_.hide,!1),_.setOverlayElement(I.getEventTrap())):x.subscribe(ops.OdtDocument.signalProcessingBatchEnd,_.handleUpdate),_},this.getCaret=M,this.getCarets=w,this.destroy=function(_){var S=w().map(function(u){return u.destroy});A.getSelectionController().setCaretXPositionLocator(null),x.unsubscribe(ops.Document.signalCursorRemoved,E),N={},core.Async.destroyAll(S,_)},A.getSelectionController().setCaretXPositionLocator(function(){var _=M(A.getInputMemberId()),S;return _&&(S=_.getBoundingClientRect()),S?S.right:void 0}),x.subscribe(ops.Document.signalCursorRemoved,E)},gui.EditInfoHandle=function(A){var j=[],M,w=A.ownerDocument,E=w.documentElement.namespaceURI;this.setEdits=function(N){j=N;var O,x,I,_;for(core.DomUtils.removeAllChildNodes(M),N=0;N<j.length;N+=1)O=w.createElementNS(E,"div"),O.className="editInfo",x=w.createElementNS(E,"span"),x.className="editInfoColor",x.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",j[N].memberid),I=w.createElementNS(E,"span"),I.className="editInfoAuthor",I.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",j[N].memberid),_=w.createElementNS(E,"span"),_.className="editInfoTime",_.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",j[N].memberid),_.appendChild(w.createTextNode(j[N].time.toString())),O.appendChild(x),O.appendChild(I),O.appendChild(_),M.appendChild(O)},this.show=function(){M.style.display="block"},this.hide=function(){M.style.display="none"},this.destroy=function(N){A.removeChild(M),N()},M=w.createElementNS(E,"div"),M.setAttribute("class","editInfoHandle"),M.style.display="none",A.appendChild(M)},ops.EditInfo=function(A,j){function M(){var N=[],O;for(O in E)E.hasOwnProperty(O)&&N.push({memberid:O,time:E[O].time});return N.sort(function(x,I){return x.time-I.time}),N}var w,E={};this.getNode=function(){return w},this.getOdtDocument=function(){return j},this.getEdits=function(){return E},this.getSortedEdits=function(){return M()},this.addEdit=function(N,O){E[N]={time:O}},this.clearEdits=function(){E={}},this.destroy=function(N){A.parentNode&&A.removeChild(w),N()},w=j.getDOMDocument().createElementNS("urn:webodf:names:editinfo","editinfo"),A.insertBefore(w,A.firstChild)},gui.EditInfoMarker=function(A,j){function M(S,u){return runtime.setTimeout(function(){O.style.opacity=S},u)}var w=this,E,N,O,x,I,_;this.addEdit=function(S,u){var y=Date.now()-u;A.addEdit(S,u),N.setEdits(A.getSortedEdits()),O.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",S),runtime.clearTimeout(I),runtime.clearTimeout(_),1e4>y?(x=M(1,0),I=M(.5,1e4-y),_=M(.2,2e4-y)):1e4<=y&&2e4>y?(x=M(.5,0),_=M(.2,2e4-y)):x=M(.2,0)},this.getEdits=function(){return A.getEdits()},this.clearEdits=function(){A.clearEdits(),N.setEdits([]),O.hasAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")&&O.removeAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")},this.getEditInfo=function(){return A},this.show=function(){O.style.display="block"},this.hide=function(){w.hideHandle(),O.style.display="none"},this.showHandle=function(){N.show()},this.hideHandle=function(){N.hide()},this.destroy=function(S){runtime.clearTimeout(x),runtime.clearTimeout(I),runtime.clearTimeout(_),E.removeChild(O),N.destroy(function(u){u?S(u):A.destroy(S)})},function(){var S=A.getOdtDocument().getDOMDocument();O=S.createElementNS(S.documentElement.namespaceURI,"div"),O.setAttribute("class","editInfoMarker"),O.onmouseover=function(){w.showHandle()},O.onmouseout=function(){w.hideHandle()},E=A.getNode(),E.appendChild(O),N=new gui.EditInfoHandle(E),j||w.hide()}()},gui.HyperlinkTooltipView=function(A,j){var M=core.DomUtils,w=odf.OdfUtils,E=runtime.getWindow(),N,O,x;runtime.assert(E!==null,"Expected to be run in an environment which has a global window, like a browser."),this.showTooltip=function(I){var _=I.target||I.srcElement,S=A.getSizer(),u=A.getZoomLevel(),y;e:{for(;_;){if(w.isHyperlink(_))break e;if(w.isParagraph(_)||w.isInlineRoot(_))break;_=_.parentNode}_=null}if(_){M.containsNode(S,x)||S.appendChild(x),y=O;var v;switch(j()){case gui.KeyboardHandler.Modifier.Ctrl:v=runtime.tr("Ctrl-click to follow link");break;case gui.KeyboardHandler.Modifier.Meta:v=runtime.tr("\u2318-click to follow link");break;default:v=""}y.textContent=v,N.textContent=w.getHyperlinkTarget(_),x.style.display="block",y=E.innerWidth-x.offsetWidth-15,_=I.clientX>y?y:I.clientX+15,y=E.innerHeight-x.offsetHeight-10,I=I.clientY>y?y:I.clientY+10,S=S.getBoundingClientRect(),_=(_-S.left)/u,I=(I-S.top)/u,x.style.left=_+"px",x.style.top=I+"px"}},this.hideTooltip=function(){x.style.display="none"},this.destroy=function(I){x.parentNode&&x.parentNode.removeChild(x),I()},function(){var I=A.getElement().ownerDocument;N=I.createElement("span"),O=I.createElement("span"),N.className="webodf-hyperlinkTooltipLink",O.className="webodf-hyperlinkTooltipText",x=I.createElement("div"),x.className="webodf-hyperlinkTooltip",x.appendChild(N),x.appendChild(O),A.getElement().appendChild(x)}()},gui.OdfFieldView=function(A){function j(){var N=odf.OdfSchema.getFields().map(function(O){return O.replace(":","|")}),E=N.join(`,
`)+`
{ background-color: #D0D0D0; }
`,N=N.map(function(O){return O+":empty::after"}).join(`,
`)+`
{ content:' '; white-space: pre; }
`;return E+`
`+N}var M,w=A.getElement().ownerDocument;this.showFieldHighlight=function(){M.appendChild(w.createTextNode(j()))},this.hideFieldHighlight=function(){for(var E=M.sheet,N=E.cssRules;N.length;)E.deleteRule(N.length-1)},this.destroy=function(E){M.parentNode&&M.parentNode.removeChild(M),E()},M=function(){var E=w.getElementsByTagName("head").item(0),N=w.createElement("style"),O="";return N.type="text/css",N.media="screen, print, handheld, projection",odf.Namespaces.forEachPrefix(function(x,I){O+="@namespace "+x+" url("+I+`);
`}),N.appendChild(w.createTextNode(O)),E.appendChild(N),N}()},gui.ShadowCursor=function(A){var j=A.getDOMDocument().createRange(),M=!0;this.removeFromDocument=function(){},this.getMemberId=function(){return gui.ShadowCursor.ShadowCursorMemberId},this.getSelectedRange=function(){return j},this.setSelectedRange=function(w,E){j=w,M=E!==!1},this.hasForwardSelection=function(){return M},this.getDocument=function(){return A},this.getSelectionType=function(){return ops.OdtCursor.RangeSelection},j.setStart(A.getRootNode(),0)},gui.ShadowCursor.ShadowCursorMemberId="",gui.SelectionView=function(A){},gui.SelectionView.prototype.rerender=function(){},gui.SelectionView.prototype.show=function(){},gui.SelectionView.prototype.hide=function(){},gui.SelectionView.prototype.destroy=function(A){},gui.SelectionViewManager=function(A){function j(){return Object.keys(M).map(function(w){return M[w]})}var M={};this.getSelectionView=function(w){return M.hasOwnProperty(w)?M[w]:null},this.getSelectionViews=j,this.removeSelectionView=function(w){M.hasOwnProperty(w)&&(M[w].destroy(function(){}),delete M[w])},this.hideSelectionView=function(w){M.hasOwnProperty(w)&&M[w].hide()},this.showSelectionView=function(w){M.hasOwnProperty(w)&&M[w].show()},this.rerenderSelectionViews=function(){Object.keys(M).forEach(function(w){M[w].rerender()})},this.registerCursor=function(w,E){var N=w.getMemberId(),O=new A(w);return E?O.show():O.hide(),M[N]=O},this.destroy=function(w){function E(O,x){x?w(x):O<N.length?N[O].destroy(function(I){E(O+1,I)}):w()}var N=j();E(0,void 0)}},gui.SessionViewOptions=function(){this.caretBlinksOnRangeSelect=this.caretAvatarsInitiallyVisible=this.editInfoMarkersInitiallyVisible=!0},function(){function A(j,M){return j!==void 0?!!j:M}gui.SessionView=function(j,M,w,E,N,O){function x(U){U.memberId===M&&$.getViewport().scrollIntoView(U.annotation.getBoundingClientRect())}function I(){var U=document.getElementsByTagName("head").item(0),F=document.createElement("style");return F.type="text/css",F.media="screen, print, handheld, projection",U.appendChild(F),F}function _(U,F,re){function W(ie,he,ve){he=ie+'[editinfo|memberid="'+U+'"]'+ve+he;e:{var Ne=ee.firstChild;for(ie=ie+'[editinfo|memberid="'+U+'"]'+ve+"{";Ne;){if(Ne.nodeType===Node.TEXT_NODE&&Ne.data.indexOf(ie)===0){ie=Ne;break e}Ne=Ne.nextSibling}ie=null}ie?ie.data=he:ee.appendChild(document.createTextNode(he))}W("div.editInfoMarker","{ background-color: "+re+"; }",""),W("span.editInfoColor","{ background-color: "+re+"; }",""),W("span.editInfoAuthor",'{ content: "'+F+'"; }',":before"),W("dc|creator","{ background-color: "+re+"; }",""),W(".webodf-selectionOverlay","{ fill: "+re+"; stroke: "+re+";}",""),U===M&&(W(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"),U=gui.ShadowCursor.ShadowCursorMemberId,W(".webodf-selectionOverlay","{ fill: "+re+"; stroke: "+re+";}",""),W(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"))}function S(U){var F,re;for(re in P)P.hasOwnProperty(re)&&(F=P[re],U?F.show():F.hide())}function u(U){N.getCarets().forEach(function(F){U?F.showHandle():F.hideHandle()})}function y(U){var F=U.getMemberId();U=U.getProperties(),_(F,U.fullName,U.color)}function v(U){var F=U.getMemberId(),re=w.getOdtDocument().getMember(F).getProperties();N.registerCursor(U,q,K),O.registerCursor(U,!0),(U=N.getCaret(F))&&(U.setAvatarImageUrl(re.imageUrl),U.setColor(re.color)),runtime.log("+++ View here +++ eagerly created an Caret for '"+F+"'! +++")}function m(U){U=U.getMemberId();var F=O.getSelectionView(M),re=O.getSelectionView(gui.ShadowCursor.ShadowCursorMemberId),W=N.getCaret(M);U===M?(re.hide(),F&&F.show(),W&&W.show()):U===gui.ShadowCursor.ShadowCursorMemberId&&(re.show(),F&&F.hide(),W&&W.hide())}function R(U){O.removeSelectionView(U)}function V(U){var F=U.paragraphElement,re=U.memberId;U=U.timeStamp;var W,ie="",he=F.getElementsByTagNameNS("urn:webodf:names:editinfo","editinfo").item(0);he?(ie=he.getAttributeNS("urn:webodf:names:editinfo","id"),W=P[ie]):(ie=Math.random().toString(),W=new ops.EditInfo(F,w.getOdtDocument()),W=new gui.EditInfoMarker(W,te),he=F.getElementsByTagNameNS("urn:webodf:names:editinfo","editinfo").item(0),he.setAttributeNS("urn:webodf:names:editinfo","id",ie),P[ie]=W),W.addEdit(re,new Date(U)),J.trigger()}function Z(){var U;z.hasChildNodes()&&core.DomUtils.removeAllChildNodes(z),E.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)===!0&&(U=w.getOdtDocument().getMember(M))&&(U=U.getProperties().fullName,z.appendChild(document.createTextNode(".annotationWrapper:not([creator = '"+U+"']) .annotationRemoveButton { display: none; }")))}function ne(U){var F=Object.keys(P).map(function(re){return P[re]});Y.unsubscribe(ops.Document.signalMemberAdded,y),Y.unsubscribe(ops.Document.signalMemberUpdated,y),Y.unsubscribe(ops.Document.signalCursorAdded,v),Y.unsubscribe(ops.Document.signalCursorRemoved,R),Y.unsubscribe(ops.OdtDocument.signalParagraphChanged,V),Y.unsubscribe(ops.Document.signalCursorMoved,m),Y.unsubscribe(ops.OdtDocument.signalParagraphChanged,O.rerenderSelectionViews),Y.unsubscribe(ops.OdtDocument.signalTableAdded,O.rerenderSelectionViews),Y.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,O.rerenderSelectionViews),E.unsubscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,Z),Y.unsubscribe(ops.Document.signalMemberAdded,Z),Y.unsubscribe(ops.Document.signalMemberUpdated,Z),ee.parentNode.removeChild(ee),z.parentNode.removeChild(z),function re(W,ie){ie?U(ie):W<F.length?F[W].destroy(function(he){re(W+1,he)}):U()}(0,void 0)}var ee,z,P={},Y,$,J,te=A(j.editInfoMarkersInitiallyVisible,!0),q=A(j.caretAvatarsInitiallyVisible,!0),K=A(j.caretBlinksOnRangeSelect,!0);this.showEditInfoMarkers=function(){te||(te=!0,S(te))},this.hideEditInfoMarkers=function(){te&&(te=!1,S(te))},this.showCaretAvatars=function(){q||(q=!0,u(q))},this.hideCaretAvatars=function(){q&&(q=!1,u(q))},this.getSession=function(){return w},this.getCaret=function(U){return N.getCaret(U)},this.destroy=function(U){var F=[J.destroy,ne];Y.unsubscribe(ops.OdtDocument.signalAnnotationAdded,x),core.Async.destroyAll(F,U)},Y=w.getOdtDocument(),$=Y.getOdfCanvas(),Y.subscribe(ops.OdtDocument.signalAnnotationAdded,x),Y.subscribe(ops.Document.signalMemberAdded,y),Y.subscribe(ops.Document.signalMemberUpdated,y),Y.subscribe(ops.Document.signalCursorAdded,v),Y.subscribe(ops.Document.signalCursorRemoved,R),Y.subscribe(ops.OdtDocument.signalParagraphChanged,V),Y.subscribe(ops.Document.signalCursorMoved,m),Y.subscribe(ops.OdtDocument.signalParagraphChanged,O.rerenderSelectionViews),Y.subscribe(ops.OdtDocument.signalTableAdded,O.rerenderSelectionViews),Y.subscribe(ops.OdtDocument.signalParagraphStyleModified,O.rerenderSelectionViews),E.subscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,Z),Y.subscribe(ops.Document.signalMemberAdded,Z),Y.subscribe(ops.Document.signalMemberUpdated,Z),ee=I(),ee.appendChild(document.createTextNode("@namespace editinfo url(urn:webodf:names:editinfo);")),ee.appendChild(document.createTextNode("@namespace dc url(http://purl.org/dc/elements/1.1/);")),z=I(),Z(),J=core.Task.createRedrawTask(function(){var U=$.getAnnotationViewManager();U&&(U.rehighlightAnnotations(),Y.fixCursorPositions())})}}(),gui.SvgSelectionView=function(A){function j(){var U=y.getRootNode();v!==U&&(v=U,m=y.getCanvas().getSizer(),m.appendChild(V),V.setAttribute("class","webodf-selectionOverlay"),ne.setAttribute("class","webodf-draggable"),ee.setAttribute("class","webodf-draggable"),ne.setAttribute("end","left"),ee.setAttribute("end","right"),ne.setAttribute("r",8),ee.setAttribute("r",8),V.appendChild(Z),V.appendChild(ne),V.appendChild(ee))}function M(U){return U=U.getBoundingClientRect(),!!(U&&U.height!==0)}function w(U){var F=z.getTextElements(U,!0,!1),re=U.cloneRange(),W=U.cloneRange();if(U=U.cloneRange(),!F.length)return null;var ie;e:{ie=0;var he=F[ie],ve=re.startContainer===he?re.startOffset:0,Ne=ve;for(re.setStart(he,ve),re.setEnd(he,Ne);!M(re);){if(he.nodeType===Node.ELEMENT_NODE&&Ne<he.childNodes.length)Ne=he.childNodes.length;else if(he.nodeType===Node.TEXT_NODE&&Ne<he.length)Ne+=1;else if(F[ie])he=F[ie],ie+=1,ve=Ne=0;else{ie=!1;break e}re.setStart(he,ve),re.setEnd(he,Ne)}ie=!0}if(!ie)return null;e:{for(ie=F.length-1,he=F[ie],Ne=ve=W.endContainer===he?W.endOffset:he.nodeType===Node.TEXT_NODE?he.length:he.childNodes.length,W.setStart(he,ve),W.setEnd(he,Ne);!M(W);){if(he.nodeType===Node.ELEMENT_NODE&&0<ve)ve=0;else if(he.nodeType===Node.TEXT_NODE&&0<ve)--ve;else if(F[ie])he=F[ie],--ie,ve=Ne=he.length||he.childNodes.length;else{F=!1;break e}W.setStart(he,ve),W.setEnd(he,Ne)}F=!0}return F?(U.setStart(re.startContainer,re.startOffset),U.setEnd(W.endContainer,W.endOffset),{firstRange:re,lastRange:W,fillerRange:U}):null}function E(U,F){var re={};return re.top=Math.min(U.top,F.top),re.left=Math.min(U.left,F.left),re.right=Math.max(U.right,F.right),re.bottom=Math.max(U.bottom,F.bottom),re.width=re.right-re.left,re.height=re.bottom-re.top,re}function N(U,F){return F&&0<F.width&&0<F.height&&(U=U?E(U,F):F),U}function O(U){function F(ke){return J.setUnfilteredPosition(ke,0),Re.acceptNode(ke)===te&&Me.acceptPosition(J)===te?te:q}function re(ke){var Ve=null;return F(ke)===te&&(Ve=P.getBoundingClientRect(ke)),Ve}var W=U.commonAncestorContainer,ie=U.startContainer,he=U.endContainer,ve=U.startOffset,Ne=U.endOffset,ze,rt,le=null,me,De=R.createRange(),Me,Re=new odf.OdfNodeFilter,we;if(ie===W||he===W)return De=U.cloneRange(),le=De.getBoundingClientRect(),De.detach(),le;for(U=ie;U.parentNode!==W;)U=U.parentNode;for(rt=he;rt.parentNode!==W;)rt=rt.parentNode;for(Me=y.createRootFilter(ie),W=U.nextSibling;W&&W!==rt;)me=re(W),le=N(le,me),W=W.nextSibling;if(z.isParagraph(U))le=N(le,P.getBoundingClientRect(U));else if(U.nodeType===Node.TEXT_NODE)W=U,De.setStart(W,ve),De.setEnd(W,W===rt?Ne:W.length),me=De.getBoundingClientRect(),le=N(le,me);else for(we=R.createTreeWalker(U,NodeFilter.SHOW_TEXT,F,!1),W=we.currentNode=ie;W&&W!==he;)De.setStart(W,ve),De.setEnd(W,W.length),me=De.getBoundingClientRect(),le=N(le,me),ze=W,ve=0,W=we.nextNode();if(ze||(ze=ie),z.isParagraph(rt))le=N(le,P.getBoundingClientRect(rt));else if(rt.nodeType===Node.TEXT_NODE)W=rt,De.setStart(W,W===U?ve:0),De.setEnd(W,Ne),me=De.getBoundingClientRect(),le=N(le,me);else for(we=R.createTreeWalker(rt,NodeFilter.SHOW_TEXT,F,!1),W=we.currentNode=he;W&&W!==ze;)De.setStart(W,0),De.setEnd(W,Ne),me=De.getBoundingClientRect(),le=N(le,me),(W=we.previousNode())&&(Ne=W.length);return le}function x(U,F){var re=U.getBoundingClientRect(),W={width:0};return W.top=re.top,W.bottom=re.bottom,W.height=re.height,W.left=W.right=F?re.right:re.left,W}function I(){var U=A.getSelectedRange(),F;if(F=$&&A.getSelectionType()===ops.OdtCursor.RangeSelection&&!U.collapsed){j();var re=P.getBoundingClientRect(m),W=Y.getZoomLevel(),U=w(U),ie,he,ve,Ne,ze,rt;if(U){F=U.firstRange,ie=U.lastRange,he=U.fillerRange,ve=P.translateRect(x(F,!1),re,W),ze=P.translateRect(x(ie,!0),re,W),Ne=(Ne=O(he))?P.translateRect(Ne,re,W):E(ve,ze),rt=Ne.left,Ne=ve.left+Math.max(0,Ne.width-(ve.left-Ne.left)),re=Math.min(ve.top,ze.top),W=ze.top+ze.height,rt=[{x:ve.left,y:re+ve.height},{x:ve.left,y:re},{x:Ne,y:re},{x:Ne,y:W-ze.height},{x:ze.right,y:W-ze.height},{x:ze.right,y:W},{x:rt,y:W},{x:rt,y:re+ve.height},{x:ve.left,y:re+ve.height}],Ne="";var le;for(le=0;le<rt.length;le+=1)Ne+=rt[le].x+","+rt[le].y+" ";Z.setAttribute("points",Ne),ne.setAttribute("cx",ve.left),ne.setAttribute("cy",re+ve.height/2),ee.setAttribute("cx",ze.right),ee.setAttribute("cy",W-ze.height/2),F.detach(),ie.detach(),he.detach()}F=!!U}V.style.display=F?"block":"none"}function _(U){$&&U===A&&K.trigger()}function S(U){U=8/U,ne.setAttribute("r",U),ee.setAttribute("r",U)}function u(U){m.removeChild(V),m.classList.remove("webodf-virtualSelections"),A.getDocument().unsubscribe(ops.Document.signalCursorMoved,_),Y.unsubscribe(gui.ZoomHelper.signalZoomChanged,S),U()}var y=A.getDocument(),v,m,R=y.getDOMDocument(),V=R.createElementNS("http://www.w3.org/2000/svg","svg"),Z=R.createElementNS("http://www.w3.org/2000/svg","polygon"),ne=R.createElementNS("http://www.w3.org/2000/svg","circle"),ee=R.createElementNS("http://www.w3.org/2000/svg","circle"),z=odf.OdfUtils,P=core.DomUtils,Y=y.getCanvas().getZoomHelper(),$=!0,J=A.getDocument().createPositionIterator(y.getRootNode()),te=NodeFilter.FILTER_ACCEPT,q=NodeFilter.FILTER_REJECT,K;this.rerender=function(){$&&K.trigger()},this.show=function(){$=!0,K.trigger()},this.hide=function(){$=!1,K.trigger()},this.destroy=function(U){core.Async.destroyAll([K.destroy,u],U)},function(){var U=A.getMemberId();K=core.Task.createRedrawTask(I),j(),V.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",U),m.classList.add("webodf-virtualSelections"),A.getDocument().subscribe(ops.Document.signalCursorMoved,_),Y.subscribe(gui.ZoomHelper.signalZoomChanged,S),S(Y.getZoomLevel())}()},gui.UndoStateRules=function(){function A(E,N){var O=E.length;this.previous=function(){for(--O;0<=O;--O)if(N(E[O]))return E[O];return null}}function j(E){E=E.spec();var N;return E.hasOwnProperty("position")&&(N=E.position),N}function M(E){return E.isEdit}function w(E,N,O){return O?(E=j(E),N=j(N),O=j(O),E-N===N-O):(O=j(E)-j(N),O===0||Math.abs(O)===1)}this.isEditOperation=M,this.isPartOfOperationSet=function(E,N){var O=E.group!==void 0,x;if(!E.isEdit||N.length===0||(x=N[N.length-1],O&&E.group===x.group))return!0;e:switch(E.spec().optype){case"RemoveText":case"InsertText":x=!0;break e;default:x=!1}if(x&&N.some(M)){if(O){var I;O=E.spec().optype,x=new A(N,M);var _=x.previous(),S=null,u,y;for(runtime.assert(!!_,"No edit operations found in state"),y=_.group,runtime.assert(y!==void 0,"Operation has no group"),u=1;_&&_.group===y;){if(O===_.spec().optype){I=_;break}_=x.previous()}if(I){for(_=x.previous();_;){if(_.group!==y){if(u===2)break;y=_.group,u+=1}if(O===_.spec().optype){S=_;break}_=x.previous()}I=w(E,I,S)}else I=!1;return I}return I=E.spec().optype,O=new A(N,M),x=O.previous(),runtime.assert(!!x,"No edit operations found in state"),I=I===x.spec().optype?w(E,x,O.previous()):!1,I}return!1}},function(){function A(w,E){this.mainId=w!==void 0?w:-1,this.subId=E!==void 0?E:-1}function j(w,E,N){function O(S,u){return S+(w.isEditOperation(u)?1:0)}var x,I,_;this.addOperation=function(S){w.isEditOperation(S)&&(_+=1),I.push(S)},this.isNextStateId=function(S){return S.mainId===x&&S.subId===_},this.getNextStateId=function(){return new A(x,_)},this.getOperations=function(){return I},x=M+=1,I=E||[],_=E&&N?E.reduce(O,0):0}var M=0;gui.TrivialUndoManager=function(w){function E(){return z.isNextStateId(ee)!==!0}function N(q){q=q.getOperations(),0<q.length&&(te=!0,Z(q),te=!1)}function O(){$.emit(gui.UndoManager.signalUndoStackChanged,{undoAvailable:v.hasUndoStates(),redoAvailable:v.hasRedoStates()})}function x(q){var K=E();q!==K&&$.emit(gui.UndoManager.signalDocumentModifiedChanged,K)}function I(){z!==V&&z!==P[P.length-1]&&P.push(z)}function _(q){var K=q.previousSibling||q.nextSibling;q.parentNode.removeChild(q),m.normalizeTextNodes(K)}function S(q){return Object.keys(q).map(function(K){return q[K]})}function u(q){function K(he){var ve=he.spec();if(re[ve.memberid])switch(ve.optype){case"AddCursor":U[ve.memberid]||(U[ve.memberid]=he,delete re[ve.memberid],--W);break;case"MoveCursor":F[ve.memberid]||(F[ve.memberid]=he)}}var U={},F={},re={},W,ie;for(ie=q.pop(),ne.getMemberIds().forEach(function(he){re[he]=!0}),W=Object.keys(re).length;ie&&0<W;)ie=ie.getOperations(),ie.reverse(),ie.forEach(K),ie=q.pop();return new j(J,S(U).concat(S(F)))}function y(){var q=E(),K=R=ne.cloneDocumentElement();m.getElementsByTagNameNS(K,"urn:webodf:names:cursor","cursor").forEach(_),m.getElementsByTagNameNS(K,"urn:webodf:names:cursor","anchor").forEach(_),I(),z=V=u([V].concat(P)),P.length=0,Y.length=0,q||(ee=z.getNextStateId()),O(),x(q)}var v=this,m=core.DomUtils,R,V,Z,ne,ee,z,P=[],Y=[],$=new core.EventNotifier([gui.UndoManager.signalUndoStackChanged,gui.UndoManager.signalUndoStateCreated,gui.UndoManager.signalUndoStateModified,gui.UndoManager.signalDocumentModifiedChanged,gui.TrivialUndoManager.signalDocumentRootReplaced]),J=w||new gui.UndoStateRules,te=!1;this.subscribe=function(q,K){$.subscribe(q,K)},this.unsubscribe=function(q,K){$.unsubscribe(q,K)},this.isDocumentModified=E,this.setDocumentModified=function(q){E()!==q&&(ee=q?new A:z.getNextStateId(),$.emit(gui.UndoManager.signalDocumentModifiedChanged,q))},this.hasUndoStates=function(){return 0<P.length},this.hasRedoStates=function(){return 0<Y.length},this.setDocument=function(q){ne=q},this.purgeInitialState=function(){var q=E();P.length=0,Y.length=0,z=V=new j(J),ee=z.getNextStateId(),R=null,O(),x(q)},this.setInitialState=y,this.initialize=function(){R||y()},this.setPlaybackFunction=function(q){Z=q},this.onOperationExecuted=function(q){if(!te){var K=E();J.isEditOperation(q)&&(z===V||0<Y.length)||!J.isPartOfOperationSet(q,z.getOperations())?(Y.length=0,I(),z=new j(J,[q],!0),P.push(z),$.emit(gui.UndoManager.signalUndoStateCreated,{operations:z.getOperations()}),O()):(z.addOperation(q),$.emit(gui.UndoManager.signalUndoStateModified,{operations:z.getOperations()})),x(K)}},this.moveForward=function(q){for(var K=0,U=E(),F;q&&Y.length;)F=Y.pop(),P.push(F),N(F),--q,K+=1;return K&&(z=P[P.length-1],O(),x(U)),K},this.moveBackward=function(q){for(var K=0,U=E();q&&P.length;)Y.push(P.pop()),--q,K+=1;return K&&(ne.getMemberIds().forEach(function(F){ne.hasCursor(F)&&ne.removeCursor(F)}),ne.setDocumentElement(R.cloneNode(!0)),$.emit(gui.TrivialUndoManager.signalDocumentRootReplaced,{}),N(V),P.forEach(N),z=P[P.length-1]||V,O(),x(U)),K},z=V=new j(J),ee=z.getNextStateId()},gui.TrivialUndoManager.signalDocumentRootReplaced="documentRootReplaced"}(),odf.GraphicProperties=function(A,j,M){var w=this,E=odf.Namespaces.stylens,N=odf.Namespaces.svgns;this.verticalPos=function(){return w.data.value("verticalPos")},this.verticalRel=function(){return w.data.value("verticalRel")},this.horizontalPos=function(){return w.data.value("horizontalPos")},this.horizontalRel=function(){return w.data.value("horizontalRel")},this.strokeWidth=function(){return w.data.value("strokeWidth")},w.data=new odf.LazyStyleProperties(M===void 0?void 0:M.data,{verticalPos:function(){var O=A.getAttributeNS(E,"vertical-pos");return O===""?void 0:O},verticalRel:function(){var O=A.getAttributeNS(E,"vertical-rel");return O===""?void 0:O},horizontalPos:function(){var O=A.getAttributeNS(E,"horizontal-pos");return O===""?void 0:O},horizontalRel:function(){var O=A.getAttributeNS(E,"horizontal-rel");return O===""?void 0:O},strokeWidth:function(){var O=A.getAttributeNS(N,"stroke-width");return j.parseLength(O)}})},odf.ComputedGraphicProperties=function(){var A;this.setGraphicProperties=function(j){A=j},this.verticalPos=function(){return A&&A.verticalPos()||"from-top"},this.verticalRel=function(){return A&&A.verticalRel()||"page"},this.horizontalPos=function(){return A&&A.horizontalPos()||"from-left"},this.horizontalRel=function(){return A&&A.horizontalRel()||"page"}},odf.PageLayoutProperties=function(A,j,M){var w=this,E=odf.Namespaces.fons;this.pageHeight=function(){return w.data.value("pageHeight")||1123},this.pageWidth=function(){return w.data.value("pageWidth")||794},w.data=new odf.LazyStyleProperties(M===void 0?void 0:M.data,{pageHeight:function(){var N;return A&&(N=A.getAttributeNS(E,"page-height"),N=j.parseLength(N)),N},pageWidth:function(){var N;return A&&(N=A.getAttributeNS(E,"page-width"),N=j.parseLength(N)),N}})},odf.PageLayout=function(A,j,M){var w=null;A&&(w=j.getPropertiesElement("page-layout-properties",A)),this.pageLayout=new odf.PageLayoutProperties(w,j,M&&M.pageLayout)},odf.PageLayoutCache=function(){},odf.PageLayoutCache.prototype.getPageLayout=function(A){},odf.PageLayoutCache.prototype.getDefaultPageLayout=function(){},odf.ParagraphProperties=function(A,j,M){var w=this,E=odf.Namespaces.fons;this.marginTop=function(){return w.data.value("marginTop")},w.data=new odf.LazyStyleProperties(M===void 0?void 0:M.data,{marginTop:function(){var N=A.getAttributeNS(E,"margin-top");return j.parsePositiveLengthOrPercent(N,"marginTop",M&&M.data)}})},odf.ComputedParagraphProperties=function(){var A={},j=[];this.setStyleChain=function(M){j=M,A={}},this.marginTop=function(){var M,w;if(A.hasOwnProperty("marginTop"))M=A.marginTop;else{for(w=0;M===void 0&&w<j.length;w+=1)M=j[w].marginTop();A.marginTop=M}return M||0}},odf.TextProperties=function(A,j,M){var w=this,E=odf.Namespaces.fons;this.fontSize=function(){return w.data.value("fontSize")},w.data=new odf.LazyStyleProperties(M===void 0?void 0:M.data,{fontSize:function(){var N=A.getAttributeNS(E,"font-size");return j.parsePositiveLengthOrPercent(N,"fontSize",M&&M.data)}})},odf.ComputedTextProperties=function(){var A={},j=[];this.setStyleChain=function(M){j=M,A={}},this.fontSize=function(){var M,w;if(A.hasOwnProperty("fontSize"))M=A.fontSize;else{for(w=0;M===void 0&&w<j.length;w+=1)M=j[w].fontSize();A.fontSize=M}return M||12}},odf.MasterPage=function(A,j){var M;A?(M=A.getAttributeNS(odf.Namespaces.stylens,"page-layout-name"),this.pageLayout=j.getPageLayout(M)):this.pageLayout=j.getDefaultPageLayout()},odf.MasterPageCache=function(){},odf.MasterPageCache.prototype.getMasterPage=function(A){},odf.StylePileEntry=function(A,j,M,w){this.masterPage=function(){var E=A.getAttributeNS(odf.Namespaces.stylens,"master-page-name"),N=null;return E&&(N=M.getMasterPage(E)),N},function(E){var N=A.getAttributeNS(odf.Namespaces.stylens,"family"),O=null;(N==="graphic"||N==="chart")&&(E.graphic=w===void 0?void 0:w.graphic,O=j.getPropertiesElement("graphic-properties",A,O),O!==null&&(E.graphic=new odf.GraphicProperties(O,j,E.graphic))),(N==="paragraph"||N==="table-cell"||N==="graphic"||N==="presentation"||N==="chart")&&(E.paragraph=w===void 0?void 0:w.paragraph,O=j.getPropertiesElement("paragraph-properties",A,O),O!==null&&(E.paragraph=new odf.ParagraphProperties(O,j,E.paragraph))),(N==="text"||N==="paragraph"||N==="table-cell"||N==="graphic"||N==="presentation"||N==="chart")&&(E.text=w===void 0?void 0:w.text,O=j.getPropertiesElement("text-properties",A,O),O!==null&&(E.text=new odf.TextProperties(O,j,E.text)))}(this)},odf.StylePile=function(A,j){function M(S,u){var y,v;return S.hasAttributeNS(w,"parent-style-name")&&(v=S.getAttributeNS(w,"parent-style-name"),u.indexOf(v)===-1&&(y=_(v,u))),new odf.StylePileEntry(S,A,j,y)}var w=odf.Namespaces.stylens,E={},N={},O,x={},I={},_;_=function(S,u){var y=x[S],v;return!y&&(v=E[S])&&(u.push(S),y=M(v,u),x[S]=y),y},this.getStyle=function(S){var u=I[S]||x[S],y,v=[];return u||(y=N[S],y||(y=E[S])&&v.push(S),y&&(u=M(y,v))),u},this.addCommonStyle=function(S){var u;S.hasAttributeNS(w,"name")&&(u=S.getAttributeNS(w,"name"),E.hasOwnProperty(u)||(E[u]=S))},this.addAutomaticStyle=function(S){var u;S.hasAttributeNS(w,"name")&&(u=S.getAttributeNS(w,"name"),N.hasOwnProperty(u)||(N[u]=S))},this.setDefaultStyle=function(S){O===void 0&&(O=M(S,[]))},this.getDefaultStyle=function(){return O}},odf.ComputedGraphicStyle=function(){this.text=new odf.ComputedTextProperties,this.paragraph=new odf.ComputedParagraphProperties,this.graphic=new odf.ComputedGraphicProperties},odf.ComputedParagraphStyle=function(){this.text=new odf.ComputedTextProperties,this.paragraph=new odf.ComputedParagraphProperties},odf.ComputedTextStyle=function(){this.text=new odf.ComputedTextProperties},odf.StyleCache=function(A){function j(J,te,q,K){te=q.getAttributeNS(te,"class-names");var U;if(te)for(te=te.split(" "),U=0;U<te.length;U+=1)(q=te[U])&&(K.push(J),K.push(q))}function M(J,te){var q=V.getStyleName("paragraph",J);return q!==void 0&&(te.push("paragraph"),te.push(q)),J.namespaceURI!==m||J.localName!=="h"&&J.localName!=="p"||j("paragraph",m,J,te),te}function w(J,te,q){var K=[],U,F,re,W;for(U=0;U<J.length;U+=2)re=J[U],W=J[U+1],re=x[re],W=re.getStyle(W),W!==void 0&&(W=W[te],W!==void 0&&W!==F&&(K.push(W),F=W));return re=x[q],(W=re.getDefaultStyle())&&(W=W[te],W!==void 0&&W!==F&&K.push(W)),K}function E(J,te){var q=V.getStyleName("text",J),K=J.parentNode;return q!==void 0&&(te.push("text"),te.push(q)),J.localName==="span"&&J.namespaceURI===m&&j("text",m,J,te),!K||K===A||(K.namespaceURI!==m||K.localName!=="p"&&K.localName!=="h"?E(K,te):M(K,te)),te}function N(J){return J=J.getAttributeNS(R,"family"),x[J]}var O=this,x,I,_,S,u,y,v,m=odf.Namespaces.textns,R=odf.Namespaces.stylens,V=new odf.StyleInfo,Z=new odf.StyleParseUtils,ne,ee,z,P,Y,$;this.getComputedGraphicStyle=function(J){var te=[];J=V.getStyleName("graphic",J),J!==void 0&&(te.push("graphic"),te.push(J)),J=te.join("/");var q=S[J];return runtime.assert(te.length%2===0,"Invalid style chain."),q===void 0&&(q=new odf.ComputedGraphicStyle,q.graphic.setGraphicProperties(w(te,"graphic","graphic")[0]),q.text.setStyleChain(w(te,"text","graphic")),q.paragraph.setStyleChain(w(te,"paragraph","graphic")),S[J]=q),q},this.getComputedParagraphStyle=function(J){J=M(J,[]);var te=J.join("/"),q=_[te];return runtime.assert(J.length%2===0,"Invalid style chain."),q===void 0&&(q=new odf.ComputedParagraphStyle,q.text.setStyleChain(w(J,"text","paragraph")),q.paragraph.setStyleChain(w(J,"paragraph","paragraph")),_[te]=q),q},this.getComputedTextStyle=function(J){J=E(J,[]);var te=J.join("/"),q=I[te];return runtime.assert(J.length%2===0,"Invalid style chain."),q===void 0&&(q=new odf.ComputedTextStyle,q.text.setStyleChain(w(J,"text","text")),I[te]=q),q},this.getPageLayout=function(J){var te=$[J];return te||((te=Y[J])?(te=new odf.PageLayout(te,Z,P),$[J]=te):te=P),te},this.getDefaultPageLayout=function(){return P},this.getMasterPage=function(J){var te=ee[J];return te===void 0&&((te=ne[J])?(te=new odf.MasterPage(te,O),ee[J]=te):te=null),te},this.getDefaultMasterPage=function(){return z},this.update=function(){var J,te,q=null,K=null;for(I={},_={},S={},ne={},ee={},$={},Y={},u=new odf.StylePile(Z,O),y=new odf.StylePile(Z,O),v=new odf.StylePile(Z,O),x={text:u,paragraph:y,graphic:v},J=A.styles.firstElementChild;J;)J.namespaceURI===R&&((te=N(J))?J.localName==="style"?te.addCommonStyle(J):J.localName==="default-style"&&te.setDefaultStyle(J):J.localName==="default-page-layout"&&(q=J)),J=J.nextElementSibling;for(P=new odf.PageLayout(q,Z),J=A.automaticStyles.firstElementChild;J;)J.namespaceURI===R&&((te=N(J))&&J.localName==="style"?te.addAutomaticStyle(J):J.localName==="page-layout"&&(Y[J.getAttributeNS(R,"name")]=J)),J=J.nextElementSibling;for(J=A.masterStyles.firstElementChild;J;)J.namespaceURI===R&&J.localName==="master-page"&&(K=K||J,te=J,q=te.getAttributeNS(R,"name"),0<q.length&&!ne.hasOwnProperty(q)&&(ne[q]=te)),J=J.nextElementSibling;z=new odf.MasterPage(K,O)}},ops.OperationTransformMatrix=function(){function A(u){u.position+=u.length,u.length*=-1}function j(u){var y=0>u.length;return y&&A(u),y}function M(u,y){function v(R){u[R]===y&&m.push(R)}var m=[];return u&&["style:parent-style-name","style:next-style-name"].forEach(v),m}function w(u,y){function v(m){u[m]===y&&delete u[m]}u&&["style:parent-style-name","style:next-style-name"].forEach(v)}function E(u){var y={};return Object.keys(u).forEach(function(v){y[v]=typeof u[v]=="object"?E(u[v]):u[v]}),y}function N(u,y,v,m){var R,V=!1,Z=!1,ne,ee=[];if(m&&m.attributes&&(ee=m.attributes.split(",")),u&&(v||0<ee.length)&&Object.keys(u).forEach(function(z){var P=u[z],Y;typeof P!="object"&&(v&&(Y=v[z]),Y!==void 0?(delete u[z],Z=!0,Y===P&&(delete v[z],V=!0)):ee.indexOf(z)!==-1&&(delete u[z],Z=!0))}),y&&y.attributes&&(v||0<ee.length)){for(ne=y.attributes.split(","),m=0;m<ne.length;m+=1)R=ne[m],(v&&v[R]!==void 0||ee&&ee.indexOf(R)!==-1)&&(ne.splice(m,1),--m,Z=!0);0<ne.length?y.attributes=ne.join(","):delete y.attributes}return{majorChanged:V,minorChanged:Z}}function O(u){for(var y in u)if(u.hasOwnProperty(y))return!0;return!1}function x(u){for(var y in u)if(u.hasOwnProperty(y)&&(y!=="attributes"||0<u.attributes.length))return!0;return!1}function I(u,y,v,m,R){var V=u?u[R]:null,Z=y?y[R]:null,ne=v?v[R]:null,ee=m?m[R]:null,z;return z=N(V,Z,ne,ee),V&&!O(V)&&delete u[R],Z&&!x(Z)&&delete y[R],ne&&!O(ne)&&delete v[R],ee&&!x(ee)&&delete m[R],z}function _(u,y){return{opSpecsA:[u],opSpecsB:[y]}}var S;S={AddAnnotation:{AddAnnotation:function(u,y,v){var m;return u.position<y.position?(m=u,v=y):y.position<u.position?(m=y,v=u):(m=v?u:y,v=v?y:u),v.position<m.position+m.length&&(m.length+=2),v.position+=2,{opSpecsA:[u],opSpecsB:[y]}},AddCursor:_,AddMember:_,AddStyle:_,ApplyDirectStyling:function(u,y){return u.position<=y.position?y.position+=2:u.position<=y.position+y.length&&(y.length+=2),{opSpecsA:[u],opSpecsB:[y]}},InsertText:function(u,y){return y.position<=u.position?u.position+=y.text.length:(u.length!==void 0&&y.position<=u.position+u.length&&(u.length+=y.text.length),y.position+=2),{opSpecsA:[u],opSpecsB:[y]}},MergeParagraph:function(u,y){return y.sourceStartPosition<=u.position?--u.position:(u.length!==void 0&&y.sourceStartPosition<=u.position+u.length&&--u.length,y.sourceStartPosition+=2,u.position<y.destinationStartPosition&&(y.destinationStartPosition+=2)),{opSpecsA:[u],opSpecsB:[y]}},MoveCursor:function(u,y){var v=j(y);return u.position<y.position?y.position+=2:u.position<y.position+y.length&&(y.length+=2),v&&A(y),{opSpecsA:[u],opSpecsB:[y]}},RemoveAnnotation:function(u,y){return u.position<y.position?(y.position<u.position+u.length&&(u.length-=y.length+2),y.position+=2):u.position-=y.length+2,{opSpecsA:[u],opSpecsB:[y]}},RemoveCursor:_,RemoveMember:_,RemoveStyle:_,RemoveText:function(u,y){var v=y.position,m=y.position+y.length,R,V=[u],Z=[y];return u.position<=y.position?y.position+=2:u.position<m&&(y.length=u.position-y.position,R={optype:"RemoveText",memberid:y.memberid,timestamp:y.timestamp,position:u.position+2,length:m-u.position},Z.unshift(R)),y.position+y.length<=u.position?(u.position-=y.length,u.length!==void 0&&R&&(u.length=R.length>=u.length?0:u.length-R.length)):u.length!==void 0&&(R=u.position+u.length,m<=R?u.length-=y.length:v<R&&(u.length=v-u.position)),{opSpecsA:V,opSpecsB:Z}},SetParagraphStyle:function(u,y){return u.position<y.position&&(y.position+=2),{opSpecsA:[u],opSpecsB:[y]}},SplitParagraph:function(u,y){return u.position<y.sourceParagraphPosition&&(y.sourceParagraphPosition+=2),y.position<=u.position?u.position+=1:(u.length!==void 0&&y.position<=u.position+u.length&&(u.length+=1),y.position+=2),{opSpecsA:[u],opSpecsB:[y]}},UpdateMember:_,UpdateMetadata:_,UpdateParagraphStyle:_},AddCursor:{AddCursor:_,AddMember:_,AddStyle:_,ApplyDirectStyling:_,InsertText:_,MergeParagraph:_,MoveCursor:_,RemoveAnnotation:_,RemoveCursor:_,RemoveMember:_,RemoveStyle:_,RemoveText:_,SetParagraphStyle:_,SplitParagraph:_,UpdateMember:_,UpdateMetadata:_,UpdateParagraphStyle:_},AddMember:{AddStyle:_,ApplyDirectStyling:_,InsertText:_,MergeParagraph:_,MoveCursor:_,RemoveAnnotation:_,RemoveCursor:_,RemoveStyle:_,RemoveText:_,SetParagraphStyle:_,SplitParagraph:_,UpdateMetadata:_,UpdateParagraphStyle:_},AddStyle:{AddStyle:_,ApplyDirectStyling:_,InsertText:_,MergeParagraph:_,MoveCursor:_,RemoveAnnotation:_,RemoveCursor:_,RemoveMember:_,RemoveStyle:function(u,y){var v,m=[u],R=[y];return u.styleFamily===y.styleFamily&&(v=M(u.setProperties,y.styleName),0<v.length&&(v={optype:"UpdateParagraphStyle",memberid:y.memberid,timestamp:y.timestamp,styleName:u.styleName,removedProperties:{attributes:v.join(",")}},R.unshift(v)),w(u.setProperties,y.styleName)),{opSpecsA:m,opSpecsB:R}},RemoveText:_,SetParagraphStyle:_,SplitParagraph:_,UpdateMember:_,UpdateMetadata:_,UpdateParagraphStyle:_},ApplyDirectStyling:{ApplyDirectStyling:function(u,y,v){var m,R,V,Z,ne,ee,z,P;return Z=[u],V=[y],u.position+u.length<=y.position||u.position>=y.position+y.length||(m=v?u:y,R=v?y:u,(u.position!==y.position||u.length!==y.length)&&(ee=E(m),z=E(R)),y=I(R.setProperties,null,m.setProperties,null,"style:text-properties"),(y.majorChanged||y.minorChanged)&&(V=[],u=[],Z=m.position+m.length,ne=R.position+R.length,R.position<m.position?y.minorChanged&&(P=E(z),P.length=m.position-R.position,u.push(P),R.position=m.position,R.length=ne-R.position):m.position<R.position&&y.majorChanged&&(P=E(ee),P.length=R.position-m.position,V.push(P),m.position=R.position,m.length=Z-m.position),ne>Z?y.minorChanged&&(ee=z,ee.position=Z,ee.length=ne-Z,u.push(ee),R.length=Z-R.position):Z>ne&&y.majorChanged&&(ee.position=ne,ee.length=Z-ne,V.push(ee),m.length=ne-m.position),m.setProperties&&O(m.setProperties)&&V.push(m),R.setProperties&&O(R.setProperties)&&u.push(R),v?(Z=V,V=u):Z=u)),{opSpecsA:Z,opSpecsB:V}},InsertText:function(u,y){return y.position<=u.position?u.position+=y.text.length:y.position<=u.position+u.length&&(u.length+=y.text.length),{opSpecsA:[u],opSpecsB:[y]}},MergeParagraph:function(u,y){var v=u.position,m=u.position+u.length;return v>=y.sourceStartPosition&&--v,m>=y.sourceStartPosition&&--m,u.position=v,u.length=m-v,{opSpecsA:[u],opSpecsB:[y]}},MoveCursor:_,RemoveAnnotation:function(u,y){var v=u.position,m=u.position+u.length,R=y.position+y.length,V=[u],Z=[y];return y.position<=v&&m<=R?V=[]:(R<v&&(v-=y.length+2),R<m&&(m-=y.length+2),u.position=v,u.length=m-v),{opSpecsA:V,opSpecsB:Z}},RemoveCursor:_,RemoveMember:_,RemoveStyle:_,RemoveText:function(u,y){var v=u.position+u.length,m=y.position+y.length,R=[u],V=[y];return m<=u.position?u.position-=y.length:y.position<v&&(u.position<y.position?u.length=m<v?u.length-y.length:y.position-u.position:(u.position=y.position,m<v?u.length=v-m:R=[])),{opSpecsA:R,opSpecsB:V}},SetParagraphStyle:_,SplitParagraph:function(u,y){return y.position<u.position?u.position+=1:y.position<u.position+u.length&&(u.length+=1),{opSpecsA:[u],opSpecsB:[y]}},UpdateMember:_,UpdateMetadata:_,UpdateParagraphStyle:_},InsertText:{InsertText:function(u,y,v){return u.position<y.position?y.position+=u.text.length:u.position>y.position?u.position+=y.text.length:v?y.position+=u.text.length:u.position+=y.text.length,{opSpecsA:[u],opSpecsB:[y]}},MergeParagraph:function(u,y){return u.position>=y.sourceStartPosition?--u.position:(u.position<y.sourceStartPosition&&(y.sourceStartPosition+=u.text.length),u.position<y.destinationStartPosition&&(y.destinationStartPosition+=u.text.length)),{opSpecsA:[u],opSpecsB:[y]}},MoveCursor:function(u,y){var v=j(y);return u.position<y.position?y.position+=u.text.length:u.position<y.position+y.length&&(y.length+=u.text.length),v&&A(y),{opSpecsA:[u],opSpecsB:[y]}},RemoveAnnotation:function(u,y){var v=u.position,m=y.position+y.length,R=[u],V=[y];return y.position<=v&&v<=m?(R=[],y.length+=u.text.length):m<u.position?u.position-=y.length+2:y.position+=u.text.length,{opSpecsA:R,opSpecsB:V}},RemoveCursor:_,RemoveMember:_,RemoveStyle:_,RemoveText:function(u,y){var v;v=y.position+y.length;var m=[u],R=[y];return v<=u.position?u.position-=y.length:u.position<=y.position?y.position+=u.text.length:(y.length=u.position-y.position,v={optype:"RemoveText",memberid:y.memberid,timestamp:y.timestamp,position:u.position+u.text.length,length:v-u.position},R.unshift(v),u.position=y.position),{opSpecsA:m,opSpecsB:R}},SetParagraphStyle:function(u,y){return y.position>u.position&&(y.position+=u.text.length),{opSpecsA:[u],opSpecsB:[y]}},SplitParagraph:function(u,y){return u.position<y.sourceParagraphPosition&&(y.sourceParagraphPosition+=u.text.length),u.position<=y.position?y.position+=u.text.length:u.position+=1,{opSpecsA:[u],opSpecsB:[y]}},UpdateMember:_,UpdateMetadata:_,UpdateParagraphStyle:_},MergeParagraph:{MergeParagraph:function(u,y,v){var m=[u],R=[y],V;return u.destinationStartPosition===y.destinationStartPosition?(m=[],R=[],u.moveCursor&&(V={optype:"MoveCursor",memberid:u.memberid,timestamp:u.timestamp,position:u.sourceStartPosition-1},m.push(V)),y.moveCursor&&(V={optype:"MoveCursor",memberid:y.memberid,timestamp:y.timestamp,position:y.sourceStartPosition-1},R.push(V)),u=v?u:y,u={optype:"SetParagraphStyle",memberid:u.memberid,timestamp:u.timestamp,position:u.destinationStartPosition,styleName:u.paragraphStyleName},v?m.push(u):R.push(u)):y.sourceStartPosition===u.destinationStartPosition?(u.destinationStartPosition=y.destinationStartPosition,--u.sourceStartPosition,u.paragraphStyleName=y.paragraphStyleName):u.sourceStartPosition===y.destinationStartPosition?(y.destinationStartPosition=u.destinationStartPosition,--y.sourceStartPosition,y.paragraphStyleName=u.paragraphStyleName):u.destinationStartPosition<y.destinationStartPosition?(--y.destinationStartPosition,--y.sourceStartPosition):(--u.destinationStartPosition,--u.sourceStartPosition),{opSpecsA:m,opSpecsB:R}},MoveCursor:function(u,y){var R=y.position,v=y.position+y.length,m=Math.min(R,v),R=Math.max(R,v);return m>=u.sourceStartPosition&&--m,R>=u.sourceStartPosition&&--R,0<=y.length?(y.position=m,y.length=R-m):(y.position=R,y.length=m-R),{opSpecsA:[u],opSpecsB:[y]}},RemoveAnnotation:function(u,y){var v=y.position+y.length,m=[u],R=[y];return y.position<=u.destinationStartPosition&&u.sourceStartPosition<=v?(m=[],--y.length):u.sourceStartPosition<y.position?--y.position:(v<u.destinationStartPosition&&(u.destinationStartPosition-=y.length+2),v<u.sourceStartPosition&&(u.sourceStartPosition-=y.length+2)),{opSpecsA:m,opSpecsB:R}},RemoveCursor:_,RemoveMember:_,RemoveStyle:_,RemoveText:function(u,y){return y.position>=u.sourceStartPosition?--y.position:(y.position<u.destinationStartPosition&&(u.destinationStartPosition-=y.length),y.position<u.sourceStartPosition&&(u.sourceStartPosition-=y.length)),{opSpecsA:[u],opSpecsB:[y]}},SetParagraphStyle:function(u,y){var v=[u],m=[y];return y.position>u.sourceStartPosition?--y.position:(y.position===u.destinationStartPosition||y.position===u.sourceStartPosition)&&(y.position=u.destinationStartPosition,u.paragraphStyleName=y.styleName),{opSpecsA:v,opSpecsB:m}},SplitParagraph:function(u,y){var v,m=[u],R=[y];return y.position<u.destinationStartPosition?(u.destinationStartPosition+=1,u.sourceStartPosition+=1):y.position>=u.destinationStartPosition&&y.position<u.sourceStartPosition?(y.paragraphStyleName=u.paragraphStyleName,v={optype:"SetParagraphStyle",memberid:u.memberid,timestamp:u.timestamp,position:u.destinationStartPosition,styleName:u.paragraphStyleName},m.push(v),y.position===u.sourceStartPosition-1&&u.moveCursor&&(v={optype:"MoveCursor",memberid:u.memberid,timestamp:u.timestamp,position:y.position,length:0},m.push(v)),u.destinationStartPosition=y.position+1,u.sourceStartPosition+=1):y.position>=u.sourceStartPosition&&(--y.position,--y.sourceParagraphPosition),{opSpecsA:m,opSpecsB:R}},UpdateMember:_,UpdateMetadata:_,UpdateParagraphStyle:_},MoveCursor:{MoveCursor:_,RemoveAnnotation:function(u,y){var v=j(u),m=u.position+u.length,R=y.position+y.length;return y.position<=u.position&&m<=R?(u.position=y.position-1,u.length=0):(R<u.position?u.position-=y.length+2:R<m&&(u.length-=y.length+2),v&&A(u)),{opSpecsA:[u],opSpecsB:[y]}},RemoveCursor:function(u,y){return{opSpecsA:u.memberid===y.memberid?[]:[u],opSpecsB:[y]}},RemoveMember:_,RemoveStyle:_,RemoveText:function(u,y){var v=j(u),m=u.position+u.length,R=y.position+y.length;return R<=u.position?u.position-=y.length:y.position<m&&(u.position<y.position?u.length=R<m?u.length-y.length:y.position-u.position:(u.position=y.position,u.length=R<m?m-R:0)),v&&A(u),{opSpecsA:[u],opSpecsB:[y]}},SetParagraphStyle:_,SplitParagraph:function(u,y){var v=j(u);return y.position<u.position?u.position+=1:y.position<u.position+u.length&&(u.length+=1),v&&A(u),{opSpecsA:[u],opSpecsB:[y]}},UpdateMember:_,UpdateMetadata:_,UpdateParagraphStyle:_},RemoveAnnotation:{RemoveAnnotation:function(u,y){var v=[u],m=[y];return u.position===y.position&&u.length===y.length?(v=[],m=[]):u.position<y.position?y.position-=u.length+2:u.position-=y.length+2,{opSpecsA:v,opSpecsB:m}},RemoveCursor:_,RemoveMember:_,RemoveStyle:_,RemoveText:function(u,y){var v=u.position+u.length,m=y.position+y.length,R=[u],V=[y];return u.position<=y.position&&m<=v?(V=[],u.length-=y.length):m<u.position?u.position-=y.length:y.position<u.position?(u.position=y.position+1,y.length-=u.length+2):y.position-=u.length+2,{opSpecsA:R,opSpecsB:V}},SetParagraphStyle:function(u,y){var v=y.position,m=u.position+u.length,R=[u],V=[y];return u.position<=v&&v<=m?V=[]:m<v&&(y.position-=u.length+2),{opSpecsA:R,opSpecsB:V}},SplitParagraph:function(u,y){var v=y.position,m=u.position+u.length,R=[u],V=[y];return u.position<=v&&v<=m?(V=[],u.length+=1):(m<y.sourceParagraphPosition&&(y.sourceParagraphPosition-=u.length+2),m<v?y.position-=u.length+2:u.position+=1),{opSpecsA:R,opSpecsB:V}},UpdateMember:_,UpdateMetadata:_,UpdateParagraphStyle:_},RemoveCursor:{RemoveCursor:function(u,y){var v=u.memberid===y.memberid;return{opSpecsA:v?[]:[u],opSpecsB:v?[]:[y]}},RemoveMember:_,RemoveStyle:_,RemoveText:_,SetParagraphStyle:_,SplitParagraph:_,UpdateMember:_,UpdateMetadata:_,UpdateParagraphStyle:_},RemoveMember:{RemoveStyle:_,RemoveText:_,SetParagraphStyle:_,SplitParagraph:_,UpdateMetadata:_,UpdateParagraphStyle:_},RemoveStyle:{RemoveStyle:function(u,y){var v=u.styleName===y.styleName&&u.styleFamily===y.styleFamily;return{opSpecsA:v?[]:[u],opSpecsB:v?[]:[y]}},RemoveText:_,SetParagraphStyle:function(u,y){var v,m=[u],R=[y];return u.styleFamily==="paragraph"&&u.styleName===y.styleName&&(v={optype:"SetParagraphStyle",memberid:u.memberid,timestamp:u.timestamp,position:y.position,styleName:""},m.unshift(v),y.styleName=""),{opSpecsA:m,opSpecsB:R}},SplitParagraph:_,UpdateMember:_,UpdateMetadata:_,UpdateParagraphStyle:function(u,y){var v,m=[u],R=[y];return u.styleFamily==="paragraph"&&(v=M(y.setProperties,u.styleName),0<v.length&&(v={optype:"UpdateParagraphStyle",memberid:u.memberid,timestamp:u.timestamp,styleName:y.styleName,removedProperties:{attributes:v.join(",")}},m.unshift(v)),u.styleName===y.styleName?R=[]:w(y.setProperties,u.styleName)),{opSpecsA:m,opSpecsB:R}}},RemoveText:{RemoveText:function(u,y){var v=u.position+u.length,m=y.position+y.length,R=[u],V=[y];return m<=u.position?u.position-=y.length:v<=y.position?y.position-=u.length:y.position<v&&(u.position<y.position?(u.length=m<v?u.length-y.length:y.position-u.position,v<m?(y.position=u.position,y.length=m-v):V=[]):(v<m?y.length-=u.length:y.position<u.position?y.length=u.position-y.position:V=[],m<v?(u.position=y.position,u.length=v-m):R=[])),{opSpecsA:R,opSpecsB:V}},SetParagraphStyle:function(u,y){return u.position<y.position&&(y.position-=u.length),{opSpecsA:[u],opSpecsB:[y]}},SplitParagraph:function(u,y){var v=u.position+u.length,m=[u],R=[y];return y.position<=u.position?u.position+=1:y.position<v&&(u.length=y.position-u.position,v={optype:"RemoveText",memberid:u.memberid,timestamp:u.timestamp,position:y.position+1,length:v-y.position},m.unshift(v)),u.position+u.length<=y.position?y.position-=u.length:u.position<y.position&&(y.position=u.position),u.position+u.length<y.sourceParagraphPosition&&(y.sourceParagraphPosition-=u.length),{opSpecsA:m,opSpecsB:R}},UpdateMember:_,UpdateMetadata:_,UpdateParagraphStyle:_},SetParagraphStyle:{SetParagraphStyle:function(u,y,v){return u.position===y.position&&(v?y.styleName=u.styleName:u.styleName=y.styleName),{opSpecsA:[u],opSpecsB:[y]}},SplitParagraph:function(u,y){var v=[u],m=[y],R;return u.position>y.position?u.position+=1:u.position===y.sourceParagraphPosition&&(y.paragraphStyleName=u.styleName,R=E(u),R.position=y.position+1,v.push(R)),{opSpecsA:v,opSpecsB:m}},UpdateMember:_,UpdateMetadata:_,UpdateParagraphStyle:_},SplitParagraph:{SplitParagraph:function(u,y,v){var m,R;return u.position<y.position?m=!0:y.position<u.position?R=!0:u.position===y.position&&(v?m=!0:R=!0),m?(y.position+=1,y.sourceParagraphPosition=u.position<y.sourceParagraphPosition?y.sourceParagraphPosition+1:u.position+1):R&&(u.position+=1,u.sourceParagraphPosition=y.position<y.sourceParagraphPosition?u.sourceParagraphPosition+1:y.position+1),{opSpecsA:[u],opSpecsB:[y]}},UpdateMember:_,UpdateMetadata:_,UpdateParagraphStyle:_},UpdateMember:{UpdateMetadata:_,UpdateParagraphStyle:_},UpdateMetadata:{UpdateMetadata:function(u,y,v){var m,R=[u],V=[y];return m=v?u:y,u=v?y:u,N(u.setProperties||null,u.removedProperties||null,m.setProperties||null,m.removedProperties||null),m.setProperties&&O(m.setProperties)||m.removedProperties&&x(m.removedProperties)||(v?R=[]:V=[]),u.setProperties&&O(u.setProperties)||u.removedProperties&&x(u.removedProperties)||(v?V=[]:R=[]),{opSpecsA:R,opSpecsB:V}},UpdateParagraphStyle:_},UpdateParagraphStyle:{UpdateParagraphStyle:function(u,y,v){var m,R=[u],V=[y];return u.styleName===y.styleName&&(m=v?u:y,u=v?y:u,I(u.setProperties,u.removedProperties,m.setProperties,m.removedProperties,"style:paragraph-properties"),I(u.setProperties,u.removedProperties,m.setProperties,m.removedProperties,"style:text-properties"),N(u.setProperties||null,u.removedProperties||null,m.setProperties||null,m.removedProperties||null),m.setProperties&&O(m.setProperties)||m.removedProperties&&x(m.removedProperties)||(v?R=[]:V=[]),u.setProperties&&O(u.setProperties)||u.removedProperties&&x(u.removedProperties)||(v?V=[]:R=[])),{opSpecsA:R,opSpecsB:V}}}},this.passUnchanged=_,this.extendTransformations=function(u){Object.keys(u).forEach(function(y){var v=u[y],m,R=S.hasOwnProperty(y);runtime.log((R?"Extending":"Adding")+" map for optypeA: "+y),R||(S[y]={}),m=S[y],Object.keys(v).forEach(function(V){var Z=m.hasOwnProperty(V);runtime.assert(y<=V,"Wrong order:"+y+", "+V),runtime.log("  "+(Z?"Overwriting":"Adding")+" entry for optypeB: "+V),m[V]=v[V]})})},this.transformOpspecVsOpspec=function(u,y){var v=u.optype<=y.optype,m;return runtime.log("Crosstransforming:"),runtime.log(runtime.toJson(u)),runtime.log(runtime.toJson(y)),v||(m=u,u=y,y=m),(m=(m=S[u.optype])&&m[y.optype])?(m=m(u,y,!v),v||m===null||(m={opSpecsA:m.opSpecsB,opSpecsB:m.opSpecsA})):m=null,runtime.log("result:"),m?(runtime.log(runtime.toJson(m.opSpecsA)),runtime.log(runtime.toJson(m.opSpecsB))):runtime.log("null"),m}},ops.OperationTransformer=function(){function A(M,w){for(var E,N,O=[],x=[];0<M.length&&w;){if(E=M.shift(),E=j.transformOpspecVsOpspec(E,w),!E)return null;if(O=O.concat(E.opSpecsA),E.opSpecsB.length===0){O=O.concat(M),w=null;break}for(;1<E.opSpecsB.length;){if(N=A(M,E.opSpecsB.shift()),!N)return null;x=x.concat(N.opSpecsB),M=N.opSpecsA}w=E.opSpecsB.pop()}return w&&x.push(w),{opSpecsA:O,opSpecsB:x}}var j=new ops.OperationTransformMatrix;this.getOperationTransformMatrix=function(){return j},this.transform=function(M,w){for(var E,N=[];0<w.length;){if(E=A(M,w.shift()),!E)return null;M=E.opSpecsA,N=N.concat(E.opSpecsB)}return{opSpecsA:M,opSpecsB:N}}};var webodf_css='@namespace draw url(urn:oasis:names:tc:opendocument:xmlns:drawing:1.0);@namespace fo url(urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0);@namespace office url(urn:oasis:names:tc:opendocument:xmlns:office:1.0);@namespace presentation url(urn:oasis:names:tc:opendocument:xmlns:presentation:1.0);@namespace style url(urn:oasis:names:tc:opendocument:xmlns:style:1.0);@namespace svg url(urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0);@namespace table url(urn:oasis:names:tc:opendocument:xmlns:table:1.0);@namespace text url(urn:oasis:names:tc:opendocument:xmlns:text:1.0);@namespace webodfhelper url(urn:webodf:names:helper);@namespace cursor url(urn:webodf:names:cursor);@namespace editinfo url(urn:webodf:names:editinfo);@namespace annotation url(urn:webodf:names:annotation);@namespace dc url(http://purl.org/dc/elements/1.1/);@namespace svgns url(http://www.w3.org/2000/svg);office|document > *, office|document-content > * {display: none;}office|body, office|document {display: inline-block;position: relative;}text|p, text|h {display: block;padding: 0;margin: 0;line-height: normal;position: relative;}text|p::after, text|h::after {content: "\\200B";white-space: pre;}*[webodfhelper|containsparagraphanchor] {position: relative;}text|s {white-space: pre;}text|tab {display: inline;white-space: pre;}text|tracked-changes {display: none;}office|binary-data {display: none;}office|text {display: block;text-align: left;overflow: visible;word-wrap: break-word;}office|text::selection {background: transparent;}.webodf-virtualSelections *::selection {background: transparent;}.webodf-virtualSelections *::-moz-selection {background: transparent;}office|text * draw|text-box {display: block;border: 1px solid #d3d3d3;}office|text draw|frame {z-index: 1;}office|spreadsheet {display: block;border-collapse: collapse;empty-cells: show;font-family: sans-serif;font-size: 10pt;text-align: left;page-break-inside: avoid;overflow: hidden;}office|presentation {display: inline-block;text-align: left;}#shadowContent {display: inline-block;text-align: left;}draw|page {display: block;position: relative;overflow: hidden;}presentation|notes, presentation|footer-decl, presentation|date-time-decl {display: none;}@media print {draw|page {border: 1pt solid black;page-break-inside: avoid;}presentation|notes {}}office|spreadsheet text|p {border: 0px;padding: 1px;margin: 0px;}office|spreadsheet table|table {margin: 3px;}office|spreadsheet table|table:after {}office|spreadsheet table|table-row {counter-increment: row;}office|spreadsheet table|table-row:before {width: 3em;background: #cccccc;border: 1px solid black;text-align: center;content: counter(row);display: table-cell;}office|spreadsheet table|table-cell {border: 1px solid #cccccc;}table|table {display: table;}draw|frame table|table {width: 100%;height: 100%;background: white;}table|table-header-rows {display: table-header-group;}table|table-row {display: table-row;}table|table-column {display: table-column;}table|table-cell {width: 0.889in;display: table-cell;word-break: break-all;}draw|frame {display: block;}draw|image {display: block;width: 100%;height: 100%;top: 0px;left: 0px;background-repeat: no-repeat;background-size: 100% 100%;-moz-background-size: 100% 100%;}draw|frame > draw|image:nth-of-type(n+2) {display: none;}text|list:before {display: none;content:"";}text|list {display: block;}text|list-item {display: block;}text|number {display:none;}text|a {color: blue;text-decoration: underline;cursor: pointer;}.webodf-inactiveLinks text|a {cursor: text;}text|note-citation {vertical-align: super;font-size: smaller;}text|note-body {display: none;}text|note:hover text|note-citation {background: #dddddd;}text|note:hover text|note-body {display: block;left:1em;max-width: 80%;position: absolute;background: #ffffaa;}text|bibliography-source {display: none;}svg|title, svg|desc {display: none;}video {width: 100%;height: 100%}cursor|anchor {display: none;}cursor|cursor {display: none;}.webodf-caretOverlay {position: absolute;top: 5%;height: 1em;z-index: 10;padding-left: 1px;pointer-events: none;}.webodf-caretOverlay .caret {position: absolute;border-left: 2px solid black;top: 0;bottom: 0;right: 0;}.webodf-caretOverlay .handle {position: absolute;margin-top: 5px;padding-top: 3px;margin-left: auto;margin-right: auto;width: 64px;height: 68px;border-radius: 5px;opacity: 0.3;text-align: center;background-color: black;box-shadow: 0px 0px 5px rgb(90, 90, 90);border: 1px solid black;top: -85px;right: -32px;}.webodf-caretOverlay .handle > img {box-shadow: 0px 0px 5px rgb(90, 90, 90) inset;background-color: rgb(200, 200, 200);border-radius: 5px;border: 2px solid;height: 60px;width: 60px;display: block;margin: auto;}.webodf-caretOverlay .handle.active {opacity: 0.8;}.webodf-caretOverlay .handle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 43%;}.webodf-caretSizer {display: inline-block;width: 0;visibility: hidden;}#eventTrap {display: block;position: absolute;bottom: 0;left: 0;outline: none;opacity: 0;color: rgba(255, 255, 255, 0);pointer-events: none;white-space: pre;overflow: hidden;}cursor|cursor > #composer {text-decoration: underline;}cursor|cursor[cursor|caret-sizer-active="true"],cursor|cursor[cursor|composing="true"] {display: inline;}editinfo|editinfo {display: inline-block;}.editInfoMarker {position: absolute;width: 10px;height: 100%;left: -20px;opacity: 0.8;top: 0;border-radius: 5px;background-color: transparent;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);}.editInfoMarker:hover {box-shadow: 0px 0px 8px rgba(0, 0, 0, 1);}.editInfoHandle {position: absolute;background-color: black;padding: 5px;border-radius: 5px;opacity: 0.8;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);bottom: 100%;margin-bottom: 10px;z-index: 3;left: -25px;}.editInfoHandle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 5px;}.editInfo {font-family: sans-serif;font-weight: normal;font-style: normal;text-decoration: none;color: white;width: 100%;height: 12pt;}.editInfoColor {float: left;width: 10pt;height: 10pt;border: 1px solid white;}.editInfoAuthor {float: left;margin-left: 5pt;font-size: 10pt;text-align: left;height: 12pt;line-height: 12pt;}.editInfoTime {float: right;margin-left: 30pt;font-size: 8pt;font-style: italic;color: yellow;height: 12pt;line-height: 12pt;}.annotationWrapper {display: inline;position: relative;}.annotationRemoveButton:before {content: "\xD7";color: white;padding: 5px;line-height: 1em;}.annotationRemoveButton {width: 20px;height: 20px;border-radius: 10px;background-color: black;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);position: absolute;top: -10px;left: -10px;z-index: 3;text-align: center;font-family: sans-serif;font-style: normal;font-weight: normal;text-decoration: none;font-size: 15px;}.annotationRemoveButton:hover {cursor: pointer;box-shadow: 0px 0px 5px rgba(0, 0, 0, 1);}.annotationNote {width: 4cm;position: absolute;display: inline;z-index: 10;top: 0;}.annotationNote > office|annotation {display: block;text-align: left;}.annotationConnector {position: absolute;display: inline;top: 0;z-index: 2;border-top: 1px dashed brown;}.annotationConnector.angular {-moz-transform-origin: left top;-webkit-transform-origin: left top;-ms-transform-origin: left top;transform-origin: left top;}.annotationConnector.horizontal {left: 0;}.annotationConnector.horizontal:before {content: "";display: inline;position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: brown transparent transparent transparent;top: -1px;left: -5px;}office|annotation {width: 100%;height: 100%;display: none;background: rgb(198, 238, 184);background: -moz-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -webkit-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -o-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -ms-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: linear-gradient(180deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);box-shadow: 0 3px 4px -3px #ccc;}office|annotation > dc|creator {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;color: white;background-color: brown;padding: 4px;}office|annotation > dc|date {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;border: 4px solid transparent;color: black;}office|annotation > text|list {display: block;padding: 5px;}office|annotation text|p {font-size: 10pt;color: black;font-weight: normal;font-style: normal;text-decoration: none;font-family: sans-serif;}#annotationsPane {background-color: #EAEAEA;width: 4cm;height: 100%;display: none;position: absolute;outline: 1px solid #ccc;}.webodf-annotationHighlight {background-color: yellow;position: relative;}.webodf-selectionOverlay {position: absolute;pointer-events: none;top: 0;left: 0;top: 0;left: 0;width: 100%;height: 100%;z-index: 15;}.webodf-selectionOverlay > polygon {fill-opacity: 0.3;stroke-opacity: 0.8;stroke-width: 1;fill-rule: evenodd;}.webodf-selectionOverlay > .webodf-draggable {fill-opacity: 0.8;stroke-opacity: 0;stroke-width: 8;pointer-events: all;display: none;-moz-transform-origin: center center;-webkit-transform-origin: center center;-ms-transform-origin: center center;transform-origin: center center;}#imageSelector {display: none;position: absolute;border-style: solid;border-color: black;}#imageSelector > div {width: 5px;height: 5px;display: block;position: absolute;border: 1px solid black;background-color: #ffffff;}#imageSelector > .topLeft {top: -4px;left: -4px;}#imageSelector > .topRight {top: -4px;right: -4px;}#imageSelector > .bottomRight {right: -4px;bottom: -4px;}#imageSelector > .bottomLeft {bottom: -4px;left: -4px;}#imageSelector > .topMiddle {top: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .rightMiddle {top: 50%;right: -4px;margin-top: -2.5px;}#imageSelector > .bottomMiddle {bottom: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .leftMiddle {top: 50%;left: -4px;margin-top: -2.5px;}div.webodf-customScrollbars::-webkit-scrollbar{width: 8px;height: 8px;background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-track{background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-thumb{background-color: #444;border-radius: 4px;}.webodf-hyperlinkTooltip {display: none;color: white;background-color: black;border-radius: 5px;box-shadow: 2px 2px 5px gray;padding: 3px;position: absolute;max-width: 210px;text-align: left;word-break: break-all;z-index: 16;}.webodf-hyperlinkTooltipText {display: block;font-weight: bold;}';(function(A){var j=typeof window<"u"?window:typeof global<"u"?global:{},M=j.externs||(j.externs={});M.JSZip=A()})(function(){var A,j,M;return function w(E,N,O){function x(S,u){if(!N[S]){if(!E[S]){var y=typeof require=="function"&&require;if(!u&&y)return y(S,!0);if(I)return I(S,!0);throw new Error("Cannot find module '"+S+"'")}var v=N[S]={exports:{}};E[S][0].call(v.exports,function(m){var R=E[S][1][m];return x(R||m)},v,v.exports,w,E,N,O)}return N[S].exports}for(var I=typeof require=="function"&&require,_=0;_<O.length;_++)x(O[_]);return x}({1:[function(w,E,N){var O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";N.encode=function(x,I){for(var _="",S,u,y,v,m,R,V,Z=0;Z<x.length;)S=x.charCodeAt(Z++),u=x.charCodeAt(Z++),y=x.charCodeAt(Z++),v=S>>2,m=(S&3)<<4|u>>4,R=(u&15)<<2|y>>6,V=y&63,isNaN(u)?R=V=64:isNaN(y)&&(V=64),_=_+O.charAt(v)+O.charAt(m)+O.charAt(R)+O.charAt(V);return _},N.decode=function(x,I){var _="",S,u,y,v,m,R,V,Z=0;for(x=x.replace(/[^A-Za-z0-9\+\/\=]/g,"");Z<x.length;)v=O.indexOf(x.charAt(Z++)),m=O.indexOf(x.charAt(Z++)),R=O.indexOf(x.charAt(Z++)),V=O.indexOf(x.charAt(Z++)),S=v<<2|m>>4,u=(m&15)<<4|R>>2,y=(R&3)<<6|V,_=_+String.fromCharCode(S),R!=64&&(_=_+String.fromCharCode(u)),V!=64&&(_=_+String.fromCharCode(y));return _}},{}],2:[function(w,E,N){function O(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}O.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},E.exports=O},{}],3:[function(w,E,N){N.STORE={magic:"\0\0",compress:function(O){return O},uncompress:function(O){return O},compressInputType:null,uncompressInputType:null},N.DEFLATE=w("./flate")},{"./flate":8}],4:[function(w,E,N){var O=w("./utils"),x=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];E.exports=function(_,S){if(typeof _>"u"||!_.length)return 0;var u=O.getTypeOf(_)!=="string";typeof S>"u"&&(S=0);var y=0,v=0,m=0;S=S^-1;for(var R=0,V=_.length;R<V;R++)m=u?_[R]:_.charCodeAt(R),v=(S^m)&255,y=x[v],S=S>>>8^y;return S^-1}},{"./utils":21}],5:[function(w,E,N){var O=w("./utils");function x(I){this.data=null,this.length=0,this.index=0}x.prototype={checkOffset:function(I){this.checkIndex(this.index+I)},checkIndex:function(I){if(this.length<I||I<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+I+"). Corrupted zip ?")},setIndex:function(I){this.checkIndex(I),this.index=I},skip:function(I){this.setIndex(this.index+I)},byteAt:function(I){},readInt:function(I){var _=0,S;for(this.checkOffset(I),S=this.index+I-1;S>=this.index;S--)_=(_<<8)+this.byteAt(S);return this.index+=I,_},readString:function(I){return O.transformTo("string",this.readData(I))},readData:function(I){},lastIndexOfSignature:function(I){},readDate:function(){var I=this.readInt(4);return new Date((I>>25&127)+1980,(I>>21&15)-1,I>>16&31,I>>11&31,I>>5&63,(I&31)<<1)}},E.exports=x},{"./utils":21}],6:[function(w,E,N){N.base64=!1,N.binary=!1,N.dir=!1,N.createFolders=!1,N.date=null,N.compression=null,N.comment=null},{}],7:[function(w,E,N){var O=w("./utils");N.string2binary=function(x){return O.string2binary(x)},N.string2Uint8Array=function(x){return O.transformTo("uint8array",x)},N.uint8Array2String=function(x){return O.transformTo("string",x)},N.string2Blob=function(x){var I=O.transformTo("arraybuffer",x);return O.arrayBuffer2Blob(I)},N.arrayBuffer2Blob=function(x){return O.arrayBuffer2Blob(x)},N.transformTo=function(x,I){return O.transformTo(x,I)},N.getTypeOf=function(x){return O.getTypeOf(x)},N.checkSupport=function(x){return O.checkSupport(x)},N.MAX_VALUE_16BITS=O.MAX_VALUE_16BITS,N.MAX_VALUE_32BITS=O.MAX_VALUE_32BITS,N.pretty=function(x){return O.pretty(x)},N.findCompression=function(x){return O.findCompression(x)},N.isRegExp=function(x){return O.isRegExp(x)}},{"./utils":21}],8:[function(w,E,N){var O=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",x=w("pako");N.uncompressInputType=O?"uint8array":"array",N.compressInputType=O?"uint8array":"array",N.magic="\b\0",N.compress=function(I){return x.deflateRaw(I)},N.uncompress=function(I){return x.inflateRaw(I)}},{pako:24}],9:[function(w,E,N){var O=w("./base64");function x(I,_){if(!(this instanceof x))return new x(I,_);this.files={},this.comment=null,this.root="",I&&this.load(I,_),this.clone=function(){var S=new x;for(var u in this)typeof this[u]!="function"&&(S[u]=this[u]);return S}}x.prototype=w("./object"),x.prototype.load=w("./load"),x.support=w("./support"),x.defaults=w("./defaults"),x.utils=w("./deprecatedPublicUtils"),x.base64={encode:function(I){return O.encode(I)},decode:function(I){return O.decode(I)}},x.compressions=w("./compressions"),E.exports=x},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(w,E,N){var O=w("./base64"),x=w("./zipEntries");E.exports=function(I,_){var S,u,y,v;for(_=_||{},_.base64&&(I=O.decode(I)),u=new x(I,_),S=u.files,y=0;y<S.length;y++)v=S[y],this.file(v.fileName,v.decompressed,{binary:!0,optimizedBinaryString:!0,date:v.date,dir:v.dir,comment:v.fileComment.length?v.fileComment:null,createFolders:_.createFolders});return u.zipComment.length&&(this.comment=u.zipComment),this}},{"./base64":1,"./zipEntries":22}],11:[function(w,E,N){(function(O){E.exports=function(x,I){return new O(x,I)},E.exports.test=function(x){return O.isBuffer(x)}}).call(this,typeof Buffer<"u"?Buffer:void 0)},{}],12:[function(w,E,N){var O=w("./uint8ArrayReader");function x(I){this.data=I,this.length=this.data.length,this.index=0}x.prototype=new O,x.prototype.readData=function(I){this.checkOffset(I);var _=this.data.slice(this.index,this.index+I);return this.index+=I,_},E.exports=x},{"./uint8ArrayReader":18}],13:[function(w,E,N){var O=w("./support"),x=w("./utils"),I=w("./crc32"),_=w("./signature"),S=w("./defaults"),u=w("./base64"),y=w("./compressions"),v=w("./compressedObject"),m=w("./nodeBuffer"),R=w("./utf8"),V=w("./stringWriter"),Z=w("./uint8ArrayWriter"),ne=function(W){if(W._data instanceof v&&(W._data=W._data.getContent(),W.options.binary=!0,W.options.base64=!1,x.getTypeOf(W._data)==="uint8array")){var ie=W._data;W._data=new Uint8Array(ie.length),ie.length!==0&&W._data.set(ie,0)}return W._data},ee=function(W){var ie=ne(W),he=x.getTypeOf(ie);return he==="string"?!W.options.binary&&O.nodebuffer?m(ie,"utf-8"):W.asBinary():ie},z=function(W){var ie=ne(this);return ie===null||typeof ie>"u"?"":(this.options.base64&&(ie=u.decode(ie)),W&&this.options.binary?ie=re.utf8decode(ie):ie=x.transformTo("string",ie),!W&&!this.options.binary&&(ie=x.transformTo("string",re.utf8encode(ie))),ie)},P=function(W,ie,he){this.name=W,this.dir=he.dir,this.date=he.date,this.comment=he.comment,this._data=ie,this.options=he,this._initialMetadata={dir:he.dir,date:he.date}};P.prototype={asText:function(){return z.call(this,!0)},asBinary:function(){return z.call(this,!1)},asNodeBuffer:function(){var W=ee(this);return x.transformTo("nodebuffer",W)},asUint8Array:function(){var W=ee(this);return x.transformTo("uint8array",W)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var Y=function(W,ie){var he="",ve;for(ve=0;ve<ie;ve++)he+=String.fromCharCode(W&255),W=W>>>8;return he},$=function(){var W={},ie,he;for(ie=0;ie<arguments.length;ie++)for(he in arguments[ie])arguments[ie].hasOwnProperty(he)&&typeof W[he]>"u"&&(W[he]=arguments[ie][he]);return W},J=function(W){return W=W||{},W.base64===!0&&(W.binary===null||W.binary===void 0)&&(W.binary=!0),W=$(W,S),W.date=W.date||new Date,W.compression!==null&&(W.compression=W.compression.toUpperCase()),W},te=function(W,ie,he){var ve=x.getTypeOf(ie),Ne;if(he=J(he),he.createFolders&&(Ne=q(W))&&K.call(this,Ne,!0),he.dir||ie===null||typeof ie>"u")he.base64=!1,he.binary=!1,ie=null;else if(ve==="string")he.binary&&!he.base64&&he.optimizedBinaryString!==!0&&(ie=x.string2binary(ie));else{if(he.base64=!1,he.binary=!0,!ve&&!(ie instanceof v))throw new Error("The data of '"+W+"' is in an unsupported format !");ve==="arraybuffer"&&(ie=x.transformTo("uint8array",ie))}var ze=new P(W,ie,he);return this.files[W]=ze,ze},q=function(W){W.slice(-1)=="/"&&(W=W.substring(0,W.length-1));var ie=W.lastIndexOf("/");return ie>0?W.substring(0,ie):""},K=function(W,ie){return W.slice(-1)!="/"&&(W+="/"),ie=typeof ie<"u"?ie:!1,this.files[W]||te.call(this,W,null,{dir:!0,createFolders:ie}),this.files[W]},U=function(W,ie){var he=new v,ve;return W._data instanceof v?(he.uncompressedSize=W._data.uncompressedSize,he.crc32=W._data.crc32,he.uncompressedSize===0||W.dir?(ie=y.STORE,he.compressedContent="",he.crc32=0):W._data.compressionMethod===ie.magic?he.compressedContent=W._data.getCompressedContent():(ve=W._data.getContent(),he.compressedContent=ie.compress(x.transformTo(ie.compressInputType,ve)))):(ve=ee(W),(!ve||ve.length===0||W.dir)&&(ie=y.STORE,ve=""),he.uncompressedSize=ve.length,he.crc32=I(ve),he.compressedContent=ie.compress(x.transformTo(ie.compressInputType,ve))),he.compressedSize=he.compressedContent.length,he.compressionMethod=ie.magic,he},F=function(W,ie,he,ve){var Ne=he.compressedContent,ze=x.transformTo("string",R.utf8encode(ie.name)),rt=ie.comment||"",le=x.transformTo("string",R.utf8encode(rt)),me=ze.length!==ie.name.length,De=le.length!==rt.length,Me=ie.options,Re,we,ke="",Ve="",We="",$e,ue;ie._initialMetadata.dir!==ie.dir?$e=ie.dir:$e=Me.dir,ie._initialMetadata.date!==ie.date?ue=ie.date:ue=Me.date,Re=ue.getHours(),Re=Re<<6,Re=Re|ue.getMinutes(),Re=Re<<5,Re=Re|ue.getSeconds()/2,we=ue.getFullYear()-1980,we=we<<4,we=we|ue.getMonth()+1,we=we<<5,we=we|ue.getDate(),me&&(Ve=Y(1,1)+Y(I(ze),4)+ze,ke+="up"+Y(Ve.length,2)+Ve),De&&(We=Y(1,1)+Y(this.crc32(le),4)+le,ke+="uc"+Y(We.length,2)+We);var Se="";Se+=`
\0`,Se+=me||De?"\0\b":"\0\0",Se+=he.compressionMethod,Se+=Y(Re,2),Se+=Y(we,2),Se+=Y(he.crc32,4),Se+=Y(he.compressedSize,4),Se+=Y(he.uncompressedSize,4),Se+=Y(ze.length,2),Se+=Y(ke.length,2);var be=_.LOCAL_FILE_HEADER+Se+ze+ke,Fe=_.CENTRAL_FILE_HEADER+"\0"+Se+Y(le.length,2)+"\0\0\0\0"+($e===!0?"\0\0\0":"\0\0\0\0")+Y(ve,4)+ze+ke+le;return{fileRecord:be,dirRecord:Fe,compressedObject:he}},re={load:function(W,ie){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(W){var ie=[],he,ve,Ne,ze;for(he in this.files)this.files.hasOwnProperty(he)&&(Ne=this.files[he],ze=new P(Ne.name,Ne._data,$(Ne.options)),ve=he.slice(this.root.length,he.length),he.slice(0,this.root.length)===this.root&&W(ve,ze)&&ie.push(ze));return ie},file:function(W,ie,he){if(arguments.length===1)if(x.isRegExp(W)){var ve=W;return this.filter(function(Ne,ze){return!ze.dir&&ve.test(Ne)})}else return this.filter(function(Ne,ze){return!ze.dir&&Ne===W})[0]||null;else W=this.root+W,te.call(this,W,ie,he);return this},folder:function(W){if(!W)return this;if(x.isRegExp(W))return this.filter(function(Ne,ze){return ze.dir&&W.test(Ne)});var ie=this.root+W,he=K.call(this,ie),ve=this.clone();return ve.root=he.name,ve},remove:function(W){W=this.root+W;var ie=this.files[W];if(ie||(W.slice(-1)!="/"&&(W+="/"),ie=this.files[W]),ie&&!ie.dir)delete this.files[W];else for(var he=this.filter(function(Ne,ze){return ze.name.slice(0,W.length)===W}),ve=0;ve<he.length;ve++)delete this.files[he[ve].name];return this},generate:function(W){W=$(W||{},{base64:!0,compression:"STORE",type:"base64",comment:null}),x.checkSupport(W.type);var ie=[],he=0,ve=0,Ne,ze,rt=x.transformTo("string",this.utf8encode(W.comment||this.comment||""));for(var le in this.files)if(this.files.hasOwnProperty(le)){var me=this.files[le],De=me.options.compression||W.compression.toUpperCase(),Me=y[De];if(!Me)throw new Error(De+" is not a valid compression method !");var Re=U.call(this,me,Me),we=F.call(this,le,me,Re,he);he+=we.fileRecord.length+Re.compressedSize,ve+=we.dirRecord.length,ie.push(we)}var ke="";ke=_.CENTRAL_DIRECTORY_END+"\0\0\0\0"+Y(ie.length,2)+Y(ie.length,2)+Y(ve,4)+Y(he,4)+Y(rt.length,2)+rt;var Ve=W.type.toLowerCase();for(Ve==="uint8array"||Ve==="arraybuffer"||Ve==="blob"||Ve==="nodebuffer"?Ne=new Z(he+ve+ke.length):Ne=new V(he+ve+ke.length),ze=0;ze<ie.length;ze++)Ne.append(ie[ze].fileRecord),Ne.append(ie[ze].compressedObject.compressedContent);for(ze=0;ze<ie.length;ze++)Ne.append(ie[ze].dirRecord);Ne.append(ke);var We=Ne.finalize();switch(W.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return x.transformTo(W.type.toLowerCase(),We);case"blob":return x.arrayBuffer2Blob(x.transformTo("arraybuffer",We));case"base64":return W.base64?u.encode(We):We;default:return We}},crc32:function(W,ie){return I(W,ie)},utf8encode:function(W){return x.transformTo("string",R.utf8encode(W))},utf8decode:function(W){return R.utf8decode(W)}};E.exports=re},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(w,E,N){N.LOCAL_FILE_HEADER="PK",N.CENTRAL_FILE_HEADER="PK",N.CENTRAL_DIRECTORY_END="PK",N.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",N.ZIP64_CENTRAL_DIRECTORY_END="PK",N.DATA_DESCRIPTOR="PK\x07\b"},{}],15:[function(w,E,N){var O=w("./dataReader"),x=w("./utils");function I(_,S){this.data=_,S||(this.data=x.string2binary(this.data)),this.length=this.data.length,this.index=0}I.prototype=new O,I.prototype.byteAt=function(_){return this.data.charCodeAt(_)},I.prototype.lastIndexOfSignature=function(_){return this.data.lastIndexOf(_)},I.prototype.readData=function(_){this.checkOffset(_);var S=this.data.slice(this.index,this.index+_);return this.index+=_,S},E.exports=I},{"./dataReader":5,"./utils":21}],16:[function(w,E,N){var O=w("./utils"),x=function(){this.data=[]};x.prototype={append:function(I){I=O.transformTo("string",I),this.data.push(I)},finalize:function(){return this.data.join("")}},E.exports=x},{"./utils":21}],17:[function(w,E,N){(function(O){if(N.base64=!0,N.array=!0,N.string=!0,N.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",N.nodebuffer=typeof O<"u",N.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")N.blob=!1;else{var x=new ArrayBuffer(0);try{N.blob=new Blob([x],{type:"application/zip"}).size===0}catch{try{var I=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,_=new I;_.append(x),N.blob=_.getBlob("application/zip").size===0}catch{N.blob=!1}}}}).call(this,typeof Buffer<"u"?Buffer:void 0)},{}],18:[function(w,E,N){var O=w("./dataReader");function x(I){I&&(this.data=I,this.length=this.data.length,this.index=0)}x.prototype=new O,x.prototype.byteAt=function(I){return this.data[I]},x.prototype.lastIndexOfSignature=function(I){for(var _=I.charCodeAt(0),S=I.charCodeAt(1),u=I.charCodeAt(2),y=I.charCodeAt(3),v=this.length-4;v>=0;--v)if(this.data[v]===_&&this.data[v+1]===S&&this.data[v+2]===u&&this.data[v+3]===y)return v;return-1},x.prototype.readData=function(I){if(this.checkOffset(I),I===0)return new Uint8Array(0);var _=this.data.subarray(this.index,this.index+I);return this.index+=I,_},E.exports=x},{"./dataReader":5}],19:[function(w,E,N){var O=w("./utils"),x=function(I){this.data=new Uint8Array(I),this.index=0};x.prototype={append:function(I){I.length!==0&&(I=O.transformTo("uint8array",I),this.data.set(I,this.index),this.index+=I.length)},finalize:function(){return this.data}},E.exports=x},{"./utils":21}],20:[function(w,E,N){for(var O=w("./utils"),x=w("./support"),I=w("./nodeBuffer"),_=new Array(256),S=0;S<256;S++)_[S]=S>=252?6:S>=248?5:S>=240?4:S>=224?3:S>=192?2:1;_[254]=_[254]=1;var u=function(m){var R,V,Z,ne,ee,z=m.length,P=0;for(ne=0;ne<z;ne++)V=m.charCodeAt(ne),(V&64512)===55296&&ne+1<z&&(Z=m.charCodeAt(ne+1),(Z&64512)===56320&&(V=65536+(V-55296<<10)+(Z-56320),ne++)),P+=V<128?1:V<2048?2:V<65536?3:4;for(x.uint8array?R=new Uint8Array(P):R=new Array(P),ee=0,ne=0;ee<P;ne++)V=m.charCodeAt(ne),(V&64512)===55296&&ne+1<z&&(Z=m.charCodeAt(ne+1),(Z&64512)===56320&&(V=65536+(V-55296<<10)+(Z-56320),ne++)),V<128?R[ee++]=V:V<2048?(R[ee++]=192|V>>>6,R[ee++]=128|V&63):V<65536?(R[ee++]=224|V>>>12,R[ee++]=128|V>>>6&63,R[ee++]=128|V&63):(R[ee++]=240|V>>>18,R[ee++]=128|V>>>12&63,R[ee++]=128|V>>>6&63,R[ee++]=128|V&63);return R},y=function(m,R){var V;for(R=R||m.length,R>m.length&&(R=m.length),V=R-1;V>=0&&(m[V]&192)===128;)V--;return V<0||V===0?R:V+_[m[V]]>R?V:R},v=function(m){var R,V,Z,ne,ee,z=m.length,P=new Array(z*2);for(Z=0,V=0;V<z;){if(ne=m[V++],ne<128){P[Z++]=ne;continue}if(ee=_[ne],ee>4){P[Z++]=65533,V+=ee-1;continue}for(ne&=ee===2?31:ee===3?15:7;ee>1&&V<z;)ne=ne<<6|m[V++]&63,ee--;if(ee>1){P[Z++]=65533;continue}ne<65536?P[Z++]=ne:(ne-=65536,P[Z++]=55296|ne>>10&1023,P[Z++]=56320|ne&1023)}return P.length!==Z&&(P.subarray?P=P.subarray(0,Z):P.length=Z),O.applyFromCharCode(P)};N.utf8encode=function(R){return x.nodebuffer?I(R,"utf-8"):u(R)},N.utf8decode=function(R){if(x.nodebuffer)return O.transformTo("nodebuffer",R).toString("utf-8");R=O.transformTo(x.uint8array?"uint8array":"array",R);for(var V=[],Z=0,ne=R.length,ee=65536;Z<ne;){var z=y(R,Math.min(Z+ee,ne));x.uint8array?V.push(v(R.subarray(Z,z))):V.push(v(R.slice(Z,z))),Z=z}return V.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(w,E,N){var O=w("./support"),x=w("./compressions"),I=w("./nodeBuffer");N.string2binary=function(m){for(var R="",V=0;V<m.length;V++)R+=String.fromCharCode(m.charCodeAt(V)&255);return R},N.arrayBuffer2Blob=function(m){N.checkSupport("blob");try{return new Blob([m],{type:"application/zip"})}catch{try{var R=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,V=new R;return V.append(m),V.getBlob("application/zip")}catch{throw new Error("Bug : can't construct the Blob.")}}};function _(m){return m}function S(m,R){for(var V=0;V<m.length;++V)R[V]=m.charCodeAt(V)&255;return R}function u(m){var R=65536,V=[],Z=m.length,ne=N.getTypeOf(m),ee=0,z=!0;try{switch(ne){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,I(0));break}}catch{z=!1}if(!z){for(var P="",Y=0;Y<m.length;Y++)P+=String.fromCharCode(m[Y]);return P}for(;ee<Z&&R>1;)try{ne==="array"||ne==="nodebuffer"?V.push(String.fromCharCode.apply(null,m.slice(ee,Math.min(ee+R,Z)))):V.push(String.fromCharCode.apply(null,m.subarray(ee,Math.min(ee+R,Z)))),ee+=R}catch{R=Math.floor(R/2)}return V.join("")}N.applyFromCharCode=u;function y(m,R){for(var V=0;V<m.length;V++)R[V]=m[V];return R}var v={};v.string={string:_,array:function(m){return S(m,new Array(m.length))},arraybuffer:function(m){return v.string.uint8array(m).buffer},uint8array:function(m){return S(m,new Uint8Array(m.length))},nodebuffer:function(m){return S(m,I(m.length))}},v.array={string:u,array:_,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return I(m)}},v.arraybuffer={string:function(m){return u(new Uint8Array(m))},array:function(m){return y(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:_,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return I(new Uint8Array(m))}},v.uint8array={string:u,array:function(m){return y(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:_,nodebuffer:function(m){return I(m)}},v.nodebuffer={string:u,array:function(m){return y(m,new Array(m.length))},arraybuffer:function(m){return v.nodebuffer.uint8array(m).buffer},uint8array:function(m){return y(m,new Uint8Array(m.length))},nodebuffer:_},N.transformTo=function(m,R){if(R||(R=""),!m)return R;N.checkSupport(m);var V=N.getTypeOf(R),Z=v[V][m](R);return Z},N.getTypeOf=function(m){if(typeof m=="string")return"string";if(Object.prototype.toString.call(m)==="[object Array]")return"array";if(O.nodebuffer&&I.test(m))return"nodebuffer";if(O.uint8array&&m instanceof Uint8Array)return"uint8array";if(O.arraybuffer&&m instanceof ArrayBuffer)return"arraybuffer"},N.checkSupport=function(m){var R=O[m.toLowerCase()];if(!R)throw new Error(m+" is not supported by this browser")},N.MAX_VALUE_16BITS=65535,N.MAX_VALUE_32BITS=-1,N.pretty=function(m){var R="",V,Z;for(Z=0;Z<(m||"").length;Z++)V=m.charCodeAt(Z),R+="\\x"+(V<16?"0":"")+V.toString(16).toUpperCase();return R},N.findCompression=function(m){for(var R in x)if(x.hasOwnProperty(R)&&x[R].magic===m)return x[R];return null},N.isRegExp=function(m){return Object.prototype.toString.call(m)==="[object RegExp]"}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(w,E,N){var O=w("./stringReader"),x=w("./nodeBufferReader"),I=w("./uint8ArrayReader"),_=w("./utils"),S=w("./signature"),u=w("./zipEntry"),y=w("./support"),v=w("./object");function m(R,V){this.files=[],this.loadOptions=V,R&&this.load(R)}m.prototype={checkSignature:function(R){var V=this.reader.readString(4);if(V!==R)throw new Error("Corrupted zip or bug : unexpected signature ("+_.pretty(V)+", expected "+_.pretty(R)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=v.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var R=this.zip64EndOfCentralSize-44,V=0,Z,ne,ee;V<R;)Z=this.reader.readInt(2),ne=this.reader.readInt(4),ee=this.reader.readString(ne),this.zip64ExtensibleData[Z]={id:Z,length:ne,value:ee}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var R,V;for(R=0;R<this.files.length;R++)V=this.files[R],this.reader.setIndex(V.localHeaderOffset),this.checkSignature(S.LOCAL_FILE_HEADER),V.readLocalPart(this.reader),V.handleUTF8()},readCentralDir:function(){var R;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===S.CENTRAL_FILE_HEADER;)R=new u({zip64:this.zip64},this.loadOptions),R.readCentralPart(this.reader),this.files.push(R)},readEndOfCentral:function(){var R=this.reader.lastIndexOfSignature(S.CENTRAL_DIRECTORY_END);if(R===-1)throw new Error("Corrupted zip : can't find end of central directory");if(this.reader.setIndex(R),this.checkSignature(S.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===_.MAX_VALUE_16BITS||this.diskWithCentralDirStart===_.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===_.MAX_VALUE_16BITS||this.centralDirRecords===_.MAX_VALUE_16BITS||this.centralDirSize===_.MAX_VALUE_32BITS||this.centralDirOffset===_.MAX_VALUE_32BITS){if(this.zip64=!0,R=this.reader.lastIndexOfSignature(S.ZIP64_CENTRAL_DIRECTORY_LOCATOR),R===-1)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(R),this.checkSignature(S.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(S.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(R){var V=_.getTypeOf(R);V==="string"&&!y.uint8array?this.reader=new O(R,this.loadOptions.optimizedBinaryString):V==="nodebuffer"?this.reader=new x(R):this.reader=new I(_.transformTo("uint8array",R))},load:function(R){this.prepareReader(R),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},E.exports=m},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(w,E,N){var O=w("./stringReader"),x=w("./utils"),I=w("./compressedObject"),_=w("./object");function S(u,y){this.options=u,this.loadOptions=y}S.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},prepareCompressedContent:function(u,y,v){return function(){var m=u.index;u.setIndex(y);var R=u.readData(v);return u.setIndex(m),R}},prepareContent:function(u,y,v,m,R){return function(){var V=x.transformTo(m.uncompressInputType,this.getCompressedContent()),Z=m.uncompress(V);if(Z.length!==R)throw new Error("Bug : uncompressed data size mismatch");return Z}},readLocalPart:function(u){var y,v;if(u.skip(22),this.fileNameLength=u.readInt(2),v=u.readInt(2),this.fileName=u.readString(this.fileNameLength),u.skip(v),this.compressedSize==-1||this.uncompressedSize==-1)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(y=x.findCompression(this.compressionMethod),y===null)throw new Error("Corrupted zip : compression "+x.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new I,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(u,u.index,this.compressedSize,y),this.decompressed.getContent=this.prepareContent(u,u.index,this.compressedSize,y,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=x.transformTo("string",this.decompressed.getContent()),_.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(u){if(this.versionMadeBy=u.readString(2),this.versionNeeded=u.readInt(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4),this.fileNameLength=u.readInt(2),this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=u.readString(this.fileNameLength),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readString(this.fileCommentLength),this.dir=!!(this.externalFileAttributes&16)},parseZIP64ExtraField:function(u){if(this.extraFields[1]){var y=new O(this.extraFields[1].value);this.uncompressedSize===x.MAX_VALUE_32BITS&&(this.uncompressedSize=y.readInt(8)),this.compressedSize===x.MAX_VALUE_32BITS&&(this.compressedSize=y.readInt(8)),this.localHeaderOffset===x.MAX_VALUE_32BITS&&(this.localHeaderOffset=y.readInt(8)),this.diskNumberStart===x.MAX_VALUE_32BITS&&(this.diskNumberStart=y.readInt(4))}},readExtraFields:function(u){var y=u.index,v,m,R;for(this.extraFields=this.extraFields||{};u.index<y+this.extraFieldsLength;)v=u.readInt(2),m=u.readInt(2),R=u.readString(m),this.extraFields[v]={id:v,length:m,value:R}},handleUTF8:function(){if(this.useUTF8())this.fileName=_.utf8decode(this.fileName),this.fileComment=_.utf8decode(this.fileComment);else{var u=this.findExtraFieldUnicodePath();u!==null&&(this.fileName=u);var y=this.findExtraFieldUnicodeComment();y!==null&&(this.fileComment=y)}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var y=new O(u.value);return y.readInt(1)!==1||_.crc32(this.fileName)!==y.readInt(4)?null:_.utf8decode(y.readString(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var y=new O(u.value);return y.readInt(1)!==1||_.crc32(this.fileComment)!==y.readInt(4)?null:_.utf8decode(y.readString(u.length-5))}return null}},E.exports=S},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(w,E,N){var O=w("./lib/utils/common").assign,x=w("./lib/deflate"),I=w("./lib/inflate"),_=w("./lib/zlib/constants"),S={};O(S,x,I,_),E.exports=S},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(w,E,N){var O=w("./zlib/deflate.js"),x=w("./utils/common"),I=w("./utils/strings"),_=w("./zlib/messages"),S=w("./zlib/zstream"),u=0,y=4,v=0,m=1,R=-1,V=0,Z=8,ne=function(Y){this.options=x.assign({level:R,method:Z,chunkSize:16384,windowBits:15,memLevel:8,strategy:V,to:""},Y||{});var $=this.options;$.raw&&$.windowBits>0?$.windowBits=-$.windowBits:$.gzip&&$.windowBits>0&&$.windowBits<16&&($.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new S,this.strm.avail_out=0;var J=O.deflateInit2(this.strm,$.level,$.method,$.windowBits,$.memLevel,$.strategy);if(J!==v)throw new Error(_[J]);$.header&&O.deflateSetHeader(this.strm,$.header)};ne.prototype.push=function(Y,$){var J=this.strm,te=this.options.chunkSize,q,K;if(this.ended)return!1;K=$===~~$?$:$===!0?y:u,typeof Y=="string"?J.input=I.string2buf(Y):J.input=Y,J.next_in=0,J.avail_in=J.input.length;do{if(J.avail_out===0&&(J.output=new x.Buf8(te),J.next_out=0,J.avail_out=te),q=O.deflate(J,K),q!==m&&q!==v)return this.onEnd(q),this.ended=!0,!1;(J.avail_out===0||J.avail_in===0&&K===y)&&(this.options.to==="string"?this.onData(I.buf2binstring(x.shrinkBuf(J.output,J.next_out))):this.onData(x.shrinkBuf(J.output,J.next_out)))}while((J.avail_in>0||J.avail_out===0)&&q!==m);return K===y?(q=O.deflateEnd(this.strm),this.onEnd(q),this.ended=!0,q===v):!0},ne.prototype.onData=function(Y){this.chunks.push(Y)},ne.prototype.onEnd=function(Y){Y===v&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=x.flattenChunks(this.chunks)),this.chunks=[],this.err=Y,this.msg=this.strm.msg};function ee(Y,$){var J=new ne($);if(J.push(Y,!0),J.err)throw J.msg;return J.result}function z(Y,$){return $=$||{},$.raw=!0,ee(Y,$)}function P(Y,$){return $=$||{},$.gzip=!0,ee(Y,$)}N.Deflate=ne,N.deflate=ee,N.deflateRaw=z,N.gzip=P},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(w,E,N){var O=w("./zlib/inflate.js"),x=w("./utils/common"),I=w("./utils/strings"),_=w("./zlib/constants"),S=w("./zlib/messages"),u=w("./zlib/zstream"),y=w("./zlib/gzheader"),v=function(V){this.options=x.assign({chunkSize:16384,windowBits:0,to:""},V||{});var Z=this.options;Z.raw&&Z.windowBits>=0&&Z.windowBits<16&&(Z.windowBits=-Z.windowBits,Z.windowBits===0&&(Z.windowBits=-15)),Z.windowBits>=0&&Z.windowBits<16&&!(V&&V.windowBits)&&(Z.windowBits+=32),Z.windowBits>15&&Z.windowBits<48&&(Z.windowBits&15||(Z.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var ne=O.inflateInit2(this.strm,Z.windowBits);if(ne!==_.Z_OK)throw new Error(S[ne]);this.header=new y,O.inflateGetHeader(this.strm,this.header)};v.prototype.push=function(V,Z){var ne=this.strm,ee=this.options.chunkSize,z,P,Y,$,J;if(this.ended)return!1;P=Z===~~Z?Z:Z===!0?_.Z_FINISH:_.Z_NO_FLUSH,typeof V=="string"?ne.input=I.binstring2buf(V):ne.input=V,ne.next_in=0,ne.avail_in=ne.input.length;do{if(ne.avail_out===0&&(ne.output=new x.Buf8(ee),ne.next_out=0,ne.avail_out=ee),z=O.inflate(ne,_.Z_NO_FLUSH),z!==_.Z_STREAM_END&&z!==_.Z_OK)return this.onEnd(z),this.ended=!0,!1;ne.next_out&&(ne.avail_out===0||z===_.Z_STREAM_END||ne.avail_in===0&&P===_.Z_FINISH)&&(this.options.to==="string"?(Y=I.utf8border(ne.output,ne.next_out),$=ne.next_out-Y,J=I.buf2string(ne.output,Y),ne.next_out=$,ne.avail_out=ee-$,$&&x.arraySet(ne.output,ne.output,Y,$,0),this.onData(J)):this.onData(x.shrinkBuf(ne.output,ne.next_out)))}while(ne.avail_in>0&&z!==_.Z_STREAM_END);return z===_.Z_STREAM_END&&(P=_.Z_FINISH),P===_.Z_FINISH?(z=O.inflateEnd(this.strm),this.onEnd(z),this.ended=!0,z===_.Z_OK):!0},v.prototype.onData=function(V){this.chunks.push(V)},v.prototype.onEnd=function(V){V===_.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=x.flattenChunks(this.chunks)),this.chunks=[],this.err=V,this.msg=this.strm.msg};function m(V,Z){var ne=new v(Z);if(ne.push(V,!0),ne.err)throw ne.msg;return ne.result}function R(V,Z){return Z=Z||{},Z.raw=!0,m(V,Z)}N.Inflate=v,N.inflate=m,N.inflateRaw=R,N.ungzip=m},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(w,E,N){var O=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";N.assign=function(_){for(var S=Array.prototype.slice.call(arguments,1);S.length;){var u=S.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var y in u)u.hasOwnProperty(y)&&(_[y]=u[y])}}return _},N.shrinkBuf=function(_,S){return _.length===S?_:_.subarray?_.subarray(0,S):(_.length=S,_)};var x={arraySet:function(_,S,u,y,v){if(S.subarray&&_.subarray){_.set(S.subarray(u,u+y),v);return}for(var m=0;m<y;m++)_[v+m]=S[u+m]},flattenChunks:function(_){var S,u,y,v,m,R;for(y=0,S=0,u=_.length;S<u;S++)y+=_[S].length;for(R=new Uint8Array(y),v=0,S=0,u=_.length;S<u;S++)m=_[S],R.set(m,v),v+=m.length;return R}},I={arraySet:function(_,S,u,y,v){for(var m=0;m<y;m++)_[v+m]=S[u+m]},flattenChunks:function(_){return[].concat.apply([],_)}};N.setTyped=function(_){_?(N.Buf8=Uint8Array,N.Buf16=Uint16Array,N.Buf32=Int32Array,N.assign(N,x)):(N.Buf8=Array,N.Buf16=Array,N.Buf32=Array,N.assign(N,I))},N.setTyped(O)},{}],28:[function(w,E,N){var O=w("./common"),x=!0,I=!0;try{String.fromCharCode.apply(null,[0])}catch{x=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{I=!1}for(var _=new O.Buf8(256),S=0;S<256;S++)_[S]=S>=252?6:S>=248?5:S>=240?4:S>=224?3:S>=192?2:1;_[254]=_[254]=1,N.string2buf=function(y){var v,m,R,V,Z,ne=y.length,ee=0;for(V=0;V<ne;V++)m=y.charCodeAt(V),(m&64512)===55296&&V+1<ne&&(R=y.charCodeAt(V+1),(R&64512)===56320&&(m=65536+(m-55296<<10)+(R-56320),V++)),ee+=m<128?1:m<2048?2:m<65536?3:4;for(v=new O.Buf8(ee),Z=0,V=0;Z<ee;V++)m=y.charCodeAt(V),(m&64512)===55296&&V+1<ne&&(R=y.charCodeAt(V+1),(R&64512)===56320&&(m=65536+(m-55296<<10)+(R-56320),V++)),m<128?v[Z++]=m:m<2048?(v[Z++]=192|m>>>6,v[Z++]=128|m&63):m<65536?(v[Z++]=224|m>>>12,v[Z++]=128|m>>>6&63,v[Z++]=128|m&63):(v[Z++]=240|m>>>18,v[Z++]=128|m>>>12&63,v[Z++]=128|m>>>6&63,v[Z++]=128|m&63);return v};function u(y,v){if(v<65537&&(y.subarray&&I||!y.subarray&&x))return String.fromCharCode.apply(null,O.shrinkBuf(y,v));for(var m="",R=0;R<v;R++)m+=String.fromCharCode(y[R]);return m}N.buf2binstring=function(y){return u(y,y.length)},N.binstring2buf=function(y){for(var v=new O.Buf8(y.length),m=0,R=v.length;m<R;m++)v[m]=y.charCodeAt(m);return v},N.buf2string=function(y,v){var m,R,V,Z,ne=v||y.length,ee=new Array(ne*2);for(R=0,m=0;m<ne;){if(V=y[m++],V<128){ee[R++]=V;continue}if(Z=_[V],Z>4){ee[R++]=65533,m+=Z-1;continue}for(V&=Z===2?31:Z===3?15:7;Z>1&&m<ne;)V=V<<6|y[m++]&63,Z--;if(Z>1){ee[R++]=65533;continue}V<65536?ee[R++]=V:(V-=65536,ee[R++]=55296|V>>10&1023,ee[R++]=56320|V&1023)}return u(ee,R)},N.utf8border=function(y,v){var m;for(v=v||y.length,v>y.length&&(v=y.length),m=v-1;m>=0&&(y[m]&192)===128;)m--;return m<0||m===0?v:m+_[y[m]]>v?m:v}},{"./common":27}],29:[function(w,E,N){function O(x,I,_,S){for(var u=x&65535|0,y=x>>>16&65535|0,v=0;_!==0;){v=_>2e3?2e3:_,_-=v;do u=u+I[S++]|0,y=y+u|0;while(--v);u%=65521,y%=65521}return u|y<<16|0}E.exports=O},{}],30:[function(w,E,N){E.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(w,E,N){function O(){for(var _,S=[],u=0;u<256;u++){_=u;for(var y=0;y<8;y++)_=_&1?3988292384^_>>>1:_>>>1;S[u]=_}return S}var x=O();function I(_,S,u,y){var v=x,m=y+u;_=_^-1;for(var R=y;R<m;R++)_=_>>>8^v[(_^S[R])&255];return _^-1}E.exports=I},{}],32:[function(w,E,N){var O=w("../utils/common"),x=w("./trees"),I=w("./adler32"),_=w("./crc32"),S=w("./messages"),u=0,y=1,v=3,m=4,R=5,V=0,Z=1,ne=-2,ee=-3,z=-5,P=-1,Y=1,$=2,J=3,te=4,q=0,K=2,U=8,F=9,re=15,W=8,ie=29,he=256,ve=he+1+ie,Ne=30,ze=19,rt=2*ve+1,le=15,me=3,De=258,Me=De+me+1,Re=32,we=42,ke=69,Ve=73,We=91,$e=103,ue=113,Se=666,be=1,Fe=2,ut=3,Pt=4,yt=3;function At(Q,qe){return Q.msg=S[qe],qe}function ri(Q){return(Q<<1)-(Q>4?9:0)}function $t(Q){for(var qe=Q.length;--qe>=0;)Q[qe]=0}function Rt(Q){var qe=Q.state,Ye=qe.pending;Ye>Q.avail_out&&(Ye=Q.avail_out),Ye!==0&&(O.arraySet(Q.output,qe.pending_buf,qe.pending_out,Ye,Q.next_out),Q.next_out+=Ye,qe.pending_out+=Ye,Q.total_out+=Ye,Q.avail_out-=Ye,qe.pending-=Ye,qe.pending===0&&(qe.pending_out=0))}function zt(Q,qe){x._tr_flush_block(Q,Q.block_start>=0?Q.block_start:-1,Q.strstart-Q.block_start,qe),Q.block_start=Q.strstart,Rt(Q.strm)}function et(Q,qe){Q.pending_buf[Q.pending++]=qe}function ct(Q,qe){Q.pending_buf[Q.pending++]=qe>>>8&255,Q.pending_buf[Q.pending++]=qe&255}function It(Q,qe,Ye,ye){var Ee=Q.avail_in;return Ee>ye&&(Ee=ye),Ee===0?0:(Q.avail_in-=Ee,O.arraySet(qe,Q.input,Q.next_in,Ee,Ye),Q.state.wrap===1?Q.adler=I(Q.adler,qe,Ee,Ye):Q.state.wrap===2&&(Q.adler=_(Q.adler,qe,Ee,Ye)),Q.next_in+=Ee,Q.total_in+=Ee,Ee)}function at(Q,qe){var Ye=Q.max_chain_length,ye=Q.strstart,Ee,Be,St=Q.prev_length,pt=Q.nice_match,gt=Q.strstart>Q.w_size-Me?Q.strstart-(Q.w_size-Me):0,qt=Q.window,Yn=Q.w_mask,Vt=Q.prev,kt=Q.strstart+De,oi=qt[ye+St-1],Si=qt[ye+St];Q.prev_length>=Q.good_match&&(Ye>>=2),pt>Q.lookahead&&(pt=Q.lookahead);do if(Ee=qe,!(qt[Ee+St]!==Si||qt[Ee+St-1]!==oi||qt[Ee]!==qt[ye]||qt[++Ee]!==qt[ye+1])){ye+=2,Ee++;do;while(qt[++ye]===qt[++Ee]&&qt[++ye]===qt[++Ee]&&qt[++ye]===qt[++Ee]&&qt[++ye]===qt[++Ee]&&qt[++ye]===qt[++Ee]&&qt[++ye]===qt[++Ee]&&qt[++ye]===qt[++Ee]&&qt[++ye]===qt[++Ee]&&ye<kt);if(Be=De-(kt-ye),ye=kt-De,Be>St){if(Q.match_start=qe,St=Be,Be>=pt)break;oi=qt[ye+St-1],Si=qt[ye+St]}}while((qe=Vt[qe&Yn])>gt&&--Ye!==0);return St<=Q.lookahead?St:Q.lookahead}function vt(Q){var qe=Q.w_size,Ye,ye,Ee,Be,St;do{if(Be=Q.window_size-Q.lookahead-Q.strstart,Q.strstart>=qe+(qe-Me)){O.arraySet(Q.window,Q.window,qe,qe,0),Q.match_start-=qe,Q.strstart-=qe,Q.block_start-=qe,ye=Q.hash_size,Ye=ye;do Ee=Q.head[--Ye],Q.head[Ye]=Ee>=qe?Ee-qe:0;while(--ye);ye=qe,Ye=ye;do Ee=Q.prev[--Ye],Q.prev[Ye]=Ee>=qe?Ee-qe:0;while(--ye);Be+=qe}if(Q.strm.avail_in===0)break;if(ye=It(Q.strm,Q.window,Q.strstart+Q.lookahead,Be),Q.lookahead+=ye,Q.lookahead+Q.insert>=me)for(St=Q.strstart-Q.insert,Q.ins_h=Q.window[St],Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[St+1])&Q.hash_mask;Q.insert&&(Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[St+me-1])&Q.hash_mask,Q.prev[St&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=St,St++,Q.insert--,!(Q.lookahead+Q.insert<me)););}while(Q.lookahead<Me&&Q.strm.avail_in!==0)}function Ke(Q,qe){var Ye=65535;for(Ye>Q.pending_buf_size-5&&(Ye=Q.pending_buf_size-5);;){if(Q.lookahead<=1){if(vt(Q),Q.lookahead===0&&qe===u)return be;if(Q.lookahead===0)break}Q.strstart+=Q.lookahead,Q.lookahead=0;var ye=Q.block_start+Ye;if((Q.strstart===0||Q.strstart>=ye)&&(Q.lookahead=Q.strstart-ye,Q.strstart=ye,zt(Q,!1),Q.strm.avail_out===0)||Q.strstart-Q.block_start>=Q.w_size-Me&&(zt(Q,!1),Q.strm.avail_out===0))return be}return Q.insert=0,qe===m?(zt(Q,!0),Q.strm.avail_out===0?ut:Pt):(Q.strstart>Q.block_start&&(zt(Q,!1),Q.strm.avail_out===0),be)}function Je(Q,qe){for(var Ye,ye;;){if(Q.lookahead<Me){if(vt(Q),Q.lookahead<Me&&qe===u)return be;if(Q.lookahead===0)break}if(Ye=0,Q.lookahead>=me&&(Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+me-1])&Q.hash_mask,Ye=Q.prev[Q.strstart&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=Q.strstart),Ye!==0&&Q.strstart-Ye<=Q.w_size-Me&&(Q.match_length=at(Q,Ye)),Q.match_length>=me)if(ye=x._tr_tally(Q,Q.strstart-Q.match_start,Q.match_length-me),Q.lookahead-=Q.match_length,Q.match_length<=Q.max_lazy_match&&Q.lookahead>=me){Q.match_length--;do Q.strstart++,Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+me-1])&Q.hash_mask,Ye=Q.prev[Q.strstart&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=Q.strstart;while(--Q.match_length!==0);Q.strstart++}else Q.strstart+=Q.match_length,Q.match_length=0,Q.ins_h=Q.window[Q.strstart],Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+1])&Q.hash_mask;else ye=x._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++;if(ye&&(zt(Q,!1),Q.strm.avail_out===0))return be}return Q.insert=Q.strstart<me-1?Q.strstart:me-1,qe===m?(zt(Q,!0),Q.strm.avail_out===0?ut:Pt):Q.last_lit&&(zt(Q,!1),Q.strm.avail_out===0)?be:Fe}function ei(Q,qe){for(var Ye,ye,Ee;;){if(Q.lookahead<Me){if(vt(Q),Q.lookahead<Me&&qe===u)return be;if(Q.lookahead===0)break}if(Ye=0,Q.lookahead>=me&&(Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+me-1])&Q.hash_mask,Ye=Q.prev[Q.strstart&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=Q.strstart),Q.prev_length=Q.match_length,Q.prev_match=Q.match_start,Q.match_length=me-1,Ye!==0&&Q.prev_length<Q.max_lazy_match&&Q.strstart-Ye<=Q.w_size-Me&&(Q.match_length=at(Q,Ye),Q.match_length<=5&&(Q.strategy===Y||Q.match_length===me&&Q.strstart-Q.match_start>4096)&&(Q.match_length=me-1)),Q.prev_length>=me&&Q.match_length<=Q.prev_length){Ee=Q.strstart+Q.lookahead-me,ye=x._tr_tally(Q,Q.strstart-1-Q.prev_match,Q.prev_length-me),Q.lookahead-=Q.prev_length-1,Q.prev_length-=2;do++Q.strstart<=Ee&&(Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+me-1])&Q.hash_mask,Ye=Q.prev[Q.strstart&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=Q.strstart);while(--Q.prev_length!==0);if(Q.match_available=0,Q.match_length=me-1,Q.strstart++,ye&&(zt(Q,!1),Q.strm.avail_out===0))return be}else if(Q.match_available){if(ye=x._tr_tally(Q,0,Q.window[Q.strstart-1]),ye&&zt(Q,!1),Q.strstart++,Q.lookahead--,Q.strm.avail_out===0)return be}else Q.match_available=1,Q.strstart++,Q.lookahead--}return Q.match_available&&(ye=x._tr_tally(Q,0,Q.window[Q.strstart-1]),Q.match_available=0),Q.insert=Q.strstart<me-1?Q.strstart:me-1,qe===m?(zt(Q,!0),Q.strm.avail_out===0?ut:Pt):Q.last_lit&&(zt(Q,!1),Q.strm.avail_out===0)?be:Fe}function ki(Q,qe){for(var Ye,ye,Ee,Be,St=Q.window;;){if(Q.lookahead<=De){if(vt(Q),Q.lookahead<=De&&qe===u)return be;if(Q.lookahead===0)break}if(Q.match_length=0,Q.lookahead>=me&&Q.strstart>0&&(Ee=Q.strstart-1,ye=St[Ee],ye===St[++Ee]&&ye===St[++Ee]&&ye===St[++Ee])){Be=Q.strstart+De;do;while(ye===St[++Ee]&&ye===St[++Ee]&&ye===St[++Ee]&&ye===St[++Ee]&&ye===St[++Ee]&&ye===St[++Ee]&&ye===St[++Ee]&&ye===St[++Ee]&&Ee<Be);Q.match_length=De-(Be-Ee),Q.match_length>Q.lookahead&&(Q.match_length=Q.lookahead)}if(Q.match_length>=me?(Ye=x._tr_tally(Q,1,Q.match_length-me),Q.lookahead-=Q.match_length,Q.strstart+=Q.match_length,Q.match_length=0):(Ye=x._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++),Ye&&(zt(Q,!1),Q.strm.avail_out===0))return be}return Q.insert=0,qe===m?(zt(Q,!0),Q.strm.avail_out===0?ut:Pt):Q.last_lit&&(zt(Q,!1),Q.strm.avail_out===0)?be:Fe}function ti(Q,qe){for(var Ye;;){if(Q.lookahead===0&&(vt(Q),Q.lookahead===0)){if(qe===u)return be;break}if(Q.match_length=0,Ye=x._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++,Ye&&(zt(Q,!1),Q.strm.avail_out===0))return be}return Q.insert=0,qe===m?(zt(Q,!0),Q.strm.avail_out===0?ut:Pt):Q.last_lit&&(zt(Q,!1),Q.strm.avail_out===0)?be:Fe}var je=function(Q,qe,Ye,ye,Ee){this.good_length=Q,this.max_lazy=qe,this.nice_length=Ye,this.max_chain=ye,this.func=Ee},Xe;Xe=[new je(0,0,0,0,Ke),new je(4,4,8,4,Je),new je(4,5,16,8,Je),new je(4,6,32,32,Je),new je(4,4,16,16,ei),new je(8,16,32,32,ei),new je(8,16,128,128,ei),new je(8,32,128,256,ei),new je(32,128,258,1024,ei),new je(32,258,258,4096,ei)];function _t(Q){Q.window_size=2*Q.w_size,$t(Q.head),Q.max_lazy_match=Xe[Q.level].max_lazy,Q.good_match=Xe[Q.level].good_length,Q.nice_match=Xe[Q.level].nice_length,Q.max_chain_length=Xe[Q.level].max_chain,Q.strstart=0,Q.block_start=0,Q.lookahead=0,Q.insert=0,Q.match_length=Q.prev_length=me-1,Q.match_available=0,Q.ins_h=0}function fe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=U,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new O.Buf16(rt*2),this.dyn_dtree=new O.Buf16((2*Ne+1)*2),this.bl_tree=new O.Buf16((2*ze+1)*2),$t(this.dyn_ltree),$t(this.dyn_dtree),$t(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new O.Buf16(le+1),this.heap=new O.Buf16(2*ve+1),$t(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new O.Buf16(2*ve+1),$t(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function tt(Q){var qe;return!Q||!Q.state?At(Q,ne):(Q.total_in=Q.total_out=0,Q.data_type=K,qe=Q.state,qe.pending=0,qe.pending_out=0,qe.wrap<0&&(qe.wrap=-qe.wrap),qe.status=qe.wrap?we:ue,Q.adler=qe.wrap===2?0:1,qe.last_flush=u,x._tr_init(qe),V)}function ot(Q){var qe=tt(Q);return qe===V&&_t(Q.state),qe}function Oe(Q,qe){return!Q||!Q.state||Q.state.wrap!==2?ne:(Q.state.gzhead=qe,V)}function Qe(Q,qe,Ye,ye,Ee,Be){if(!Q)return ne;var St=1;if(qe===P&&(qe=6),ye<0?(St=0,ye=-ye):ye>15&&(St=2,ye-=16),Ee<1||Ee>F||Ye!==U||ye<8||ye>15||qe<0||qe>9||Be<0||Be>te)return At(Q,ne);ye===8&&(ye=9);var pt=new fe;return Q.state=pt,pt.strm=Q,pt.wrap=St,pt.gzhead=null,pt.w_bits=ye,pt.w_size=1<<pt.w_bits,pt.w_mask=pt.w_size-1,pt.hash_bits=Ee+7,pt.hash_size=1<<pt.hash_bits,pt.hash_mask=pt.hash_size-1,pt.hash_shift=~~((pt.hash_bits+me-1)/me),pt.window=new O.Buf8(pt.w_size*2),pt.head=new O.Buf16(pt.hash_size),pt.prev=new O.Buf16(pt.w_size),pt.lit_bufsize=1<<Ee+6,pt.pending_buf_size=pt.lit_bufsize*4,pt.pending_buf=new O.Buf8(pt.pending_buf_size),pt.d_buf=pt.lit_bufsize>>1,pt.l_buf=3*pt.lit_bufsize,pt.level=qe,pt.strategy=Be,pt.method=Ye,ot(Q)}function de(Q,qe){return Qe(Q,qe,U,re,W,q)}function nt(Q,qe){var Ye,ye,Ee,Be;if(!Q||!Q.state||qe>R||qe<0)return Q?At(Q,ne):ne;if(ye=Q.state,!Q.output||!Q.input&&Q.avail_in!==0||ye.status===Se&&qe!==m)return At(Q,Q.avail_out===0?z:ne);if(ye.strm=Q,Ye=ye.last_flush,ye.last_flush=qe,ye.status===we)if(ye.wrap===2)Q.adler=0,et(ye,31),et(ye,139),et(ye,8),ye.gzhead?(et(ye,(ye.gzhead.text?1:0)+(ye.gzhead.hcrc?2:0)+(ye.gzhead.extra?4:0)+(ye.gzhead.name?8:0)+(ye.gzhead.comment?16:0)),et(ye,ye.gzhead.time&255),et(ye,ye.gzhead.time>>8&255),et(ye,ye.gzhead.time>>16&255),et(ye,ye.gzhead.time>>24&255),et(ye,ye.level===9?2:ye.strategy>=$||ye.level<2?4:0),et(ye,ye.gzhead.os&255),ye.gzhead.extra&&ye.gzhead.extra.length&&(et(ye,ye.gzhead.extra.length&255),et(ye,ye.gzhead.extra.length>>8&255)),ye.gzhead.hcrc&&(Q.adler=_(Q.adler,ye.pending_buf,ye.pending,0)),ye.gzindex=0,ye.status=ke):(et(ye,0),et(ye,0),et(ye,0),et(ye,0),et(ye,0),et(ye,ye.level===9?2:ye.strategy>=$||ye.level<2?4:0),et(ye,yt),ye.status=ue);else{var St=U+(ye.w_bits-8<<4)<<8,pt=-1;ye.strategy>=$||ye.level<2?pt=0:ye.level<6?pt=1:ye.level===6?pt=2:pt=3,St|=pt<<6,ye.strstart!==0&&(St|=Re),St+=31-St%31,ye.status=ue,ct(ye,St),ye.strstart!==0&&(ct(ye,Q.adler>>>16),ct(ye,Q.adler&65535)),Q.adler=1}if(ye.status===ke)if(ye.gzhead.extra){for(Ee=ye.pending;ye.gzindex<(ye.gzhead.extra.length&65535)&&!(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>Ee&&(Q.adler=_(Q.adler,ye.pending_buf,ye.pending-Ee,Ee)),Rt(Q),Ee=ye.pending,ye.pending===ye.pending_buf_size));)et(ye,ye.gzhead.extra[ye.gzindex]&255),ye.gzindex++;ye.gzhead.hcrc&&ye.pending>Ee&&(Q.adler=_(Q.adler,ye.pending_buf,ye.pending-Ee,Ee)),ye.gzindex===ye.gzhead.extra.length&&(ye.gzindex=0,ye.status=Ve)}else ye.status=Ve;if(ye.status===Ve)if(ye.gzhead.name){Ee=ye.pending;do{if(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>Ee&&(Q.adler=_(Q.adler,ye.pending_buf,ye.pending-Ee,Ee)),Rt(Q),Ee=ye.pending,ye.pending===ye.pending_buf_size)){Be=1;break}ye.gzindex<ye.gzhead.name.length?Be=ye.gzhead.name.charCodeAt(ye.gzindex++)&255:Be=0,et(ye,Be)}while(Be!==0);ye.gzhead.hcrc&&ye.pending>Ee&&(Q.adler=_(Q.adler,ye.pending_buf,ye.pending-Ee,Ee)),Be===0&&(ye.gzindex=0,ye.status=We)}else ye.status=We;if(ye.status===We)if(ye.gzhead.comment){Ee=ye.pending;do{if(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>Ee&&(Q.adler=_(Q.adler,ye.pending_buf,ye.pending-Ee,Ee)),Rt(Q),Ee=ye.pending,ye.pending===ye.pending_buf_size)){Be=1;break}ye.gzindex<ye.gzhead.comment.length?Be=ye.gzhead.comment.charCodeAt(ye.gzindex++)&255:Be=0,et(ye,Be)}while(Be!==0);ye.gzhead.hcrc&&ye.pending>Ee&&(Q.adler=_(Q.adler,ye.pending_buf,ye.pending-Ee,Ee)),Be===0&&(ye.status=$e)}else ye.status=$e;if(ye.status===$e&&(ye.gzhead.hcrc?(ye.pending+2>ye.pending_buf_size&&Rt(Q),ye.pending+2<=ye.pending_buf_size&&(et(ye,Q.adler&255),et(ye,Q.adler>>8&255),Q.adler=0,ye.status=ue)):ye.status=ue),ye.pending!==0){if(Rt(Q),Q.avail_out===0)return ye.last_flush=-1,V}else if(Q.avail_in===0&&ri(qe)<=ri(Ye)&&qe!==m)return At(Q,z);if(ye.status===Se&&Q.avail_in!==0)return At(Q,z);if(Q.avail_in!==0||ye.lookahead!==0||qe!==u&&ye.status!==Se){var gt=ye.strategy===$?ti(ye,qe):ye.strategy===J?ki(ye,qe):Xe[ye.level].func(ye,qe);if((gt===ut||gt===Pt)&&(ye.status=Se),gt===be||gt===ut)return Q.avail_out===0&&(ye.last_flush=-1),V;if(gt===Fe&&(qe===y?x._tr_align(ye):qe!==R&&(x._tr_stored_block(ye,0,0,!1),qe===v&&($t(ye.head),ye.lookahead===0&&(ye.strstart=0,ye.block_start=0,ye.insert=0))),Rt(Q),Q.avail_out===0))return ye.last_flush=-1,V}return qe!==m?V:ye.wrap<=0?Z:(ye.wrap===2?(et(ye,Q.adler&255),et(ye,Q.adler>>8&255),et(ye,Q.adler>>16&255),et(ye,Q.adler>>24&255),et(ye,Q.total_in&255),et(ye,Q.total_in>>8&255),et(ye,Q.total_in>>16&255),et(ye,Q.total_in>>24&255)):(ct(ye,Q.adler>>>16),ct(ye,Q.adler&65535)),Rt(Q),ye.wrap>0&&(ye.wrap=-ye.wrap),ye.pending!==0?V:Z)}function bt(Q){var qe;return!Q||!Q.state?ne:(qe=Q.state.status,qe!==we&&qe!==ke&&qe!==Ve&&qe!==We&&qe!==$e&&qe!==ue&&qe!==Se?At(Q,ne):(Q.state=null,qe===ue?At(Q,ee):V))}N.deflateInit=de,N.deflateInit2=Qe,N.deflateReset=ot,N.deflateResetKeep=tt,N.deflateSetHeader=Oe,N.deflate=nt,N.deflateEnd=bt,N.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(w,E,N){function O(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}E.exports=O},{}],34:[function(w,E,N){var O=30,x=12;E.exports=function(_,S){var u,y,v,m,R,V,Z,ne,ee,z,P,Y,$,J,te,q,K,U,F,re,W,ie,he,ve,Ne;u=_.state,y=_.next_in,ve=_.input,v=y+(_.avail_in-5),m=_.next_out,Ne=_.output,R=m-(S-_.avail_out),V=m+(_.avail_out-257),Z=u.dmax,ne=u.wsize,ee=u.whave,z=u.wnext,P=u.window,Y=u.hold,$=u.bits,J=u.lencode,te=u.distcode,q=(1<<u.lenbits)-1,K=(1<<u.distbits)-1;e:do{$<15&&(Y+=ve[y++]<<$,$+=8,Y+=ve[y++]<<$,$+=8),U=J[Y&q];t:for(;;){if(F=U>>>24,Y>>>=F,$-=F,F=U>>>16&255,F===0)Ne[m++]=U&65535;else if(F&16){re=U&65535,F&=15,F&&($<F&&(Y+=ve[y++]<<$,$+=8),re+=Y&(1<<F)-1,Y>>>=F,$-=F),$<15&&(Y+=ve[y++]<<$,$+=8,Y+=ve[y++]<<$,$+=8),U=te[Y&K];i:for(;;){if(F=U>>>24,Y>>>=F,$-=F,F=U>>>16&255,F&16){if(W=U&65535,F&=15,$<F&&(Y+=ve[y++]<<$,$+=8,$<F&&(Y+=ve[y++]<<$,$+=8)),W+=Y&(1<<F)-1,W>Z){_.msg="invalid distance too far back",u.mode=O;break e}if(Y>>>=F,$-=F,F=m-R,W>F){if(F=W-F,F>ee&&u.sane){_.msg="invalid distance too far back",u.mode=O;break e}if(ie=0,he=P,z===0){if(ie+=ne-F,F<re){re-=F;do Ne[m++]=P[ie++];while(--F);ie=m-W,he=Ne}}else if(z<F){if(ie+=ne+z-F,F-=z,F<re){re-=F;do Ne[m++]=P[ie++];while(--F);if(ie=0,z<re){F=z,re-=F;do Ne[m++]=P[ie++];while(--F);ie=m-W,he=Ne}}}else if(ie+=z-F,F<re){re-=F;do Ne[m++]=P[ie++];while(--F);ie=m-W,he=Ne}for(;re>2;)Ne[m++]=he[ie++],Ne[m++]=he[ie++],Ne[m++]=he[ie++],re-=3;re&&(Ne[m++]=he[ie++],re>1&&(Ne[m++]=he[ie++]))}else{ie=m-W;do Ne[m++]=Ne[ie++],Ne[m++]=Ne[ie++],Ne[m++]=Ne[ie++],re-=3;while(re>2);re&&(Ne[m++]=Ne[ie++],re>1&&(Ne[m++]=Ne[ie++]))}}else if(F&64){_.msg="invalid distance code",u.mode=O;break e}else{U=te[(U&65535)+(Y&(1<<F)-1)];continue i}break}}else if(F&64)if(F&32){u.mode=x;break e}else{_.msg="invalid literal/length code",u.mode=O;break e}else{U=J[(U&65535)+(Y&(1<<F)-1)];continue t}break}}while(y<v&&m<V);re=$>>3,y-=re,$-=re<<3,Y&=(1<<$)-1,_.next_in=y,_.next_out=m,_.avail_in=y<v?5+(v-y):5-(y-v),_.avail_out=m<V?257+(V-m):257-(m-V),u.hold=Y,u.bits=$}},{}],35:[function(w,E,N){var O=w("../utils/common"),x=w("./adler32"),I=w("./crc32"),_=w("./inffast"),S=w("./inftrees"),u=0,y=1,v=2,m=4,R=5,V=6,Z=0,ne=1,ee=2,z=-2,P=-3,Y=-4,$=-5,J=8,te=1,q=2,K=3,U=4,F=5,re=6,W=7,ie=8,he=9,ve=10,Ne=11,ze=12,rt=13,le=14,me=15,De=16,Me=17,Re=18,we=19,ke=20,Ve=21,We=22,$e=23,ue=24,Se=25,be=26,Fe=27,ut=28,Pt=29,yt=30,At=31,ri=32,$t=852,Rt=592,zt=15,et=zt;function ct(Oe){return(Oe>>>24&255)+(Oe>>>8&65280)+((Oe&65280)<<8)+((Oe&255)<<24)}function It(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new O.Buf16(320),this.work=new O.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function at(Oe){var Qe;return!Oe||!Oe.state?z:(Qe=Oe.state,Oe.total_in=Oe.total_out=Qe.total=0,Oe.msg="",Qe.wrap&&(Oe.adler=Qe.wrap&1),Qe.mode=te,Qe.last=0,Qe.havedict=0,Qe.dmax=32768,Qe.head=null,Qe.hold=0,Qe.bits=0,Qe.lencode=Qe.lendyn=new O.Buf32($t),Qe.distcode=Qe.distdyn=new O.Buf32(Rt),Qe.sane=1,Qe.back=-1,Z)}function vt(Oe){var Qe;return!Oe||!Oe.state?z:(Qe=Oe.state,Qe.wsize=0,Qe.whave=0,Qe.wnext=0,at(Oe))}function Ke(Oe,Qe){var de,nt;return!Oe||!Oe.state||(nt=Oe.state,Qe<0?(de=0,Qe=-Qe):(de=(Qe>>4)+1,Qe<48&&(Qe&=15)),Qe&&(Qe<8||Qe>15))?z:(nt.window!==null&&nt.wbits!==Qe&&(nt.window=null),nt.wrap=de,nt.wbits=Qe,vt(Oe))}function Je(Oe,Qe){var de,nt;return Oe?(nt=new It,Oe.state=nt,nt.window=null,de=Ke(Oe,Qe),de!==Z&&(Oe.state=null),de):z}function ei(Oe){return Je(Oe,et)}var ki=!0,ti,je;function Xe(Oe){if(ki){var Qe;for(ti=new O.Buf32(512),je=new O.Buf32(32),Qe=0;Qe<144;)Oe.lens[Qe++]=8;for(;Qe<256;)Oe.lens[Qe++]=9;for(;Qe<280;)Oe.lens[Qe++]=7;for(;Qe<288;)Oe.lens[Qe++]=8;for(S(y,Oe.lens,0,288,ti,0,Oe.work,{bits:9}),Qe=0;Qe<32;)Oe.lens[Qe++]=5;S(v,Oe.lens,0,32,je,0,Oe.work,{bits:5}),ki=!1}Oe.lencode=ti,Oe.lenbits=9,Oe.distcode=je,Oe.distbits=5}function _t(Oe,Qe,de,nt){var bt,Q=Oe.state;return Q.window===null&&(Q.wsize=1<<Q.wbits,Q.wnext=0,Q.whave=0,Q.window=new O.Buf8(Q.wsize)),nt>=Q.wsize?(O.arraySet(Q.window,Qe,de-Q.wsize,Q.wsize,0),Q.wnext=0,Q.whave=Q.wsize):(bt=Q.wsize-Q.wnext,bt>nt&&(bt=nt),O.arraySet(Q.window,Qe,de-nt,bt,Q.wnext),nt-=bt,nt?(O.arraySet(Q.window,Qe,de-nt,nt,0),Q.wnext=nt,Q.whave=Q.wsize):(Q.wnext+=bt,Q.wnext===Q.wsize&&(Q.wnext=0),Q.whave<Q.wsize&&(Q.whave+=bt))),0}function fe(Oe,Qe){var de,nt,bt,Q,qe,Ye,ye,Ee,Be,St,pt,gt,qt,Yn,Vt=0,kt,oi,Si,Pi,hr,Kt,Yt,Hi,Ai=new O.Buf8(4),qi,ci,Zn=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Oe||!Oe.state||!Oe.output||!Oe.input&&Oe.avail_in!==0)return z;de=Oe.state,de.mode===ze&&(de.mode=rt),qe=Oe.next_out,bt=Oe.output,ye=Oe.avail_out,Q=Oe.next_in,nt=Oe.input,Ye=Oe.avail_in,Ee=de.hold,Be=de.bits,St=Ye,pt=ye,Hi=Z;e:for(;;)switch(de.mode){case te:if(de.wrap===0){de.mode=rt;break}for(;Be<16;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}if(de.wrap&2&&Ee===35615){de.check=0,Ai[0]=Ee&255,Ai[1]=Ee>>>8&255,de.check=I(de.check,Ai,2,0),Ee=0,Be=0,de.mode=q;break}if(de.flags=0,de.head&&(de.head.done=!1),!(de.wrap&1)||(((Ee&255)<<8)+(Ee>>8))%31){Oe.msg="incorrect header check",de.mode=yt;break}if((Ee&15)!==J){Oe.msg="unknown compression method",de.mode=yt;break}if(Ee>>>=4,Be-=4,Yt=(Ee&15)+8,de.wbits===0)de.wbits=Yt;else if(Yt>de.wbits){Oe.msg="invalid window size",de.mode=yt;break}de.dmax=1<<Yt,Oe.adler=de.check=1,de.mode=Ee&512?ve:ze,Ee=0,Be=0;break;case q:for(;Be<16;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}if(de.flags=Ee,(de.flags&255)!==J){Oe.msg="unknown compression method",de.mode=yt;break}if(de.flags&57344){Oe.msg="unknown header flags set",de.mode=yt;break}de.head&&(de.head.text=Ee>>8&1),de.flags&512&&(Ai[0]=Ee&255,Ai[1]=Ee>>>8&255,de.check=I(de.check,Ai,2,0)),Ee=0,Be=0,de.mode=K;case K:for(;Be<32;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}de.head&&(de.head.time=Ee),de.flags&512&&(Ai[0]=Ee&255,Ai[1]=Ee>>>8&255,Ai[2]=Ee>>>16&255,Ai[3]=Ee>>>24&255,de.check=I(de.check,Ai,4,0)),Ee=0,Be=0,de.mode=U;case U:for(;Be<16;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}de.head&&(de.head.xflags=Ee&255,de.head.os=Ee>>8),de.flags&512&&(Ai[0]=Ee&255,Ai[1]=Ee>>>8&255,de.check=I(de.check,Ai,2,0)),Ee=0,Be=0,de.mode=F;case F:if(de.flags&1024){for(;Be<16;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}de.length=Ee,de.head&&(de.head.extra_len=Ee),de.flags&512&&(Ai[0]=Ee&255,Ai[1]=Ee>>>8&255,de.check=I(de.check,Ai,2,0)),Ee=0,Be=0}else de.head&&(de.head.extra=null);de.mode=re;case re:if(de.flags&1024&&(gt=de.length,gt>Ye&&(gt=Ye),gt&&(de.head&&(Yt=de.head.extra_len-de.length,de.head.extra||(de.head.extra=new Array(de.head.extra_len)),O.arraySet(de.head.extra,nt,Q,gt,Yt)),de.flags&512&&(de.check=I(de.check,nt,gt,Q)),Ye-=gt,Q+=gt,de.length-=gt),de.length))break e;de.length=0,de.mode=W;case W:if(de.flags&2048){if(Ye===0)break e;gt=0;do Yt=nt[Q+gt++],de.head&&Yt&&de.length<65536&&(de.head.name+=String.fromCharCode(Yt));while(Yt&&gt<Ye);if(de.flags&512&&(de.check=I(de.check,nt,gt,Q)),Ye-=gt,Q+=gt,Yt)break e}else de.head&&(de.head.name=null);de.length=0,de.mode=ie;case ie:if(de.flags&4096){if(Ye===0)break e;gt=0;do Yt=nt[Q+gt++],de.head&&Yt&&de.length<65536&&(de.head.comment+=String.fromCharCode(Yt));while(Yt&&gt<Ye);if(de.flags&512&&(de.check=I(de.check,nt,gt,Q)),Ye-=gt,Q+=gt,Yt)break e}else de.head&&(de.head.comment=null);de.mode=he;case he:if(de.flags&512){for(;Be<16;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}if(Ee!==(de.check&65535)){Oe.msg="header crc mismatch",de.mode=yt;break}Ee=0,Be=0}de.head&&(de.head.hcrc=de.flags>>9&1,de.head.done=!0),Oe.adler=de.check=0,de.mode=ze;break;case ve:for(;Be<32;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}Oe.adler=de.check=ct(Ee),Ee=0,Be=0,de.mode=Ne;case Ne:if(de.havedict===0)return Oe.next_out=qe,Oe.avail_out=ye,Oe.next_in=Q,Oe.avail_in=Ye,de.hold=Ee,de.bits=Be,ee;Oe.adler=de.check=1,de.mode=ze;case ze:if(Qe===R||Qe===V)break e;case rt:if(de.last){Ee>>>=Be&7,Be-=Be&7,de.mode=Fe;break}for(;Be<3;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}switch(de.last=Ee&1,Ee>>>=1,Be-=1,Ee&3){case 0:de.mode=le;break;case 1:if(Xe(de),de.mode=ke,Qe===V){Ee>>>=2,Be-=2;break e}break;case 2:de.mode=Me;break;case 3:Oe.msg="invalid block type",de.mode=yt}Ee>>>=2,Be-=2;break;case le:for(Ee>>>=Be&7,Be-=Be&7;Be<32;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}if((Ee&65535)!==(Ee>>>16^65535)){Oe.msg="invalid stored block lengths",de.mode=yt;break}if(de.length=Ee&65535,Ee=0,Be=0,de.mode=me,Qe===V)break e;case me:de.mode=De;case De:if(gt=de.length,gt){if(gt>Ye&&(gt=Ye),gt>ye&&(gt=ye),gt===0)break e;O.arraySet(bt,nt,Q,gt,qe),Ye-=gt,Q+=gt,ye-=gt,qe+=gt,de.length-=gt;break}de.mode=ze;break;case Me:for(;Be<14;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}if(de.nlen=(Ee&31)+257,Ee>>>=5,Be-=5,de.ndist=(Ee&31)+1,Ee>>>=5,Be-=5,de.ncode=(Ee&15)+4,Ee>>>=4,Be-=4,de.nlen>286||de.ndist>30){Oe.msg="too many length or distance symbols",de.mode=yt;break}de.have=0,de.mode=Re;case Re:for(;de.have<de.ncode;){for(;Be<3;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}de.lens[Zn[de.have++]]=Ee&7,Ee>>>=3,Be-=3}for(;de.have<19;)de.lens[Zn[de.have++]]=0;if(de.lencode=de.lendyn,de.lenbits=7,qi={bits:de.lenbits},Hi=S(u,de.lens,0,19,de.lencode,0,de.work,qi),de.lenbits=qi.bits,Hi){Oe.msg="invalid code lengths set",de.mode=yt;break}de.have=0,de.mode=we;case we:for(;de.have<de.nlen+de.ndist;){for(;Vt=de.lencode[Ee&(1<<de.lenbits)-1],kt=Vt>>>24,oi=Vt>>>16&255,Si=Vt&65535,!(kt<=Be);){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}if(Si<16)Ee>>>=kt,Be-=kt,de.lens[de.have++]=Si;else{if(Si===16){for(ci=kt+2;Be<ci;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}if(Ee>>>=kt,Be-=kt,de.have===0){Oe.msg="invalid bit length repeat",de.mode=yt;break}Yt=de.lens[de.have-1],gt=3+(Ee&3),Ee>>>=2,Be-=2}else if(Si===17){for(ci=kt+3;Be<ci;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}Ee>>>=kt,Be-=kt,Yt=0,gt=3+(Ee&7),Ee>>>=3,Be-=3}else{for(ci=kt+7;Be<ci;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}Ee>>>=kt,Be-=kt,Yt=0,gt=11+(Ee&127),Ee>>>=7,Be-=7}if(de.have+gt>de.nlen+de.ndist){Oe.msg="invalid bit length repeat",de.mode=yt;break}for(;gt--;)de.lens[de.have++]=Yt}}if(de.mode===yt)break;if(de.lens[256]===0){Oe.msg="invalid code -- missing end-of-block",de.mode=yt;break}if(de.lenbits=9,qi={bits:de.lenbits},Hi=S(y,de.lens,0,de.nlen,de.lencode,0,de.work,qi),de.lenbits=qi.bits,Hi){Oe.msg="invalid literal/lengths set",de.mode=yt;break}if(de.distbits=6,de.distcode=de.distdyn,qi={bits:de.distbits},Hi=S(v,de.lens,de.nlen,de.ndist,de.distcode,0,de.work,qi),de.distbits=qi.bits,Hi){Oe.msg="invalid distances set",de.mode=yt;break}if(de.mode=ke,Qe===V)break e;case ke:de.mode=Ve;case Ve:if(Ye>=6&&ye>=258){Oe.next_out=qe,Oe.avail_out=ye,Oe.next_in=Q,Oe.avail_in=Ye,de.hold=Ee,de.bits=Be,_(Oe,pt),qe=Oe.next_out,bt=Oe.output,ye=Oe.avail_out,Q=Oe.next_in,nt=Oe.input,Ye=Oe.avail_in,Ee=de.hold,Be=de.bits,de.mode===ze&&(de.back=-1);break}for(de.back=0;Vt=de.lencode[Ee&(1<<de.lenbits)-1],kt=Vt>>>24,oi=Vt>>>16&255,Si=Vt&65535,!(kt<=Be);){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}if(oi&&!(oi&240)){for(Pi=kt,hr=oi,Kt=Si;Vt=de.lencode[Kt+((Ee&(1<<Pi+hr)-1)>>Pi)],kt=Vt>>>24,oi=Vt>>>16&255,Si=Vt&65535,!(Pi+kt<=Be);){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}Ee>>>=Pi,Be-=Pi,de.back+=Pi}if(Ee>>>=kt,Be-=kt,de.back+=kt,de.length=Si,oi===0){de.mode=be;break}if(oi&32){de.back=-1,de.mode=ze;break}if(oi&64){Oe.msg="invalid literal/length code",de.mode=yt;break}de.extra=oi&15,de.mode=We;case We:if(de.extra){for(ci=de.extra;Be<ci;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}de.length+=Ee&(1<<de.extra)-1,Ee>>>=de.extra,Be-=de.extra,de.back+=de.extra}de.was=de.length,de.mode=$e;case $e:for(;Vt=de.distcode[Ee&(1<<de.distbits)-1],kt=Vt>>>24,oi=Vt>>>16&255,Si=Vt&65535,!(kt<=Be);){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}if(!(oi&240)){for(Pi=kt,hr=oi,Kt=Si;Vt=de.distcode[Kt+((Ee&(1<<Pi+hr)-1)>>Pi)],kt=Vt>>>24,oi=Vt>>>16&255,Si=Vt&65535,!(Pi+kt<=Be);){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}Ee>>>=Pi,Be-=Pi,de.back+=Pi}if(Ee>>>=kt,Be-=kt,de.back+=kt,oi&64){Oe.msg="invalid distance code",de.mode=yt;break}de.offset=Si,de.extra=oi&15,de.mode=ue;case ue:if(de.extra){for(ci=de.extra;Be<ci;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}de.offset+=Ee&(1<<de.extra)-1,Ee>>>=de.extra,Be-=de.extra,de.back+=de.extra}if(de.offset>de.dmax){Oe.msg="invalid distance too far back",de.mode=yt;break}de.mode=Se;case Se:if(ye===0)break e;if(gt=pt-ye,de.offset>gt){if(gt=de.offset-gt,gt>de.whave&&de.sane){Oe.msg="invalid distance too far back",de.mode=yt;break}gt>de.wnext?(gt-=de.wnext,qt=de.wsize-gt):qt=de.wnext-gt,gt>de.length&&(gt=de.length),Yn=de.window}else Yn=bt,qt=qe-de.offset,gt=de.length;gt>ye&&(gt=ye),ye-=gt,de.length-=gt;do bt[qe++]=Yn[qt++];while(--gt);de.length===0&&(de.mode=Ve);break;case be:if(ye===0)break e;bt[qe++]=de.length,ye--,de.mode=Ve;break;case Fe:if(de.wrap){for(;Be<32;){if(Ye===0)break e;Ye--,Ee|=nt[Q++]<<Be,Be+=8}if(pt-=ye,Oe.total_out+=pt,de.total+=pt,pt&&(Oe.adler=de.check=de.flags?I(de.check,bt,pt,qe-pt):x(de.check,bt,pt,qe-pt)),pt=ye,(de.flags?Ee:ct(Ee))!==de.check){Oe.msg="incorrect data check",de.mode=yt;break}Ee=0,Be=0}de.mode=ut;case ut:if(de.wrap&&de.flags){for(;Be<32;){if(Ye===0)break e;Ye--,Ee+=nt[Q++]<<Be,Be+=8}if(Ee!==(de.total&4294967295)){Oe.msg="incorrect length check",de.mode=yt;break}Ee=0,Be=0}de.mode=Pt;case Pt:Hi=ne;break e;case yt:Hi=P;break e;case At:return Y;case ri:default:return z}return Oe.next_out=qe,Oe.avail_out=ye,Oe.next_in=Q,Oe.avail_in=Ye,de.hold=Ee,de.bits=Be,(de.wsize||pt!==Oe.avail_out&&de.mode<yt&&(de.mode<Fe||Qe!==m))&&_t(Oe,Oe.output,Oe.next_out,pt-Oe.avail_out)?(de.mode=At,Y):(St-=Oe.avail_in,pt-=Oe.avail_out,Oe.total_in+=St,Oe.total_out+=pt,de.total+=pt,de.wrap&&pt&&(Oe.adler=de.check=de.flags?I(de.check,bt,pt,Oe.next_out-pt):x(de.check,bt,pt,Oe.next_out-pt)),Oe.data_type=de.bits+(de.last?64:0)+(de.mode===ze?128:0)+(de.mode===ke||de.mode===me?256:0),(St===0&&pt===0||Qe===m)&&Hi===Z&&(Hi=$),Hi)}function tt(Oe){if(!Oe||!Oe.state)return z;var Qe=Oe.state;return Qe.window&&(Qe.window=null),Oe.state=null,Z}function ot(Oe,Qe){var de;return!Oe||!Oe.state||(de=Oe.state,!(de.wrap&2))?z:(de.head=Qe,Qe.done=!1,Z)}N.inflateReset=vt,N.inflateReset2=Ke,N.inflateResetKeep=at,N.inflateInit=ei,N.inflateInit2=Je,N.inflate=fe,N.inflateEnd=tt,N.inflateGetHeader=ot,N.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(w,E,N){var O=w("../utils/common"),x=15,I=852,_=592,S=0,u=1,y=2,v=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],m=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],R=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],V=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];E.exports=function(ne,ee,z,P,Y,$,J,te){var q=te.bits,K=0,U=0,F=0,re=0,W=0,ie=0,he=0,ve=0,Ne=0,ze=0,rt,le,me,De,Me,Re=null,we=0,ke,Ve=new O.Buf16(x+1),We=new O.Buf16(x+1),$e=null,ue=0,Se,be,Fe;for(K=0;K<=x;K++)Ve[K]=0;for(U=0;U<P;U++)Ve[ee[z+U]]++;for(W=q,re=x;re>=1&&Ve[re]===0;re--);if(W>re&&(W=re),re===0)return Y[$++]=1<<24|64<<16|0,Y[$++]=1<<24|64<<16|0,te.bits=1,0;for(F=1;F<re&&Ve[F]===0;F++);for(W<F&&(W=F),ve=1,K=1;K<=x;K++)if(ve<<=1,ve-=Ve[K],ve<0)return-1;if(ve>0&&(ne===S||re!==1))return-1;for(We[1]=0,K=1;K<x;K++)We[K+1]=We[K]+Ve[K];for(U=0;U<P;U++)ee[z+U]!==0&&(J[We[ee[z+U]]++]=U);if(ne===S?(Re=$e=J,ke=19):ne===u?(Re=v,we-=257,$e=m,ue-=257,ke=256):(Re=R,$e=V,ke=-1),ze=0,U=0,K=F,Me=$,ie=W,he=0,me=-1,Ne=1<<W,De=Ne-1,ne===u&&Ne>I||ne===y&&Ne>_)return 1;for(var ut=0;;){ut++,Se=K-he,J[U]<ke?(be=0,Fe=J[U]):J[U]>ke?(be=$e[ue+J[U]],Fe=Re[we+J[U]]):(be=96,Fe=0),rt=1<<K-he,le=1<<ie,F=le;do le-=rt,Y[Me+(ze>>he)+le]=Se<<24|be<<16|Fe|0;while(le!==0);for(rt=1<<K-1;ze&rt;)rt>>=1;if(rt!==0?(ze&=rt-1,ze+=rt):ze=0,U++,--Ve[K]===0){if(K===re)break;K=ee[z+J[U]]}if(K>W&&(ze&De)!==me){for(he===0&&(he=W),Me+=F,ie=K-he,ve=1<<ie;ie+he<re&&(ve-=Ve[ie+he],!(ve<=0));)ie++,ve<<=1;if(Ne+=1<<ie,ne===u&&Ne>I||ne===y&&Ne>_)return 1;me=ze&De,Y[me]=W<<24|ie<<16|Me-$|0}}return ze!==0&&(Y[Me+ze]=K-he<<24|64<<16|0),te.bits=W,0}},{"../utils/common":27}],37:[function(w,E,N){E.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(w,E,N){var O=w("../utils/common"),x=4,I=0,_=1,S=2;function u(fe){for(var tt=fe.length;--tt>=0;)fe[tt]=0}var y=0,v=1,m=2,R=3,V=258,Z=29,ne=256,ee=ne+1+Z,z=30,P=19,Y=2*ee+1,$=15,J=16,te=7,q=256,K=16,U=17,F=18,re=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],W=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],he=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ve=512,Ne=new Array((ee+2)*2);u(Ne);var ze=new Array(z*2);u(ze);var rt=new Array(ve);u(rt);var le=new Array(V-R+1);u(le);var me=new Array(Z);u(me);var De=new Array(z);u(De);var Me=function(fe,tt,ot,Oe,Qe){this.static_tree=fe,this.extra_bits=tt,this.extra_base=ot,this.elems=Oe,this.max_length=Qe,this.has_stree=fe&&fe.length},Re,we,ke,Ve=function(fe,tt){this.dyn_tree=fe,this.max_code=0,this.stat_desc=tt};function We(fe){return fe<256?rt[fe]:rt[256+(fe>>>7)]}function $e(fe,tt){fe.pending_buf[fe.pending++]=tt&255,fe.pending_buf[fe.pending++]=tt>>>8&255}function ue(fe,tt,ot){fe.bi_valid>J-ot?(fe.bi_buf|=tt<<fe.bi_valid&65535,$e(fe,fe.bi_buf),fe.bi_buf=tt>>J-fe.bi_valid,fe.bi_valid+=ot-J):(fe.bi_buf|=tt<<fe.bi_valid&65535,fe.bi_valid+=ot)}function Se(fe,tt,ot){ue(fe,ot[tt*2],ot[tt*2+1])}function be(fe,tt){var ot=0;do ot|=fe&1,fe>>>=1,ot<<=1;while(--tt>0);return ot>>>1}function Fe(fe){fe.bi_valid===16?($e(fe,fe.bi_buf),fe.bi_buf=0,fe.bi_valid=0):fe.bi_valid>=8&&(fe.pending_buf[fe.pending++]=fe.bi_buf&255,fe.bi_buf>>=8,fe.bi_valid-=8)}function ut(fe,tt){var ot=tt.dyn_tree,Oe=tt.max_code,Qe=tt.stat_desc.static_tree,de=tt.stat_desc.has_stree,nt=tt.stat_desc.extra_bits,bt=tt.stat_desc.extra_base,Q=tt.stat_desc.max_length,qe,Ye,ye,Ee,Be,St,pt=0;for(Ee=0;Ee<=$;Ee++)fe.bl_count[Ee]=0;for(ot[fe.heap[fe.heap_max]*2+1]=0,qe=fe.heap_max+1;qe<Y;qe++)Ye=fe.heap[qe],Ee=ot[ot[Ye*2+1]*2+1]+1,Ee>Q&&(Ee=Q,pt++),ot[Ye*2+1]=Ee,!(Ye>Oe)&&(fe.bl_count[Ee]++,Be=0,Ye>=bt&&(Be=nt[Ye-bt]),St=ot[Ye*2],fe.opt_len+=St*(Ee+Be),de&&(fe.static_len+=St*(Qe[Ye*2+1]+Be)));if(pt!==0){do{for(Ee=Q-1;fe.bl_count[Ee]===0;)Ee--;fe.bl_count[Ee]--,fe.bl_count[Ee+1]+=2,fe.bl_count[Q]--,pt-=2}while(pt>0);for(Ee=Q;Ee!==0;Ee--)for(Ye=fe.bl_count[Ee];Ye!==0;)ye=fe.heap[--qe],!(ye>Oe)&&(ot[ye*2+1]!==Ee&&(fe.opt_len+=(Ee-ot[ye*2+1])*ot[ye*2],ot[ye*2+1]=Ee),Ye--)}}function Pt(fe,tt,ot){var Oe=new Array($+1),Qe=0,de,nt;for(de=1;de<=$;de++)Oe[de]=Qe=Qe+ot[de-1]<<1;for(nt=0;nt<=tt;nt++){var bt=fe[nt*2+1];bt!==0&&(fe[nt*2]=be(Oe[bt]++,bt))}}function yt(){var fe,tt,ot,Oe,Qe,de=new Array($+1);for(ot=0,Oe=0;Oe<Z-1;Oe++)for(me[Oe]=ot,fe=0;fe<1<<re[Oe];fe++)le[ot++]=Oe;for(le[ot-1]=Oe,Qe=0,Oe=0;Oe<16;Oe++)for(De[Oe]=Qe,fe=0;fe<1<<W[Oe];fe++)rt[Qe++]=Oe;for(Qe>>=7;Oe<z;Oe++)for(De[Oe]=Qe<<7,fe=0;fe<1<<W[Oe]-7;fe++)rt[256+Qe++]=Oe;for(tt=0;tt<=$;tt++)de[tt]=0;for(fe=0;fe<=143;)Ne[fe*2+1]=8,fe++,de[8]++;for(;fe<=255;)Ne[fe*2+1]=9,fe++,de[9]++;for(;fe<=279;)Ne[fe*2+1]=7,fe++,de[7]++;for(;fe<=287;)Ne[fe*2+1]=8,fe++,de[8]++;for(Pt(Ne,ee+1,de),fe=0;fe<z;fe++)ze[fe*2+1]=5,ze[fe*2]=be(fe,5);Re=new Me(Ne,re,ne+1,ee,$),we=new Me(ze,W,0,z,$),ke=new Me(new Array(0),ie,0,P,te)}function At(fe){var tt;for(tt=0;tt<ee;tt++)fe.dyn_ltree[tt*2]=0;for(tt=0;tt<z;tt++)fe.dyn_dtree[tt*2]=0;for(tt=0;tt<P;tt++)fe.bl_tree[tt*2]=0;fe.dyn_ltree[q*2]=1,fe.opt_len=fe.static_len=0,fe.last_lit=fe.matches=0}function ri(fe){fe.bi_valid>8?$e(fe,fe.bi_buf):fe.bi_valid>0&&(fe.pending_buf[fe.pending++]=fe.bi_buf),fe.bi_buf=0,fe.bi_valid=0}function $t(fe,tt,ot,Oe){ri(fe),Oe&&($e(fe,ot),$e(fe,~ot)),O.arraySet(fe.pending_buf,fe.window,tt,ot,fe.pending),fe.pending+=ot}function Rt(fe,tt,ot,Oe){var Qe=tt*2,de=ot*2;return fe[Qe]<fe[de]||fe[Qe]===fe[de]&&Oe[tt]<=Oe[ot]}function zt(fe,tt,ot){for(var Oe=fe.heap[ot],Qe=ot<<1;Qe<=fe.heap_len&&(Qe<fe.heap_len&&Rt(tt,fe.heap[Qe+1],fe.heap[Qe],fe.depth)&&Qe++,!Rt(tt,Oe,fe.heap[Qe],fe.depth));)fe.heap[ot]=fe.heap[Qe],ot=Qe,Qe<<=1;fe.heap[ot]=Oe}function et(fe,tt,ot){var Oe,Qe,de=0,nt,bt;if(fe.last_lit!==0)do Oe=fe.pending_buf[fe.d_buf+de*2]<<8|fe.pending_buf[fe.d_buf+de*2+1],Qe=fe.pending_buf[fe.l_buf+de],de++,Oe===0?Se(fe,Qe,tt):(nt=le[Qe],Se(fe,nt+ne+1,tt),bt=re[nt],bt!==0&&(Qe-=me[nt],ue(fe,Qe,bt)),Oe--,nt=We(Oe),Se(fe,nt,ot),bt=W[nt],bt!==0&&(Oe-=De[nt],ue(fe,Oe,bt)));while(de<fe.last_lit);Se(fe,q,tt)}function ct(fe,tt){var ot=tt.dyn_tree,Oe=tt.stat_desc.static_tree,Qe=tt.stat_desc.has_stree,de=tt.stat_desc.elems,nt,bt,Q=-1,qe;for(fe.heap_len=0,fe.heap_max=Y,nt=0;nt<de;nt++)ot[nt*2]!==0?(fe.heap[++fe.heap_len]=Q=nt,fe.depth[nt]=0):ot[nt*2+1]=0;for(;fe.heap_len<2;)qe=fe.heap[++fe.heap_len]=Q<2?++Q:0,ot[qe*2]=1,fe.depth[qe]=0,fe.opt_len--,Qe&&(fe.static_len-=Oe[qe*2+1]);for(tt.max_code=Q,nt=fe.heap_len>>1;nt>=1;nt--)zt(fe,ot,nt);qe=de;do nt=fe.heap[1],fe.heap[1]=fe.heap[fe.heap_len--],zt(fe,ot,1),bt=fe.heap[1],fe.heap[--fe.heap_max]=nt,fe.heap[--fe.heap_max]=bt,ot[qe*2]=ot[nt*2]+ot[bt*2],fe.depth[qe]=(fe.depth[nt]>=fe.depth[bt]?fe.depth[nt]:fe.depth[bt])+1,ot[nt*2+1]=ot[bt*2+1]=qe,fe.heap[1]=qe++,zt(fe,ot,1);while(fe.heap_len>=2);fe.heap[--fe.heap_max]=fe.heap[1],ut(fe,tt),Pt(ot,Q,fe.bl_count)}function It(fe,tt,ot){var Oe,Qe=-1,de,nt=tt[0*2+1],bt=0,Q=7,qe=4;for(nt===0&&(Q=138,qe=3),tt[(ot+1)*2+1]=65535,Oe=0;Oe<=ot;Oe++)de=nt,nt=tt[(Oe+1)*2+1],!(++bt<Q&&de===nt)&&(bt<qe?fe.bl_tree[de*2]+=bt:de!==0?(de!==Qe&&fe.bl_tree[de*2]++,fe.bl_tree[K*2]++):bt<=10?fe.bl_tree[U*2]++:fe.bl_tree[F*2]++,bt=0,Qe=de,nt===0?(Q=138,qe=3):de===nt?(Q=6,qe=3):(Q=7,qe=4))}function at(fe,tt,ot){var Oe,Qe=-1,de,nt=tt[0*2+1],bt=0,Q=7,qe=4;for(nt===0&&(Q=138,qe=3),Oe=0;Oe<=ot;Oe++)if(de=nt,nt=tt[(Oe+1)*2+1],!(++bt<Q&&de===nt)){if(bt<qe)do Se(fe,de,fe.bl_tree);while(--bt!==0);else de!==0?(de!==Qe&&(Se(fe,de,fe.bl_tree),bt--),Se(fe,K,fe.bl_tree),ue(fe,bt-3,2)):bt<=10?(Se(fe,U,fe.bl_tree),ue(fe,bt-3,3)):(Se(fe,F,fe.bl_tree),ue(fe,bt-11,7));bt=0,Qe=de,nt===0?(Q=138,qe=3):de===nt?(Q=6,qe=3):(Q=7,qe=4)}}function vt(fe){var tt;for(It(fe,fe.dyn_ltree,fe.l_desc.max_code),It(fe,fe.dyn_dtree,fe.d_desc.max_code),ct(fe,fe.bl_desc),tt=P-1;tt>=3&&fe.bl_tree[he[tt]*2+1]===0;tt--);return fe.opt_len+=3*(tt+1)+5+5+4,tt}function Ke(fe,tt,ot,Oe){var Qe;for(ue(fe,tt-257,5),ue(fe,ot-1,5),ue(fe,Oe-4,4),Qe=0;Qe<Oe;Qe++)ue(fe,fe.bl_tree[he[Qe]*2+1],3);at(fe,fe.dyn_ltree,tt-1),at(fe,fe.dyn_dtree,ot-1)}function Je(fe){var tt=4093624447,ot;for(ot=0;ot<=31;ot++,tt>>>=1)if(tt&1&&fe.dyn_ltree[ot*2]!==0)return I;if(fe.dyn_ltree[9*2]!==0||fe.dyn_ltree[10*2]!==0||fe.dyn_ltree[13*2]!==0)return _;for(ot=32;ot<ne;ot++)if(fe.dyn_ltree[ot*2]!==0)return _;return I}var ei=!1;function ki(fe){ei||(yt(),ei=!0),fe.l_desc=new Ve(fe.dyn_ltree,Re),fe.d_desc=new Ve(fe.dyn_dtree,we),fe.bl_desc=new Ve(fe.bl_tree,ke),fe.bi_buf=0,fe.bi_valid=0,At(fe)}function ti(fe,tt,ot,Oe){ue(fe,(y<<1)+(Oe?1:0),3),$t(fe,tt,ot,!0)}function je(fe){ue(fe,v<<1,3),Se(fe,q,Ne),Fe(fe)}function Xe(fe,tt,ot,Oe){var Qe,de,nt=0;fe.level>0?(fe.strm.data_type===S&&(fe.strm.data_type=Je(fe)),ct(fe,fe.l_desc),ct(fe,fe.d_desc),nt=vt(fe),Qe=fe.opt_len+3+7>>>3,de=fe.static_len+3+7>>>3,de<=Qe&&(Qe=de)):Qe=de=ot+5,ot+4<=Qe&&tt!==-1?ti(fe,tt,ot,Oe):fe.strategy===x||de===Qe?(ue(fe,(v<<1)+(Oe?1:0),3),et(fe,Ne,ze)):(ue(fe,(m<<1)+(Oe?1:0),3),Ke(fe,fe.l_desc.max_code+1,fe.d_desc.max_code+1,nt+1),et(fe,fe.dyn_ltree,fe.dyn_dtree)),At(fe),Oe&&ri(fe)}function _t(fe,tt,ot){return fe.pending_buf[fe.d_buf+fe.last_lit*2]=tt>>>8&255,fe.pending_buf[fe.d_buf+fe.last_lit*2+1]=tt&255,fe.pending_buf[fe.l_buf+fe.last_lit]=ot&255,fe.last_lit++,tt===0?fe.dyn_ltree[ot*2]++:(fe.matches++,tt--,fe.dyn_ltree[(le[ot]+ne+1)*2]++,fe.dyn_dtree[We(tt)*2]++),fe.last_lit===fe.lit_bufsize-1}N._tr_init=ki,N._tr_stored_block=ti,N._tr_flush_block=Xe,N._tr_tally=_t,N._tr_align=je},{"../utils/common":27}],39:[function(w,E,N){function O(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}E.exports=O},{}]},{},[9])(9)});/**
 * videojs-http-source-selector-contrib-quality-levels
 * Original source https://github.com/jfujita/videojs-http-source-selector 1.1.6 by jfujita
 * rewritten to work with videojs-http-source-selector ^8.0
 * @author https://github.com/csgultekin
 * for Ozet Akademi
 * @link https://github.com/OzetAkademi/videojs-http-source-selector
 * @version 1.1.7
 * @license Apache-2.0
 */(function(A,j){typeof exports=="object"&&typeof module<"u"?module.exports=j(require("video.js")):typeof define=="function"&&define.amd?define(["video.js"],j):(A=A||self,A["videojs-http-source-selector"]=j(A.videojs))})(this,function(A){A=A&&Object.prototype.hasOwnProperty.call(A,"default")?A.default:A;var j=A.getComponent("MenuButton"),M=A.getComponent("MenuItem"),w="1.1.7";class E extends M{constructor(u,y){super(u,y)}handleClick(u){for(var y=this.el_.parentNode.children,v=this.options_,m=this.player().qualityLevels(),R=0;R<y.length;R++)y[R].classList.remove("vjs-selected");for(var V=0;V<m.length;V++)m[V].enabled_(!1),(v.index==m.length||v.index==V)&&m[V].enabled_(!0);super.handleClick(u)}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}}class N extends j{createEl(){return A.dom.createEl("div",{className:"vjs-http-source-selector vjs-menu-button vjs-menu-button-popup vjs-control vjs-button"})}buildCSSClass(){return j.prototype.buildCSSClass.call(this)+" vjs-icon-cog"}update=function(){return j.prototype.update.call(this)};createItems(){this.options_.selectable=!0,this.options_.multiSelectable=!1;var u=this.player().qualityLevels();if(this.options_&&this.options_.default){if(this.options_.default=="low")for(var y=0;y<u.length;y++)u[y].enabled=y==0;else if(this.options_.default="high")for(var y=0;y<u.length;y++)u[y].enabled=y==u.length-1}for(var v=[],m=this.player().qualityLevels(),R=[],y=0;y<m.length;y++){var V=m.length-(y+1),Z=V===m.selectedIndex,ne=""+V,ee=V;m[V].height?(ne=m[V].height+"p",ee=parseInt(m[V].height,10)):m[V].bitrate&&(ne=Math.floor(m[V].bitrate/1e3)+" kbps",ee=parseInt(m[V].bitrate,10)),!(R.indexOf(ne)>=0)&&(R.push(ne),v.push(new E(this.player_,{label:ne,index:V,selected:Z,sortVal:ee,selectable:!0,multiSelectable:!1})))}return m.length>1&&v.push(new E(this.player_,{label:"Auto",index:m.length,selected:!1,sortVal:99999,selectable:!0,multiSelectable:!1})),v.sort(function(z,P){return z.options_.sortVal<P.options_.sortVal?1:z.options_.sortVal>P.options_.sortVal?-1:0}),v}}var O={},x=A.registerPlugin||A.plugin,I=function(u,y){if(u.addClass("vjs-http-source-selector"),A.log("videojs-http-source-selector-http-source-selector initialized!"),A.log("player.techName_:"+u.techName_),u.techName_!="Html5")return!1;u.on(["loadedmetadata"],function(v){var m=u.qualityLevels();if(A.log("loadmetadata event"),u.videojs_http_source_selector_initialized=="undefined"||u.videojs_http_source_selector_initialized==!0)A.log("player.videojs_http_source_selector_initialized == true");else{A.log("player.videojs_http_source_selector_initialized == false"),u.videojs_http_source_selector_initialized=!0;var R=u.controlBar,V=R.getChild("fullscreenToggle").el();R.addChild("SourceMenuButton",{})}})},_=function(u){var y=this;this.ready(function(){I(y,A.mergeOptions(O,u))}),A.registerComponent("SourceMenuButton",N),A.registerComponent("SourceMenuItem",E)};return x("httpSourceSelector",_),_.VERSION=w,_});
